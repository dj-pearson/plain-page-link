import{j as e}from"./ui-components-DtyTDbSg.js";import{r as s}from"./react-vendor-B_Chv4nK.js";import{u as t}from"./use-toast-BIxl6y56.js";import{u as a}from"./data-ChU7VID-.js";import{u as l,B as r,l as n,C as i,e as d,s as m}from"./index-DxTo7WPx.js";import{u as o,U as c}from"./UpgradeModal-CFOSkjmS.js";import{K as x,S as h,M as u,P as p,e as f,j,J as v}from"./icons-K_BhWJ_Z.js";import"./three-t2PEh41g.js";import"./charts-CeHnXkIf.js";import"./utils-D6PrBqaA.js";import"./supabase-D4JaKbf_.js";import"./forms-yc2f2ZZT.js";function g(){const[g,N]=s.useState(""),[b,w]=s.useState(!1),{user:y}=l(),{toast:C}=t(),{subscription:L}=o(),{data:S,isLoading:k}=a({queryKey:["leads",null==y?void 0:y.id],queryFn:async()=>{if(!(null==y?void 0:y.id))return[];const{data:e,error:s}=await m.from("leads").select("*").eq("user_id",y.id).order("created_at",{ascending:!1});if(s)throw s;return e},enabled:!!(null==y?void 0:y.id)}),_=s=>{const t={new:{variant:"default",label:"New"},contacted:{variant:"secondary",label:"Contacted"},qualified:{variant:"outline",label:"Qualified"},converted:{variant:"default",label:"Converted"}}[s]||{variant:"outline",label:s};return e.jsx(n,{variant:t.variant,children:t.label})},q=s=>{switch(s){case"buyer":return e.jsx(v,{className:"h-4 w-4"});case"seller":return e.jsx(p,{className:"h-4 w-4"});case"valuation":return e.jsx(u,{className:"h-4 w-4"});default:return e.jsx(j,{className:"h-4 w-4"})}},U=null==S?void 0:S.filter(e=>!g||(e.name.toLowerCase().includes(g.toLowerCase())||e.email.toLowerCase().includes(g.toLowerCase())));return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Lead Management"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Track and follow up with your inquiries"})]}),e.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:e.jsxs(r,{onClick:()=>{if("free"===(null==L?void 0:L.plan_name))return void w(!0);if(!S||0===S.length)return void C({title:"No leads to export",description:"You don't have any leads yet.",variant:"destructive"});const e=[["Name","Email","Phone","Type","Message","Status","Created At"].join(","),...S.map(e=>[e.name,e.email,e.phone||"",e.lead_type,`"${(e.message||"").replace(/"/g,'""')}"`,e.status,new Date(e.created_at).toLocaleDateString()].join(","))].join("\n"),s=new Blob([e],{type:"text/csv"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`leads-${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t),C({title:"Leads exported",description:`Successfully exported ${S.length} leads to CSV`})},variant:"outline",disabled:!S||0===S.length,className:"flex-1 sm:flex-none min-h-[44px] active:scale-95 transition-all",children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Export CSV"}),"free"===(null==L?void 0:L.plan_name)&&e.jsx(n,{variant:"secondary",className:"ml-2",children:"Pro"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(i,{className:"hover:shadow-md transition-shadow",children:e.jsxs(d,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-foreground",children:(null==S?void 0:S.length)||0}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Total Leads"})]})}),e.jsx(i,{className:"hover:shadow-md transition-shadow",children:e.jsxs(d,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:(null==S?void 0:S.filter(e=>"new"===e.status).length)||0}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"New"})]})}),e.jsx(i,{className:"hover:shadow-md transition-shadow",children:e.jsxs(d,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:(null==S?void 0:S.filter(e=>"contacted"===e.status).length)||0}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Contacted"})]})}),e.jsx(i,{className:"hover:shadow-md transition-shadow",children:e.jsxs(d,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary",children:(null==S?void 0:S.filter(e=>"converted"===e.status).length)||0}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Converted"})]})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),e.jsx("input",{type:"text",placeholder:"Search leads by name or email...",value:g,onChange:e=>N(e.target.value),className:"w-full pl-10 pr-4 py-2.5 sm:py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm sm:text-base min-h-[44px]"})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:k?e.jsx(i,{children:e.jsx(d,{className:"p-6 sm:p-8 text-center text-muted-foreground text-sm sm:text-base",children:"Loading leads..."})}):U&&U.length>0?U.map(s=>e.jsx(i,{className:"hover:shadow-md active:shadow-lg transition-all",children:e.jsx(d,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:q(s.lead_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-sm sm:text-base text-foreground truncate",children:s.name}),_(s.status),e.jsx(n,{variant:"outline",className:"capitalize text-xs",children:s.lead_type})]}),e.jsxs("div",{className:"space-y-1.5 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 min-h-[32px]",children:[e.jsx(u,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("a",{href:`mailto:${s.email}`,className:"hover:text-primary active:text-primary-dark break-all",children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 min-h-[32px]",children:[e.jsx(p,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("a",{href:`tel:${s.phone}`,className:"hover:text-primary active:text-primary-dark",children:s.phone})]}),s.message&&e.jsx("p",{className:"mt-2 text-foreground line-clamp-2 text-xs sm:text-sm leading-relaxed",children:s.message})]})]})]}),e.jsx("div",{className:"text-left sm:text-right flex-shrink-0 pl-12 sm:pl-0",children:e.jsxs("div",{className:"flex sm:justify-end items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(f,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]})})]})})},s.id)):e.jsx(i,{children:e.jsxs(d,{className:"p-8 sm:p-12 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 bg-accent rounded-full mb-3 sm:mb-4",children:e.jsx(j,{className:"h-7 w-7 sm:h-8 sm:w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1 sm:mb-2",children:"No leads yet"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:"Leads will appear here when visitors contact you through your profile"})]})})}),e.jsx(c,{open:b,onOpenChange:w,feature:"lead_export",currentPlan:(null==L?void 0:L.plan_name)||"Free",requiredPlan:"Starter"})]})}export{g as default};
