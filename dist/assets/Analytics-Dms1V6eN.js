import{ab as $,j as e,C as y,c as b,d as w,Y as g,f as v,e as L,r as S,B as u,$ as F,M as q,aa as z,U as V,bL as U,bM as Y,bN as E,i as I,p as G,ag as H,g as O,V as W,aq as X,ae as J,J as Q,n as Z,a4 as ee,a5 as se}from"./index-j2vL7j7Z.js";import{g as ae,B as M,X as _,Y as P,f as te,R as ie,L as re,a as ne,T as le,b as oe,c as ce,d as de,e as T,h as f,i as me,j as p}from"./table-DrxlT8ia.js";import{A as xe,a as he,C as pe,S as ue}from"./SearchAnalyticsDashboard-ChgaMhur.js";import{L as B}from"./lightbulb-BevxGu3p.js";import{T as ge,a as je,b as D,c as R}from"./tabs-iLw12Itq.js";import{D as fe,a as ye,b as be,c as A}from"./dropdown-menu-CiKPVbbK.js";import{u as we}from"./useAnalytics-CP1MWZhH.js";import"./useMutation-C2pZVh8S.js";import"./circle-x-DjqGd3Ob.js";import"./mouse-pointer-vJQa_c42.js";import"./file-text-CgF0aHFr.js";import"./trending-down-BMtc3A6H.js";import"./minus-zqsPzhE0.js";import"./popover-DRoNIYeG.js";import"./checkbox-CFt5kuWI.js";import"./filter-BZCybRNZ.js";import"./exportUtils-BaHhu_V5.js";import"./refresh-cw-DyqD2dep.js";import"./settings-BeSz7WMv.js";import"./index-DolH92gt.js";const ve=$("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function C({title:a,value:r,change:t,changeLabel:m="vs last period",icon:i,iconColor:c="text-blue-600",iconBgColor:d="bg-blue-100",trend:l="neutral"}){const x=l==="up"?"text-green-600":l==="down"?"text-red-600":"text-gray-600",n=l==="up"?"↑":l==="down"?"↓":"•";return e.jsxs(y,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(w,{className:"text-sm font-medium text-muted-foreground",children:a}),e.jsx("div",{className:g("rounded-full p-2",d),children:e.jsx(i,{className:g("h-4 w-4",c)})})]}),e.jsxs(v,{children:[e.jsx("div",{className:"text-2xl font-bold",children:r}),t!==void 0&&e.jsxs("p",{className:g("text-xs font-medium mt-1",x),children:[n," ",Math.abs(t),"% ",m]})]})]})}var Ne=ae({chartName:"BarChart",GraphicalChild:M,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:_},{axisType:"yAxis",AxisComp:P}],formatAxisMap:te});function Ce({title:a,description:r,data:t,series:m,type:i="line",height:c=300,showLegend:d=!0,yAxisLabel:l}){const x=()=>{const n={data:t,margin:{top:5,right:20,left:0,bottom:5}},N=e.jsxs(e.Fragment,{children:[e.jsx(pe,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(_,{dataKey:"name",tick:{fontSize:12},tickLine:!1,axisLine:!1}),e.jsx(P,{tick:{fontSize:12},tickLine:!1,axisLine:!1,label:l?{value:l,angle:-90,position:"insideLeft"}:void 0}),e.jsx(le,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}}),d&&e.jsx(oe,{})]});switch(i){case"area":return e.jsxs(xe,{...n,children:[N,m.map(s=>e.jsx(he,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,fill:s.color,fillOpacity:.2,strokeWidth:2},s.dataKey))]});case"bar":return e.jsxs(Ne,{...n,children:[N,m.map(s=>e.jsx(M,{dataKey:s.dataKey,name:s.name,fill:s.color,radius:[4,4,0,0]},s.dataKey))]});case"line":default:return e.jsxs(re,{...n,children:[N,m.map(s=>e.jsx(ne,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,strokeWidth:2,dot:{r:4},activeDot:{r:6}},s.dataKey))]})}};return e.jsxs(y,{children:[e.jsxs(b,{children:[e.jsx(w,{children:a}),r&&e.jsx(L,{children:r})]}),e.jsx(v,{children:e.jsx(ie,{width:"100%",height:c,children:x()})})]})}function ke({leads:a,onLeadClick:r}){const[t,m]=S.useState("created_at"),[i,c]=S.useState("desc"),d=s=>{t===s?c(i==="asc"?"desc":"asc"):(m(s),c("desc"))},l=[...a].sort((s,h)=>{let j=0;switch(t){case"created_at":j=new Date(s.created_at).getTime()-new Date(h.created_at).getTime();break;case"name":j=s.name.localeCompare(h.name);break;case"lead_type":j=s.lead_type.localeCompare(h.lead_type);break;case"status":j=s.status.localeCompare(h.status);break}return i==="asc"?j:-j}),x=({field:s})=>t!==s?null:i==="asc"?e.jsx(Y,{className:"inline w-4 h-4 ml-1"}):e.jsx(E,{className:"inline w-4 h-4 ml-1"}),n=s=>{switch(s){case"new":return"bg-blue-100 text-blue-800";case"contacted":return"bg-yellow-100 text-yellow-800";case"qualified":return"bg-green-100 text-green-800";case"converted":return"bg-purple-100 text-purple-800";case"lost":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},N=s=>{switch(s){case"buyer":return"Buyer";case"seller":return"Seller";case"valuation":return"Valuation";case"contact":return"Contact";default:return s}};return e.jsxs(y,{children:[e.jsxs(b,{children:[e.jsx(w,{children:"Recent Leads"}),e.jsxs(L,{children:["Your latest lead submissions (",a.length," total)"]})]}),e.jsx(v,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(ce,{children:[e.jsx(de,{children:e.jsxs(T,{children:[e.jsx(f,{children:e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>d("name"),className:"hover:bg-transparent",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Name",e.jsx(x,{field:"name"})]})}),e.jsx(f,{children:"Contact"}),e.jsx(f,{children:e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>d("lead_type"),className:"hover:bg-transparent",children:["Type",e.jsx(x,{field:"lead_type"})]})}),e.jsx(f,{children:e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>d("status"),className:"hover:bg-transparent",children:["Status",e.jsx(x,{field:"status"})]})}),e.jsx(f,{children:e.jsxs(u,{variant:"ghost",size:"sm",onClick:()=>d("created_at"),className:"hover:bg-transparent",children:["Date",e.jsx(x,{field:"created_at"})]})}),e.jsx(f,{className:"text-right",children:"Actions"})]})}),e.jsx(me,{children:l.length===0?e.jsx(T,{children:e.jsx(p,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No leads yet. They'll appear here when visitors submit forms."})}):l.map(s=>e.jsxs(T,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>r?.(s),children:[e.jsx(p,{className:"font-medium",children:s.name}),e.jsx(p,{children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("a",{href:`mailto:${s.email}`,className:"flex items-center text-blue-600 hover:underline",onClick:h=>h.stopPropagation(),children:[e.jsx(q,{className:"w-3 h-3 mr-1"}),s.email]}),s.phone&&e.jsxs("a",{href:`tel:${s.phone}`,className:"flex items-center text-blue-600 hover:underline",onClick:h=>h.stopPropagation(),children:[e.jsx(z,{className:"w-3 h-3 mr-1"}),s.phone]})]})}),e.jsx(p,{children:e.jsx(V,{variant:"outline",children:N(s.lead_type)})}),e.jsx(p,{children:e.jsx(V,{className:n(s.status),children:s.status})}),e.jsx(p,{className:"text-sm text-muted-foreground",children:U(s.created_at)}),e.jsx(p,{className:"text-right",children:e.jsx(u,{variant:"ghost",size:"sm",onClick:h=>{h.stopPropagation(),r?.(s)},children:"View"})})]},s.id))})]})})})]})}function Le({stats:a,previousStats:r,listingsCount:t=0,linksCount:m=0}){const i=[],c=r?(a.totalViews-r.totalViews)/(r.totalViews||1)*100:0,d=r?(a.totalLeads-r.totalLeads)/(r.totalLeads||1)*100:0;c>20&&i.push({id:"views-growth",type:"positive",title:`Profile views up ${c.toFixed(0)}%`,description:"Your profile is getting great visibility! Keep sharing your link on social media."}),d>15&&i.push({id:"leads-growth",type:"positive",title:`Leads increased ${d.toFixed(0)}%`,description:"Your lead generation is accelerating. Make sure to respond quickly to maintain momentum.",action:{label:"Check leads",href:"/dashboard/leads"}}),a.conversionRate>5&&i.push({id:"high-conversion",type:"positive",title:`Strong ${a.conversionRate}% conversion rate`,description:"You're converting visitors to leads at an excellent rate!"}),a.totalViews>100&&a.conversionRate<2&&i.push({id:"low-conversion",type:"warning",title:"Conversion rate could be higher",description:"You're getting views but not many leads. Try adding clear call-to-action buttons.",action:{label:"Add CTAs",href:"/dashboard/links"}}),a.totalViews<50&&t>0&&i.push({id:"low-traffic",type:"warning",title:"Profile needs more visibility",description:"Share your profile link on Instagram, Facebook, and email signatures to increase traffic."}),t===0?i.push({id:"no-listings",type:"warning",title:"Add your first listing",description:"Profiles with property listings get 3x more leads. Showcase what you're selling!",action:{label:"Add listing",href:"/dashboard/listings"}}):t<3&&i.push({id:"few-listings",type:"tip",title:"Add more listings",description:"Agents with 5+ listings convert 40% better. Add more properties to build credibility.",action:{label:"Add listings",href:"/dashboard/listings"}}),m===0&&i.push({id:"no-links",type:"tip",title:"Add custom links",description:"Link to your website, calendar, and social media to give visitors more ways to connect.",action:{label:"Add links",href:"/dashboard/links"}}),a.totalViews>0&&a.totalLeads===0&&i.push({id:"no-leads-yet",type:"tip",title:"First lead tips",description:"Add contact forms, showcase testimonials, and ensure your phone/email are visible.",action:{label:"Edit profile",href:"/dashboard/profile"}}),c<-20&&i.push({id:"views-declining",type:"warning",title:`Views down ${Math.abs(c).toFixed(0)}%`,description:"Increase your social media activity and consider updating your listings to boost visibility."}),i.length===0&&i.push({id:"keep-going",type:"positive",title:"You're doing great!",description:"Keep your profile updated with fresh listings and share it regularly to maintain growth."});const l=n=>{switch(n){case"positive":return e.jsx(O,{className:"w-5 h-5 text-green-600"});case"warning":return e.jsx(H,{className:"w-5 h-5 text-orange-600"});case"tip":return e.jsx(B,{className:"w-5 h-5 text-blue-600"})}},x=n=>{switch(n){case"positive":return"bg-green-50 border-green-200";case"warning":return"bg-orange-50 border-orange-200";case"tip":return"bg-blue-50 border-blue-200"}};return e.jsxs(y,{children:[e.jsx(b,{className:"pb-3",children:e.jsxs(w,{className:"text-lg flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-primary"}),"Insights & Recommendations"]})}),e.jsx(v,{children:e.jsx("div",{className:"space-y-3",children:i.slice(0,5).map(n=>e.jsx("div",{className:`p-4 rounded-lg border ${x(n.type)}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:l(n.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-1",children:n.title}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:n.description}),n.action&&e.jsxs(I,{to:n.action.href,className:"inline-flex items-center gap-1 text-sm font-medium text-blue-600 hover:text-blue-700",children:[n.action.label,e.jsx(G,{className:"w-4 h-4"})]})]})]})},n.id))})})]})}function o({className:a,animate:r=!0,...t}){return e.jsx("div",{className:g("rounded-md bg-gray-200",r&&"animate-pulse",a),"aria-hidden":"true",...t})}function K({className:a}){return e.jsxs("div",{className:g("rounded-lg border border-gray-200 bg-white p-4 sm:p-6",a),"aria-hidden":"true",children:[e.jsx(o,{className:"h-4 w-1/3 mb-4"}),e.jsx(o,{className:"h-8 w-1/2 mb-2"}),e.jsx(o,{className:"h-3 w-2/3"})]})}function k({className:a}){return e.jsxs("div",{className:g("rounded-lg border border-gray-200 bg-white p-4 sm:p-6",a),"aria-hidden":"true",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(o,{className:"h-4 w-20"}),e.jsx(o,{className:"h-8 w-8 rounded-full"})]}),e.jsx(o,{className:"h-7 w-16 mb-1"}),e.jsx(o,{className:"h-3 w-24"})]})}function Te({className:a,height:r=300}){return e.jsxs("div",{className:g("rounded-lg border border-gray-200 bg-white p-4 sm:p-6",a),"aria-hidden":"true",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{children:[e.jsx(o,{className:"h-5 w-32 mb-2"}),e.jsx(o,{className:"h-3 w-48"})]})}),e.jsx(o,{className:"w-full rounded-lg",style:{height:`${r}px`}})]})}function Ae(){return e.jsxs("div",{className:"space-y-4 sm:space-y-6",role:"status","aria-label":"Loading analytics",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx(o,{className:"h-8 w-32 mb-2"}),e.jsx(o,{className:"h-4 w-64"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{className:"h-9 w-32"}),e.jsx(o,{className:"h-9 w-28"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(k,{}),e.jsx(k,{}),e.jsx(k,{}),e.jsx(k,{})]}),e.jsx(Te,{height:250}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(K,{}),e.jsx(K,{})]}),e.jsx("span",{className:"sr-only",children:"Loading analytics data..."})]})}function We(){const[a,r]=S.useState("30d"),{stats:t,viewsData:m,leadsData:i,recentLeads:c,isLoading:d}=we(a);return d?e.jsx(Ae,{}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Analytics"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Track your profile performance, lead generation, and search visibility"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(fe,{children:[e.jsx(ye,{asChild:!0,children:e.jsxs(u,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:a==="7d"?"Last 7 days":a==="30d"?"Last 30 days":"Last 90 days"})]})}),e.jsxs(be,{align:"end",children:[e.jsx(A,{onClick:()=>r("7d"),children:"Last 7 days"}),e.jsx(A,{onClick:()=>r("30d"),children:"Last 30 days"}),e.jsx(A,{onClick:()=>r("90d"),children:"Last 90 days"})]})]}),e.jsxs(u,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Export"})]})]})]}),e.jsxs(ge,{defaultValue:"overview",className:"space-y-4 sm:space-y-6",children:[e.jsxs(je,{className:"grid w-full grid-cols-2 sm:w-auto",children:[e.jsxs(D,{value:"overview",className:"gap-2",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Profile Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Overview"})]}),e.jsxs(D,{value:"search",className:"gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Search Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Search"})]})]}),e.jsxs(R,{value:"overview",className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(C,{title:"Total Views",value:t.totalViews.toLocaleString(),icon:Z,iconColor:"text-blue-600",iconBgColor:"bg-blue-100"}),e.jsx(C,{title:"Unique Visitors",value:t.uniqueVisitors.toLocaleString(),icon:ee,iconColor:"text-green-600",iconBgColor:"bg-green-100"}),e.jsx(C,{title:"Total Leads",value:t.totalLeads,icon:ve,iconColor:"text-purple-600",iconBgColor:"bg-purple-100"}),e.jsx(C,{title:"Conversion Rate",value:`${t.conversionRate}%`,icon:se,iconColor:"text-orange-600",iconBgColor:"bg-orange-100"})]}),e.jsx(Le,{stats:t,listingsCount:0,linksCount:0}),e.jsx(Ce,{title:"Profile Views",description:"Views and unique visitors over time",data:m.length>0?m:[{name:"No data",views:0,visitors:0}],series:[{dataKey:"views",name:"Total Views",color:"#3B82F6"},{dataKey:"visitors",name:"Unique Visitors",color:"#10B981"}],type:"area",height:window.innerWidth<640?200:300}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(y,{children:[e.jsxs(b,{className:"pb-3 sm:pb-4",children:[e.jsx(w,{className:"text-base sm:text-lg",children:"Leads by Type"}),e.jsx(L,{className:"text-xs sm:text-sm",children:"Distribution of lead inquiries"})]}),e.jsx(v,{children:i.length>0?e.jsx("div",{className:"space-y-2 sm:space-y-3",children:i.map(l=>e.jsxs("div",{className:"flex items-center justify-between py-2 min-h-[44px]",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:l.name})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:"text-xs sm:text-sm text-muted-foreground whitespace-nowrap",children:[l.value," leads"]}),e.jsxs("span",{className:"text-xs sm:text-sm font-semibold min-w-[35px] text-right",children:[t.totalLeads>0?(l.value/t.totalLeads*100).toFixed(0):0,"%"]})]})]},l.name))}):e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:"No leads yet"})})]}),e.jsxs(y,{children:[e.jsxs(b,{className:"pb-3 sm:pb-4",children:[e.jsx(w,{className:"text-base sm:text-lg",children:"Recent Activity"}),e.jsx(L,{className:"text-xs sm:text-sm",children:"Latest profile interactions"})]}),e.jsx(v,{children:e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:t.totalViews>0?`${t.totalViews} profile views`:"No activity yet"})})]})]}),e.jsx(ke,{leads:c,onLeadClick:l=>console.log("Lead clicked:",l)})]}),e.jsx(R,{value:"search",className:"space-y-4 sm:space-y-6",children:e.jsx(ue,{})})]})]})}export{We as default};
