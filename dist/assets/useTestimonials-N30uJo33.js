import{b as i,u as e,d as t}from"./data-Hz84gFTE.js";import{u as s,s as n}from"./index-q1Xv5wHf.js";function a(){const{user:a}=s(),o=i(),{data:r=[],isLoading:d}=e({queryKey:["testimonials",null==a?void 0:a.id],queryFn:async()=>{if(!(null==a?void 0:a.id))return[];const{data:i,error:e}=await n.from("testimonials").select("*").eq("user_id",a.id).order("date",{ascending:!1});if(e)throw e;return i},enabled:!!(null==a?void 0:a.id)});return{testimonials:r,isLoading:d,addTestimonial:t({mutationFn:async i=>{if(!(null==a?void 0:a.id))throw new Error("User not authenticated");const{data:e,error:t}=await n.from("testimonials").insert({user_id:a.id,...i}).select().single();if(t)throw t;return e},onSuccess:()=>{o.invalidateQueries({queryKey:["testimonials",null==a?void 0:a.id]})}}),updateTestimonial:t({mutationFn:async({id:i,...e})=>{const{data:t,error:s}=await n.from("testimonials").update(e).eq("id",i).select().single();if(s)throw s;return t},onSuccess:()=>{o.invalidateQueries({queryKey:["testimonials",null==a?void 0:a.id]})}}),deleteTestimonial:t({mutationFn:async i=>{const{error:e}=await n.from("testimonials").delete().eq("id",i);if(e)throw e},onSuccess:()=>{o.invalidateQueries({queryKey:["testimonials",null==a?void 0:a.id]})}})}}export{a as u};
