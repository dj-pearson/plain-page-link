import{u as h}from"./data-15YcDnrk.js";import{s as m}from"./supabase-Ba7v9dZh.js";import{u as y}from"./state-stores-BuSRU7CA.js";import{j as e,L as b}from"./react-vendor-CotwlNTQ.js";import{D as w,l as k,m as L,n as S,G as _,B as f,O as F,j}from"./ui-components-XxFWEsul.js";import{aA as g,T as d,Z as N}from"./icons-CcUX9GkC.js";function I(){const{user:n}=y(),{data:a,isLoading:t}=h({queryKey:["subscription",n?.id],queryFn:async()=>{if(!n?.id)return null;const{data:s,error:i}=await m.from("subscriptions").select("*").eq("user_id",n.id).single();if(i)throw i;return s},enabled:!!n?.id}),{data:l,isLoading:x}=h({queryKey:["usage",n?.id],queryFn:async()=>{if(!n?.id)return{listings:0,links:0,testimonials:0};const[s,i,r]=await Promise.all([m.from("listings").select("id",{count:"exact"}).eq("user_id",n.id),m.from("links").select("id",{count:"exact"}).eq("user_id",n.id),m.from("testimonials").select("id",{count:"exact"}).eq("user_id",n.id)]);return{listings:s.count||0,links:i.count||0,testimonials:r.count||0}},enabled:!!n?.id}),c=s=>{if(!a||!l)return!1;const i=a[`max_${s}`],r=l[s];return i===-1?!0:r<i},u=s=>a?.[s]||!1,o=s=>{if(!a)return 0;const i=a[`max_${s}`];return i===-1?1/0:i},p=s=>l?.[s]||0;return{subscription:a,usage:l,isLoading:t||x,canAdd:c,hasFeature:u,getLimit:o,getUsage:p,getRemainingCount:s=>{const i=o(s),r=p(s);return i===1/0?1/0:Math.max(0,i-r)}}}const v={listings:{plan:"Starter",icon:d},testimonials:{plan:"Starter",icon:g},links:{plan:"Starter",icon:d},custom_domain:{plan:"Professional",icon:g},lead_export:{plan:"Starter",icon:d},analytics:{plan:"Professional",icon:d},premium_themes:{plan:"Professional",icon:g}};function M({open:n,onOpenChange:a,feature:t,currentPlan:l="Free",requiredPlan:x}){const c=v[t]||{plan:"Professional",icon:N},u=c.icon,o=x||c.plan;return e.jsx(w,{open:n,onOpenChange:a,children:e.jsxs(k,{className:"sm:max-w-md",children:[e.jsxs(L,{children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 mx-auto mb-4",children:e.jsx(u,{className:"w-6 h-6 text-primary"})}),e.jsxs(S,{className:"text-center text-2xl",children:["Upgrade to unlock ",t.replace(/_/g," ")]}),e.jsxs(_,{className:"text-center pt-2",children:["You've reached the limit of your ",e.jsx(f,{variant:"secondary",children:l})," plan. Upgrade to ",e.jsx(f,{variant:"default",children:o})," to unlock this feature."]})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 my-4",children:[e.jsx("h4",{className:"font-semibold mb-2",children:"What you'll get:"}),e.jsxs("ul",{className:"space-y-2 text-sm",children:[t==="listings"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"flex items-center gap-2",children:"✓ Up to 20 active listings (Starter)"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Featured property showcase"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Sold properties tracking"})]}),t==="testimonials"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"flex items-center gap-2",children:"✓ Up to 10 testimonials (Starter)"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Client reviews showcase"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Rating display"})]}),t==="links"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"flex items-center gap-2",children:"✓ Up to 15 custom links (Starter)"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Link analytics"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Custom icons"})]}),t==="lead_export"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"flex items-center gap-2",children:"✓ Export all leads to CSV"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ CRM integration ready"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Lead management tools"})]}),t==="custom_domain"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"flex items-center gap-2",children:"✓ Connect your own domain"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Professional branding"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ SSL certificate included"})]}),t==="premium_themes"&&e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"flex items-center gap-2",children:"✓ 10+ premium themes"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ 3D animated backgrounds"}),e.jsx("li",{className:"flex items-center gap-2",children:"✓ Advanced customization"})]})]})]}),e.jsxs(F,{className:"gap-2 sm:gap-0",children:[e.jsx(j,{variant:"outline",onClick:()=>a(!1),children:"Maybe Later"}),e.jsx(b,{to:"/pricing",children:e.jsxs(j,{className:"w-full sm:w-auto",children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"View Plans"]})})]})]})})}export{M as U,I as u};
