import{j as e}from"./ui-components-DtyTDbSg.js";import{r as s}from"./react-vendor-B_Chv4nK.js";import{C as a,b as t,c as r,m as l,e as i,d as n,B as c,l as o,z as d}from"./index-DxTo7WPx.js";import{R as m,L as x,a as h,B as j,b as p,A as u,c as f,C as g,X as N,Y as b,T as y,d as v}from"./charts-CeHnXkIf.js";import{J as w,M as C,P as k,c as L,b as T,e as R,K as _,E as K,U as V,ak as B,q as S}from"./icons-K_BhWJ_Z.js";import{u as z}from"./useAnalytics-CR6_g7oU.js";import"./three-t2PEh41g.js";import"./data-ChU7VID-.js";import"./utils-D6PrBqaA.js";import"./supabase-D4JaKbf_.js";import"./forms-yc2f2ZZT.js";function D({title:s,value:n,change:c,changeLabel:o="vs last period",icon:d,iconColor:m="text-blue-600",iconBgColor:x="bg-blue-100",trend:h="neutral"}){const j="up"===h?"text-green-600":"down"===h?"text-red-600":"text-gray-600",p="up"===h?"↑":"down"===h?"↓":"•";return e.jsxs(a,{children:[e.jsxs(t,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(r,{className:"text-sm font-medium text-muted-foreground",children:s}),e.jsx("div",{className:l("rounded-full p-2",x),children:e.jsx(d,{className:l("h-4 w-4",m)})})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold",children:n}),void 0!==c&&e.jsxs("p",{className:l("text-xs font-medium mt-1",j),children:[p," ",Math.abs(c),"% ",o]})]})]})}function q({title:s,description:l,data:c,series:o,type:d="line",height:w=300,showLegend:C=!0,yAxisLabel:k}){return e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsx(r,{children:s}),l&&e.jsx(n,{children:l})]}),e.jsx(i,{children:e.jsx(m,{width:"100%",height:w,children:(()=>{const s={data:c,margin:{top:5,right:20,left:0,bottom:5}},a=e.jsxs(e.Fragment,{children:[e.jsx(g,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(N,{dataKey:"name",tick:{fontSize:12},tickLine:!1,axisLine:!1}),e.jsx(b,{tick:{fontSize:12},tickLine:!1,axisLine:!1,label:k?{value:k,angle:-90,position:"insideLeft"}:void 0}),e.jsx(y,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}}),C&&e.jsx(v,{})]});switch(d){case"area":return e.jsxs(u,{...s,children:[a,o.map(s=>e.jsx(f,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,fill:s.color,fillOpacity:.2,strokeWidth:2},s.dataKey))]});case"bar":return e.jsxs(j,{...s,children:[a,o.map(s=>e.jsx(p,{dataKey:s.dataKey,name:s.name,fill:s.color,radius:[4,4,0,0]},s.dataKey))]});default:return e.jsxs(x,{...s,children:[a,o.map(s=>e.jsx(h,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,strokeWidth:2,dot:{r:4},activeDot:{r:6}},s.dataKey))]})}})()})})]})}const A=s.forwardRef(({className:s,...a},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:l("w-full caption-bottom text-sm",s),...a})}));A.displayName="Table";const P=s.forwardRef(({className:s,...a},t)=>e.jsx("thead",{ref:t,className:l("[&_tr]:border-b",s),...a}));P.displayName="TableHeader";const F=s.forwardRef(({className:s,...a},t)=>e.jsx("tbody",{ref:t,className:l("[&_tr:last-child]:border-0",s),...a}));F.displayName="TableBody";s.forwardRef(({className:s,...a},t)=>e.jsx("tfoot",{ref:t,className:l("border-t bg-gray-100/50 font-medium [&>tr]:last:border-b-0",s),...a})).displayName="TableFooter";const $=s.forwardRef(({className:s,...a},t)=>e.jsx("tr",{ref:t,className:l("border-b transition-colors hover:bg-gray-100/50 data-[state=selected]:bg-gray-100",s),...a}));$.displayName="TableRow";const E=s.forwardRef(({className:s,...a},t)=>e.jsx("th",{ref:t,className:l("h-12 px-4 text-left align-middle font-medium text-gray-500 [&:has([role=checkbox])]:pr-0",s),...a}));E.displayName="TableHead";const U=s.forwardRef(({className:s,...a},t)=>e.jsx("td",{ref:t,className:l("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a}));U.displayName="TableCell";function W({leads:l,onLeadClick:m}){const[x,h]=s.useState("created_at"),[j,p]=s.useState("desc"),u=e=>{x===e?p("asc"===j?"desc":"asc"):(h(e),p("desc"))},f=[...l].sort((e,s)=>{let a=0;switch(x){case"created_at":a=new Date(e.created_at).getTime()-new Date(s.created_at).getTime();break;case"name":a=e.name.localeCompare(s.name);break;case"lead_type":a=e.lead_type.localeCompare(s.lead_type);break;case"status":a=e.status.localeCompare(s.status)}return"asc"===j?a:-a}),g=({field:s})=>x!==s?null:"asc"===j?e.jsx(L,{className:"inline w-4 h-4 ml-1"}):e.jsx(T,{className:"inline w-4 h-4 ml-1"}),N=e=>{switch(e){case"new":return"bg-blue-100 text-blue-800";case"contacted":return"bg-yellow-100 text-yellow-800";case"qualified":return"bg-green-100 text-green-800";case"converted":return"bg-purple-100 text-purple-800";case"lost":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},b=e=>{switch(e){case"buyer":return"Buyer";case"seller":return"Seller";case"valuation":return"Valuation";case"contact":return"Contact";default:return e}};return e.jsxs(a,{children:[e.jsxs(t,{children:[e.jsx(r,{children:"Recent Leads"}),e.jsxs(n,{children:["Your latest lead submissions (",l.length," total)"]})]}),e.jsx(i,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(A,{children:[e.jsx(P,{children:e.jsxs($,{children:[e.jsx(E,{children:e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>u("name"),className:"hover:bg-transparent",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Name",e.jsx(g,{field:"name"})]})}),e.jsx(E,{children:"Contact"}),e.jsx(E,{children:e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>u("lead_type"),className:"hover:bg-transparent",children:["Type",e.jsx(g,{field:"lead_type"})]})}),e.jsx(E,{children:e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>u("status"),className:"hover:bg-transparent",children:["Status",e.jsx(g,{field:"status"})]})}),e.jsx(E,{children:e.jsxs(c,{variant:"ghost",size:"sm",onClick:()=>u("created_at"),className:"hover:bg-transparent",children:["Date",e.jsx(g,{field:"created_at"})]})}),e.jsx(E,{className:"text-right",children:"Actions"})]})}),e.jsx(F,{children:0===f.length?e.jsx($,{children:e.jsx(U,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No leads yet. They'll appear here when visitors submit forms."})}):f.map(s=>e.jsxs($,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>null==m?void 0:m(s),children:[e.jsx(U,{className:"font-medium",children:s.name}),e.jsx(U,{children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("a",{href:`mailto:${s.email}`,className:"flex items-center text-blue-600 hover:underline",onClick:e=>e.stopPropagation(),children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),s.email]}),s.phone&&e.jsxs("a",{href:`tel:${s.phone}`,className:"flex items-center text-blue-600 hover:underline",onClick:e=>e.stopPropagation(),children:[e.jsx(k,{className:"w-3 h-3 mr-1"}),s.phone]})]})}),e.jsx(U,{children:e.jsx(o,{variant:"outline",children:b(s.lead_type)})}),e.jsx(U,{children:e.jsx(o,{className:N(s.status),children:s.status})}),e.jsx(U,{className:"text-sm text-muted-foreground",children:d(s.created_at)}),e.jsx(U,{className:"text-right",children:e.jsx(c,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),null==m||m(s)},children:"View"})})]},s.id))})]})})})]})}function H(){const[l,o]=s.useState("30d"),{stats:d,viewsData:m,leadsData:x,recentLeads:h,isLoading:j}=z();return j?e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading..."}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Analytics"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Track your profile performance and lead generation metrics"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(c,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"7d"===l?"Last 7 days":"30d"===l?"Last 30 days":"Last 90 days"})]}),e.jsxs(c,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Export"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(D,{title:"Total Views",value:d.totalViews.toLocaleString(),icon:K,iconColor:"text-blue-600",iconBgColor:"bg-blue-100"}),e.jsx(D,{title:"Unique Visitors",value:d.uniqueVisitors.toLocaleString(),icon:V,iconColor:"text-green-600",iconBgColor:"bg-green-100"}),e.jsx(D,{title:"Total Leads",value:d.totalLeads,icon:B,iconColor:"text-purple-600",iconBgColor:"bg-purple-100"}),e.jsx(D,{title:"Conversion Rate",value:`${d.conversionRate}%`,icon:S,iconColor:"text-orange-600",iconBgColor:"bg-orange-100"})]}),e.jsx(q,{title:"Profile Views",description:"Views and unique visitors over time",data:m.length>0?m:[{name:"No data",views:0,visitors:0}],series:[{dataKey:"views",name:"Total Views",color:"#3B82F6"},{dataKey:"visitors",name:"Unique Visitors",color:"#10B981"}],type:"area",height:window.innerWidth<640?200:300}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(a,{children:[e.jsxs(t,{className:"pb-3 sm:pb-4",children:[e.jsx(r,{className:"text-base sm:text-lg",children:"Leads by Type"}),e.jsx(n,{className:"text-xs sm:text-sm",children:"Distribution of lead inquiries"})]}),e.jsx(i,{children:x.length>0?e.jsx("div",{className:"space-y-2 sm:space-y-3",children:x.map(s=>e.jsxs("div",{className:"flex items-center justify-between py-2 min-h-[44px]",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:s.name})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:"text-xs sm:text-sm text-muted-foreground whitespace-nowrap",children:[s.value," leads"]}),e.jsxs("span",{className:"text-xs sm:text-sm font-semibold min-w-[35px] text-right",children:[d.totalLeads>0?(s.value/d.totalLeads*100).toFixed(0):0,"%"]})]})]},s.name))}):e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:"No leads yet"})})]}),e.jsxs(a,{children:[e.jsxs(t,{className:"pb-3 sm:pb-4",children:[e.jsx(r,{className:"text-base sm:text-lg",children:"Recent Activity"}),e.jsx(n,{className:"text-xs sm:text-sm",children:"Latest profile interactions"})]}),e.jsx(i,{children:e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:d.totalViews>0?`${d.totalViews} profile views`:"No activity yet"})})]})]}),e.jsx(W,{leads:h,onLeadClick:e=>{}})]})}s.forwardRef(({className:s,...a},t)=>e.jsx("caption",{ref:t,className:l("mt-4 text-sm text-gray-500",s),...a})).displayName="TableCaption";export{H as default};
