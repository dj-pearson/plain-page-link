import{ak as f,bK as Ve,r as de,b as fe,aS as qe,s as J,D as Ge,j as e,C as S,c as E,d as T,e as L,f as F,Q,bi as ut,_ as ht,B as q,at as Ke,m as mt,ap as ft,ab as xt,a2 as ke,a3 as we,bL as De,R as gt,L as pt,an as yt}from"./index-DliZj9NM.js";import{T as Ue,a as Qe,b as W,c as V}from"./tabs-CLb9k0aR.js";import{u as Ne}from"./useMutation-EUGWti0R.js";import{C as vt}from"./circle-x-C4gPxezr.js";import{M as jt}from"./mouse-pointer-HNgxjUxQ.js";import{F as je}from"./file-text-DPaXTO3P.js";import{T as ue}from"./trending-down-BRAB-ZDh.js";import{M as Pe}from"./minus-BhUsOV9f.js";import{u as bt,k as wt,l as Nt,m as D,n as Pt,o as At,p as Z,w as Oe,q as He,r as Ye,s as Xe,C as Je,t as G,v as re,x as ie,y as ge,A as _t,z as Y,D as Ce,E as kt,F as Se,G as Dt,H as Ot,I as Ct,J as St,K as Ee,M as Te,N as Et,g as Tt,X as le,Y as ne,f as Ft,R as pe,T as ye,b as ve,L as Fe,a as oe,c as Ze,d as et,e as he,h as O,i as tt,j as C}from"./table-C8DqrBdj.js";import{P as at,a as rt,b as nt}from"./popover-n8Tvb_m0.js";import{C as zt}from"./checkbox-BkHKPEpb.js";import{F as Lt}from"./filter-B3Qrz_TH.js";import{f as ze,e as $t,a as It}from"./exportUtils-DEE5LIZE.js";import{D as Mt,a as Rt,b as Bt,c as Le}from"./dropdown-menu-DGqY6NQ7.js";import{R as Wt}from"./refresh-cw-BK3yxPHC.js";import{S as Vt}from"./settings-B2ULRNcB.js";var qt=["x1","y1","x2","y2","key"],Gt=["offset"];function H(a){"@babel/helpers - typeof";return H=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},H(a)}function $e(a,t){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),i.push.apply(i,r)}return i}function N(a){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?$e(Object(i),!0).forEach(function(r){Kt(a,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):$e(Object(i)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(i,r))})}return a}function Kt(a,t,i){return t=Ut(t),t in a?Object.defineProperty(a,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[t]=i,a}function Ut(a){var t=Qt(a,"string");return H(t)=="symbol"?t:t+""}function Qt(a,t){if(H(a)!="object"||!a)return a;var i=a[Symbol.toPrimitive];if(i!==void 0){var r=i.call(a,t);if(H(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(a)}function K(){return K=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(a[r]=i[r])}return a},K.apply(this,arguments)}function Ie(a,t){if(a==null)return{};var i=Ht(a,t),r,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);for(n=0;n<s.length;n++)r=s[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(i[r]=a[r])}return i}function Ht(a,t){if(a==null)return{};var i={};for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){if(t.indexOf(r)>=0)continue;i[r]=a[r]}return i}var Yt=function(t){var i=t.fill;if(!i||i==="none")return null;var r=t.fillOpacity,n=t.x,s=t.y,o=t.width,d=t.height,c=t.ry;return f.createElement("rect",{x:n,y:s,ry:c,width:o,height:d,stroke:"none",fill:i,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function st(a,t){var i;if(f.isValidElement(a))i=f.cloneElement(a,t);else if(Z(a))i=a(t);else{var r=t.x1,n=t.y1,s=t.x2,o=t.y2,d=t.key,c=Ie(t,qt),l=G(c,!1);l.offset;var u=Ie(l,Gt);i=f.createElement("line",K({},u,{x1:r,y1:n,x2:s,y2:o,fill:"none",key:d}))}return i}function Xt(a){var t=a.x,i=a.width,r=a.horizontal,n=r===void 0?!0:r,s=a.horizontalPoints;if(!n||!s||!s.length)return null;var o=s.map(function(d,c){var l=N(N({},a),{},{x1:t,y1:d,x2:t+i,y2:d,key:"line-".concat(c),index:c});return st(n,l)});return f.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function Jt(a){var t=a.y,i=a.height,r=a.vertical,n=r===void 0?!0:r,s=a.verticalPoints;if(!n||!s||!s.length)return null;var o=s.map(function(d,c){var l=N(N({},a),{},{x1:d,y1:t,x2:d,y2:t+i,key:"line-".concat(c),index:c});return st(n,l)});return f.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function Zt(a){var t=a.horizontalFill,i=a.fillOpacity,r=a.x,n=a.y,s=a.width,o=a.height,d=a.horizontalPoints,c=a.horizontal,l=c===void 0?!0:c;if(!l||!t||!t.length)return null;var u=d.map(function(m){return Math.round(m+n-n)}).sort(function(m,x){return m-x});n!==u[0]&&u.unshift(0);var h=u.map(function(m,x){var w=!u[x+1],y=w?n+o-m:u[x+1]-m;if(y<=0)return null;var g=x%t.length;return f.createElement("rect",{key:"react-".concat(x),y:m,x:r,height:y,width:s,stroke:"none",fill:t[g],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function ea(a){var t=a.vertical,i=t===void 0?!0:t,r=a.verticalFill,n=a.fillOpacity,s=a.x,o=a.y,d=a.width,c=a.height,l=a.verticalPoints;if(!i||!r||!r.length)return null;var u=l.map(function(m){return Math.round(m+s-s)}).sort(function(m,x){return m-x});s!==u[0]&&u.unshift(0);var h=u.map(function(m,x){var w=!u[x+1],y=w?s+d-m:u[x+1]-m;if(y<=0)return null;var g=x%r.length;return f.createElement("rect",{key:"react-".concat(x),x:m,y:o,width:y,height:c,stroke:"none",fill:r[g],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return f.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var ta=function(t,i){var r=t.xAxis,n=t.width,s=t.height,o=t.offset;return He(Ye(N(N(N({},Je.defaultProps),r),{},{ticks:Xe(r,!0),viewBox:{x:0,y:0,width:n,height:s}})),o.left,o.left+o.width,i)},aa=function(t,i){var r=t.yAxis,n=t.width,s=t.height,o=t.offset;return He(Ye(N(N(N({},Je.defaultProps),r),{},{ticks:Xe(r,!0),viewBox:{x:0,y:0,width:n,height:s}})),o.top,o.top+o.height,i)},X={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function ce(a){var t,i,r,n,s,o,d=bt(),c=wt(),l=Nt(),u=N(N({},a),{},{stroke:(t=a.stroke)!==null&&t!==void 0?t:X.stroke,fill:(i=a.fill)!==null&&i!==void 0?i:X.fill,horizontal:(r=a.horizontal)!==null&&r!==void 0?r:X.horizontal,horizontalFill:(n=a.horizontalFill)!==null&&n!==void 0?n:X.horizontalFill,vertical:(s=a.vertical)!==null&&s!==void 0?s:X.vertical,verticalFill:(o=a.verticalFill)!==null&&o!==void 0?o:X.verticalFill,x:D(a.x)?a.x:l.left,y:D(a.y)?a.y:l.top,width:D(a.width)?a.width:l.width,height:D(a.height)?a.height:l.height}),h=u.x,m=u.y,x=u.width,w=u.height,y=u.syncWithTicks,g=u.horizontalValues,_=u.verticalValues,v=Pt(),k=At();if(!D(x)||x<=0||!D(w)||w<=0||!D(h)||h!==+h||!D(m)||m!==+m)return null;var p=u.verticalCoordinatesGenerator||ta,j=u.horizontalCoordinatesGenerator||aa,b=u.horizontalPoints,P=u.verticalPoints;if((!b||!b.length)&&Z(j)){var A=g&&g.length,$=j({yAxis:k?N(N({},k),{},{ticks:A?g:k.ticks}):void 0,width:d,height:c,offset:l},A?!0:y);Oe(Array.isArray($),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(H($),"]")),Array.isArray($)&&(b=$)}if((!P||!P.length)&&Z(p)){var I=_&&_.length,z=p({xAxis:v?N(N({},v),{},{ticks:I?_:v.ticks}):void 0,width:d,height:c,offset:l},I?!0:y);Oe(Array.isArray(z),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(H(z),"]")),Array.isArray(z)&&(P=z)}return f.createElement("g",{className:"recharts-cartesian-grid"},f.createElement(Yt,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),f.createElement(Xt,K({},u,{offset:l,horizontalPoints:b,xAxis:v,yAxis:k})),f.createElement(Jt,K({},u,{offset:l,verticalPoints:P,xAxis:v,yAxis:k})),f.createElement(Zt,K({},u,{horizontalPoints:b})),f.createElement(ea,K({},u,{verticalPoints:P})))}ce.displayName="CartesianGrid";var ra=["layout","type","stroke","connectNulls","isRange","ref"],na=["key"],it;function ee(a){"@babel/helpers - typeof";return ee=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ee(a)}function ot(a,t){if(a==null)return{};var i=sa(a,t),r,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(a);for(n=0;n<s.length;n++)r=s[n],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(a,r)&&(i[r]=a[r])}return i}function sa(a,t){if(a==null)return{};var i={};for(var r in a)if(Object.prototype.hasOwnProperty.call(a,r)){if(t.indexOf(r)>=0)continue;i[r]=a[r]}return i}function U(){return U=Object.assign?Object.assign.bind():function(a){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(a[r]=i[r])}return a},U.apply(this,arguments)}function Me(a,t){var i=Object.keys(a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(a);t&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(a,n).enumerable})),i.push.apply(i,r)}return i}function B(a){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Me(Object(i),!0).forEach(function(r){M(a,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):Me(Object(i)).forEach(function(r){Object.defineProperty(a,r,Object.getOwnPropertyDescriptor(i,r))})}return a}function ia(a,t){if(!(a instanceof t))throw new TypeError("Cannot call a class as a function")}function Re(a,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(a,ct(r.key),r)}}function oa(a,t,i){return t&&Re(a.prototype,t),i&&Re(a,i),Object.defineProperty(a,"prototype",{writable:!1}),a}function la(a,t,i){return t=me(t),ca(a,lt()?Reflect.construct(t,i||[],me(a).constructor):t.apply(a,i))}function ca(a,t){if(t&&(ee(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return da(a)}function da(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function lt(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lt=function(){return!!a})()}function me(a){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},me(a)}function ua(a,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(t&&t.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),t&&be(a,t)}function be(a,t){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},be(a,t)}function M(a,t,i){return t=ct(t),t in a?Object.defineProperty(a,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):a[t]=i,a}function ct(a){var t=ha(a,"string");return ee(t)=="symbol"?t:t+""}function ha(a,t){if(ee(a)!="object"||!a)return a;var i=a[Symbol.toPrimitive];if(i!==void 0){var r=i.call(a,t);if(ee(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}var R=(function(a){function t(){var i;ia(this,t);for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return i=la(this,t,[].concat(n)),M(i,"state",{isAnimationFinished:!0}),M(i,"id",Ct("recharts-area-")),M(i,"handleAnimationEnd",function(){var o=i.props.onAnimationEnd;i.setState({isAnimationFinished:!0}),Z(o)&&o()}),M(i,"handleAnimationStart",function(){var o=i.props.onAnimationStart;i.setState({isAnimationFinished:!1}),Z(o)&&o()}),i}return ua(t,a),oa(t,[{key:"renderDots",value:function(r,n,s){var o=this.props.isAnimationActive,d=this.state.isAnimationFinished;if(o&&!d)return null;var c=this.props,l=c.dot,u=c.points,h=c.dataKey,m=G(this.props,!1),x=G(l,!0),w=u.map(function(g,_){var v=B(B(B({key:"dot-".concat(_),r:3},m),x),{},{index:_,cx:g.x,cy:g.y,dataKey:h,value:g.value,payload:g.payload,points:u});return t.renderDotItem(l,v)}),y={clipPath:r?"url(#clipPath-".concat(n?"":"dots-").concat(s,")"):null};return f.createElement(re,U({className:"recharts-area-dots"},y),w)}},{key:"renderHorizontalRect",value:function(r){var n=this.props,s=n.baseLine,o=n.points,d=n.strokeWidth,c=o[0].x,l=o[o.length-1].x,u=r*Math.abs(c-l),h=ie(o.map(function(m){return m.y||0}));return D(s)&&typeof s=="number"?h=Math.max(s,h):s&&Array.isArray(s)&&s.length&&(h=Math.max(ie(s.map(function(m){return m.y||0})),h)),D(h)?f.createElement("rect",{x:c<l?c:c-u,y:0,width:u,height:Math.floor(h+(d?parseInt("".concat(d),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var n=this.props,s=n.baseLine,o=n.points,d=n.strokeWidth,c=o[0].y,l=o[o.length-1].y,u=r*Math.abs(c-l),h=ie(o.map(function(m){return m.x||0}));return D(s)&&typeof s=="number"?h=Math.max(s,h):s&&Array.isArray(s)&&s.length&&(h=Math.max(ie(s.map(function(m){return m.x||0})),h)),D(h)?f.createElement("rect",{x:0,y:c<l?c:c-u,width:h+(d?parseInt("".concat(d),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(r){var n=this.props.layout;return n==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,n,s,o){var d=this.props,c=d.layout,l=d.type,u=d.stroke,h=d.connectNulls,m=d.isRange;d.ref;var x=ot(d,ra);return f.createElement(re,{clipPath:s?"url(#clipPath-".concat(o,")"):null},f.createElement(ge,U({},G(x,!0),{points:r,connectNulls:h,type:l,baseLine:n,layout:c,stroke:"none",className:"recharts-area-area"})),u!=="none"&&f.createElement(ge,U({},G(this.props,!1),{className:"recharts-area-curve",layout:c,type:l,connectNulls:h,fill:"none",points:r})),u!=="none"&&m&&f.createElement(ge,U({},G(this.props,!1),{className:"recharts-area-curve",layout:c,type:l,connectNulls:h,fill:"none",points:n})))}},{key:"renderAreaWithAnimation",value:function(r,n){var s=this,o=this.props,d=o.points,c=o.baseLine,l=o.isAnimationActive,u=o.animationBegin,h=o.animationDuration,m=o.animationEasing,x=o.animationId,w=this.state,y=w.prevPoints,g=w.prevBaseLine;return f.createElement(_t,{begin:u,duration:h,isActive:l,easing:m,from:{t:0},to:{t:1},key:"area-".concat(x),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(_){var v=_.t;if(y){var k=y.length/d.length,p=d.map(function(A,$){var I=Math.floor($*k);if(y[I]){var z=y[I],te=Y(z.x,A.x),ae=Y(z.y,A.y);return B(B({},A),{},{x:te(v),y:ae(v)})}return A}),j;if(D(c)&&typeof c=="number"){var b=Y(g,c);j=b(v)}else if(Ce(c)||kt(c)){var P=Y(g,0);j=P(v)}else j=c.map(function(A,$){var I=Math.floor($*k);if(g[I]){var z=g[I],te=Y(z.x,A.x),ae=Y(z.y,A.y);return B(B({},A),{},{x:te(v),y:ae(v)})}return A});return s.renderAreaStatically(p,j,r,n)}return f.createElement(re,null,f.createElement("defs",null,f.createElement("clipPath",{id:"animationClipPath-".concat(n)},s.renderClipRect(v))),f.createElement(re,{clipPath:"url(#animationClipPath-".concat(n,")")},s.renderAreaStatically(d,c,r,n)))})}},{key:"renderArea",value:function(r,n){var s=this.props,o=s.points,d=s.baseLine,c=s.isAnimationActive,l=this.state,u=l.prevPoints,h=l.prevBaseLine,m=l.totalLength;return c&&o&&o.length&&(!u&&m>0||!Se(u,o)||!Se(h,d))?this.renderAreaWithAnimation(r,n):this.renderAreaStatically(o,d,r,n)}},{key:"render",value:function(){var r,n=this.props,s=n.hide,o=n.dot,d=n.points,c=n.className,l=n.top,u=n.left,h=n.xAxis,m=n.yAxis,x=n.width,w=n.height,y=n.isAnimationActive,g=n.id;if(s||!d||!d.length)return null;var _=this.state.isAnimationFinished,v=d.length===1,k=Ve("recharts-area",c),p=h&&h.allowDataOverflow,j=m&&m.allowDataOverflow,b=p||j,P=Ce(g)?this.id:g,A=(r=G(o,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},$=A.r,I=$===void 0?3:$,z=A.strokeWidth,te=z===void 0?2:z,ae=Dt(o)?o:{},Ae=ae.clipDot,_e=Ae===void 0?!0:Ae,se=I*2+te;return f.createElement(re,{className:k},p||j?f.createElement("defs",null,f.createElement("clipPath",{id:"clipPath-".concat(P)},f.createElement("rect",{x:p?u:u-x/2,y:j?l:l-w/2,width:p?x:x*2,height:j?w:w*2})),!_e&&f.createElement("clipPath",{id:"clipPath-dots-".concat(P)},f.createElement("rect",{x:u-se/2,y:l-se/2,width:x+se,height:w+se}))):null,v?null:this.renderArea(b,P),(o||v)&&this.renderDots(b,_e,P),(!y||_)&&Ot.renderCallByParent(this.props,d))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:n.curPoints,prevBaseLine:n.curBaseLine}:r.points!==n.curPoints||r.baseLine!==n.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])})(de.PureComponent);it=R;M(R,"displayName","Area");M(R,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!St.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});M(R,"getBaseValue",function(a,t,i,r){var n=a.layout,s=a.baseValue,o=t.props.baseValue,d=o??s;if(D(d)&&typeof d=="number")return d;var c=n==="horizontal"?r:i,l=c.scale.domain();if(c.type==="number"){var u=Math.max(l[0],l[1]),h=Math.min(l[0],l[1]);return d==="dataMin"?h:d==="dataMax"||u<0?u:Math.max(Math.min(l[0],l[1]),0)}return d==="dataMin"?l[0]:d==="dataMax"?l[1]:l[0]});M(R,"getComposedData",function(a){var t=a.props,i=a.item,r=a.xAxis,n=a.yAxis,s=a.xAxisTicks,o=a.yAxisTicks,d=a.bandSize,c=a.dataKey,l=a.stackedData,u=a.dataStartIndex,h=a.displayedData,m=a.offset,x=t.layout,w=l&&l.length,y=it.getBaseValue(t,i,r,n),g=x==="horizontal",_=!1,v=h.map(function(p,j){var b;w?b=l[u+j]:(b=Ee(p,c),Array.isArray(b)?_=!0:b=[y,b]);var P=b[1]==null||w&&Ee(p,c)==null;return g?{x:Te({axis:r,ticks:s,bandSize:d,entry:p,index:j}),y:P?null:n.scale(b[1]),value:b,payload:p}:{x:P?null:r.scale(b[1]),y:Te({axis:n,ticks:o,bandSize:d,entry:p,index:j}),value:b,payload:p}}),k;return w||_?k=v.map(function(p){var j=Array.isArray(p.value)?p.value[0]:null;return g?{x:p.x,y:j!=null&&p.y!=null?n.scale(j):null}:{x:j!=null?r.scale(j):null,y:p.y}}):k=g?n.scale(y):r.scale(y),B({points:v,baseLine:k,layout:x,isRange:_},m)});M(R,"renderDotItem",function(a,t){var i;if(f.isValidElement(a))i=f.cloneElement(a,t);else if(Z(a))i=a(t);else{var r=Ve("recharts-area-dot",typeof a!="boolean"?a.className:""),n=t.key,s=ot(t,na);i=f.createElement(Et,U({},s,{key:n,className:r}))}return i});var ma=Tt({chartName:"AreaChart",GraphicalChild:R,axisComponents:[{axisType:"xAxis",AxisComp:le},{axisType:"yAxis",AxisComp:ne}],formatAxisMap:Ft});function fa(){return Ge({queryKey:["connected-platforms"],queryFn:async()=>{const{data:{user:a}}=await J.auth.getUser();if(!a)throw new Error("Not authenticated");const{data:t,error:i}=await J.rpc("get_connected_search_platforms",{p_user_id:a.id});if(i)throw i;return t}})}function xa(){const{toast:a}=fe();return Ne({mutationFn:async t=>{const i={google_analytics:`${window.location.origin}/admin/search-analytics/oauth/callback/google-analytics`,google_search_console:`${window.location.origin}/admin/search-analytics/oauth/callback/google-search-console`,bing_webmaster:`${window.location.origin}/admin/search-analytics/oauth/callback/bing-webmaster`,yandex_webmaster:`${window.location.origin}/admin/search-analytics/oauth/callback/yandex-webmaster`},r={google_analytics:"https://accounts.google.com/o/oauth2/v2/auth",google_search_console:"https://accounts.google.com/o/oauth2/v2/auth",bing_webmaster:"https://login.microsoftonline.com/common/oauth2/v2.0/authorize",yandex_webmaster:"https://oauth.yandex.ru/authorize"},n=new URLSearchParams({client_id:(t.includes("google"),""),redirect_uri:i[t],response_type:"code",scope:t==="google_analytics"?"https://www.googleapis.com/auth/analytics.readonly":t==="google_search_console"?"https://www.googleapis.com/auth/webmasters.readonly":t==="bing_webmaster"?"https://api.bing.microsoft.com/webmaster.read offline_access":"webmaster:read",access_type:"offline",prompt:"consent"}),s=`${r[t]}?${n.toString()}`;window.location.href=s},onError:t=>{a({title:"OAuth Error",description:t.message,variant:"destructive"})}})}function ga(){const{toast:a}=fe(),t=qe();return Ne({mutationFn:async({platform:i,property_id:r,site_id:n,start_date:s,end_date:o})=>{const{data:{session:d}}=await J.auth.getSession();if(!d)throw new Error("Not authenticated");const c=i==="google_analytics"?"google-analytics-sync":i==="google_search_console"?"google-search-console-sync":i==="bing_webmaster"?"bing-webmaster-sync":"yandex-webmaster-sync",{data:l,error:u}=await edgeFunctions.invoke(c,{body:{property_id:r,site_id:n,start_date:s,end_date:o},headers:{Authorization:`Bearer ${d.access_token}`}});if(u)throw u;return l},onSuccess:()=>{a({title:"Sync Started",description:"Data synchronization started successfully"}),t.invalidateQueries({queryKey:["search-analytics"]})},onError:i=>{a({title:"Sync Failed",description:i.message,variant:"destructive"})}})}function pa(){const{toast:a}=fe(),t=qe();return Ne({mutationFn:async({start_date:i,end_date:r,force_refresh:n})=>{const{data:{session:s}}=await J.auth.getSession();if(!s)throw new Error("Not authenticated");const{data:o,error:d}=await edgeFunctions.invoke("aggregate-search-analytics",{body:{start_date:i,end_date:r,force_refresh:n},headers:{Authorization:`Bearer ${s.access_token}`}});if(d)throw d;return o},onSuccess:()=>{a({title:"Aggregation Complete",description:"Analytics data aggregated successfully"}),t.invalidateQueries({queryKey:["unified-analytics"]})},onError:i=>{a({title:"Aggregation Failed",description:i.message,variant:"destructive"})}})}function xe(a){return Ge({queryKey:["unified-analytics",a],queryFn:async()=>{const{data:{user:t}}=await J.auth.getUser();if(!t)throw new Error("Not authenticated");let i=J.from("unified_search_analytics").select("*").eq("user_id",t.id).gte("date",a.startDate).lte("date",a.endDate);a.platforms&&a.platforms.length>0&&(i=i.in("source_platform",a.platforms));const{data:r,error:n}=await i.order("date",{ascending:!1});if(n)throw n;return r}})}function ya(a){const{data:t}=xe(a);return t?{total_clicks:t.reduce((r,n)=>r+(n.clicks||0),0),total_impressions:t.reduce((r,n)=>r+(n.impressions||0),0),total_sessions:t.reduce((r,n)=>r+(n.sessions||0),0),total_users:t.reduce((r,n)=>r+(n.users||0),0),total_pageviews:t.reduce((r,n)=>r+(n.pageviews||0),0),average_ctr:t.length>0?t.reduce((r,n)=>r+(n.ctr||0),0)/t.length:0,average_position:t.length>0?t.reduce((r,n)=>r+(n.average_position||0),0)/t.length:0,average_bounce_rate:t.length>0?t.reduce((r,n)=>r+(n.bounce_rate||0),0)/t.length:0,clicks_change:0,impressions_change:0,sessions_change:0}:null}function va(a){const{data:t}=xe(a);if(!t)return null;const i=t.reduce((r,n)=>{const s=n.date;return r[s]||(r[s]={date:s,clicks:0,impressions:0,sessions:0,users:0,ctr:0,position:0,count:0}),r[s].clicks+=n.clicks||0,r[s].impressions+=n.impressions||0,r[s].sessions+=n.sessions||0,r[s].users+=n.users||0,r[s].ctr+=n.ctr||0,r[s].position+=n.average_position||0,r[s].count+=1,r},{});return Object.values(i).map(r=>({date:r.date,clicks:r.clicks,impressions:r.impressions,sessions:r.sessions,users:r.users,ctr:r.count>0?r.ctr/r.count:0,position:r.count>0?r.position/r.count:0}))}function dt(a){const{data:t}=xe(a);if(!t)return null;const r=t.filter(s=>s.query).reduce((s,o)=>{const d=o.query;return s[d]||(s[d]={query:d,clicks:0,impressions:0,ctr:0,position:0,count:0,change:0}),s[d].clicks+=o.clicks||0,s[d].impressions+=o.impressions||0,s[d].ctr+=o.ctr||0,s[d].position+=o.average_position||0,s[d].count+=1,s},{});return Object.values(r).map(s=>({query:s.query,clicks:s.clicks,impressions:s.impressions,ctr:s.count>0?s.ctr/s.count:0,position:s.count>0?s.position/s.count:0,change:0})).sort((s,o)=>o.clicks-s.clicks).slice(0,a.limit||10)}function ja(a){const{data:t}=xe(a);if(!t)return null;const r=t.filter(s=>s.page_url).reduce((s,o)=>{const d=o.page_url;return s[d]||(s[d]={url:d,title:o.page_title,clicks:0,impressions:0,sessions:0,ctr:0,position:0,count:0,change:0}),s[d].clicks+=o.clicks||0,s[d].impressions+=o.impressions||0,s[d].sessions+=o.sessions||0,s[d].ctr+=o.ctr||0,s[d].position+=o.average_position||0,s[d].count+=1,s},{});return Object.values(r).map(s=>({url:s.url,title:s.title,clicks:s.clicks,impressions:s.impressions,sessions:s.sessions,ctr:s.count>0?s.ctr/s.count:0,position:s.count>0?s.position/s.count:0,change:0})).sort((s,o)=>o.clicks-s.clicks).slice(0,a.limit||10)}const ba={google_search_console:{name:"Google Search Console",description:"Search performance and indexing data",icon:"ðŸ”"},google_analytics:{name:"Google Analytics 4",description:"Website traffic and user behavior",icon:"ðŸ“Š"},bing_webmaster:{name:"Bing Webmaster Tools",description:"Bing search performance data",icon:"ðŸ…±ï¸"},yandex_webmaster:{name:"Yandex Webmaster",description:"Yandex search performance data",icon:"ðŸ‡·ðŸ‡º"}};function wa(){const{data:a,isLoading:t}=fa(),i=xa(),r=ga(),n=o=>{i.mutate(o)},s=o=>{r.mutate({platform:o})};return t?e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Platform Connections"}),e.jsx(L,{children:"Loading connection status..."})]}),e.jsx(F,{children:e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Platform Connections"}),e.jsx(L,{children:"Connect and manage your analytics platforms"})]}),e.jsx(F,{children:e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:a?.map(o=>{const d=ba[o.platform],c=o.is_connected,l=o.credential_status==="active",u=o.credential_status==="expired";return e.jsxs(S,{className:"relative",children:[e.jsxs(E,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:d.icon}),e.jsx("div",{children:e.jsx(T,{className:"text-sm",children:d.name})})]}),l&&e.jsxs(Q,{variant:"default",className:"text-xs",children:[e.jsx(ut,{className:"h-3 w-3 mr-1"}),"Connected"]}),u&&e.jsxs(Q,{variant:"destructive",className:"text-xs",children:[e.jsx(ht,{className:"h-3 w-3 mr-1"}),"Expired"]}),!c&&e.jsxs(Q,{variant:"secondary",className:"text-xs",children:[e.jsx(vt,{className:"h-3 w-3 mr-1"}),"Not Connected"]})]}),e.jsx(L,{className:"text-xs mt-1",children:d.description})]}),e.jsxs(F,{className:"pt-0",children:[o.last_sync&&e.jsxs("p",{className:"text-xs text-muted-foreground mb-3",children:["Last sync: ",new Date(o.last_sync).toLocaleDateString()]}),e.jsx("div",{className:"flex flex-col gap-2",children:!c||u?e.jsxs(q,{size:"sm",onClick:()=>n(o.platform),disabled:i.isPending,className:"w-full",children:[e.jsx(Ke,{className:"h-3 w-3 mr-2"}),u?"Reconnect":"Connect"]}):e.jsx(q,{size:"sm",variant:"outline",onClick:()=>s(o.platform),disabled:r.isPending,className:"w-full",children:"Sync Data"})})]})]},o.platform)})})})]})}function Na({startDate:a,endDate:t,platforms:i}){const r=ya({startDate:a,endDate:t,platforms:i});if(!r)return e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(c=>e.jsxs(S,{children:[e.jsx(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx(T,{className:"text-sm font-medium",children:"Loading..."})}),e.jsx(F,{children:e.jsx("div",{className:"h-8 bg-muted animate-pulse rounded"})})]},c))});const n=c=>new Intl.NumberFormat("en-US",{notation:"compact",maximumFractionDigits:1}).format(c),s=c=>`${(c*100).toFixed(2)}%`,o=c=>{if(c===0)return{icon:Pe,color:"text-muted-foreground",text:"0%"};const l=c>0;return{icon:l?we:ue,color:l?"text-green-600":"text-red-600",text:`${l?"+":""}${s(c/100)}`}},d=[{title:"Total Clicks",value:r.total_clicks,change:r.clicks_change,icon:jt,description:"Users who clicked through"},{title:"Total Impressions",value:r.total_impressions,change:r.impressions_change,icon:mt,description:"Times your site appeared"},{title:"Avg. CTR",value:r.average_ctr,change:0,icon:ft,description:"Click-through rate",isPercentage:!0},{title:"Avg. Position",value:r.average_position,change:0,icon:xt,description:"Average search position",decimals:1},{title:"Total Sessions",value:r.total_sessions,change:r.sessions_change,icon:ke,description:"Website sessions"},{title:"Total Users",value:r.total_users,change:0,icon:ke,description:"Unique visitors"},{title:"Total Pageviews",value:r.total_pageviews,change:0,icon:je,description:"Pages viewed"},{title:"Bounce Rate",value:r.average_bounce_rate,change:0,icon:ue,description:"Visitors who left quickly",isPercentage:!0}];return e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:d.map(c=>{const l=o(c.change),u=c.icon,h=l.icon;return e.jsxs(S,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(T,{className:"text-sm font-medium",children:c.title}),e.jsx(u,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(F,{children:[e.jsx("div",{className:"text-2xl font-bold",children:c.isPercentage?s(c.value):c.decimals?c.value.toFixed(c.decimals):n(c.value)}),e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(h,{className:`h-3 w-3 ${l.color}`}),e.jsx("span",{className:l.color,children:l.text}),e.jsx("span",{children:"vs. previous period"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:c.description})]})]},c.title)})})}function Pa({startDate:a,endDate:t,platforms:i}){const r=va({startDate:a,endDate:t,platforms:i});return!r||r.length===0?e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Performance Trends"}),e.jsx(L,{children:"No data available for the selected period"})]}),e.jsx(F,{children:e.jsx("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:e.jsx("p",{children:"Connect your platforms and sync data to see performance trends"})})})]}):e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Performance Trends"}),e.jsx(L,{children:"Track your search and traffic metrics over time"})]}),e.jsx(F,{children:e.jsxs(Ue,{defaultValue:"traffic",className:"space-y-4",children:[e.jsxs(Qe,{children:[e.jsx(W,{value:"traffic",children:"Traffic"}),e.jsx(W,{value:"search",children:"Search Performance"}),e.jsx(W,{value:"engagement",children:"Engagement"})]}),e.jsx(V,{value:"traffic",className:"space-y-4",children:e.jsx(pe,{width:"100%",height:350,children:e.jsxs(ma,{data:r,children:[e.jsx(ce,{strokeDasharray:"3 3"}),e.jsx(le,{dataKey:"date",tickFormatter:n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(ne,{}),e.jsx(ye,{labelFormatter:n=>new Date(n).toLocaleDateString(),formatter:n=>[new Intl.NumberFormat().format(n),""]}),e.jsx(ve,{}),e.jsx(R,{type:"monotone",dataKey:"sessions",stackId:"1",stroke:"#8884d8",fill:"#8884d8",name:"Sessions"}),e.jsx(R,{type:"monotone",dataKey:"users",stackId:"2",stroke:"#82ca9d",fill:"#82ca9d",name:"Users"}),e.jsx(R,{type:"monotone",dataKey:"pageviews",stackId:"3",stroke:"#ffc658",fill:"#ffc658",name:"Pageviews"})]})})}),e.jsx(V,{value:"search",className:"space-y-4",children:e.jsx(pe,{width:"100%",height:350,children:e.jsxs(Fe,{data:r,children:[e.jsx(ce,{strokeDasharray:"3 3"}),e.jsx(le,{dataKey:"date",tickFormatter:n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(ne,{yAxisId:"left"}),e.jsx(ne,{yAxisId:"right",orientation:"right"}),e.jsx(ye,{labelFormatter:n=>new Date(n).toLocaleDateString(),formatter:(n,s)=>s==="CTR"?[`${(n*100).toFixed(2)}%`,s]:s==="Avg Position"?[n.toFixed(1),s]:[new Intl.NumberFormat().format(n),s]}),e.jsx(ve,{}),e.jsx(oe,{yAxisId:"left",type:"monotone",dataKey:"clicks",stroke:"#8884d8",name:"Clicks",strokeWidth:2}),e.jsx(oe,{yAxisId:"left",type:"monotone",dataKey:"impressions",stroke:"#82ca9d",name:"Impressions",strokeWidth:2}),e.jsx(oe,{yAxisId:"right",type:"monotone",dataKey:"ctr",stroke:"#ffc658",name:"CTR",strokeWidth:2})]})})}),e.jsxs(V,{value:"engagement",className:"space-y-4",children:[e.jsx(pe,{width:"100%",height:350,children:e.jsxs(Fe,{data:r,children:[e.jsx(ce,{strokeDasharray:"3 3"}),e.jsx(le,{dataKey:"date",tickFormatter:n=>new Date(n).toLocaleDateString("en-US",{month:"short",day:"numeric"})}),e.jsx(ne,{}),e.jsx(ye,{labelFormatter:n=>new Date(n).toLocaleDateString(),formatter:(n,s)=>s==="Avg Position"?[n.toFixed(1),s]:[new Intl.NumberFormat().format(n),s]}),e.jsx(ve,{}),e.jsx(oe,{type:"monotone",dataKey:"position",stroke:"#8884d8",name:"Avg Position",strokeWidth:2})]})}),e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"Lower position values are better (position 1 is the top result)"})]})]})})]})}function Be({startDate:a,endDate:t,platforms:i,limit:r=10}){const n=dt({startDate:a,endDate:t,platforms:i,limit:r});if(!n||n.length===0)return e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No query data available for the selected period"}),e.jsx("p",{className:"text-sm mt-2",children:"Connect platforms and sync data to see top queries"})]});const s=c=>new Intl.NumberFormat("en-US").format(c),o=c=>`${(c*100).toFixed(2)}%`,d=c=>c>0?e.jsx(we,{className:"h-3 w-3 text-green-600"}):c<0?e.jsx(ue,{className:"h-3 w-3 text-red-600"}):e.jsx(Pe,{className:"h-3 w-3 text-muted-foreground"});return e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ze,{children:[e.jsx(et,{children:e.jsxs(he,{children:[e.jsx(O,{className:"w-[40%]",children:"Query"}),e.jsx(O,{className:"text-right",children:"Clicks"}),e.jsx(O,{className:"text-right",children:"Impressions"}),e.jsx(O,{className:"text-right",children:"CTR"}),e.jsx(O,{className:"text-right",children:"Position"}),e.jsx(O,{className:"text-right",children:"Trend"})]})}),e.jsx(tt,{children:n.map((c,l)=>e.jsxs(he,{children:[e.jsx(C,{className:"font-medium max-w-xs truncate",children:c.query}),e.jsx(C,{className:"text-right",children:s(c.clicks)}),e.jsx(C,{className:"text-right",children:s(c.impressions)}),e.jsx(C,{className:"text-right",children:e.jsx(Q,{variant:"outline",children:o(c.ctr)})}),e.jsx(C,{className:"text-right",children:e.jsx(Q,{variant:"secondary",children:c.position.toFixed(1)})}),e.jsx(C,{className:"text-right",children:e.jsx("div",{className:"flex justify-end",children:d(c.change)})})]},`${c.query}-${l}`))})]})})}function We({startDate:a,endDate:t,platforms:i,limit:r=10}){const n=ja({startDate:a,endDate:t,platforms:i,limit:r});if(!n||n.length===0)return e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"No page data available for the selected period"}),e.jsx("p",{className:"text-sm mt-2",children:"Connect platforms and sync data to see top pages"})]});const s=l=>new Intl.NumberFormat("en-US").format(l),o=l=>`${(l*100).toFixed(2)}%`,d=l=>l>0?e.jsx(we,{className:"h-3 w-3 text-green-600"}):l<0?e.jsx(ue,{className:"h-3 w-3 text-red-600"}):e.jsx(Pe,{className:"h-3 w-3 text-muted-foreground"}),c=(l,u=50)=>l.length<=u?l:l.substring(0,u)+"...";return e.jsx("div",{className:"rounded-md border",children:e.jsxs(Ze,{children:[e.jsx(et,{children:e.jsxs(he,{children:[e.jsx(O,{className:"w-[35%]",children:"Page"}),e.jsx(O,{className:"text-right",children:"Clicks"}),e.jsx(O,{className:"text-right",children:"Sessions"}),e.jsx(O,{className:"text-right",children:"Impressions"}),e.jsx(O,{className:"text-right",children:"CTR"}),e.jsx(O,{className:"text-right",children:"Position"}),e.jsx(O,{className:"text-right",children:"Trend"}),e.jsx(O,{className:"w-[50px]"})]})}),e.jsx(tt,{children:n.map((l,u)=>e.jsxs(he,{children:[e.jsx(C,{className:"max-w-xs",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium text-sm truncate",title:l.url,children:c(l.url)}),l.title&&e.jsx("span",{className:"text-xs text-muted-foreground truncate",title:l.title,children:l.title})]})}),e.jsx(C,{className:"text-right",children:s(l.clicks)}),e.jsx(C,{className:"text-right",children:s(l.sessions)}),e.jsx(C,{className:"text-right",children:s(l.impressions)}),e.jsx(C,{className:"text-right",children:e.jsx(Q,{variant:"outline",children:o(l.ctr)})}),e.jsx(C,{className:"text-right",children:e.jsx(Q,{variant:"secondary",children:l.position.toFixed(1)})}),e.jsx(C,{className:"text-right",children:e.jsx("div",{className:"flex justify-end",children:d(l.change)})}),e.jsx(C,{children:e.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/80",children:e.jsx(Ke,{className:"h-4 w-4"})})})]},`${l.url}-${u}`))})]})})}function Aa({startDate:a,endDate:t,onChange:i}){const[r,n]=de.useState(!1),s=d=>{const c=new Date,l=new Date;l.setDate(l.getDate()-d),i(l.toISOString().split("T")[0],c.toISOString().split("T")[0]),n(!1)},o=[{label:"Last 7 days",days:7},{label:"Last 30 days",days:30},{label:"Last 90 days",days:90},{label:"Last 6 months",days:180},{label:"Last year",days:365}];return e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(at,{open:r,onOpenChange:n,children:[e.jsx(rt,{asChild:!0,children:e.jsxs(q,{variant:"outline",className:"gap-2",children:[e.jsx(gt,{className:"h-4 w-4"}),De(new Date(a),"MMM dd, yyyy")," - ",De(new Date(t),"MMM dd, yyyy")]})}),e.jsx(nt,{className:"w-auto p-4",align:"start",children:e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Quick Select"}),e.jsx("div",{className:"grid gap-2",children:o.map(d=>e.jsx(q,{variant:"ghost",className:"justify-start",onClick:()=>s(d.days),children:d.label},d.label))})]})})})]})})}const _a=[{value:"google_search_console",label:"Google Search Console"},{value:"google_analytics",label:"Google Analytics"},{value:"bing_webmaster",label:"Bing Webmaster"},{value:"yandex_webmaster",label:"Yandex Webmaster"}];function ka({selectedPlatforms:a,onChange:t}){const i=r=>{a.includes(r)?t(a.filter(n=>n!==r)):t([...a,r])};return e.jsxs(at,{children:[e.jsx(rt,{asChild:!0,children:e.jsxs(q,{variant:"outline",className:"gap-2",children:[e.jsx(Lt,{className:"h-4 w-4"}),"Platforms (",a.length,")"]})}),e.jsx(nt,{className:"w-64",align:"start",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-medium text-sm",children:"Filter by Platform"}),e.jsx("div",{className:"space-y-3",children:_a.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(zt,{id:r.value,checked:a.includes(r.value),onCheckedChange:()=>i(r.value)}),e.jsx(pt,{htmlFor:r.value,className:"text-sm font-normal cursor-pointer",children:r.label})]},r.value))})]})})]})}function qa(){const{toast:a}=fe(),[t,i]=de.useState({start:new Date(Date.now()-720*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[r,n]=de.useState(["google_search_console","google_analytics"]),s=pa(),o=dt({startDate:t.start,endDate:t.end,platforms:r,limit:100}),d=async()=>{try{await s.mutateAsync({start_date:t.start,end_date:t.end,force_refresh:!0})}catch(u){console.error("Failed to refresh data:",u)}},c=()=>{if(!o||o.length===0){a({title:"No Data to Export",description:"Connect a platform and sync data before exporting.",variant:"destructive"});return}const u=`${t.start} to ${t.end}`,h=ze(o,"Search Analytics Report",u);$t(h),a({title:"Exported to CSV",description:`Exported ${o.length} queries to CSV.`})},l=()=>{if(!o||o.length===0){a({title:"No Data to Export",description:"Connect a platform and sync data before exporting.",variant:"destructive"});return}const u=`${t.start} to ${t.end}`,h=ze(o,"Search Analytics Report",u);It(h),a({title:"Opening PDF",description:`Preparing PDF report with ${o.length} queries.`})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 flex-wrap",children:[e.jsxs(q,{variant:"outline",size:"sm",onClick:d,disabled:s.isPending,children:[e.jsx(Wt,{className:`h-4 w-4 mr-2 ${s.isPending?"animate-spin":""}`}),"Refresh Data"]}),e.jsxs(Mt,{children:[e.jsx(Rt,{asChild:!0,children:e.jsxs(q,{variant:"outline",size:"sm",children:[e.jsx(yt,{className:"h-4 w-4 mr-2"}),"Export"]})}),e.jsxs(Bt,{align:"end",children:[e.jsxs(Le,{onClick:c,children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Export to CSV"]}),e.jsxs(Le,{onClick:l,children:[e.jsx(je,{className:"h-4 w-4 mr-2"}),"Export to PDF"]})]})]}),e.jsxs(q,{variant:"outline",size:"sm",children:[e.jsx(Vt,{className:"h-4 w-4 mr-2"}),"Settings"]})]}),e.jsx(wa,{}),e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Filters"}),e.jsx(L,{children:"Customize your analytics view"})]}),e.jsxs(F,{className:"flex flex-wrap gap-4",children:[e.jsx(Aa,{startDate:t.start,endDate:t.end,onChange:(u,h)=>i({start:u,end:h})}),e.jsx(ka,{selectedPlatforms:r,onChange:n})]})]}),e.jsxs(Ue,{defaultValue:"overview",className:"space-y-4",children:[e.jsxs(Qe,{children:[e.jsx(W,{value:"overview",children:"Overview"}),e.jsx(W,{value:"queries",children:"Top Queries"}),e.jsx(W,{value:"pages",children:"Top Pages"}),e.jsx(W,{value:"devices",children:"Devices"}),e.jsx(W,{value:"countries",children:"Countries"})]}),e.jsxs(V,{value:"overview",className:"space-y-4",children:[e.jsx(Na,{startDate:t.start,endDate:t.end,platforms:r}),e.jsx(Pa,{startDate:t.start,endDate:t.end,platforms:r}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Top 10 Queries"}),e.jsx(L,{children:"Highest performing search queries"})]}),e.jsx(F,{children:e.jsx(Be,{startDate:t.start,endDate:t.end,platforms:r,limit:10})})]}),e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Top 10 Pages"}),e.jsx(L,{children:"Highest performing pages"})]}),e.jsx(F,{children:e.jsx(We,{startDate:t.start,endDate:t.end,platforms:r,limit:10})})]})]})]}),e.jsx(V,{value:"queries",className:"space-y-4",children:e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"All Search Queries"}),e.jsx(L,{children:"Complete list of search queries with performance metrics"})]}),e.jsx(F,{children:e.jsx(Be,{startDate:t.start,endDate:t.end,platforms:r,limit:100})})]})}),e.jsx(V,{value:"pages",className:"space-y-4",children:e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"All Pages"}),e.jsx(L,{children:"Complete list of pages with traffic metrics"})]}),e.jsx(F,{children:e.jsx(We,{startDate:t.start,endDate:t.end,platforms:r,limit:100})})]})}),e.jsx(V,{value:"devices",className:"space-y-4",children:e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Device Breakdown"}),e.jsx(L,{children:"Performance metrics by device type"})]}),e.jsx(F,{children:e.jsx("p",{className:"text-muted-foreground",children:"Device analytics coming soon..."})})]})}),e.jsx(V,{value:"countries",className:"space-y-4",children:e.jsxs(S,{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Geographic Distribution"}),e.jsx(L,{children:"Performance metrics by country"})]}),e.jsx(F,{children:e.jsx("p",{className:"text-muted-foreground",children:"Geographic analytics coming soon..."})})]})})]})]})}export{ma as A,ce as C,qa as S,R as a};
