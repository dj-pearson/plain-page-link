import{r as b,a as w,j as e,B as f,o as $,H as P,n as U,k,C as Y,A as T,p as F,q as _,b as R,l as X,s as p}from"./index-CjfB9Lcv.js";import{P as H}from"./progress-hzfPCVfY.js";import{U as B}from"./upload-DrUtOEjI.js";import{L as I}from"./link-oPePHaqr.js";function W({onComplete:s,userProfile:t}){const[r,i]=b.useState(1),[o,c]=b.useState({templateChoice:null,profileBasics:{photo:null,photoPreview:null,fullName:t?.full_name||"",title:"",bio:"",phone:"",location:""},firstListing:{photo:null,photoPreview:null,address:"",price:"",beds:"",baths:"",status:"active"},importOption:null});w();const u=5,l=r/u*100,d=[{number:1,title:"Choose Template",icon:$},{number:2,title:"Profile Basics",icon:B},{number:3,title:"First Listing",icon:P},{number:4,title:"Preview",icon:U},{number:5,title:"Share",icon:I}],g=[{id:"luxury",name:"Luxury",description:"High-end properties",colors:["#1e3a8a","#d4af37"]},{id:"modern",name:"Modern Clean",description:"Minimalist & professional",colors:["#2563eb","#10b981"]},{id:"coastal",name:"Coastal",description:"Beach & waterfront",colors:["#0891b2","#06b6d4"]},{id:"classic",name:"Classic",description:"Traditional & timeless",colors:["#7c3aed","#a855f7"]}],n=()=>{r<u?i(r+1):s(o)},m=()=>{r>1&&i(r-1)},x=()=>{s(o)},h=()=>{switch(r){case 1:return o.templateChoice!==null;case 2:return o.profileBasics.fullName&&o.profileBasics.title;case 3:return!0;case 4:return!0;case 5:return!0;default:return!1}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Setup Your AgentBio Profile"}),e.jsx(f,{variant:"ghost",size:"sm",onClick:x,children:"Skip Setup"})]}),e.jsx(H,{value:l,className:"h-2 mb-4"}),e.jsx("div",{className:"flex items-center justify-between",children:d.map(a=>e.jsxs("div",{className:`flex items-center gap-2 ${a.number===r?"text-blue-600 font-semibold":a.number<r?"text-green-600":"text-gray-400"}`,children:[a.number<r?e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:e.jsx(k,{className:"h-5 w-5 text-white"})}):e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center ${a.number===r?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"}`,children:a.number}),e.jsx("span",{className:"hidden md:inline text-sm",children:a.title})]},a.number))})]}),e.jsxs(Y,{className:"p-8 bg-white shadow-xl",children:[r===1&&e.jsx(q,{templates:g,selected:o.templateChoice,onSelect:a=>c({...o,templateChoice:a})}),r===2&&e.jsx(M,{data:o.profileBasics,onChange:a=>c({...o,profileBasics:a})}),r===3&&e.jsx(O,{data:o.firstListing,onChange:a=>c({...o,firstListing:a})}),r===4&&e.jsx(Z,{wizardData:o}),r===5&&e.jsx(G,{username:t?.username||"yourname"})]}),e.jsxs("div",{className:"flex items-center justify-between mt-8",children:[e.jsxs(f,{variant:"outline",onClick:m,disabled:r===1,children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Back"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Step ",r," of ",u," â€¢ ~",10-r*2," min remaining"]}),e.jsxs(f,{onClick:n,disabled:!h(),children:[r===u?"Go to Dashboard":"Next",e.jsx(F,{className:"h-4 w-4 ml-2"})]})]})]})})}function q({templates:s,selected:t,onSelect:r}){return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Choose Your Style"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Select a template to match your brand. You can customize it later."}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.map(i=>e.jsxs("button",{onClick:()=>r(i.id),className:`p-4 rounded-xl border-2 transition-all ${t===i.id?"border-blue-600 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"w-full h-24 rounded-lg mb-3",style:{background:`linear-gradient(135deg, ${i.colors[0]}, ${i.colors[1]})`}}),e.jsx("div",{className:"font-semibold text-sm",children:i.name}),e.jsx("div",{className:"text-xs text-gray-500",children:i.description})]},i.id))})]})}function M({data:s,onChange:t}){const r=i=>{const o=i.target.files?.[0];if(o){const c=new FileReader;c.onloadend=()=>{t({...s,photo:o,photoPreview:c.result})},c.readAsDataURL(o)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Your Profile Basics"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Add your photo and basic info. Takes ~2 minutes."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Profile Photo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-200 overflow-hidden",children:s.photoPreview?e.jsx("img",{src:s.photoPreview,alt:"Preview",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(B,{className:"h-8 w-8"})})}),e.jsxs("div",{children:[e.jsx("input",{type:"file",id:"photo-upload",accept:"image/*",onChange:r,className:"hidden"}),e.jsx(f,{asChild:!0,variant:"outline",size:"sm",children:e.jsx("label",{htmlFor:"photo-upload",className:"cursor-pointer",children:"Upload Photo"})})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Full Name *"}),e.jsx("input",{type:"text",value:s.fullName,onChange:i=>t({...s,fullName:i.target.value}),placeholder:"Sarah Johnson",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Title *"}),e.jsx("input",{type:"text",value:s.title,onChange:i=>t({...s,title:i.target.value}),placeholder:"Luxury Home Specialist",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bio (optional)"}),e.jsx("textarea",{value:s.bio,onChange:i=>t({...s,bio:i.target.value}),placeholder:"Helping families find their dream homes...",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 h-24 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Phone (optional)"}),e.jsx("input",{type:"tel",value:s.phone,onChange:i=>t({...s,phone:i.target.value}),placeholder:"(555) 123-4567",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Location (optional)"}),e.jsx("input",{type:"text",value:s.location,onChange:i=>t({...s,location:i.target.value}),placeholder:"Austin, TX",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]})]})}function O({data:s,onChange:t}){const r=i=>{const o=i.target.files?.[0];if(o){const c=new FileReader;c.onloadend=()=>{t({...s,photo:o,photoPreview:c.result})},c.readAsDataURL(o)}};return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Add Your First Listing"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Showcase a property to make your profile pop. You can skip and add later."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Property Photo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-32 h-24 rounded-lg bg-gray-200 overflow-hidden",children:s.photoPreview?e.jsx("img",{src:s.photoPreview,alt:"Property",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-400",children:e.jsx(P,{className:"h-8 w-8"})})}),e.jsxs("div",{children:[e.jsx("input",{type:"file",id:"listing-photo",accept:"image/*",onChange:r,className:"hidden"}),e.jsx(f,{asChild:!0,variant:"outline",size:"sm",children:e.jsx("label",{htmlFor:"listing-photo",className:"cursor-pointer",children:"Upload Photo"})})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Address"}),e.jsx("input",{type:"text",value:s.address,onChange:i=>t({...s,address:i.target.value}),placeholder:"123 Main St, Austin, TX 78701",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Price"}),e.jsx("input",{type:"text",value:s.price,onChange:i=>t({...s,price:i.target.value}),placeholder:"$750,000",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Beds"}),e.jsx("input",{type:"number",value:s.beds,onChange:i=>t({...s,beds:i.target.value}),placeholder:"3",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Baths"}),e.jsx("input",{type:"number",value:s.baths,onChange:i=>t({...s,baths:i.target.value}),placeholder:"2",className:"w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Status"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:s.status==="active",onChange:()=>t({...s,status:"active"}),className:"text-blue-600"}),e.jsx("span",{children:"Active Listing"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:s.status==="sold",onChange:()=>t({...s,status:"sold"}),className:"text-blue-600"}),e.jsx("span",{children:"Sold Property"})]})]})]})]})]})}function Z({wizardData:s}){return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Preview Your Profile"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Here's how your profile will look. You can edit everything later."}),e.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-8 border border-gray-200",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[s.profileBasics.photoPreview?e.jsx("img",{src:s.profileBasics.photoPreview,alt:"Profile",className:"w-24 h-24 rounded-full object-cover mb-4"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-gray-300 mb-4"}),e.jsx("h3",{className:"text-xl font-bold",children:s.profileBasics.fullName||"Your Name"}),e.jsx("p",{className:"text-sm text-gray-600",children:s.profileBasics.title||"Your Title"}),s.profileBasics.location&&e.jsx("p",{className:"text-sm text-gray-500",children:s.profileBasics.location})]}),s.profileBasics.bio&&e.jsx("p",{className:"text-sm text-gray-700 text-center mb-4",children:s.profileBasics.bio}),s.firstListing.photoPreview&&e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("img",{src:s.firstListing.photoPreview,alt:"Listing",className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"font-semibold text-lg text-blue-600 mb-1",children:s.firstListing.price||"$XXX,XXX"}),e.jsx("div",{className:"text-sm text-gray-700 mb-2",children:s.firstListing.address||"Property Address"}),(s.firstListing.beds||s.firstListing.baths)&&e.jsxs("div",{className:"text-sm text-gray-600",children:[s.firstListing.beds," bd â€¢ ",s.firstListing.baths," ba"]})]})]})]})})]})}function G({username:s}){const t=`agentbio.net/${s}`,[r,i]=b.useState(!1),o=()=>{navigator.clipboard.writeText(`https://${t}`),i(!0),setTimeout(()=>i(!1),2e3)};return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(k,{className:"h-8 w-8 text-green-600"})}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"ðŸŽ‰ Your Profile is Live!"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Share your link on Instagram, Facebook, business cards, and everywhere you connect with clients."}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl p-6 mb-6",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Your AgentBio Link"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mb-4",children:t}),e.jsx(f,{onClick:o,size:"lg",className:"mb-4",children:r?"Copied!":"Copy Link"})]}),e.jsxs("div",{className:"space-y-3 text-left max-w-md mx-auto",children:[e.jsx("h3",{className:"font-semibold text-center mb-4",children:"Next Steps:"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:"1"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Add it to Instagram bio"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Replace your current link with your AgentBio URL"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:"2"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Add more listings"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Showcase your sold properties and active listings"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:"3"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Customize your theme"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Match your personal brand with colors and fonts"})]})]})]})]})}function D(){const s=w(),{user:t,profile:r}=_(),{toast:i}=R(),[o,c]=b.useState(!1),u=async l=>{if(!t){i({title:"Error",description:"You must be logged in to complete onboarding",variant:"destructive"}),s("/auth/login");return}c(!0);try{const d={};if(l.profileBasics.fullName&&(d.full_name=l.profileBasics.fullName),l.profileBasics.title&&(d.title=l.profileBasics.title),l.profileBasics.bio&&(d.bio=l.profileBasics.bio),l.profileBasics.phone&&(d.phone=l.profileBasics.phone),l.profileBasics.location){const n=l.profileBasics.location.split(",").map(m=>m.trim());n.length>=2&&(d.city=n[0],d.license_state=n[1])}if(l.profileBasics.photo)try{const n=l.profileBasics.photo.name.split(".").pop(),x=`avatars/${`${t.id}-${Date.now()}.${n}`}`,{error:h}=await p.storage.from("avatars").upload(x,l.profileBasics.photo);if(h)throw h;const{data:{publicUrl:a}}=p.storage.from("avatars").getPublicUrl(x);d.avatar_url=a}catch(n){console.error("Error uploading avatar:",n)}l.templateChoice&&(d.theme=l.templateChoice);const{error:g}=await p.from("profiles").update(d).eq("id",t.id);if(g)throw g;if(l.firstListing.address||l.firstListing.price)try{let n=null;if(l.firstListing.photo){const j=l.firstListing.photo.name.split(".").pop(),y=`listings/${`${t.id}-listing-${Date.now()}.${j}`}`,{error:A}=await p.storage.from("listing-images").upload(y,l.firstListing.photo);if(!A){const{data:{publicUrl:E}}=p.storage.from("listing-images").getPublicUrl(y);n=E}}const m=l.firstListing.address?.split(",").map(j=>j.trim())||[],x=m[0]||"",h=m[1]||"",v=(m[2]||"").split(" "),L=v[0]||"",S=v[1]||"",C={user_id:t.id,address:x,city:h,state:L,zip_code:S,price:l.firstListing.price||"0",bedrooms:l.firstListing.beds?parseInt(l.firstListing.beds):null,bathrooms:l.firstListing.baths?parseInt(l.firstListing.baths):null,status:l.firstListing.status||"active",featured:!0,photos:n?[n]:[]},{error:N}=await p.from("listings").insert(C);N&&console.error("Error creating listing:",N)}catch(n){console.error("Error with first listing:",n)}try{await edgeFunctions.invoke("send-welcome-email",{body:{user_id:t.id,email:t.email,full_name:l.profileBasics.fullName||t.user_metadata?.full_name,username:t.user_metadata?.username||"agent"}})}catch(n){console.error("Welcome email failed (non-critical):",n)}i({title:"ðŸŽ‰ Welcome to AgentBio!",description:"Your profile is ready to share. Check your email for next steps!"}),s("/dashboard",{replace:!0})}catch(d){console.error("Error completing onboarding:",d),i({title:"Error",description:d.message||"Failed to save your information. Please try again.",variant:"destructive"})}finally{c(!1)}};return o?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Setting up your profile..."}),e.jsx("p",{className:"text-gray-600",children:"This will only take a moment"})]})}):e.jsx(W,{onComplete:u,userProfile:r||t})}export{D as default};
