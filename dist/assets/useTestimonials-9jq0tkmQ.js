import{b as e,u as i,d as t}from"./data-hbyXtiTU.js";import{u as s,s as a}from"./index-B6WqPLum.js";function r(){const{user:r}=s(),n=e(),{data:o=[],isLoading:d}=i({queryKey:["testimonials",r?.id],queryFn:async()=>{if(!r?.id)return[];const{data:e,error:i}=await a.from("testimonials").select("*").eq("user_id",r.id).order("date",{ascending:!1});if(i)throw i;return e},enabled:!!r?.id});return{testimonials:o,isLoading:d,addTestimonial:t({mutationFn:async e=>{if(!r?.id)throw new Error("User not authenticated");const{data:i,error:t}=await a.from("testimonials").insert({user_id:r.id,...e}).select().single();if(t)throw t;return i},onSuccess:()=>{n.invalidateQueries({queryKey:["testimonials",r?.id]})}}),updateTestimonial:t({mutationFn:async({id:e,...i})=>{const{data:t,error:s}=await a.from("testimonials").update(i).eq("id",e).select().single();if(s)throw s;return t},onSuccess:()=>{n.invalidateQueries({queryKey:["testimonials",r?.id]})}}),deleteTestimonial:t({mutationFn:async e=>{const{error:i}=await a.from("testimonials").delete().eq("id",e);if(i)throw i},onSuccess:()=>{n.invalidateQueries({queryKey:["testimonials",r?.id]})}})}}export{r as u};
