{"version":3,"file":"SearchAnalyticsDashboard-Dp169vYX.js","sources":["../../src/hooks/useSearchAnalytics.ts","../../src/components/admin/searchAnalytics/PlatformConnections.tsx","../../src/components/admin/searchAnalytics/MetricsOverview.tsx","../../src/components/admin/searchAnalytics/AnalyticsCharts.tsx","../../src/components/admin/searchAnalytics/TopQueriesTable.tsx","../../src/components/admin/searchAnalytics/TopPagesTable.tsx","../../src/components/admin/searchAnalytics/DateRangePicker.tsx","../../src/components/admin/searchAnalytics/PlatformFilter.tsx","../../src/components/admin/SearchAnalyticsDashboard.tsx"],"sourcesContent":["import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useToast } from '@/hooks/use-toast';\nimport type {\n  ConnectedPlatform,\n  GA4Property,\n  BingWebmasterSite,\n  YandexWebmasterSite,\n  UnifiedSearchAnalytics,\n  SearchDashboardConfig,\n  SyncRequest,\n  AggregateRequest,\n  OAuthCallbackRequest,\n  SearchPlatform,\n  AggregatedMetrics,\n  TimeSeriesDataPoint,\n  TopQuery,\n  TopPage,\n} from '@/types/searchAnalytics';\n\n// Hook to get connected platforms status\nexport function useConnectedPlatforms() {\n  return useQuery({\n    queryKey: ['connected-platforms'],\n    queryFn: async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('Not authenticated');\n\n      const { data, error } = await supabase.rpc('get_connected_search_platforms', {\n        p_user_id: user.id,\n      });\n\n      if (error) throw error;\n      return data as ConnectedPlatform[];\n    },\n  });\n}\n\n// Hook to initiate OAuth flow\nexport function useOAuthInit() {\n  const { toast } = useToast();\n\n  return useMutation({\n    mutationFn: async (platform: SearchPlatform) => {\n      // Get OAuth URLs based on platform\n      const redirectUris: Record<SearchPlatform, string> = {\n        google_analytics: `${window.location.origin}/admin/search-analytics/oauth/callback/google-analytics`,\n        google_search_console: `${window.location.origin}/admin/search-analytics/oauth/callback/google-search-console`,\n        bing_webmaster: `${window.location.origin}/admin/search-analytics/oauth/callback/bing-webmaster`,\n        yandex_webmaster: `${window.location.origin}/admin/search-analytics/oauth/callback/yandex-webmaster`,\n      };\n\n      // Platform-specific OAuth URLs\n      const oauthUrls: Record<SearchPlatform, string> = {\n        google_analytics: 'https://accounts.google.com/o/oauth2/v2/auth',\n        google_search_console: 'https://accounts.google.com/o/oauth2/v2/auth',\n        bing_webmaster: 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize',\n        yandex_webmaster: 'https://oauth.yandex.ru/authorize',\n      };\n\n      // Build OAuth URL with parameters\n      const params = new URLSearchParams({\n        client_id: platform.includes('google')\n          ? import.meta.env.VITE_GOOGLE_CLIENT_ID || ''\n          : platform === 'bing_webmaster'\n          ? import.meta.env.VITE_MICROSOFT_CLIENT_ID || ''\n          : import.meta.env.VITE_YANDEX_CLIENT_ID || '',\n        redirect_uri: redirectUris[platform],\n        response_type: 'code',\n        scope: platform === 'google_analytics'\n          ? 'https://www.googleapis.com/auth/analytics.readonly'\n          : platform === 'google_search_console'\n          ? 'https://www.googleapis.com/auth/webmasters.readonly'\n          : platform === 'bing_webmaster'\n          ? 'https://api.bing.microsoft.com/webmaster.read offline_access'\n          : 'webmaster:read',\n        access_type: 'offline',\n        prompt: 'consent',\n      });\n\n      const oauthUrl = `${oauthUrls[platform]}?${params.toString()}`;\n\n      // Redirect to OAuth provider\n      window.location.href = oauthUrl;\n    },\n    onError: (error: Error) => {\n      toast({\n        title: 'OAuth Error',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n}\n\n// Hook to handle OAuth callback\nexport function useOAuthCallback() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ platform, code, state }: OAuthCallbackRequest) => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) throw new Error('Not authenticated');\n\n      // Determine which Edge Function to call\n      const functionName = platform === 'google_analytics'\n        ? 'google-analytics-oauth-callback'\n        : platform === 'google_search_console'\n        ? 'google-search-console-oauth-callback' // Would need to create this\n        : platform === 'bing_webmaster'\n        ? 'bing-webmaster-oauth-callback'\n        : 'yandex-webmaster-oauth-callback';\n\n      const { data, error } = await edgeFunctions.invoke(functionName, {\n        body: { code, state },\n        headers: {\n          Authorization: `Bearer ${session.access_token}`,\n        },\n      });\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      toast({\n        title: 'Success',\n        description: 'Platform connected successfully',\n      });\n      queryClient.invalidateQueries({ queryKey: ['connected-platforms'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: 'Connection Failed',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n}\n\n// Hook to sync data from a platform\nexport function useSyncPlatform() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ platform, property_id, site_id, start_date, end_date }: SyncRequest) => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) throw new Error('Not authenticated');\n\n      const functionName = platform === 'google_analytics'\n        ? 'google-analytics-sync'\n        : platform === 'google_search_console'\n        ? 'google-search-console-sync' // Would need to create this or use existing\n        : platform === 'bing_webmaster'\n        ? 'bing-webmaster-sync'\n        : 'yandex-webmaster-sync';\n\n      const { data, error } = await edgeFunctions.invoke(functionName, {\n        body: { property_id, site_id, start_date, end_date },\n        headers: {\n          Authorization: `Bearer ${session.access_token}`,\n        },\n      });\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      toast({\n        title: 'Sync Started',\n        description: 'Data synchronization started successfully',\n      });\n      queryClient.invalidateQueries({ queryKey: ['search-analytics'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: 'Sync Failed',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n}\n\n// Hook to aggregate analytics data\nexport function useAggregateAnalytics() {\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  return useMutation({\n    mutationFn: async ({ start_date, end_date, force_refresh }: AggregateRequest) => {\n      const { data: { session } } = await supabase.auth.getSession();\n      if (!session) throw new Error('Not authenticated');\n\n      const { data, error } = await edgeFunctions.invoke('aggregate-search-analytics', {\n        body: { start_date, end_date, force_refresh },\n        headers: {\n          Authorization: `Bearer ${session.access_token}`,\n        },\n      });\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      toast({\n        title: 'Aggregation Complete',\n        description: 'Analytics data aggregated successfully',\n      });\n      queryClient.invalidateQueries({ queryKey: ['unified-analytics'] });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: 'Aggregation Failed',\n        description: error.message,\n        variant: 'destructive',\n      });\n    },\n  });\n}\n\n// Hook to fetch GA4 properties\nexport function useGA4Properties() {\n  return useQuery({\n    queryKey: ['ga4-properties'],\n    queryFn: async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('Not authenticated');\n\n      const { data, error } = await supabase\n        .from('ga4_properties')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      return data as GA4Property[];\n    },\n  });\n}\n\n// Hook to fetch Bing sites\nexport function useBingSites() {\n  return useQuery({\n    queryKey: ['bing-sites'],\n    queryFn: async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('Not authenticated');\n\n      const { data, error } = await supabase\n        .from('bing_webmaster_sites')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      return data as BingWebmasterSite[];\n    },\n  });\n}\n\n// Hook to fetch Yandex sites\nexport function useYandexSites() {\n  return useQuery({\n    queryKey: ['yandex-sites'],\n    queryFn: async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('Not authenticated');\n\n      const { data, error } = await supabase\n        .from('yandex_webmaster_sites')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      return data as YandexWebmasterSite[];\n    },\n  });\n}\n\n// Hook to fetch unified analytics with filters\nexport function useUnifiedAnalytics(filters: {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n}) {\n  return useQuery({\n    queryKey: ['unified-analytics', filters],\n    queryFn: async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('Not authenticated');\n\n      let query = supabase\n        .from('unified_search_analytics')\n        .select('*')\n        .eq('user_id', user.id)\n        .gte('date', filters.startDate)\n        .lte('date', filters.endDate);\n\n      if (filters.platforms && filters.platforms.length > 0) {\n        query = query.in('source_platform', filters.platforms);\n      }\n\n      const { data, error } = await query.order('date', { ascending: false });\n\n      if (error) throw error;\n      return data as UnifiedSearchAnalytics[];\n    },\n  });\n}\n\n// Hook to get aggregated metrics\nexport function useAggregatedMetrics(filters: {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n}) {\n  const { data: analyticsData } = useUnifiedAnalytics(filters);\n\n  if (!analyticsData) return null;\n\n  const metrics: AggregatedMetrics = {\n    total_clicks: analyticsData.reduce((sum, row) => sum + (row.clicks || 0), 0),\n    total_impressions: analyticsData.reduce((sum, row) => sum + (row.impressions || 0), 0),\n    total_sessions: analyticsData.reduce((sum, row) => sum + (row.sessions || 0), 0),\n    total_users: analyticsData.reduce((sum, row) => sum + (row.users || 0), 0),\n    total_pageviews: analyticsData.reduce((sum, row) => sum + (row.pageviews || 0), 0),\n    average_ctr: analyticsData.length > 0\n      ? analyticsData.reduce((sum, row) => sum + (row.ctr || 0), 0) / analyticsData.length\n      : 0,\n    average_position: analyticsData.length > 0\n      ? analyticsData.reduce((sum, row) => sum + (row.average_position || 0), 0) / analyticsData.length\n      : 0,\n    average_bounce_rate: analyticsData.length > 0\n      ? analyticsData.reduce((sum, row) => sum + (row.bounce_rate || 0), 0) / analyticsData.length\n      : 0,\n    clicks_change: 0, // Would need comparison period data\n    impressions_change: 0,\n    sessions_change: 0,\n  };\n\n  return metrics;\n}\n\n// Hook to get time series data for charts\nexport function useTimeSeriesData(filters: {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n}): TimeSeriesDataPoint[] | null {\n  const { data: analyticsData } = useUnifiedAnalytics(filters);\n\n  if (!analyticsData) return null;\n\n  // Group by date\n  const grouped = analyticsData.reduce((acc, row) => {\n    const date = row.date;\n    if (!acc[date]) {\n      acc[date] = {\n        date,\n        clicks: 0,\n        impressions: 0,\n        sessions: 0,\n        users: 0,\n        ctr: 0,\n        position: 0,\n        count: 0,\n      };\n    }\n\n    acc[date].clicks += row.clicks || 0;\n    acc[date].impressions += row.impressions || 0;\n    acc[date].sessions += row.sessions || 0;\n    acc[date].users += row.users || 0;\n    acc[date].ctr += row.ctr || 0;\n    acc[date].position += row.average_position || 0;\n    acc[date].count += 1;\n\n    return acc;\n  }, {} as Record<string, any>);\n\n  // Calculate averages and format\n  return Object.values(grouped).map(item => ({\n    date: item.date,\n    clicks: item.clicks,\n    impressions: item.impressions,\n    sessions: item.sessions,\n    users: item.users,\n    ctr: item.count > 0 ? item.ctr / item.count : 0,\n    position: item.count > 0 ? item.position / item.count : 0,\n  })) as TimeSeriesDataPoint[];\n}\n\n// Hook to get top queries\nexport function useTopQueries(filters: {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n  limit?: number;\n}): TopQuery[] | null {\n  const { data: analyticsData } = useUnifiedAnalytics(filters);\n\n  if (!analyticsData) return null;\n\n  // Filter only rows with queries\n  const withQueries = analyticsData.filter(row => row.query);\n\n  // Group by query\n  const grouped = withQueries.reduce((acc, row) => {\n    const query = row.query!;\n    if (!acc[query]) {\n      acc[query] = {\n        query,\n        clicks: 0,\n        impressions: 0,\n        ctr: 0,\n        position: 0,\n        count: 0,\n        change: 0,\n      };\n    }\n\n    acc[query].clicks += row.clicks || 0;\n    acc[query].impressions += row.impressions || 0;\n    acc[query].ctr += row.ctr || 0;\n    acc[query].position += row.average_position || 0;\n    acc[query].count += 1;\n\n    return acc;\n  }, {} as Record<string, any>);\n\n  // Calculate averages, sort by clicks, and limit\n  const topQueries = Object.values(grouped)\n    .map(item => ({\n      query: item.query,\n      clicks: item.clicks,\n      impressions: item.impressions,\n      ctr: item.count > 0 ? item.ctr / item.count : 0,\n      position: item.count > 0 ? item.position / item.count : 0,\n      change: 0, // Would need historical data\n    }))\n    .sort((a, b) => b.clicks - a.clicks)\n    .slice(0, filters.limit || 10) as TopQuery[];\n\n  return topQueries;\n}\n\n// Hook to get top pages\nexport function useTopPages(filters: {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n  limit?: number;\n}): TopPage[] | null {\n  const { data: analyticsData } = useUnifiedAnalytics(filters);\n\n  if (!analyticsData) return null;\n\n  // Filter only rows with page URLs\n  const withPages = analyticsData.filter(row => row.page_url);\n\n  // Group by page URL\n  const grouped = withPages.reduce((acc, row) => {\n    const url = row.page_url!;\n    if (!acc[url]) {\n      acc[url] = {\n        url,\n        title: row.page_title,\n        clicks: 0,\n        impressions: 0,\n        sessions: 0,\n        ctr: 0,\n        position: 0,\n        count: 0,\n        change: 0,\n      };\n    }\n\n    acc[url].clicks += row.clicks || 0;\n    acc[url].impressions += row.impressions || 0;\n    acc[url].sessions += row.sessions || 0;\n    acc[url].ctr += row.ctr || 0;\n    acc[url].position += row.average_position || 0;\n    acc[url].count += 1;\n\n    return acc;\n  }, {} as Record<string, any>);\n\n  // Calculate averages, sort by clicks, and limit\n  const topPages = Object.values(grouped)\n    .map(item => ({\n      url: item.url,\n      title: item.title,\n      clicks: item.clicks,\n      impressions: item.impressions,\n      sessions: item.sessions,\n      ctr: item.count > 0 ? item.ctr / item.count : 0,\n      position: item.count > 0 ? item.position / item.count : 0,\n      change: 0, // Would need historical data\n    }))\n    .sort((a, b) => b.clicks - a.clicks)\n    .slice(0, filters.limit || 10) as TopPage[];\n\n  return topPages;\n}\n\n// Hook to get or create dashboard config\nexport function useDashboardConfig() {\n  return useQuery({\n    queryKey: ['dashboard-config'],\n    queryFn: async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user) throw new Error('Not authenticated');\n\n      const { data, error } = await supabase\n        .from('search_dashboard_config')\n        .select('*')\n        .eq('user_id', user.id)\n        .single();\n\n      if (error && error.code !== 'PGRST116') throw error;\n\n      // Create default config if doesn't exist\n      if (!data) {\n        const { data: newConfig, error: insertError } = await supabase\n          .from('search_dashboard_config')\n          .insert({\n            user_id: user.id,\n            default_date_range: '30days',\n            default_comparison_period: 'previous_period',\n            default_grouping: 'daily',\n            enabled_platforms: ['google_search_console', 'google_analytics'],\n            primary_platform: 'google_search_console',\n            visible_metrics: ['clicks', 'impressions', 'ctr', 'position', 'sessions', 'users'],\n            enable_alerts: true,\n          })\n          .select()\n          .single();\n\n        if (insertError) throw insertError;\n        return newConfig as SearchDashboardConfig;\n      }\n\n      return data as SearchDashboardConfig;\n    },\n  });\n}\n","import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { CheckCircle2, XCircle, Clock, ExternalLink } from 'lucide-react';\nimport { useConnectedPlatforms, useOAuthInit, useSyncPlatform } from '@/hooks/useSearchAnalytics';\nimport type { SearchPlatform } from '@/types/searchAnalytics';\n\nconst PLATFORM_INFO: Record<SearchPlatform, { name: string; description: string; icon: string }> = {\n  google_search_console: {\n    name: 'Google Search Console',\n    description: 'Search performance and indexing data',\n    icon: 'ðŸ”',\n  },\n  google_analytics: {\n    name: 'Google Analytics 4',\n    description: 'Website traffic and user behavior',\n    icon: 'ðŸ“Š',\n  },\n  bing_webmaster: {\n    name: 'Bing Webmaster Tools',\n    description: 'Bing search performance data',\n    icon: 'ðŸ…±ï¸',\n  },\n  yandex_webmaster: {\n    name: 'Yandex Webmaster',\n    description: 'Yandex search performance data',\n    icon: 'ðŸ‡·ðŸ‡º',\n  },\n};\n\nexport function PlatformConnections() {\n  const { data: platforms, isLoading } = useConnectedPlatforms();\n  const oauthInit = useOAuthInit();\n  const syncMutation = useSyncPlatform();\n\n  const handleConnect = (platform: SearchPlatform) => {\n    oauthInit.mutate(platform);\n  };\n\n  const handleSync = (platform: SearchPlatform) => {\n    syncMutation.mutate({ platform });\n  };\n\n  if (isLoading) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle>Platform Connections</CardTitle>\n          <CardDescription>Loading connection status...</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex justify-center py-8\">\n            <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\"></div>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Platform Connections</CardTitle>\n        <CardDescription>Connect and manage your analytics platforms</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n          {platforms?.map((platform) => {\n            const info = PLATFORM_INFO[platform.platform];\n            const isConnected = platform.is_connected;\n            const isActive = platform.credential_status === 'active';\n            const isExpired = platform.credential_status === 'expired';\n\n            return (\n              <Card key={platform.platform} className=\"relative\">\n                <CardHeader className=\"pb-3\">\n                  <div className=\"flex items-start justify-between\">\n                    <div className=\"flex items-center gap-2\">\n                      <span className=\"text-2xl\">{info.icon}</span>\n                      <div>\n                        <CardTitle className=\"text-sm\">{info.name}</CardTitle>\n                      </div>\n                    </div>\n                    {isActive && (\n                      <Badge variant=\"default\" className=\"text-xs\">\n                        <CheckCircle2 className=\"h-3 w-3 mr-1\" />\n                        Connected\n                      </Badge>\n                    )}\n                    {isExpired && (\n                      <Badge variant=\"destructive\" className=\"text-xs\">\n                        <Clock className=\"h-3 w-3 mr-1\" />\n                        Expired\n                      </Badge>\n                    )}\n                    {!isConnected && (\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        <XCircle className=\"h-3 w-3 mr-1\" />\n                        Not Connected\n                      </Badge>\n                    )}\n                  </div>\n                  <CardDescription className=\"text-xs mt-1\">\n                    {info.description}\n                  </CardDescription>\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {platform.last_sync && (\n                    <p className=\"text-xs text-muted-foreground mb-3\">\n                      Last sync: {new Date(platform.last_sync).toLocaleDateString()}\n                    </p>\n                  )}\n                  <div className=\"flex flex-col gap-2\">\n                    {!isConnected || isExpired ? (\n                      <Button\n                        size=\"sm\"\n                        onClick={() => handleConnect(platform.platform)}\n                        disabled={oauthInit.isPending}\n                        className=\"w-full\"\n                      >\n                        <ExternalLink className=\"h-3 w-3 mr-2\" />\n                        {isExpired ? 'Reconnect' : 'Connect'}\n                      </Button>\n                    ) : (\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        onClick={() => handleSync(platform.platform)}\n                        disabled={syncMutation.isPending}\n                        className=\"w-full\"\n                      >\n                        Sync Data\n                      </Button>\n                    )}\n                  </div>\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { TrendingUp, TrendingDown, Minus, MousePointer, Eye, Users, FileText, Target, BarChart3 } from 'lucide-react';\nimport { useAggregatedMetrics } from '@/hooks/useSearchAnalytics';\nimport type { SearchPlatform } from '@/types/searchAnalytics';\n\ninterface MetricsOverviewProps {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n}\n\nexport function MetricsOverview({ startDate, endDate, platforms }: MetricsOverviewProps) {\n  const metrics = useAggregatedMetrics({ startDate, endDate, platforms });\n\n  if (!metrics) {\n    return (\n      <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n        {[1, 2, 3, 4].map((i) => (\n          <Card key={i}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">Loading...</CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"h-8 bg-muted animate-pulse rounded\"></div>\n            </CardContent>\n          </Card>\n        ))}\n      </div>\n    );\n  }\n\n  const formatNumber = (num: number) => {\n    return new Intl.NumberFormat('en-US', { notation: 'compact', maximumFractionDigits: 1 }).format(num);\n  };\n\n  const formatPercent = (num: number) => {\n    return `${(num * 100).toFixed(2)}%`;\n  };\n\n  const formatChange = (change: number) => {\n    if (change === 0) return { icon: Minus, color: 'text-muted-foreground', text: '0%' };\n    const isPositive = change > 0;\n    return {\n      icon: isPositive ? TrendingUp : TrendingDown,\n      color: isPositive ? 'text-green-600' : 'text-red-600',\n      text: `${isPositive ? '+' : ''}${formatPercent(change / 100)}`,\n    };\n  };\n\n  const metricsData = [\n    {\n      title: 'Total Clicks',\n      value: metrics.total_clicks,\n      change: metrics.clicks_change,\n      icon: MousePointer,\n      description: 'Users who clicked through',\n    },\n    {\n      title: 'Total Impressions',\n      value: metrics.total_impressions,\n      change: metrics.impressions_change,\n      icon: Eye,\n      description: 'Times your site appeared',\n    },\n    {\n      title: 'Avg. CTR',\n      value: metrics.average_ctr,\n      change: 0,\n      icon: Target,\n      description: 'Click-through rate',\n      isPercentage: true,\n    },\n    {\n      title: 'Avg. Position',\n      value: metrics.average_position,\n      change: 0,\n      icon: BarChart3,\n      description: 'Average search position',\n      decimals: 1,\n    },\n    {\n      title: 'Total Sessions',\n      value: metrics.total_sessions,\n      change: metrics.sessions_change,\n      icon: Users,\n      description: 'Website sessions',\n    },\n    {\n      title: 'Total Users',\n      value: metrics.total_users,\n      change: 0,\n      icon: Users,\n      description: 'Unique visitors',\n    },\n    {\n      title: 'Total Pageviews',\n      value: metrics.total_pageviews,\n      change: 0,\n      icon: FileText,\n      description: 'Pages viewed',\n    },\n    {\n      title: 'Bounce Rate',\n      value: metrics.average_bounce_rate,\n      change: 0,\n      icon: TrendingDown,\n      description: 'Visitors who left quickly',\n      isPercentage: true,\n    },\n  ];\n\n  return (\n    <div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-4\">\n      {metricsData.map((metric) => {\n        const changeData = formatChange(metric.change);\n        const Icon = metric.icon;\n        const ChangeIcon = changeData.icon;\n\n        return (\n          <Card key={metric.title}>\n            <CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n              <CardTitle className=\"text-sm font-medium\">{metric.title}</CardTitle>\n              <Icon className=\"h-4 w-4 text-muted-foreground\" />\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-2xl font-bold\">\n                {metric.isPercentage\n                  ? formatPercent(metric.value)\n                  : metric.decimals\n                  ? metric.value.toFixed(metric.decimals)\n                  : formatNumber(metric.value)}\n              </div>\n              <div className=\"flex items-center gap-1 text-xs text-muted-foreground\">\n                <ChangeIcon className={`h-3 w-3 ${changeData.color}`} />\n                <span className={changeData.color}>{changeData.text}</span>\n                <span>vs. previous period</span>\n              </div>\n              <p className=\"text-xs text-muted-foreground mt-1\">{metric.description}</p>\n            </CardContent>\n          </Card>\n        );\n      })}\n    </div>\n  );\n}\n","import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { LineChart, Line, AreaChart, Area, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer } from 'recharts';\nimport { useTimeSeriesData } from '@/hooks/useSearchAnalytics';\nimport type { SearchPlatform } from '@/types/searchAnalytics';\n\ninterface AnalyticsChartsProps {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n}\n\nexport function AnalyticsCharts({ startDate, endDate, platforms }: AnalyticsChartsProps) {\n  const timeSeriesData = useTimeSeriesData({ startDate, endDate, platforms });\n\n  if (!timeSeriesData || timeSeriesData.length === 0) {\n    return (\n      <Card>\n        <CardHeader>\n          <CardTitle>Performance Trends</CardTitle>\n          <CardDescription>No data available for the selected period</CardDescription>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex flex-col items-center justify-center py-12 text-muted-foreground\">\n            <p>Connect your platforms and sync data to see performance trends</p>\n          </div>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle>Performance Trends</CardTitle>\n        <CardDescription>Track your search and traffic metrics over time</CardDescription>\n      </CardHeader>\n      <CardContent>\n        <Tabs defaultValue=\"traffic\" className=\"space-y-4\">\n          <TabsList>\n            <TabsTrigger value=\"traffic\">Traffic</TabsTrigger>\n            <TabsTrigger value=\"search\">Search Performance</TabsTrigger>\n            <TabsTrigger value=\"engagement\">Engagement</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"traffic\" className=\"space-y-4\">\n            <ResponsiveContainer width=\"100%\" height={350}>\n              <AreaChart data={timeSeriesData}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis\n                  dataKey=\"date\"\n                  tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                />\n                <YAxis />\n                <Tooltip\n                  labelFormatter={(value) => new Date(value).toLocaleDateString()}\n                  formatter={(value: number) => [new Intl.NumberFormat().format(value), '']}\n                />\n                <Legend />\n                <Area\n                  type=\"monotone\"\n                  dataKey=\"sessions\"\n                  stackId=\"1\"\n                  stroke=\"#8884d8\"\n                  fill=\"#8884d8\"\n                  name=\"Sessions\"\n                />\n                <Area\n                  type=\"monotone\"\n                  dataKey=\"users\"\n                  stackId=\"2\"\n                  stroke=\"#82ca9d\"\n                  fill=\"#82ca9d\"\n                  name=\"Users\"\n                />\n                <Area\n                  type=\"monotone\"\n                  dataKey=\"pageviews\"\n                  stackId=\"3\"\n                  stroke=\"#ffc658\"\n                  fill=\"#ffc658\"\n                  name=\"Pageviews\"\n                />\n              </AreaChart>\n            </ResponsiveContainer>\n          </TabsContent>\n\n          <TabsContent value=\"search\" className=\"space-y-4\">\n            <ResponsiveContainer width=\"100%\" height={350}>\n              <LineChart data={timeSeriesData}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis\n                  dataKey=\"date\"\n                  tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                />\n                <YAxis yAxisId=\"left\" />\n                <YAxis yAxisId=\"right\" orientation=\"right\" />\n                <Tooltip\n                  labelFormatter={(value) => new Date(value).toLocaleDateString()}\n                  formatter={(value: number, name: string) => {\n                    if (name === 'CTR') return [`${(value * 100).toFixed(2)}%`, name];\n                    if (name === 'Avg Position') return [value.toFixed(1), name];\n                    return [new Intl.NumberFormat().format(value), name];\n                  }}\n                />\n                <Legend />\n                <Line\n                  yAxisId=\"left\"\n                  type=\"monotone\"\n                  dataKey=\"clicks\"\n                  stroke=\"#8884d8\"\n                  name=\"Clicks\"\n                  strokeWidth={2}\n                />\n                <Line\n                  yAxisId=\"left\"\n                  type=\"monotone\"\n                  dataKey=\"impressions\"\n                  stroke=\"#82ca9d\"\n                  name=\"Impressions\"\n                  strokeWidth={2}\n                />\n                <Line\n                  yAxisId=\"right\"\n                  type=\"monotone\"\n                  dataKey=\"ctr\"\n                  stroke=\"#ffc658\"\n                  name=\"CTR\"\n                  strokeWidth={2}\n                />\n              </LineChart>\n            </ResponsiveContainer>\n          </TabsContent>\n\n          <TabsContent value=\"engagement\" className=\"space-y-4\">\n            <ResponsiveContainer width=\"100%\" height={350}>\n              <LineChart data={timeSeriesData}>\n                <CartesianGrid strokeDasharray=\"3 3\" />\n                <XAxis\n                  dataKey=\"date\"\n                  tickFormatter={(value) => new Date(value).toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}\n                />\n                <YAxis />\n                <Tooltip\n                  labelFormatter={(value) => new Date(value).toLocaleDateString()}\n                  formatter={(value: number, name: string) => {\n                    if (name === 'Avg Position') return [value.toFixed(1), name];\n                    return [new Intl.NumberFormat().format(value), name];\n                  }}\n                />\n                <Legend />\n                <Line\n                  type=\"monotone\"\n                  dataKey=\"position\"\n                  stroke=\"#8884d8\"\n                  name=\"Avg Position\"\n                  strokeWidth={2}\n                />\n              </LineChart>\n            </ResponsiveContainer>\n            <p className=\"text-xs text-muted-foreground text-center\">\n              Lower position values are better (position 1 is the top result)\n            </p>\n          </TabsContent>\n        </Tabs>\n      </CardContent>\n    </Card>\n  );\n}\n","import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { TrendingUp, TrendingDown, Minus } from 'lucide-react';\nimport { useTopQueries } from '@/hooks/useSearchAnalytics';\nimport type { SearchPlatform } from '@/types/searchAnalytics';\n\ninterface TopQueriesTableProps {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n  limit?: number;\n}\n\nexport function TopQueriesTable({ startDate, endDate, platforms, limit = 10 }: TopQueriesTableProps) {\n  const topQueries = useTopQueries({ startDate, endDate, platforms, limit });\n\n  if (!topQueries || topQueries.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-muted-foreground\">\n        <p>No query data available for the selected period</p>\n        <p className=\"text-sm mt-2\">Connect platforms and sync data to see top queries</p>\n      </div>\n    );\n  }\n\n  const formatNumber = (num: number) => {\n    return new Intl.NumberFormat('en-US').format(num);\n  };\n\n  const formatPercent = (num: number) => {\n    return `${(num * 100).toFixed(2)}%`;\n  };\n\n  const getTrendIcon = (change: number) => {\n    if (change > 0) return <TrendingUp className=\"h-3 w-3 text-green-600\" />;\n    if (change < 0) return <TrendingDown className=\"h-3 w-3 text-red-600\" />;\n    return <Minus className=\"h-3 w-3 text-muted-foreground\" />;\n  };\n\n  return (\n    <div className=\"rounded-md border\">\n      <Table>\n        <TableHeader>\n          <TableRow>\n            <TableHead className=\"w-[40%]\">Query</TableHead>\n            <TableHead className=\"text-right\">Clicks</TableHead>\n            <TableHead className=\"text-right\">Impressions</TableHead>\n            <TableHead className=\"text-right\">CTR</TableHead>\n            <TableHead className=\"text-right\">Position</TableHead>\n            <TableHead className=\"text-right\">Trend</TableHead>\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {topQueries.map((query, index) => (\n            <TableRow key={`${query.query}-${index}`}>\n              <TableCell className=\"font-medium max-w-xs truncate\">\n                {query.query}\n              </TableCell>\n              <TableCell className=\"text-right\">{formatNumber(query.clicks)}</TableCell>\n              <TableCell className=\"text-right\">{formatNumber(query.impressions)}</TableCell>\n              <TableCell className=\"text-right\">\n                <Badge variant=\"outline\">{formatPercent(query.ctr)}</Badge>\n              </TableCell>\n              <TableCell className=\"text-right\">\n                <Badge variant=\"secondary\">{query.position.toFixed(1)}</Badge>\n              </TableCell>\n              <TableCell className=\"text-right\">\n                <div className=\"flex justify-end\">\n                  {getTrendIcon(query.change)}\n                </div>\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';\nimport { Badge } from '@/components/ui/badge';\nimport { ExternalLink, TrendingUp, TrendingDown, Minus } from 'lucide-react';\nimport { useTopPages } from '@/hooks/useSearchAnalytics';\nimport type { SearchPlatform } from '@/types/searchAnalytics';\n\ninterface TopPagesTableProps {\n  startDate: string;\n  endDate: string;\n  platforms?: SearchPlatform[];\n  limit?: number;\n}\n\nexport function TopPagesTable({ startDate, endDate, platforms, limit = 10 }: TopPagesTableProps) {\n  const topPages = useTopPages({ startDate, endDate, platforms, limit });\n\n  if (!topPages || topPages.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-muted-foreground\">\n        <p>No page data available for the selected period</p>\n        <p className=\"text-sm mt-2\">Connect platforms and sync data to see top pages</p>\n      </div>\n    );\n  }\n\n  const formatNumber = (num: number) => {\n    return new Intl.NumberFormat('en-US').format(num);\n  };\n\n  const formatPercent = (num: number) => {\n    return `${(num * 100).toFixed(2)}%`;\n  };\n\n  const getTrendIcon = (change: number) => {\n    if (change > 0) return <TrendingUp className=\"h-3 w-3 text-green-600\" />;\n    if (change < 0) return <TrendingDown className=\"h-3 w-3 text-red-600\" />;\n    return <Minus className=\"h-3 w-3 text-muted-foreground\" />;\n  };\n\n  const truncateUrl = (url: string, maxLength = 50) => {\n    if (url.length <= maxLength) return url;\n    return url.substring(0, maxLength) + '...';\n  };\n\n  return (\n    <div className=\"rounded-md border\">\n      <Table>\n        <TableHeader>\n          <TableRow>\n            <TableHead className=\"w-[35%]\">Page</TableHead>\n            <TableHead className=\"text-right\">Clicks</TableHead>\n            <TableHead className=\"text-right\">Sessions</TableHead>\n            <TableHead className=\"text-right\">Impressions</TableHead>\n            <TableHead className=\"text-right\">CTR</TableHead>\n            <TableHead className=\"text-right\">Position</TableHead>\n            <TableHead className=\"text-right\">Trend</TableHead>\n            <TableHead className=\"w-[50px]\"></TableHead>\n          </TableRow>\n        </TableHeader>\n        <TableBody>\n          {topPages.map((page, index) => (\n            <TableRow key={`${page.url}-${index}`}>\n              <TableCell className=\"max-w-xs\">\n                <div className=\"flex flex-col\">\n                  <span className=\"font-medium text-sm truncate\" title={page.url}>\n                    {truncateUrl(page.url)}\n                  </span>\n                  {page.title && (\n                    <span className=\"text-xs text-muted-foreground truncate\" title={page.title}>\n                      {page.title}\n                    </span>\n                  )}\n                </div>\n              </TableCell>\n              <TableCell className=\"text-right\">{formatNumber(page.clicks)}</TableCell>\n              <TableCell className=\"text-right\">{formatNumber(page.sessions)}</TableCell>\n              <TableCell className=\"text-right\">{formatNumber(page.impressions)}</TableCell>\n              <TableCell className=\"text-right\">\n                <Badge variant=\"outline\">{formatPercent(page.ctr)}</Badge>\n              </TableCell>\n              <TableCell className=\"text-right\">\n                <Badge variant=\"secondary\">{page.position.toFixed(1)}</Badge>\n              </TableCell>\n              <TableCell className=\"text-right\">\n                <div className=\"flex justify-end\">\n                  {getTrendIcon(page.change)}\n                </div>\n              </TableCell>\n              <TableCell>\n                <a\n                  href={page.url}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  className=\"text-primary hover:text-primary/80\"\n                >\n                  <ExternalLink className=\"h-4 w-4\" />\n                </a>\n              </TableCell>\n            </TableRow>\n          ))}\n        </TableBody>\n      </Table>\n    </div>\n  );\n}\n","import { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Calendar } from '@/components/ui/calendar';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { CalendarIcon } from 'lucide-react';\nimport { format } from 'date-fns';\n\ninterface DateRangePickerProps {\n  startDate: string;\n  endDate: string;\n  onChange: (start: string, end: string) => void;\n}\n\nexport function DateRangePicker({ startDate, endDate, onChange }: DateRangePickerProps) {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const handlePresetClick = (days: number) => {\n    const end = new Date();\n    const start = new Date();\n    start.setDate(start.getDate() - days);\n\n    onChange(\n      start.toISOString().split('T')[0],\n      end.toISOString().split('T')[0]\n    );\n    setIsOpen(false);\n  };\n\n  const presets = [\n    { label: 'Last 7 days', days: 7 },\n    { label: 'Last 30 days', days: 30 },\n    { label: 'Last 90 days', days: 90 },\n    { label: 'Last 6 months', days: 180 },\n    { label: 'Last year', days: 365 },\n  ];\n\n  return (\n    <div className=\"flex items-center gap-2\">\n      <Popover open={isOpen} onOpenChange={setIsOpen}>\n        <PopoverTrigger asChild>\n          <Button variant=\"outline\" className=\"gap-2\">\n            <CalendarIcon className=\"h-4 w-4\" />\n            {format(new Date(startDate), 'MMM dd, yyyy')} - {format(new Date(endDate), 'MMM dd, yyyy')}\n          </Button>\n        </PopoverTrigger>\n        <PopoverContent className=\"w-auto p-4\" align=\"start\">\n          <div className=\"space-y-4\">\n            <div>\n              <h4 className=\"font-medium mb-2\">Quick Select</h4>\n              <div className=\"grid gap-2\">\n                {presets.map((preset) => (\n                  <Button\n                    key={preset.label}\n                    variant=\"ghost\"\n                    className=\"justify-start\"\n                    onClick={() => handlePresetClick(preset.days)}\n                  >\n                    {preset.label}\n                  </Button>\n                ))}\n              </div>\n            </div>\n          </div>\n        </PopoverContent>\n      </Popover>\n    </div>\n  );\n}\n","import { Checkbox } from '@/components/ui/checkbox';\nimport { Label } from '@/components/ui/label';\nimport { Popover, PopoverContent, PopoverTrigger } from '@/components/ui/popover';\nimport { Button } from '@/components/ui/button';\nimport { Filter } from 'lucide-react';\nimport type { SearchPlatform } from '@/types/searchAnalytics';\n\ninterface PlatformFilterProps {\n  selectedPlatforms: SearchPlatform[];\n  onChange: (platforms: SearchPlatform[]) => void;\n}\n\nconst PLATFORMS: { value: SearchPlatform; label: string }[] = [\n  { value: 'google_search_console', label: 'Google Search Console' },\n  { value: 'google_analytics', label: 'Google Analytics' },\n  { value: 'bing_webmaster', label: 'Bing Webmaster' },\n  { value: 'yandex_webmaster', label: 'Yandex Webmaster' },\n];\n\nexport function PlatformFilter({ selectedPlatforms, onChange }: PlatformFilterProps) {\n  const handleToggle = (platform: SearchPlatform) => {\n    if (selectedPlatforms.includes(platform)) {\n      onChange(selectedPlatforms.filter(p => p !== platform));\n    } else {\n      onChange([...selectedPlatforms, platform]);\n    }\n  };\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button variant=\"outline\" className=\"gap-2\">\n          <Filter className=\"h-4 w-4\" />\n          Platforms ({selectedPlatforms.length})\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-64\" align=\"start\">\n        <div className=\"space-y-4\">\n          <h4 className=\"font-medium text-sm\">Filter by Platform</h4>\n          <div className=\"space-y-3\">\n            {PLATFORMS.map((platform) => (\n              <div key={platform.value} className=\"flex items-center space-x-2\">\n                <Checkbox\n                  id={platform.value}\n                  checked={selectedPlatforms.includes(platform.value)}\n                  onCheckedChange={() => handleToggle(platform.value)}\n                />\n                <Label\n                  htmlFor={platform.value}\n                  className=\"text-sm font-normal cursor-pointer\"\n                >\n                  {platform.label}\n                </Label>\n              </div>\n            ))}\n          </div>\n        </div>\n      </PopoverContent>\n    </Popover>\n  );\n}\n","import { useState } from 'react';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Button } from '@/components/ui/button';\nimport { RefreshCw, Download, Settings as SettingsIcon, FileText } from 'lucide-react';\nimport { PlatformConnections } from './searchAnalytics/PlatformConnections';\nimport { MetricsOverview } from './searchAnalytics/MetricsOverview';\nimport { AnalyticsCharts } from './searchAnalytics/AnalyticsCharts';\nimport { TopQueriesTable } from './searchAnalytics/TopQueriesTable';\nimport { TopPagesTable } from './searchAnalytics/TopPagesTable';\nimport { DateRangePicker } from './searchAnalytics/DateRangePicker';\nimport { PlatformFilter } from './searchAnalytics/PlatformFilter';\nimport { useAggregateAnalytics, useTopQueries } from '@/hooks/useSearchAnalytics';\nimport { useToast } from '@/hooks/use-toast';\nimport { exportToCSV, exportToPDF, formatAnalyticsForExport } from '@/lib/exportUtils';\nimport type { SearchPlatform } from '@/types/searchAnalytics';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '@/components/ui/dropdown-menu';\n\nexport function SearchAnalyticsDashboard() {\n  const { toast } = useToast();\n  const [dateRange, setDateRange] = useState({\n    start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\n    end: new Date().toISOString().split('T')[0],\n  });\n  const [selectedPlatforms, setSelectedPlatforms] = useState<SearchPlatform[]>([\n    'google_search_console',\n    'google_analytics',\n  ]);\n\n  const aggregateMutation = useAggregateAnalytics();\n\n  // Fetch real query data for exports\n  const topQueries = useTopQueries({\n    startDate: dateRange.start,\n    endDate: dateRange.end,\n    platforms: selectedPlatforms,\n    limit: 100,\n  });\n\n  const handleRefreshData = async () => {\n    try {\n      await aggregateMutation.mutateAsync({\n        start_date: dateRange.start,\n        end_date: dateRange.end,\n        force_refresh: true,\n      });\n    } catch (error) {\n      console.error('Failed to refresh data:', error);\n    }\n  };\n\n  const handleExportCSV = () => {\n    // Use real query data from the hook\n    if (!topQueries || topQueries.length === 0) {\n      toast({\n        title: 'No Data to Export',\n        description: 'Connect a platform and sync data before exporting.',\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    const dateRangeText = `${dateRange.start} to ${dateRange.end}`;\n    const exportData = formatAnalyticsForExport(topQueries, 'Search Analytics Report', dateRangeText);\n\n    exportToCSV(exportData);\n\n    toast({\n      title: 'Exported to CSV',\n      description: `Exported ${topQueries.length} queries to CSV.`,\n    });\n  };\n\n  const handleExportPDF = () => {\n    // Use real query data from the hook\n    if (!topQueries || topQueries.length === 0) {\n      toast({\n        title: 'No Data to Export',\n        description: 'Connect a platform and sync data before exporting.',\n        variant: 'destructive',\n      });\n      return;\n    }\n\n    const dateRangeText = `${dateRange.start} to ${dateRange.end}`;\n    const exportData = formatAnalyticsForExport(topQueries, 'Search Analytics Report', dateRangeText);\n\n    exportToPDF(exportData);\n\n    toast({\n      title: 'Opening PDF',\n      description: `Preparing PDF report with ${topQueries.length} queries.`,\n    });\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Quick Actions */}\n      <div className=\"flex items-center justify-end gap-2 flex-wrap\">\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={handleRefreshData}\n          disabled={aggregateMutation.isPending}\n        >\n          <RefreshCw className={`h-4 w-4 mr-2 ${aggregateMutation.isPending ? 'animate-spin' : ''}`} />\n          Refresh Data\n        </Button>\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"outline\" size=\"sm\">\n              <Download className=\"h-4 w-4 mr-2\" />\n              Export\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\">\n            <DropdownMenuItem onClick={handleExportCSV}>\n              <FileText className=\"h-4 w-4 mr-2\" />\n              Export to CSV\n            </DropdownMenuItem>\n            <DropdownMenuItem onClick={handleExportPDF}>\n              <FileText className=\"h-4 w-4 mr-2\" />\n              Export to PDF\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n        <Button variant=\"outline\" size=\"sm\">\n          <SettingsIcon className=\"h-4 w-4 mr-2\" />\n          Settings\n        </Button>\n      </div>\n\n      {/* Platform Connections */}\n      <PlatformConnections />\n\n      {/* Filters */}\n      <Card>\n        <CardHeader>\n          <CardTitle>Filters</CardTitle>\n          <CardDescription>Customize your analytics view</CardDescription>\n        </CardHeader>\n        <CardContent className=\"flex flex-wrap gap-4\">\n          <DateRangePicker\n            startDate={dateRange.start}\n            endDate={dateRange.end}\n            onChange={(start, end) => setDateRange({ start, end })}\n          />\n          <PlatformFilter\n            selectedPlatforms={selectedPlatforms}\n            onChange={setSelectedPlatforms}\n          />\n        </CardContent>\n      </Card>\n\n      {/* Main Content Tabs */}\n      <Tabs defaultValue=\"overview\" className=\"space-y-4\">\n        <TabsList>\n          <TabsTrigger value=\"overview\">Overview</TabsTrigger>\n          <TabsTrigger value=\"queries\">Top Queries</TabsTrigger>\n          <TabsTrigger value=\"pages\">Top Pages</TabsTrigger>\n          <TabsTrigger value=\"devices\">Devices</TabsTrigger>\n          <TabsTrigger value=\"countries\">Countries</TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"overview\" className=\"space-y-4\">\n          {/* Metrics Overview */}\n          <MetricsOverview\n            startDate={dateRange.start}\n            endDate={dateRange.end}\n            platforms={selectedPlatforms}\n          />\n\n          {/* Charts */}\n          <AnalyticsCharts\n            startDate={dateRange.start}\n            endDate={dateRange.end}\n            platforms={selectedPlatforms}\n          />\n\n          {/* Quick Stats Grid */}\n          <div className=\"grid gap-4 md:grid-cols-2\">\n            <Card>\n              <CardHeader>\n                <CardTitle>Top 10 Queries</CardTitle>\n                <CardDescription>Highest performing search queries</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <TopQueriesTable\n                  startDate={dateRange.start}\n                  endDate={dateRange.end}\n                  platforms={selectedPlatforms}\n                  limit={10}\n                />\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader>\n                <CardTitle>Top 10 Pages</CardTitle>\n                <CardDescription>Highest performing pages</CardDescription>\n              </CardHeader>\n              <CardContent>\n                <TopPagesTable\n                  startDate={dateRange.start}\n                  endDate={dateRange.end}\n                  platforms={selectedPlatforms}\n                  limit={10}\n                />\n              </CardContent>\n            </Card>\n          </div>\n        </TabsContent>\n\n        <TabsContent value=\"queries\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>All Search Queries</CardTitle>\n              <CardDescription>Complete list of search queries with performance metrics</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <TopQueriesTable\n                startDate={dateRange.start}\n                endDate={dateRange.end}\n                platforms={selectedPlatforms}\n                limit={100}\n              />\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"pages\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>All Pages</CardTitle>\n              <CardDescription>Complete list of pages with traffic metrics</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <TopPagesTable\n                startDate={dateRange.start}\n                endDate={dateRange.end}\n                platforms={selectedPlatforms}\n                limit={100}\n              />\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"devices\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Device Breakdown</CardTitle>\n              <CardDescription>Performance metrics by device type</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-muted-foreground\">Device analytics coming soon...</p>\n            </CardContent>\n          </Card>\n        </TabsContent>\n\n        <TabsContent value=\"countries\" className=\"space-y-4\">\n          <Card>\n            <CardHeader>\n              <CardTitle>Geographic Distribution</CardTitle>\n              <CardDescription>Performance metrics by country</CardDescription>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-muted-foreground\">Geographic analytics coming soon...</p>\n            </CardContent>\n          </Card>\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n"],"names":["useConnectedPlatforms","useQuery","user","supabase","data","error","useOAuthInit","toast","useToast","useMutation","platform","redirectUris","oauthUrls","params","oauthUrl","useSyncPlatform","queryClient","useQueryClient","property_id","site_id","start_date","end_date","session","functionName","useAggregateAnalytics","force_refresh","useUnifiedAnalytics","filters","query","useAggregatedMetrics","analyticsData","sum","row","useTimeSeriesData","grouped","acc","date","item","useTopQueries","a","b","useTopPages","url","PLATFORM_INFO","PlatformConnections","platforms","isLoading","oauthInit","syncMutation","handleConnect","handleSync","Card","jsxs","CardHeader","jsx","CardTitle","CardDescription","CardContent","info","isConnected","isActive","isExpired","Badge","CheckCircle2","Clock","XCircle","Button","ExternalLink","MetricsOverview","startDate","endDate","metrics","i","formatNumber","num","formatPercent","formatChange","change","Minus","isPositive","TrendingUp","TrendingDown","metricsData","MousePointer","Eye","Target","BarChart3","Users","FileText","metric","changeData","Icon","ChangeIcon","AnalyticsCharts","timeSeriesData","Tabs","TabsList","TabsTrigger","TabsContent","ResponsiveContainer","AreaChart","CartesianGrid","XAxis","value","YAxis","Tooltip","Legend","Area","LineChart","name","Line","TopQueriesTable","limit","topQueries","getTrendIcon","Table","TableHeader","TableRow","TableHead","TableBody","index","TableCell","TopPagesTable","topPages","truncateUrl","maxLength","page","DateRangePicker","onChange","isOpen","setIsOpen","useState","handlePresetClick","days","end","start","presets","Popover","PopoverTrigger","CalendarIcon","format","PopoverContent","preset","PLATFORMS","PlatformFilter","selectedPlatforms","handleToggle","p","Filter","Checkbox","Label","SearchAnalyticsDashboard","dateRange","setDateRange","setSelectedPlatforms","aggregateMutation","handleRefreshData","handleExportCSV","dateRangeText","exportData","formatAnalyticsForExport","exportToCSV","handleExportPDF","exportToPDF","RefreshCw","DropdownMenu","DropdownMenuTrigger","Download","DropdownMenuContent","DropdownMenuItem","SettingsIcon"],"mappings":"4sCAqBO,SAASA,IAAwB,CACtC,OAAOC,EAAS,CACd,SAAU,CAAC,qBAAqB,EAChC,QAAS,SAAY,CACnB,KAAM,CAAE,KAAM,CAAE,KAAAC,CAAA,GAAW,MAAMC,EAAS,KAAK,QAAA,EAC/C,GAAI,CAACD,EAAM,MAAM,IAAI,MAAM,mBAAmB,EAE9C,KAAM,CAAE,KAAAE,EAAM,MAAAC,CAAA,EAAU,MAAMF,EAAS,IAAI,iCAAkC,CAC3E,UAAWD,EAAK,EAAA,CACjB,EAED,GAAIG,EAAO,MAAMA,EACjB,OAAOD,CACT,CAAA,CACD,CACH,CAGO,SAASE,IAAe,CAC7B,KAAM,CAAE,MAAAC,CAAA,EAAUC,EAAA,EAElB,OAAOC,EAAY,CACjB,WAAY,MAAOC,GAA6B,CAE9C,MAAMC,EAA+C,CACnD,iBAAkB,GAAG,OAAO,SAAS,MAAM,0DAC3C,sBAAuB,GAAG,OAAO,SAAS,MAAM,+DAChD,eAAgB,GAAG,OAAO,SAAS,MAAM,wDACzC,iBAAkB,GAAG,OAAO,SAAS,MAAM,yDAAA,EAIvCC,EAA4C,CAChD,iBAAkB,+CAClB,sBAAuB,+CACvB,eAAgB,iEAChB,iBAAkB,mCAAA,EAIdC,EAAS,IAAI,gBAAgB,CACjC,WAAWH,EAAS,SAAS,QAAQ,EACQ,IAI7C,aAAcC,EAAaD,CAAQ,EACnC,cAAe,OACf,MAAOA,IAAa,mBAChB,qDACAA,IAAa,wBACb,sDACAA,IAAa,iBACb,+DACA,iBACJ,YAAa,UACb,OAAQ,SAAA,CACT,EAEKI,EAAW,GAAGF,EAAUF,CAAQ,CAAC,IAAIG,EAAO,UAAU,GAG5D,OAAO,SAAS,KAAOC,CACzB,EACA,QAAUT,GAAiB,CACzBE,EAAM,CACJ,MAAO,cACP,YAAaF,EAAM,QACnB,QAAS,aAAA,CACV,CACH,CAAA,CACD,CACH,CAiDO,SAASU,IAAkB,CAChC,KAAM,CAAE,MAAAR,CAAA,EAAUC,EAAA,EACZQ,EAAcC,EAAA,EAEpB,OAAOR,EAAY,CACjB,WAAY,MAAO,CAAE,SAAAC,EAAU,YAAAQ,EAAa,QAAAC,EAAS,WAAAC,EAAY,SAAAC,KAA4B,CAC3F,KAAM,CAAE,KAAM,CAAE,QAAAC,CAAA,GAAc,MAAMnB,EAAS,KAAK,WAAA,EAClD,GAAI,CAACmB,EAAS,MAAM,IAAI,MAAM,mBAAmB,EAEjD,MAAMC,EAAeb,IAAa,mBAC9B,wBACAA,IAAa,wBACb,6BACAA,IAAa,iBACb,sBACA,wBAEE,CAAE,KAAAN,EAAM,MAAAC,CAAA,EAAU,MAAM,cAAc,OAAOkB,EAAc,CAC/D,KAAM,CAAE,YAAAL,EAAa,QAAAC,EAAS,WAAAC,EAAY,SAAAC,CAAA,EAC1C,QAAS,CACP,cAAe,UAAUC,EAAQ,YAAY,EAAA,CAC/C,CACD,EAED,GAAIjB,EAAO,MAAMA,EACjB,OAAOD,CACT,EACA,UAAW,IAAM,CACfG,EAAM,CACJ,MAAO,eACP,YAAa,2CAAA,CACd,EACDS,EAAY,kBAAkB,CAAE,SAAU,CAAC,kBAAkB,EAAG,CAClE,EACA,QAAUX,GAAiB,CACzBE,EAAM,CACJ,MAAO,cACP,YAAaF,EAAM,QACnB,QAAS,aAAA,CACV,CACH,CAAA,CACD,CACH,CAGO,SAASmB,IAAwB,CACtC,KAAM,CAAE,MAAAjB,CAAA,EAAUC,EAAA,EACZQ,EAAcC,EAAA,EAEpB,OAAOR,EAAY,CACjB,WAAY,MAAO,CAAE,WAAAW,EAAY,SAAAC,EAAU,cAAAI,KAAsC,CAC/E,KAAM,CAAE,KAAM,CAAE,QAAAH,CAAA,GAAc,MAAMnB,EAAS,KAAK,WAAA,EAClD,GAAI,CAACmB,EAAS,MAAM,IAAI,MAAM,mBAAmB,EAEjD,KAAM,CAAE,KAAAlB,EAAM,MAAAC,CAAA,EAAU,MAAM,cAAc,OAAO,6BAA8B,CAC/E,KAAM,CAAE,WAAAe,EAAY,SAAAC,EAAU,cAAAI,CAAA,EAC9B,QAAS,CACP,cAAe,UAAUH,EAAQ,YAAY,EAAA,CAC/C,CACD,EAED,GAAIjB,EAAO,MAAMA,EACjB,OAAOD,CACT,EACA,UAAW,IAAM,CACfG,EAAM,CACJ,MAAO,uBACP,YAAa,wCAAA,CACd,EACDS,EAAY,kBAAkB,CAAE,SAAU,CAAC,mBAAmB,EAAG,CACnE,EACA,QAAUX,GAAiB,CACzBE,EAAM,CACJ,MAAO,qBACP,YAAaF,EAAM,QACnB,QAAS,aAAA,CACV,CACH,CAAA,CACD,CACH,CA+DO,SAASqB,EAAoBC,EAIjC,CACD,OAAO1B,EAAS,CACd,SAAU,CAAC,oBAAqB0B,CAAO,EACvC,QAAS,SAAY,CACnB,KAAM,CAAE,KAAM,CAAE,KAAAzB,CAAA,GAAW,MAAMC,EAAS,KAAK,QAAA,EAC/C,GAAI,CAACD,EAAM,MAAM,IAAI,MAAM,mBAAmB,EAE9C,IAAI0B,EAAQzB,EACT,KAAK,0BAA0B,EAC/B,OAAO,GAAG,EACV,GAAG,UAAWD,EAAK,EAAE,EACrB,IAAI,OAAQyB,EAAQ,SAAS,EAC7B,IAAI,OAAQA,EAAQ,OAAO,EAE1BA,EAAQ,WAAaA,EAAQ,UAAU,OAAS,IAClDC,EAAQA,EAAM,GAAG,kBAAmBD,EAAQ,SAAS,GAGvD,KAAM,CAAE,KAAAvB,EAAM,MAAAC,CAAA,EAAU,MAAMuB,EAAM,MAAM,OAAQ,CAAE,UAAW,GAAO,EAEtE,GAAIvB,EAAO,MAAMA,EACjB,OAAOD,CACT,CAAA,CACD,CACH,CAGO,SAASyB,GAAqBF,EAIlC,CACD,KAAM,CAAE,KAAMG,GAAkBJ,EAAoBC,CAAO,EAE3D,OAAKG,EAE8B,CACjC,aAAcA,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,QAAU,GAAI,CAAC,EAC3E,kBAAmBF,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,aAAe,GAAI,CAAC,EACrF,eAAgBF,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,UAAY,GAAI,CAAC,EAC/E,YAAaF,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,OAAS,GAAI,CAAC,EACzE,gBAAiBF,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,WAAa,GAAI,CAAC,EACjF,YAAaF,EAAc,OAAS,EAChCA,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,KAAO,GAAI,CAAC,EAAIF,EAAc,OAC5E,EACJ,iBAAkBA,EAAc,OAAS,EACrCA,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,kBAAoB,GAAI,CAAC,EAAIF,EAAc,OACzF,EACJ,oBAAqBA,EAAc,OAAS,EACxCA,EAAc,OAAO,CAACC,EAAKC,IAAQD,GAAOC,EAAI,aAAe,GAAI,CAAC,EAAIF,EAAc,OACpF,EACJ,cAAe,EACf,mBAAoB,EACpB,gBAAiB,CAAA,EAnBQ,IAuB7B,CAGO,SAASG,GAAkBN,EAID,CAC/B,KAAM,CAAE,KAAMG,GAAkBJ,EAAoBC,CAAO,EAE3D,GAAI,CAACG,EAAe,OAAO,KAG3B,MAAMI,EAAUJ,EAAc,OAAO,CAACK,EAAKH,IAAQ,CACjD,MAAMI,EAAOJ,EAAI,KACjB,OAAKG,EAAIC,CAAI,IACXD,EAAIC,CAAI,EAAI,CACV,KAAAA,EACA,OAAQ,EACR,YAAa,EACb,SAAU,EACV,MAAO,EACP,IAAK,EACL,SAAU,EACV,MAAO,CAAA,GAIXD,EAAIC,CAAI,EAAE,QAAUJ,EAAI,QAAU,EAClCG,EAAIC,CAAI,EAAE,aAAeJ,EAAI,aAAe,EAC5CG,EAAIC,CAAI,EAAE,UAAYJ,EAAI,UAAY,EACtCG,EAAIC,CAAI,EAAE,OAASJ,EAAI,OAAS,EAChCG,EAAIC,CAAI,EAAE,KAAOJ,EAAI,KAAO,EAC5BG,EAAIC,CAAI,EAAE,UAAYJ,EAAI,kBAAoB,EAC9CG,EAAIC,CAAI,EAAE,OAAS,EAEZD,CACT,EAAG,CAAA,CAAyB,EAG5B,OAAO,OAAO,OAAOD,CAAO,EAAE,IAAIG,IAAS,CACzC,KAAMA,EAAK,KACX,OAAQA,EAAK,OACb,YAAaA,EAAK,YAClB,SAAUA,EAAK,SACf,MAAOA,EAAK,MACZ,IAAKA,EAAK,MAAQ,EAAIA,EAAK,IAAMA,EAAK,MAAQ,EAC9C,SAAUA,EAAK,MAAQ,EAAIA,EAAK,SAAWA,EAAK,MAAQ,CAAA,EACxD,CACJ,CAGO,SAASC,GAAcX,EAKR,CACpB,KAAM,CAAE,KAAMG,GAAkBJ,EAAoBC,CAAO,EAE3D,GAAI,CAACG,EAAe,OAAO,KAM3B,MAAMI,EAHcJ,EAAc,OAAOE,GAAOA,EAAI,KAAK,EAG7B,OAAO,CAACG,EAAKH,IAAQ,CAC/C,MAAMJ,EAAQI,EAAI,MAClB,OAAKG,EAAIP,CAAK,IACZO,EAAIP,CAAK,EAAI,CACX,MAAAA,EACA,OAAQ,EACR,YAAa,EACb,IAAK,EACL,SAAU,EACV,MAAO,EACP,OAAQ,CAAA,GAIZO,EAAIP,CAAK,EAAE,QAAUI,EAAI,QAAU,EACnCG,EAAIP,CAAK,EAAE,aAAeI,EAAI,aAAe,EAC7CG,EAAIP,CAAK,EAAE,KAAOI,EAAI,KAAO,EAC7BG,EAAIP,CAAK,EAAE,UAAYI,EAAI,kBAAoB,EAC/CG,EAAIP,CAAK,EAAE,OAAS,EAEbO,CACT,EAAG,CAAA,CAAyB,EAe5B,OAZmB,OAAO,OAAOD,CAAO,EACrC,IAAIG,IAAS,CACZ,MAAOA,EAAK,MACZ,OAAQA,EAAK,OACb,YAAaA,EAAK,YAClB,IAAKA,EAAK,MAAQ,EAAIA,EAAK,IAAMA,EAAK,MAAQ,EAC9C,SAAUA,EAAK,MAAQ,EAAIA,EAAK,SAAWA,EAAK,MAAQ,EACxD,OAAQ,CAAA,EACR,EACD,KAAK,CAACE,EAAGC,IAAMA,EAAE,OAASD,EAAE,MAAM,EAClC,MAAM,EAAGZ,EAAQ,OAAS,EAAE,CAGjC,CAGO,SAASc,GAAYd,EAKP,CACnB,KAAM,CAAE,KAAMG,GAAkBJ,EAAoBC,CAAO,EAE3D,GAAI,CAACG,EAAe,OAAO,KAM3B,MAAMI,EAHYJ,EAAc,OAAOE,GAAOA,EAAI,QAAQ,EAGhC,OAAO,CAACG,EAAKH,IAAQ,CAC7C,MAAMU,EAAMV,EAAI,SAChB,OAAKG,EAAIO,CAAG,IACVP,EAAIO,CAAG,EAAI,CACT,IAAAA,EACA,MAAOV,EAAI,WACX,OAAQ,EACR,YAAa,EACb,SAAU,EACV,IAAK,EACL,SAAU,EACV,MAAO,EACP,OAAQ,CAAA,GAIZG,EAAIO,CAAG,EAAE,QAAUV,EAAI,QAAU,EACjCG,EAAIO,CAAG,EAAE,aAAeV,EAAI,aAAe,EAC3CG,EAAIO,CAAG,EAAE,UAAYV,EAAI,UAAY,EACrCG,EAAIO,CAAG,EAAE,KAAOV,EAAI,KAAO,EAC3BG,EAAIO,CAAG,EAAE,UAAYV,EAAI,kBAAoB,EAC7CG,EAAIO,CAAG,EAAE,OAAS,EAEXP,CACT,EAAG,CAAA,CAAyB,EAiB5B,OAdiB,OAAO,OAAOD,CAAO,EACnC,IAAIG,IAAS,CACZ,IAAKA,EAAK,IACV,MAAOA,EAAK,MACZ,OAAQA,EAAK,OACb,YAAaA,EAAK,YAClB,SAAUA,EAAK,SACf,IAAKA,EAAK,MAAQ,EAAIA,EAAK,IAAMA,EAAK,MAAQ,EAC9C,SAAUA,EAAK,MAAQ,EAAIA,EAAK,SAAWA,EAAK,MAAQ,EACxD,OAAQ,CAAA,EACR,EACD,KAAK,CAACE,EAAGC,IAAMA,EAAE,OAASD,EAAE,MAAM,EAClC,MAAM,EAAGZ,EAAQ,OAAS,EAAE,CAGjC,CCpfA,MAAMgB,GAA6F,CACjG,sBAAuB,CACrB,KAAM,wBACN,YAAa,uCACb,KAAM,IAAA,EAER,iBAAkB,CAChB,KAAM,qBACN,YAAa,oCACb,KAAM,IAAA,EAER,eAAgB,CACd,KAAM,uBACN,YAAa,+BACb,KAAM,KAAA,EAER,iBAAkB,CAChB,KAAM,mBACN,YAAa,iCACb,KAAM,MAAA,CAEV,EAEO,SAASC,IAAsB,CACpC,KAAM,CAAE,KAAMC,EAAW,UAAAC,CAAA,EAAc9C,GAAA,EACjC+C,EAAYzC,GAAA,EACZ0C,EAAejC,GAAA,EAEfkC,EAAiBvC,GAA6B,CAClDqC,EAAU,OAAOrC,CAAQ,CAC3B,EAEMwC,EAAcxC,GAA6B,CAC/CsC,EAAa,OAAO,CAAE,SAAAtC,EAAU,CAClC,EAEA,OAAIoC,SAECK,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,sBAAA,CAAoB,EAC/BD,EAAAA,IAACE,GAAgB,SAAA,8BAAA,CAA4B,CAAA,EAC/C,EACAF,EAAAA,IAACG,EAAA,CACC,SAAAH,EAAAA,IAAC,MAAA,CAAI,UAAU,2BACb,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,6DAAA,CAA8D,CAAA,CAC/E,CAAA,CACF,CAAA,EACF,SAKDH,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,sBAAA,CAAoB,EAC/BD,EAAAA,IAACE,GAAgB,SAAA,6CAAA,CAA2C,CAAA,EAC9D,EACAF,EAAAA,IAACG,GACC,SAAAH,EAAAA,IAAC,MAAA,CAAI,UAAU,2CACZ,SAAAT,GAAW,IAAKnC,GAAa,CAC5B,MAAMgD,EAAOf,GAAcjC,EAAS,QAAQ,EACtCiD,EAAcjD,EAAS,aACvBkD,EAAWlD,EAAS,oBAAsB,SAC1CmD,EAAYnD,EAAS,oBAAsB,UAEjD,OACE0C,EAAAA,KAACD,EAAA,CAA6B,UAAU,WACtC,SAAA,CAAAC,EAAAA,KAACC,EAAA,CAAW,UAAU,OACpB,SAAA,CAAAD,EAAAA,KAAC,MAAA,CAAI,UAAU,mCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAE,EAAAA,IAAC,OAAA,CAAK,UAAU,WAAY,SAAAI,EAAK,KAAK,EACtCJ,EAAAA,IAAC,OACC,SAAAA,EAAAA,IAACC,EAAA,CAAU,UAAU,UAAW,SAAAG,EAAK,KAAK,CAAA,CAC5C,CAAA,EACF,EACCE,GACCR,EAAAA,KAACU,EAAA,CAAM,QAAQ,UAAU,UAAU,UACjC,SAAA,CAAAR,EAAAA,IAACS,GAAA,CAAa,UAAU,cAAA,CAAe,EAAE,WAAA,EAE3C,EAEDF,GACCT,EAAAA,KAACU,EAAA,CAAM,QAAQ,cAAc,UAAU,UACrC,SAAA,CAAAR,EAAAA,IAACU,GAAA,CAAM,UAAU,cAAA,CAAe,EAAE,SAAA,EAEpC,EAED,CAACL,GACAP,EAAAA,KAACU,GAAM,QAAQ,YAAY,UAAU,UACnC,SAAA,CAAAR,EAAAA,IAACW,GAAA,CAAQ,UAAU,cAAA,CAAe,EAAE,eAAA,CAAA,CAEtC,CAAA,EAEJ,EACAX,EAAAA,IAACE,EAAA,CAAgB,UAAU,eACxB,WAAK,WAAA,CACR,CAAA,EACF,EACAJ,EAAAA,KAACK,EAAA,CAAY,UAAU,OACpB,SAAA,CAAA/C,EAAS,WACR0C,OAAC,IAAA,CAAE,UAAU,qCAAqC,SAAA,CAAA,cACpC,IAAI,KAAK1C,EAAS,SAAS,EAAE,mBAAA,CAAmB,EAC9D,QAED,MAAA,CAAI,UAAU,sBACZ,SAAA,CAACiD,GAAeE,EACfT,EAAAA,KAACc,EAAA,CACC,KAAK,KACL,QAAS,IAAMjB,EAAcvC,EAAS,QAAQ,EAC9C,SAAUqC,EAAU,UACpB,UAAU,SAEV,SAAA,CAAAO,EAAAA,IAACa,EAAA,CAAa,UAAU,cAAA,CAAe,EACtCN,EAAY,YAAc,SAAA,CAAA,CAAA,EAG7BP,EAAAA,IAACY,EAAA,CACC,KAAK,KACL,QAAQ,UACR,QAAS,IAAMhB,EAAWxC,EAAS,QAAQ,EAC3C,SAAUsC,EAAa,UACvB,UAAU,SACX,SAAA,WAAA,CAAA,CAED,CAEJ,CAAA,CAAA,CACF,CAAA,CAAA,EA7DStC,EAAS,QA8DpB,CAEJ,CAAC,EACH,CAAA,CACF,CAAA,EACF,CAEJ,CCpIO,SAAS0D,GAAgB,CAAE,UAAAC,EAAW,QAAAC,EAAS,UAAAzB,GAAmC,CACvF,MAAM0B,EAAU1C,GAAqB,CAAE,UAAAwC,EAAW,QAAAC,EAAS,UAAAzB,EAAW,EAEtE,GAAI,CAAC0B,EACH,OACEjB,EAAAA,IAAC,MAAA,CAAI,UAAU,2CACZ,UAAC,EAAG,EAAG,EAAG,CAAC,EAAE,IAAKkB,UAChBrB,EAAA,CACC,SAAA,CAAAG,EAAAA,IAACD,EAAA,CAAW,UAAU,4DACpB,SAAAC,EAAAA,IAACC,GAAU,UAAU,sBAAsB,sBAAU,CAAA,CACvD,QACCE,EAAA,CACC,SAAAH,EAAAA,IAAC,MAAA,CAAI,UAAU,qCAAqC,CAAA,CACtD,CAAA,GANSkB,CAOX,CACD,EACH,EAIJ,MAAMC,EAAgBC,GACb,IAAI,KAAK,aAAa,QAAS,CAAE,SAAU,UAAW,sBAAuB,CAAA,CAAG,EAAE,OAAOA,CAAG,EAG/FC,EAAiBD,GACd,IAAIA,EAAM,KAAK,QAAQ,CAAC,CAAC,IAG5BE,EAAgBC,GAAmB,CACvC,GAAIA,IAAW,EAAG,MAAO,CAAE,KAAMC,EAAO,MAAO,wBAAyB,KAAM,IAAA,EAC9E,MAAMC,EAAaF,EAAS,EAC5B,MAAO,CACL,KAAME,EAAaC,EAAaC,EAChC,MAAOF,EAAa,iBAAmB,eACvC,KAAM,GAAGA,EAAa,IAAM,EAAE,GAAGJ,EAAcE,EAAS,GAAG,CAAC,EAAA,CAEhE,EAEMK,EAAc,CAClB,CACE,MAAO,eACP,MAAOX,EAAQ,aACf,OAAQA,EAAQ,cAChB,KAAMY,GACN,YAAa,2BAAA,EAEf,CACE,MAAO,oBACP,MAAOZ,EAAQ,kBACf,OAAQA,EAAQ,mBAChB,KAAMa,GACN,YAAa,0BAAA,EAEf,CACE,MAAO,WACP,MAAOb,EAAQ,YACf,OAAQ,EACR,KAAMc,GACN,YAAa,qBACb,aAAc,EAAA,EAEhB,CACE,MAAO,gBACP,MAAOd,EAAQ,iBACf,OAAQ,EACR,KAAMe,GACN,YAAa,0BACb,SAAU,CAAA,EAEZ,CACE,MAAO,iBACP,MAAOf,EAAQ,eACf,OAAQA,EAAQ,gBAChB,KAAMgB,EACN,YAAa,kBAAA,EAEf,CACE,MAAO,cACP,MAAOhB,EAAQ,YACf,OAAQ,EACR,KAAMgB,EACN,YAAa,iBAAA,EAEf,CACE,MAAO,kBACP,MAAOhB,EAAQ,gBACf,OAAQ,EACR,KAAMiB,EACN,YAAa,cAAA,EAEf,CACE,MAAO,cACP,MAAOjB,EAAQ,oBACf,OAAQ,EACR,KAAMU,EACN,YAAa,4BACb,aAAc,EAAA,CAChB,EAGF,aACG,MAAA,CAAI,UAAU,2CACZ,SAAAC,EAAY,IAAKO,GAAW,CAC3B,MAAMC,EAAad,EAAaa,EAAO,MAAM,EACvCE,EAAOF,EAAO,KACdG,EAAaF,EAAW,KAE9B,cACGvC,EAAA,CACC,SAAA,CAAAC,EAAAA,KAACC,EAAA,CAAW,UAAU,4DACpB,SAAA,CAAAC,EAAAA,IAACC,EAAA,CAAU,UAAU,sBAAuB,SAAAkC,EAAO,MAAM,EACzDnC,EAAAA,IAACqC,EAAA,CAAK,UAAU,+BAAA,CAAgC,CAAA,EAClD,SACClC,EAAA,CACC,SAAA,CAAAH,EAAAA,IAAC,MAAA,CAAI,UAAU,qBACZ,SAAAmC,EAAO,aACJd,EAAcc,EAAO,KAAK,EAC1BA,EAAO,SACPA,EAAO,MAAM,QAAQA,EAAO,QAAQ,EACpChB,EAAagB,EAAO,KAAK,EAC/B,EACArC,EAAAA,KAAC,MAAA,CAAI,UAAU,wDACb,SAAA,CAAAE,MAACsC,EAAA,CAAW,UAAW,WAAWF,EAAW,KAAK,GAAI,QACrD,OAAA,CAAK,UAAWA,EAAW,MAAQ,WAAW,KAAK,EACpDpC,EAAAA,IAAC,QAAK,SAAA,qBAAA,CAAmB,CAAA,EAC3B,EACAA,EAAAA,IAAC,IAAA,CAAE,UAAU,qCAAsC,WAAO,WAAA,CAAY,CAAA,CAAA,CACxE,CAAA,CAAA,EAnBSmC,EAAO,KAoBlB,CAEJ,CAAC,CAAA,CACH,CAEJ,CCpIO,SAASI,GAAgB,CAAE,UAAAxB,EAAW,QAAAC,EAAS,UAAAzB,GAAmC,CACvF,MAAMiD,EAAiB7D,GAAkB,CAAE,UAAAoC,EAAW,QAAAC,EAAS,UAAAzB,EAAW,EAE1E,MAAI,CAACiD,GAAkBA,EAAe,SAAW,SAE5C3C,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,oBAAA,CAAkB,EAC7BD,EAAAA,IAACE,GAAgB,SAAA,2CAAA,CAAyC,CAAA,EAC5D,EACAF,EAAAA,IAACG,EAAA,CACC,SAAAH,EAAAA,IAAC,MAAA,CAAI,UAAU,wEACb,SAAAA,EAAAA,IAAC,IAAA,CAAE,SAAA,gEAAA,CAA8D,CAAA,CACnE,CAAA,CACF,CAAA,EACF,SAKDH,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,oBAAA,CAAkB,EAC7BD,EAAAA,IAACE,GAAgB,SAAA,iDAAA,CAA+C,CAAA,EAClE,QACCC,EAAA,CACC,SAAAL,OAAC2C,GAAK,aAAa,UAAU,UAAU,YACrC,SAAA,CAAA3C,OAAC4C,EAAA,CACC,SAAA,CAAA1C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,UAAU,SAAA,UAAO,EACpC3C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,SAAS,SAAA,qBAAkB,EAC9C3C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,aAAa,SAAA,YAAA,CAAU,CAAA,EAC5C,EAEA3C,MAAC4C,EAAA,CAAY,MAAM,UAAU,UAAU,YACrC,SAAA5C,EAAAA,IAAC6C,EAAA,CAAoB,MAAM,OAAO,OAAQ,IACxC,SAAA/C,EAAAA,KAACgD,GAAA,CAAU,KAAMN,EACf,SAAA,CAAAxC,EAAAA,IAAC+C,EAAA,CAAc,gBAAgB,KAAA,CAAM,EACrC/C,EAAAA,IAACgD,EAAA,CACC,QAAQ,OACR,cAAgBC,GAAU,IAAI,KAAKA,CAAK,EAAE,mBAAmB,QAAS,CAAE,MAAO,QAAS,IAAK,UAAW,CAAA,CAAA,QAEzGC,EAAA,EAAM,EACPlD,EAAAA,IAACmD,EAAA,CACC,eAAiBF,GAAU,IAAI,KAAKA,CAAK,EAAE,mBAAA,EAC3C,UAAYA,GAAkB,CAAC,IAAI,KAAK,eAAe,OAAOA,CAAK,EAAG,EAAE,CAAA,CAAA,QAEzEG,EAAA,EAAO,EACRpD,EAAAA,IAACqD,EAAA,CACC,KAAK,WACL,QAAQ,WACR,QAAQ,IACR,OAAO,UACP,KAAK,UACL,KAAK,UAAA,CAAA,EAEPrD,EAAAA,IAACqD,EAAA,CACC,KAAK,WACL,QAAQ,QACR,QAAQ,IACR,OAAO,UACP,KAAK,UACL,KAAK,OAAA,CAAA,EAEPrD,EAAAA,IAACqD,EAAA,CACC,KAAK,WACL,QAAQ,YACR,QAAQ,IACR,OAAO,UACP,KAAK,UACL,KAAK,WAAA,CAAA,CACP,CAAA,CACF,EACF,EACF,EAEArD,MAAC4C,EAAA,CAAY,MAAM,SAAS,UAAU,YACpC,SAAA5C,EAAAA,IAAC6C,EAAA,CAAoB,MAAM,OAAO,OAAQ,IACxC,SAAA/C,EAAAA,KAACwD,EAAA,CAAU,KAAMd,EACf,SAAA,CAAAxC,EAAAA,IAAC+C,EAAA,CAAc,gBAAgB,KAAA,CAAM,EACrC/C,EAAAA,IAACgD,EAAA,CACC,QAAQ,OACR,cAAgBC,GAAU,IAAI,KAAKA,CAAK,EAAE,mBAAmB,QAAS,CAAE,MAAO,QAAS,IAAK,UAAW,CAAA,CAAA,EAE1GjD,EAAAA,IAACkD,EAAA,CAAM,QAAQ,MAAA,CAAO,EACtBlD,EAAAA,IAACkD,EAAA,CAAM,QAAQ,QAAQ,YAAY,QAAQ,EAC3ClD,EAAAA,IAACmD,EAAA,CACC,eAAiBF,GAAU,IAAI,KAAKA,CAAK,EAAE,mBAAA,EAC3C,UAAW,CAACA,EAAeM,IACrBA,IAAS,MAAc,CAAC,IAAIN,EAAQ,KAAK,QAAQ,CAAC,CAAC,IAAKM,CAAI,EAC5DA,IAAS,eAAuB,CAACN,EAAM,QAAQ,CAAC,EAAGM,CAAI,EACpD,CAAC,IAAI,KAAK,aAAA,EAAe,OAAON,CAAK,EAAGM,CAAI,CACrD,CAAA,QAEDH,EAAA,EAAO,EACRpD,EAAAA,IAACwD,EAAA,CACC,QAAQ,OACR,KAAK,WACL,QAAQ,SACR,OAAO,UACP,KAAK,SACL,YAAa,CAAA,CAAA,EAEfxD,EAAAA,IAACwD,EAAA,CACC,QAAQ,OACR,KAAK,WACL,QAAQ,cACR,OAAO,UACP,KAAK,cACL,YAAa,CAAA,CAAA,EAEfxD,EAAAA,IAACwD,EAAA,CACC,QAAQ,QACR,KAAK,WACL,QAAQ,MACR,OAAO,UACP,KAAK,MACL,YAAa,CAAA,CAAA,CACf,CAAA,CACF,EACF,EACF,EAEA1D,EAAAA,KAAC8C,EAAA,CAAY,MAAM,aAAa,UAAU,YACxC,SAAA,CAAA5C,EAAAA,IAAC6C,EAAA,CAAoB,MAAM,OAAO,OAAQ,IACxC,SAAA/C,EAAAA,KAACwD,EAAA,CAAU,KAAMd,EACf,SAAA,CAAAxC,EAAAA,IAAC+C,EAAA,CAAc,gBAAgB,KAAA,CAAM,EACrC/C,EAAAA,IAACgD,EAAA,CACC,QAAQ,OACR,cAAgBC,GAAU,IAAI,KAAKA,CAAK,EAAE,mBAAmB,QAAS,CAAE,MAAO,QAAS,IAAK,UAAW,CAAA,CAAA,QAEzGC,EAAA,EAAM,EACPlD,EAAAA,IAACmD,EAAA,CACC,eAAiBF,GAAU,IAAI,KAAKA,CAAK,EAAE,mBAAA,EAC3C,UAAW,CAACA,EAAeM,IACrBA,IAAS,eAAuB,CAACN,EAAM,QAAQ,CAAC,EAAGM,CAAI,EACpD,CAAC,IAAI,KAAK,aAAA,EAAe,OAAON,CAAK,EAAGM,CAAI,CACrD,CAAA,QAEDH,EAAA,EAAO,EACRpD,EAAAA,IAACwD,EAAA,CACC,KAAK,WACL,QAAQ,WACR,OAAO,UACP,KAAK,eACL,YAAa,CAAA,CAAA,CACf,CAAA,CACF,CAAA,CACF,EACAxD,EAAAA,IAAC,IAAA,CAAE,UAAU,4CAA4C,SAAA,iEAAA,CAEzD,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAEJ,CC3JO,SAASyD,EAAgB,CAAE,UAAA1C,EAAW,QAAAC,EAAS,UAAAzB,EAAW,MAAAmE,EAAQ,IAA4B,CACnG,MAAMC,EAAa3E,GAAc,CAAE,UAAA+B,EAAW,QAAAC,EAAS,UAAAzB,EAAW,MAAAmE,EAAO,EAEzE,GAAI,CAACC,GAAcA,EAAW,SAAW,EACvC,OACE7D,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAE,EAAAA,IAAC,KAAE,SAAA,iDAAA,CAA+C,EAClDA,EAAAA,IAAC,IAAA,CAAE,UAAU,eAAe,SAAA,oDAAA,CAAkD,CAAA,EAChF,EAIJ,MAAMmB,EAAgBC,GACb,IAAI,KAAK,aAAa,OAAO,EAAE,OAAOA,CAAG,EAG5CC,EAAiBD,GACd,IAAIA,EAAM,KAAK,QAAQ,CAAC,CAAC,IAG5BwC,EAAgBrC,GAChBA,EAAS,EAAUvB,EAAAA,IAAC0B,EAAA,CAAW,UAAU,yBAAyB,EAClEH,EAAS,EAAUvB,EAAAA,IAAC2B,EAAA,CAAa,UAAU,uBAAuB,EAC/D3B,EAAAA,IAACwB,EAAA,CAAM,UAAU,+BAAA,CAAgC,EAG1D,OACExB,EAAAA,IAAC,MAAA,CAAI,UAAU,oBACb,gBAAC6D,GAAA,CACC,SAAA,CAAA7D,EAAAA,IAAC8D,GAAA,CACC,gBAACC,EAAA,CACC,SAAA,CAAA/D,EAAAA,IAACgE,EAAA,CAAU,UAAU,UAAU,SAAA,QAAK,EACpChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,SAAM,EACxChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,cAAW,EAC7ChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,MAAG,EACrChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,WAAQ,EAC1ChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,OAAA,CAAK,CAAA,CAAA,CACzC,CAAA,CACF,EACAhE,EAAAA,IAACiE,IACE,SAAAN,EAAW,IAAI,CAACrF,EAAO4F,WACrBH,EAAA,CACC,SAAA,CAAA/D,EAAAA,IAACmE,EAAA,CAAU,UAAU,gCAClB,SAAA7F,EAAM,MACT,QACC6F,EAAA,CAAU,UAAU,aAAc,SAAAhD,EAAa7C,EAAM,MAAM,EAAE,QAC7D6F,EAAA,CAAU,UAAU,aAAc,SAAAhD,EAAa7C,EAAM,WAAW,EAAE,EACnE0B,EAAAA,IAACmE,EAAA,CAAU,UAAU,aACnB,SAAAnE,EAAAA,IAACQ,EAAA,CAAM,QAAQ,UAAW,SAAAa,EAAc/C,EAAM,GAAG,CAAA,CAAE,EACrD,EACA0B,EAAAA,IAACmE,EAAA,CAAU,UAAU,aACnB,SAAAnE,EAAAA,IAACQ,EAAA,CAAM,QAAQ,YAAa,SAAAlC,EAAM,SAAS,QAAQ,CAAC,EAAE,EACxD,EACA0B,EAAAA,IAACmE,EAAA,CAAU,UAAU,aACnB,SAAAnE,EAAAA,IAAC,MAAA,CAAI,UAAU,mBACZ,SAAA4D,EAAatF,EAAM,MAAM,CAAA,CAC5B,CAAA,CACF,CAAA,CAAA,EAhBa,GAAGA,EAAM,KAAK,IAAI4F,CAAK,EAiBtC,CACD,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CACF,CAEJ,CChEO,SAASE,EAAc,CAAE,UAAArD,EAAW,QAAAC,EAAS,UAAAzB,EAAW,MAAAmE,EAAQ,IAA0B,CAC/F,MAAMW,EAAWlF,GAAY,CAAE,UAAA4B,EAAW,QAAAC,EAAS,UAAAzB,EAAW,MAAAmE,EAAO,EAErE,GAAI,CAACW,GAAYA,EAAS,SAAW,EACnC,OACEvE,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAE,EAAAA,IAAC,KAAE,SAAA,gDAAA,CAA8C,EACjDA,EAAAA,IAAC,IAAA,CAAE,UAAU,eAAe,SAAA,kDAAA,CAAgD,CAAA,EAC9E,EAIJ,MAAMmB,EAAgBC,GACb,IAAI,KAAK,aAAa,OAAO,EAAE,OAAOA,CAAG,EAG5CC,EAAiBD,GACd,IAAIA,EAAM,KAAK,QAAQ,CAAC,CAAC,IAG5BwC,EAAgBrC,GAChBA,EAAS,EAAUvB,EAAAA,IAAC0B,EAAA,CAAW,UAAU,yBAAyB,EAClEH,EAAS,EAAUvB,EAAAA,IAAC2B,EAAA,CAAa,UAAU,uBAAuB,EAC/D3B,EAAAA,IAACwB,EAAA,CAAM,UAAU,+BAAA,CAAgC,EAGpD8C,EAAc,CAAClF,EAAamF,EAAY,KACxCnF,EAAI,QAAUmF,EAAkBnF,EAC7BA,EAAI,UAAU,EAAGmF,CAAS,EAAI,MAGvC,OACEvE,EAAAA,IAAC,MAAA,CAAI,UAAU,oBACb,gBAAC6D,GAAA,CACC,SAAA,CAAA7D,EAAAA,IAAC8D,GAAA,CACC,gBAACC,EAAA,CACC,SAAA,CAAA/D,EAAAA,IAACgE,EAAA,CAAU,UAAU,UAAU,SAAA,OAAI,EACnChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,SAAM,EACxChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,WAAQ,EAC1ChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,cAAW,EAC7ChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,MAAG,EACrChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,WAAQ,EAC1ChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,aAAa,SAAA,QAAK,EACvChE,EAAAA,IAACgE,EAAA,CAAU,UAAU,UAAA,CAAW,CAAA,CAAA,CAClC,CAAA,CACF,EACAhE,EAAAA,IAACiE,IACE,SAAAI,EAAS,IAAI,CAACG,EAAMN,WAClBH,EAAA,CACC,SAAA,CAAA/D,EAAAA,IAACmE,GAAU,UAAU,WACnB,SAAArE,EAAAA,KAAC,MAAA,CAAI,UAAU,gBACb,SAAA,CAAAE,EAAAA,IAAC,OAAA,CAAK,UAAU,+BAA+B,MAAOwE,EAAK,IACxD,SAAAF,EAAYE,EAAK,GAAG,CAAA,CACvB,EACCA,EAAK,OACJxE,EAAAA,IAAC,OAAA,CAAK,UAAU,yCAAyC,MAAOwE,EAAK,MAClE,SAAAA,EAAK,KAAA,CACR,CAAA,CAAA,CAEJ,CAAA,CACF,QACCL,EAAA,CAAU,UAAU,aAAc,SAAAhD,EAAaqD,EAAK,MAAM,EAAE,QAC5DL,EAAA,CAAU,UAAU,aAAc,SAAAhD,EAAaqD,EAAK,QAAQ,EAAE,QAC9DL,EAAA,CAAU,UAAU,aAAc,SAAAhD,EAAaqD,EAAK,WAAW,EAAE,EAClExE,EAAAA,IAACmE,EAAA,CAAU,UAAU,aACnB,SAAAnE,EAAAA,IAACQ,EAAA,CAAM,QAAQ,UAAW,SAAAa,EAAcmD,EAAK,GAAG,CAAA,CAAE,EACpD,EACAxE,EAAAA,IAACmE,EAAA,CAAU,UAAU,aACnB,SAAAnE,EAAAA,IAACQ,EAAA,CAAM,QAAQ,YAAa,SAAAgE,EAAK,SAAS,QAAQ,CAAC,EAAE,EACvD,EACAxE,EAAAA,IAACmE,EAAA,CAAU,UAAU,aACnB,SAAAnE,EAAAA,IAAC,MAAA,CAAI,UAAU,mBACZ,SAAA4D,EAAaY,EAAK,MAAM,CAAA,CAC3B,EACF,QACCL,EAAA,CACC,SAAAnE,EAAAA,IAAC,IAAA,CACC,KAAMwE,EAAK,IACX,OAAO,SACP,IAAI,sBACJ,UAAU,qCAEV,SAAAxE,EAAAA,IAACa,EAAA,CAAa,UAAU,SAAA,CAAU,CAAA,CAAA,CACpC,CACF,CAAA,CAAA,EApCa,GAAG2D,EAAK,GAAG,IAAIN,CAAK,EAqCnC,CACD,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CACF,CAEJ,CC3FO,SAASO,GAAgB,CAAE,UAAA1D,EAAW,QAAAC,EAAS,SAAA0D,GAAkC,CACtF,KAAM,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAAS,EAAK,EAEpCC,EAAqBC,GAAiB,CAC1C,MAAMC,MAAU,KACVC,MAAY,KAClBA,EAAM,QAAQA,EAAM,QAAA,EAAYF,CAAI,EAEpCL,EACEO,EAAM,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,EAChCD,EAAI,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,CAAA,EAEhCJ,EAAU,EAAK,CACjB,EAEMM,EAAU,CACd,CAAE,MAAO,cAAe,KAAM,CAAA,EAC9B,CAAE,MAAO,eAAgB,KAAM,EAAA,EAC/B,CAAE,MAAO,eAAgB,KAAM,EAAA,EAC/B,CAAE,MAAO,gBAAiB,KAAM,GAAA,EAChC,CAAE,MAAO,YAAa,KAAM,GAAA,CAAI,EAGlC,OACElF,EAAAA,IAAC,OAAI,UAAU,0BACb,gBAACmF,GAAA,CAAQ,KAAMR,EAAQ,aAAcC,EACnC,SAAA,CAAA5E,EAAAA,IAACoF,GAAA,CAAe,QAAO,GACrB,SAAAtF,EAAAA,KAACc,GAAO,QAAQ,UAAU,UAAU,QAClC,SAAA,CAAAZ,EAAAA,IAACqF,GAAA,CAAa,UAAU,SAAA,CAAU,EACjCC,EAAO,IAAI,KAAKvE,CAAS,EAAG,cAAc,EAAE,MAAIuE,EAAO,IAAI,KAAKtE,CAAO,EAAG,cAAc,CAAA,CAAA,CAC3F,CAAA,CACF,EACAhB,EAAAA,IAACuF,GAAA,CAAe,UAAU,aAAa,MAAM,QAC3C,SAAAvF,EAAAA,IAAC,MAAA,CAAI,UAAU,YACb,SAAAF,EAAAA,KAAC,MAAA,CACC,SAAA,CAAAE,EAAAA,IAAC,KAAA,CAAG,UAAU,mBAAmB,SAAA,eAAY,QAC5C,MAAA,CAAI,UAAU,aACZ,SAAAkF,EAAQ,IAAKM,GACZxF,EAAAA,IAACY,EAAA,CAEC,QAAQ,QACR,UAAU,gBACV,QAAS,IAAMkE,EAAkBU,EAAO,IAAI,EAE3C,SAAAA,EAAO,KAAA,EALHA,EAAO,KAAA,CAOf,CAAA,CACH,CAAA,CAAA,CACF,EACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAEJ,CCvDA,MAAMC,GAAwD,CAC5D,CAAE,MAAO,wBAAyB,MAAO,uBAAA,EACzC,CAAE,MAAO,mBAAoB,MAAO,kBAAA,EACpC,CAAE,MAAO,iBAAkB,MAAO,gBAAA,EAClC,CAAE,MAAO,mBAAoB,MAAO,kBAAA,CACtC,EAEO,SAASC,GAAe,CAAE,kBAAAC,EAAmB,SAAAjB,GAAiC,CACnF,MAAMkB,EAAgBxI,GAA6B,CAC7CuI,EAAkB,SAASvI,CAAQ,EACrCsH,EAASiB,EAAkB,OAAOE,GAAKA,IAAMzI,CAAQ,CAAC,EAEtDsH,EAAS,CAAC,GAAGiB,EAAmBvI,CAAQ,CAAC,CAE7C,EAEA,cACG+H,GAAA,CACC,SAAA,CAAAnF,EAAAA,IAACoF,GAAA,CAAe,QAAO,GACrB,SAAAtF,EAAAA,KAACc,GAAO,QAAQ,UAAU,UAAU,QAClC,SAAA,CAAAZ,EAAAA,IAAC8F,GAAA,CAAO,UAAU,SAAA,CAAU,EAAE,cAClBH,EAAkB,OAAO,GAAA,CAAA,CACvC,CAAA,CACF,EACA3F,EAAAA,IAACuF,IAAe,UAAU,OAAO,MAAM,QACrC,SAAAzF,EAAAA,KAAC,MAAA,CAAI,UAAU,YACb,SAAA,CAAAE,EAAAA,IAAC,KAAA,CAAG,UAAU,sBAAsB,SAAA,qBAAkB,EACtDA,EAAAA,IAAC,MAAA,CAAI,UAAU,YACZ,SAAAyF,GAAU,IAAKrI,GACd0C,EAAAA,KAAC,MAAA,CAAyB,UAAU,8BAClC,SAAA,CAAAE,EAAAA,IAAC+F,GAAA,CACC,GAAI3I,EAAS,MACb,QAASuI,EAAkB,SAASvI,EAAS,KAAK,EAClD,gBAAiB,IAAMwI,EAAaxI,EAAS,KAAK,CAAA,CAAA,EAEpD4C,EAAAA,IAACgG,GAAA,CACC,QAAS5I,EAAS,MAClB,UAAU,qCAET,SAAAA,EAAS,KAAA,CAAA,CACZ,GAXQA,EAAS,KAYnB,CACD,CAAA,CACH,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAEJ,CCrCO,SAAS6I,IAA2B,CACzC,KAAM,CAAE,MAAAhJ,CAAA,EAAUC,EAAA,EACZ,CAACgJ,EAAWC,CAAY,EAAItB,WAAS,CACzC,MAAO,IAAI,KAAK,KAAK,IAAA,EAAQ,IAAU,GAAK,GAAK,GAAI,EAAE,YAAA,EAAc,MAAM,GAAG,EAAE,CAAC,EACjF,QAAS,KAAA,EAAO,cAAc,MAAM,GAAG,EAAE,CAAC,CAAA,CAC3C,EACK,CAACc,EAAmBS,CAAoB,EAAIvB,WAA2B,CAC3E,wBACA,kBAAA,CACD,EAEKwB,EAAoBnI,GAAA,EAGpByF,EAAa3E,GAAc,CAC/B,UAAWkH,EAAU,MACrB,QAASA,EAAU,IACnB,UAAWP,EACX,MAAO,GAAA,CACR,EAEKW,EAAoB,SAAY,CACpC,GAAI,CACF,MAAMD,EAAkB,YAAY,CAClC,WAAYH,EAAU,MACtB,SAAUA,EAAU,IACpB,cAAe,EAAA,CAChB,CACH,OAASnJ,EAAO,CACd,QAAQ,MAAM,0BAA2BA,CAAK,CAChD,CACF,EAEMwJ,EAAkB,IAAM,CAE5B,GAAI,CAAC5C,GAAcA,EAAW,SAAW,EAAG,CAC1C1G,EAAM,CACJ,MAAO,oBACP,YAAa,qDACb,QAAS,aAAA,CACV,EACD,MACF,CAEA,MAAMuJ,EAAgB,GAAGN,EAAU,KAAK,OAAOA,EAAU,GAAG,GACtDO,EAAaC,EAAyB/C,EAAY,0BAA2B6C,CAAa,EAEhGG,GAAYF,CAAU,EAEtBxJ,EAAM,CACJ,MAAO,kBACP,YAAa,YAAY0G,EAAW,MAAM,kBAAA,CAC3C,CACH,EAEMiD,EAAkB,IAAM,CAE5B,GAAI,CAACjD,GAAcA,EAAW,SAAW,EAAG,CAC1C1G,EAAM,CACJ,MAAO,oBACP,YAAa,qDACb,QAAS,aAAA,CACV,EACD,MACF,CAEA,MAAMuJ,EAAgB,GAAGN,EAAU,KAAK,OAAOA,EAAU,GAAG,GACtDO,EAAaC,EAAyB/C,EAAY,0BAA2B6C,CAAa,EAEhGK,GAAYJ,CAAU,EAEtBxJ,EAAM,CACJ,MAAO,cACP,YAAa,6BAA6B0G,EAAW,MAAM,WAAA,CAC5D,CACH,EAEA,OACE7D,EAAAA,KAAC,MAAA,CAAI,UAAU,YAEb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,gDACb,SAAA,CAAAA,EAAAA,KAACc,EAAA,CACC,QAAQ,UACR,KAAK,KACL,QAAS0F,EACT,SAAUD,EAAkB,UAE5B,SAAA,CAAArG,EAAAA,IAAC8G,IAAU,UAAW,gBAAgBT,EAAkB,UAAY,eAAiB,EAAE,GAAI,EAAE,cAAA,CAAA,CAAA,SAG9FU,GAAA,CACC,SAAA,CAAA/G,EAAAA,IAACgH,GAAA,CAAoB,QAAO,GAC1B,SAAAlH,EAAAA,KAACc,GAAO,QAAQ,UAAU,KAAK,KAC7B,SAAA,CAAAZ,EAAAA,IAACiH,GAAA,CAAS,UAAU,cAAA,CAAe,EAAE,QAAA,CAAA,CAEvC,CAAA,CACF,EACAnH,EAAAA,KAACoH,GAAA,CAAoB,MAAM,MACzB,SAAA,CAAApH,EAAAA,KAACqH,EAAA,CAAiB,QAASZ,EACzB,SAAA,CAAAvG,EAAAA,IAACkC,EAAA,CAAS,UAAU,cAAA,CAAe,EAAE,eAAA,EAEvC,EACApC,EAAAA,KAACqH,EAAA,CAAiB,QAASP,EACzB,SAAA,CAAA5G,EAAAA,IAACkC,EAAA,CAAS,UAAU,cAAA,CAAe,EAAE,eAAA,CAAA,CAEvC,CAAA,CAAA,CACF,CAAA,EACF,EACApC,EAAAA,KAACc,EAAA,CAAO,QAAQ,UAAU,KAAK,KAC7B,SAAA,CAAAZ,EAAAA,IAACoH,GAAA,CAAa,UAAU,cAAA,CAAe,EAAE,UAAA,CAAA,CAE3C,CAAA,EACF,QAGC9H,GAAA,EAAoB,SAGpBO,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,SAAA,CAAO,EAClBD,EAAAA,IAACE,GAAgB,SAAA,+BAAA,CAA6B,CAAA,EAChD,EACAJ,EAAAA,KAACK,EAAA,CAAY,UAAU,uBACrB,SAAA,CAAAH,EAAAA,IAACyE,GAAA,CACC,UAAWyB,EAAU,MACrB,QAASA,EAAU,IACnB,SAAU,CAACjB,EAAOD,IAAQmB,EAAa,CAAE,MAAAlB,EAAO,IAAAD,EAAK,CAAA,CAAA,EAEvDhF,EAAAA,IAAC0F,GAAA,CACC,kBAAAC,EACA,SAAUS,CAAA,CAAA,CACZ,CAAA,CACF,CAAA,EACF,EAGAtG,EAAAA,KAAC2C,EAAA,CAAK,aAAa,WAAW,UAAU,YACtC,SAAA,CAAA3C,OAAC4C,EAAA,CACC,SAAA,CAAA1C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,WAAW,SAAA,WAAQ,EACtC3C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,UAAU,SAAA,cAAW,EACxC3C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,QAAQ,SAAA,YAAS,EACpC3C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,UAAU,SAAA,UAAO,EACpC3C,EAAAA,IAAC2C,EAAA,CAAY,MAAM,YAAY,SAAA,WAAA,CAAS,CAAA,EAC1C,EAEA7C,EAAAA,KAAC8C,EAAA,CAAY,MAAM,WAAW,UAAU,YAEtC,SAAA,CAAA5C,EAAAA,IAACc,GAAA,CACC,UAAWoF,EAAU,MACrB,QAASA,EAAU,IACnB,UAAWP,CAAA,CAAA,EAIb3F,EAAAA,IAACuC,GAAA,CACC,UAAW2D,EAAU,MACrB,QAASA,EAAU,IACnB,UAAWP,CAAA,CAAA,EAIb7F,EAAAA,KAAC,MAAA,CAAI,UAAU,4BACb,SAAA,CAAAA,OAACD,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,gBAAA,CAAc,EACzBD,EAAAA,IAACE,GAAgB,SAAA,mCAAA,CAAiC,CAAA,EACpD,QACCC,EAAA,CACC,SAAAH,EAAAA,IAACyD,EAAA,CACC,UAAWyC,EAAU,MACrB,QAASA,EAAU,IACnB,UAAWP,EACX,MAAO,EAAA,CAAA,CACT,CACF,CAAA,EACF,SAEC9F,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,cAAA,CAAY,EACvBD,EAAAA,IAACE,GAAgB,SAAA,0BAAA,CAAwB,CAAA,EAC3C,QACCC,EAAA,CACC,SAAAH,EAAAA,IAACoE,EAAA,CACC,UAAW8B,EAAU,MACrB,QAASA,EAAU,IACnB,UAAWP,EACX,MAAO,EAAA,CAAA,CACT,CACF,CAAA,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,QAEC/C,EAAA,CAAY,MAAM,UAAU,UAAU,YACrC,gBAAC/C,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,oBAAA,CAAkB,EAC7BD,EAAAA,IAACE,GAAgB,SAAA,0DAAA,CAAwD,CAAA,EAC3E,QACCC,EAAA,CACC,SAAAH,EAAAA,IAACyD,EAAA,CACC,UAAWyC,EAAU,MACrB,QAASA,EAAU,IACnB,UAAWP,EACX,MAAO,GAAA,CAAA,CACT,CACF,CAAA,CAAA,CACF,CAAA,CACF,QAEC/C,EAAA,CAAY,MAAM,QAAQ,UAAU,YACnC,gBAAC/C,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,WAAA,CAAS,EACpBD,EAAAA,IAACE,GAAgB,SAAA,6CAAA,CAA2C,CAAA,EAC9D,QACCC,EAAA,CACC,SAAAH,EAAAA,IAACoE,EAAA,CACC,UAAW8B,EAAU,MACrB,QAASA,EAAU,IACnB,UAAWP,EACX,MAAO,GAAA,CAAA,CACT,CACF,CAAA,CAAA,CACF,CAAA,CACF,QAEC/C,EAAA,CAAY,MAAM,UAAU,UAAU,YACrC,gBAAC/C,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,kBAAA,CAAgB,EAC3BD,EAAAA,IAACE,GAAgB,SAAA,oCAAA,CAAkC,CAAA,EACrD,QACCC,EAAA,CACC,SAAAH,MAAC,KAAE,UAAU,wBAAwB,2CAA+B,CAAA,CACtE,CAAA,CAAA,CACF,CAAA,CACF,QAEC4C,EAAA,CAAY,MAAM,YAAY,UAAU,YACvC,gBAAC/C,EAAA,CACC,SAAA,CAAAC,OAACC,EAAA,CACC,SAAA,CAAAC,EAAAA,IAACC,GAAU,SAAA,yBAAA,CAAuB,EAClCD,EAAAA,IAACE,GAAgB,SAAA,gCAAA,CAA8B,CAAA,EACjD,QACCC,EAAA,CACC,SAAAH,MAAC,KAAE,UAAU,wBAAwB,+CAAmC,CAAA,CAC1E,CAAA,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}