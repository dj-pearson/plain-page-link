import{j as e}from"./ui-components-BlSGx7hb.js";import{a as s,N as t,L as a}from"./react-vendor-CmKLYqnR.js";import{s as r,D as i,N as n,B as l,q as o,v as c,r as d,t as u,L as m,I as h,i as x,j as p,k as j,l as g,m as y,y as f,C as v,a as w,b as N,c as b,d as k,n as _,T as S,e as C}from"./index-BN67XOPb.js";import{T as F,a as A,b as q,c as M}from"./tabs-THrZwbcC.js";import{S as P}from"./switch-CUrMGSbI.js";import{b as I,u as K,d as E}from"./data-CgAYSh8x.js";import{u as T,a as L}from"./utils-CwVVV8W2.js";import{aw as G,L as W,k as D,aX as O,g as U,e as Q,a5 as V,E as z,ay as R,aY as B,aZ as H,a_ as $,a$ as X,a6 as J,a1 as Z,ad as Y,b0 as ee,Z as se,a8 as te,aD as ae,J as re,T as ie,h as ne,an as le,a2 as oe,b1 as ce,u as de,aj as ue,b2 as me,S as he,B as xe,U as pe}from"./icons-C4ubqulC.js";import{S as je}from"./SEOManager-CTZqaH6h.js";import{S as ge}from"./SearchAnalyticsDashboard-BmiDmcev.js";import"./three-addons-bxfOomGn.js";import"./three-BxgHQpUo.js";import"./charts-D6IDAGAX.js";import"./supabase-DpFHdg_3.js";import"./forms-BQFHsYzL.js";import"./table-BZ2GnPwa.js";import"./popover-CNUqIhkd.js";import"./checkbox-CZcFbFhe.js";function ye({onAdd:t,isAdding:a}){const[r,v]=s.useState(!1),[w,N]=s.useState({provider:"",model_name:"",model_id:"",description:"",context_window:2e5,max_output_tokens:8192,supports_vision:!0,is_active:!0,auth_type:"bearer",secret_name:"",api_endpoint:""});return e.jsxs(i,{open:r,onOpenChange:v,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{className:"gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Add New Model"]})}),e.jsx(o,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),t(w),v(!1),N({provider:"",model_name:"",model_id:"",description:"",context_window:2e5,max_output_tokens:8192,supports_vision:!0,is_active:!0,auth_type:"bearer",secret_name:"",api_endpoint:""})},children:[e.jsxs(c,{children:[e.jsx(d,{children:"Add New AI Model"}),e.jsx(u,{children:"Configure a new AI model with authentication and endpoint details"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"provider",children:"Provider Name *"}),e.jsx(h,{id:"provider",placeholder:"e.g., Anthropic",value:w.provider,onChange:e=>N({...w,provider:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"model_name",children:"Display Name *"}),e.jsx(h,{id:"model_name",placeholder:"e.g., Claude Sonnet 4.5",value:w.model_name,onChange:e=>N({...w,model_name:e.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"model_id",children:"Model ID *"}),e.jsx(h,{id:"model_id",placeholder:"e.g., claude-sonnet-4-5-20250929",value:w.model_id,onChange:e=>N({...w,model_id:e.target.value}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The exact model identifier for API calls"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"description",children:"Description"}),e.jsx(h,{id:"description",placeholder:"Brief description of model capabilities",value:w.description,onChange:e=>N({...w,description:e.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"auth_type",children:"Authentication Type *"}),e.jsxs(x,{value:w.auth_type,onValueChange:e=>N({...w,auth_type:e}),children:[e.jsx(p,{id:"auth_type",children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(y,{value:"bearer",children:"Bearer Token"}),e.jsx(y,{value:"x-api-key",children:"X-API-Key Header"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How the API key is sent (Bearer for most, X-API-Key for Anthropic)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"secret_name",children:"Supabase Secret Name *"}),e.jsx(h,{id:"secret_name",placeholder:"e.g., CLAUDE_API_KEY",value:w.secret_name,onChange:e=>N({...w,secret_name:e.target.value}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Name of the secret stored in Supabase (must be added to Supabase secrets)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"api_endpoint",children:"API Endpoint *"}),e.jsx(h,{id:"api_endpoint",placeholder:"e.g., https://api.anthropic.com/v1/messages",value:w.api_endpoint,onChange:e=>N({...w,api_endpoint:e.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"context_window",children:"Context Window"}),e.jsx(h,{id:"context_window",type:"number",value:w.context_window,onChange:e=>N({...w,context_window:parseInt(e.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"max_output_tokens",children:"Max Output Tokens"}),e.jsx(h,{id:"max_output_tokens",type:"number",value:w.max_output_tokens,onChange:e=>N({...w,max_output_tokens:parseInt(e.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"supports_vision",children:"Supports Vision"}),e.jsx(P,{id:"supports_vision",checked:w.supports_vision,onCheckedChange:e=>N({...w,supports_vision:e})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"is_active",children:"Active"}),e.jsx(P,{id:"is_active",checked:w.is_active,onCheckedChange:e=>N({...w,is_active:e})})]})]}),e.jsxs(f,{children:[e.jsx(l,{type:"button",variant:"outline",onClick:()=>v(!1),children:"Cancel"}),e.jsxs(l,{type:"submit",disabled:a,children:[a&&e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Model"]})]})]})})]})}function fe(){const{models:s,isLoading:t,getConfigValue:a,handleUpdateConfig:i,toggleModel:n,addModel:o,testModel:c,isTestingModel:d,isAddingModel:u}=function(){const e=I(),s=K({queryKey:["ai-models"],queryFn:async()=>{const{data:e,error:s}=await r.from("ai_models").select("*").order("provider",{ascending:!0});if(s)throw s;return e}}),t=K({queryKey:["ai-configuration"],queryFn:async()=>{const{data:e,error:s}=await r.from("ai_configuration").select("*");if(s)throw s;return e}}),a=E({mutationFn:async({key:e,value:s})=>{const{error:t}=await r.from("ai_configuration").update({setting_value:s,updated_at:(new Date).toISOString(),updated_by:(await r.auth.getUser()).data.user?.id}).eq("setting_key",e);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["ai-configuration"]}),T.success("Configuration updated")},onError:e=>{T.error("Failed to update: "+e.message)}}),i=E({mutationFn:async({id:e,isActive:s})=>{const{error:t}=await r.from("ai_models").update({is_active:s}).eq("id",e);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["ai-models"]}),T.success("Model status updated")},onError:e=>{T.error("Failed to update model: "+e.message)}}),n=E({mutationFn:async e=>{const{error:s}=await r.from("ai_models").insert([e]);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["ai-models"]}),T.success("Model added successfully")},onError:e=>{T.error("Failed to add model: "+e.message)}}),l=E({mutationFn:async e=>{const{data:s,error:t}=await r.functions.invoke("test-ai-model",{body:{model:e}});if(t)throw t;return s},onSuccess:e=>{e.success?T.success(e.message):T.error(e.error)},onError:e=>{T.error("Model test failed: "+e.message)}});return{models:s.data,config:t.data,isLoading:s.isLoading||t.isLoading,getConfigValue:e=>{const s=t.data?.find(s=>s.setting_key===e);if(!s)return"";try{return JSON.parse(s.setting_value)}catch{return s.setting_value}},handleUpdateConfig:(e,s)=>{a.mutate({key:e,value:JSON.stringify(s)})},toggleModel:i.mutate,addModel:n.mutate,testModel:l.mutate,isTestingModel:l.isPending,isAddingModel:n.isPending}}();if(t)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(W,{className:"h-8 w-8 animate-spin text-primary"})});const f=a("default_model");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{children:[e.jsxs(w,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5"}),"AI Model Configuration"]}),e.jsx(b,{children:"Configure AI models and settings for content generation"})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"default-model",children:"Default AI Model"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{value:f,onValueChange:e=>i("default_model",e),children:[e.jsx(p,{id:"default-model",children:e.jsx(j,{placeholder:"Select a model"})}),e.jsx(g,{children:s?.map(s=>e.jsxs(y,{value:s.model_id,children:[s.model_name," (",s.provider,")"]},s.id))})]}),e.jsx(l,{variant:"outline",size:"icon",onClick:()=>c(f),disabled:d,title:"Test AI Model",children:d?e.jsx(W,{className:"h-4 w-4 animate-spin"}):e.jsx(O,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"temp-precise",children:"Precise Temperature"}),e.jsx(h,{id:"temp-precise",type:"number",step:"0.1",min:"0",max:"1",value:a("temperature_precise"),onChange:e=>i("temperature_precise",parseFloat(e.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For data extraction and precise tasks"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"temp-creative",children:"Creative Temperature"}),e.jsx(h,{id:"temp-creative",type:"number",step:"0.1",min:"0",max:"1",value:a("temperature_creative"),onChange:e=>i("temperature_creative",parseFloat(e.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For content generation and creative tasks"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"tokens-standard",children:"Standard Max Tokens"}),e.jsx(h,{id:"tokens-standard",type:"number",step:"100",value:a("max_tokens_standard"),onChange:e=>i("max_tokens_standard",parseInt(e.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"tokens-large",children:"Large Content Max Tokens"}),e.jsx(h,{id:"tokens-large",type:"number",step:"100",value:a("max_tokens_large"),onChange:e=>i("max_tokens_large",parseInt(e.target.value))})]})]})]})]}),e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Available AI Models"}),e.jsx(b,{children:"Manage which models are available for selection"})]}),e.jsx(ye,{onAdd:o,isAdding:u})]})}),e.jsx(k,{children:e.jsx("div",{className:"space-y-4",children:s?.map(s=>e.jsxs("div",{className:"flex items-start justify-between p-4 border rounded-lg gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:s.model_name}),e.jsx(_,{variant:"outline",className:"text-xs",children:s.provider})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:s.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Context: ",s.context_window.toLocaleString()," tokens"]}),e.jsxs("span",{children:["Max Output: ",s.max_output_tokens.toLocaleString()," tokens"]}),s.supports_vision&&e.jsx("span",{children:"âœ“ Vision"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2 text-xs",children:[e.jsx(_,{variant:"secondary",children:"bearer"===s.auth_type?"Bearer Token":"X-API-Key"}),e.jsxs(_,{variant:"secondary",children:["Secret: ",s.secret_name]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 font-mono truncate",children:s.api_endpoint})]}),e.jsx(P,{checked:s.is_active,onCheckedChange:e=>n({id:s.id,isActive:e})})]},s.id))})})]})]})}function ve(){const e=I(),s=K({queryKey:["social-media-posts"],queryFn:async()=>{const{data:e,error:s}=await r.from("social_media_posts").select("*").order("created_at",{ascending:!1});if(s)throw s;return e}}),t=K({queryKey:["marketing-posts"],queryFn:async()=>{const{data:e,error:s}=await r.from("social_media_posts").select("*").eq("content_type","marketing").order("created_at",{ascending:!1});if(s)throw s;return e}}),a=K({queryKey:["social-media-webhooks"],queryFn:async()=>{const{data:e,error:s}=await r.from("social_media_webhooks").select("*").order("name",{ascending:!0});if(s)throw s;return e}}),i=E({mutationFn:async e=>{const{data:s,error:t}=await r.functions.invoke("generate-social-post",{body:e});if(t)throw t;return s},onSuccess:e=>{e.success?T.success("Content generated successfully!"):T.error(e.error||"Generation failed")},onError:e=>{T.error("Failed to generate content: "+e.message)}}),n=E({mutationFn:async e=>{const{data:s}=await r.auth.getUser(),{data:t,error:a}=await r.from("social_media_posts").insert({...e,created_by:s.user?.id}).select().single();if(a)throw a;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["social-media-posts"]}),T.success("Post created successfully")},onError:e=>{T.error("Failed to create post: "+e.message)}}),l=E({mutationFn:async({id:e,updates:s})=>{const{error:t}=await r.from("social_media_posts").update(s).eq("id",e);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["social-media-posts"]}),T.success("Post updated successfully")},onError:e=>{T.error("Failed to update post: "+e.message)}}),o=E({mutationFn:async e=>{const{error:s}=await r.from("social_media_posts").delete().eq("id",e);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["social-media-posts"]}),T.success("Post deleted successfully")},onError:e=>{T.error("Failed to delete post: "+e.message)}}),c=E({mutationFn:async e=>{const{data:s,error:t}=await r.from("social_media_webhooks").insert(e).select().single();if(t)throw t;return s},onSuccess:()=>{e.invalidateQueries({queryKey:["social-media-webhooks"]}),T.success("Webhook created successfully")},onError:e=>{T.error("Failed to create webhook: "+e.message)}}),d=E({mutationFn:async({id:e,updates:s})=>{const{error:t}=await r.from("social_media_webhooks").update(s).eq("id",e);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["social-media-webhooks"]}),T.success("Webhook updated successfully")},onError:e=>{T.error("Failed to update webhook: "+e.message)}}),u=E({mutationFn:async e=>{const{error:s}=await r.from("social_media_webhooks").delete().eq("id",e);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["social-media-webhooks"]}),T.success("Webhook deleted successfully")},onError:e=>{T.error("Failed to delete webhook: "+e.message)}}),m=E({mutationFn:async e=>{const{data:s,error:t}=await r.functions.invoke("test-social-webhook",{body:{webhookId:e}});if(t)throw t;return s},onSuccess:e=>{e.success?T.success("Test webhook sent successfully!"):T.error("Test webhook failed: "+(e.error||"Unknown error"))},onError:e=>{T.error("Failed to test webhook: "+e.message)}}),h=E({mutationFn:async e=>{const{data:s,error:t}=await r.functions.invoke("generate-marketing-post",{body:{webhookUrl:e}});if(t)throw t;return s},onSuccess:s=>{e.invalidateQueries({queryKey:["marketing-posts"]}),s.success?T.success(s.message):T.error(s.error||"Failed to generate post")},onError:e=>{T.error("Failed to generate post: "+e.message)}}),x=E({mutationFn:async({postId:e,webhookUrl:s})=>{const{data:t}=await r.from("social_media_posts").select("post_content").eq("id",e).single();if(!t)throw new Error("Post not found");if(!(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t.post_content)})).ok)throw new Error("Webhook delivery failed");return await r.from("social_media_posts").update({status:"posted",posted_at:(new Date).toISOString(),webhook_urls:[s]}).eq("id",e),{success:!0}},onSuccess:()=>{e.invalidateQueries({queryKey:["marketing-posts"]}),T.success("Post resent successfully")},onError:e=>{T.error("Failed to resend post")}});return{posts:s.data,marketingPosts:t.data,webhooks:a.data,isLoading:s.isLoading||a.isLoading||t.isLoading,generatePost:i.mutate,isGenerating:i.isPending,generatedContent:i.data,createPost:n.mutate,updatePost:l.mutate,deletePost:o.mutate,createWebhook:c.mutate,updateWebhook:d.mutate,deleteWebhook:u.mutate,testWebhook:m.mutate,isTestingWebhook:m.isPending,generateMarketingPost:h.mutate,isGeneratingMarketingPost:h.isPending,marketingPostData:h.data,retryMarketingPost:x.mutate,isRetryingPost:x.isPending}}function we(){const[t,a]=s.useState(!1),[f,v]=s.useState("property_highlight"),[w,N]=s.useState("listing_of_the_day"),[b,k]=s.useState("combined"),[_,C]=s.useState(""),[F,A]=s.useState(""),[q,M]=s.useState(""),[P,I]=s.useState(null),{generatePost:E,isGenerating:T,createPost:L}=ve(),{data:D}=K({queryKey:["listings-for-social"],queryFn:async()=>{const{data:e,error:s}=await r.from("listings").select("id, address, price, status").eq("status","active").order("created_at",{ascending:!1}).limit(20);if(s)throw s;return e}});return e.jsxs(i,{open:t,onOpenChange:a,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{className:"gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"Create Post"]})}),e.jsxs(o,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(c,{children:[e.jsx(d,{children:"Create Social Media Post"}),e.jsx(u,{children:"Generate AI-powered social media content for your real estate business"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"content-type",children:"Content Type"}),e.jsxs(x,{value:f,onValueChange:v,children:[e.jsx(p,{id:"content-type",children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(y,{value:"property_highlight",children:"Property Highlight"}),e.jsx(y,{value:"market_update",children:"Market Update"}),e.jsx(y,{value:"agent_tip",children:"Agent Tip"}),e.jsx(y,{value:"community_spotlight",children:"Community Spotlight"}),e.jsx(y,{value:"success_story",children:"Success Story"}),e.jsx(y,{value:"general",children:"General"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"subject-type",children:"Subject Type"}),e.jsxs(x,{value:w,onValueChange:N,children:[e.jsx(p,{id:"subject-type",children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(y,{value:"listing_of_the_day",children:"Listing of the Day"}),e.jsx(y,{value:"market_analysis",children:"Market Analysis"}),e.jsx(y,{value:"buyer_seller_tip",children:"Buyer/Seller Tip"}),e.jsx(y,{value:"neighborhood_feature",children:"Neighborhood Feature"}),e.jsx(y,{value:"testimonial_highlight",children:"Testimonial Highlight"}),e.jsx(y,{value:"special_announcement",children:"Special Announcement"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"platform-type",children:"Platform"}),e.jsxs(x,{value:b,onValueChange:k,children:[e.jsx(p,{id:"platform-type",children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(y,{value:"combined",children:"All Platforms"}),e.jsx(y,{value:"twitter_threads",children:"Twitter/X Threads"}),e.jsx(y,{value:"facebook_linkedin",children:"Facebook/LinkedIn"}),e.jsx(y,{value:"instagram",children:"Instagram"})]})]})]}),"property_highlight"===f&&D&&D.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"listing",children:"Select Property (Optional)"}),e.jsxs(x,{value:_,onValueChange:C,children:[e.jsx(p,{id:"listing",children:e.jsx(j,{placeholder:"Choose a listing..."})}),e.jsx(g,{children:D.map(s=>e.jsxs(y,{value:s.id,children:[s.address," - ",s.price]},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"custom-prompt",children:"Custom Instructions (Optional)"}),e.jsx(S,{id:"custom-prompt",placeholder:"Add any specific instructions for the AI...",value:F,onChange:e=>A(e.target.value),rows:3})]}),e.jsx(l,{onClick:()=>{E({contentType:f,subjectType:w,platformType:b,listingId:_||void 0,customPrompt:F||void 0},{onSuccess:e=>{e.success&&I(e.content)}})},disabled:T,className:"w-full gap-2",children:T?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4"}),"Generate with AI"]})}),P&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"post-title",children:"Post Title"}),e.jsx(h,{id:"post-title",placeholder:"Enter a title for this post...",value:q,onChange:e=>M(e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Generated Content"}),e.jsx("div",{className:"p-4 bg-background border rounded-lg whitespace-pre-wrap text-sm",children:P[b]||P.raw})]}),e.jsx(l,{onClick:()=>{P&&L({content_type:f,subject_type:w,platform_type:b,post_content:P,post_title:q||`${f} - ${(new Date).toLocaleDateString()}`,listing_id:_||null,status:"draft",ai_prompt_used:F||void 0},{onSuccess:()=>{a(!1),I(null),M(""),A("")}})},className:"w-full",children:"Save as Draft"})]})]})]})]})}function Ne(){const[t,a]=s.useState(!1),[r,f]=s.useState(""),[v,w]=s.useState(""),[N,b]=s.useState(""),[k,_]=s.useState(!0),{createWebhook:S}=ve();return e.jsxs(i,{open:t,onOpenChange:a,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{variant:"outline",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Add Webhook"]})}),e.jsxs(o,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Add Social Media Webhook"}),e.jsx(u,{children:"Configure a webhook to automatically distribute posts to your platforms"})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),r.trim()?v?N.trim()?(S({name:r,platform:v,webhook_url:N,is_active:k,headers:{}}),f(""),w(""),b(""),_(!0),a(!1)):T.error("Please enter a webhook URL"):T.error("Please select a platform"):T.error("Please enter a webhook name")},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Webhook Name"}),e.jsx(h,{id:"name",placeholder:"My Make.com Workflow",value:r,onChange:e=>f(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"platform",children:"Platform *"}),e.jsxs(x,{value:v,onValueChange:w,children:[e.jsx(p,{id:"platform",children:e.jsx(j,{placeholder:"Select platform"})}),e.jsxs(g,{children:[e.jsx(y,{value:"make",children:"Make.com"}),e.jsx(y,{value:"zapier",children:"Zapier"}),e.jsx(y,{value:"n8n",children:"n8n"}),e.jsx(y,{value:"custom",children:"Custom"}),e.jsx(y,{value:"facebook",children:"Facebook"}),e.jsx(y,{value:"instagram",children:"Instagram"}),e.jsx(y,{value:"linkedin",children:"LinkedIn"}),e.jsx(y,{value:"twitter",children:"Twitter/X"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"url",children:"Webhook URL"}),e.jsx(h,{id:"url",type:"url",placeholder:"https://hook.example.com/webhook/social",value:N,onChange:e=>b(e.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"active",children:"Active"}),e.jsx(P,{id:"active",checked:k,onCheckedChange:_})]}),e.jsx(l,{type:"submit",className:"w-full",children:"Create Webhook"})]})]})]})}function be(){const[t,a]=s.useState("all"),{posts:r,marketingPosts:i,webhooks:n,isLoading:o,deletePost:c,updateWebhook:d,deleteWebhook:u,testWebhook:m,isTestingWebhook:h,generateMarketingPost:x,isGeneratingMarketingPost:p,marketingPostData:j,retryMarketingPost:g,isRetryingPost:y}=ve(),f=e=>{switch(e){case"posted":return"bg-green-500";case"scheduled":return"bg-blue-500";case"draft":default:return"bg-gray-500";case"archived":return"bg-orange-500"}},S=e=>e.split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");if(o)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(W,{className:"h-8 w-8 animate-spin text-primary"})});const C="all"===t?r:r?.filter(e=>e.status===t);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Social Media Content"}),e.jsx(b,{children:"Manage and generate social media posts for your real estate business"})]}),e.jsx(we,{})]})}),e.jsx(k,{children:e.jsxs(F,{value:t,onValueChange:a,children:[e.jsxs(A,{children:[e.jsx(q,{value:"all",children:"All Posts"}),e.jsx(q,{value:"draft",children:"Drafts"}),e.jsx(q,{value:"scheduled",children:"Scheduled"}),e.jsx(q,{value:"posted",children:"Posted"})]}),e.jsx(M,{value:t,className:"space-y-4 mt-6",children:C&&C.length>0?C.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:s.post_title||"Untitled Post"}),e.jsx(_,{className:`${f(s.status)} text-white`,children:s.status})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-muted-foreground mb-3",children:[e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(_,{variant:"outline",children:S(s.content_type)})}),e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(_,{variant:"outline",children:S(s.subject_type)})}),e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(_,{variant:"outline",children:S(s.platform_type)})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Created: ",L(new Date(s.created_at),"MMM d, yyyy h:mm a")]}),s.scheduled_for&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),"Scheduled: ",L(new Date(s.scheduled_for),"MMM d, yyyy h:mm a")]}),s.posted_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"h-3 w-3"}),"Posted: ",L(new Date(s.posted_at),"MMM d, yyyy h:mm a")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",children:e.jsx(R,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this post?")&&c(s.id)},children:e.jsx(B,{className:"h-4 w-4"})})]})]})},s.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No posts found"}),e.jsx(we,{})]})})]})})]}),e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Webhook Configuration"}),e.jsx(b,{children:"Configure webhooks for automatic post distribution"})]}),e.jsx(Ne,{})]})}),e.jsx(k,{children:n&&n.length>0?e.jsx("div",{className:"space-y-3",children:n.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.platform}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 truncate max-w-md",children:s.webhook_url})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>m(s.id),disabled:h,title:"Test webhook with sample post",children:h?e.jsx(W,{className:"h-4 w-4 animate-spin"}):e.jsx(V,{className:"h-4 w-4"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>d({id:s.id,updates:{is_active:!s.is_active}}),children:s.is_active?e.jsx($,{className:"h-5 w-5 text-green-600"}):e.jsx(X,{className:"h-5 w-5 text-gray-400"})}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this webhook?")&&u(s.id)},children:e.jsx(B,{className:"h-4 w-4"})})]})]},s.id))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No webhooks configured yet. Add a webhook to automatically distribute posts."})})})]}),e.jsxs(v,{children:[e.jsxs(w,{children:[e.jsx(N,{children:"Marketing Post Generator"}),e.jsx(b,{children:"Generate unique, catchy social media posts to drive agent signups"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{onClick:()=>x(),disabled:p,className:"flex-1",children:p?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Generate New Post"]})}),n&&n.length>0&&e.jsx(l,{variant:"outline",onClick:()=>{const e=n.find(e=>e.is_active);e&&x(e.webhook_url)},disabled:p||!n.some(e=>e.is_active),children:"Generate & Send"})]}),j&&j.payload&&e.jsxs("div",{className:"space-y-4 mt-4 border-t pt-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Long Form (LinkedIn/Facebook):"}),e.jsx("div",{className:"bg-muted p-4 rounded-lg text-sm whitespace-pre-wrap",children:j.payload.longFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Short Form (Twitter/Threads):"}),e.jsx("div",{className:"bg-muted p-4 rounded-lg text-sm",children:j.payload.shortFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Hashtags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:j.payload.hashtags.map((s,t)=>e.jsx(_,{variant:"secondary",children:s},t))})]})]})]})]}),e.jsxs(v,{children:[e.jsxs(w,{children:[e.jsx(N,{children:"Marketing Post History"}),e.jsx(b,{children:"View and redeploy previously generated marketing posts"})]}),e.jsx(k,{children:i&&i.length>0?e.jsx("div",{className:"space-y-4",children:i.map(s=>{const t=s.post_content;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:`${f(s.status)} text-white`,children:s.status}),e.jsx("span",{className:"text-sm text-muted-foreground",children:L(new Date(s.created_at),"MMM d, yyyy h:mm a")})]}),e.jsxs("div",{className:"flex gap-2",children:[n&&n.length>0&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{const e=n.find(e=>e.is_active);e&&g({postId:s.id,webhookUrl:e.webhook_url})},disabled:y||!n.some(e=>e.is_active),children:y?e.jsx(W,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Resend"]})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this post?")&&c(s.id)},children:e.jsx(B,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Long Form:"}),e.jsx("div",{className:"bg-muted p-3 rounded text-sm whitespace-pre-wrap",children:t.longFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Short Form:"}),e.jsx("div",{className:"bg-muted p-3 rounded text-sm",children:t.shortFormPost})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.hashtags?.map((s,t)=>e.jsx(_,{variant:"secondary",className:"text-xs",children:s},t))})]})]},s.id)})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No marketing posts generated yet. Create your first one above!"})})})]})]})}function ke(){const e=I(),s=K({queryKey:["articles"],queryFn:async()=>{const{data:e,error:s}=await r.from("articles").select("*").order("created_at",{ascending:!1});if(s)throw s;return e}}),t=E({mutationFn:async e=>{const{data:s,error:t}=await r.functions.invoke("generate-article",{body:e});if(t)throw t;return s},onSuccess:e=>{e.success?T.success("Article generated successfully!"):T.error(e.error||"Generation failed")},onError:e=>{T.error("Failed to generate article: "+e.message)}}),a=E({mutationFn:async e=>{const{data:s}=await r.auth.getUser(),{data:t,error:a}=await r.from("articles").insert({...e,author_id:s.user?.id}).select().single();if(a)throw a;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["articles"]}),T.success("Article created successfully")},onError:e=>{T.error("Failed to create article: "+e.message)}}),i=E({mutationFn:async({id:e,updates:s})=>{const{error:t}=await r.from("articles").update(s).eq("id",e);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["articles"]}),T.success("Article updated successfully")},onError:e=>{T.error("Failed to update article: "+e.message)}}),n=E({mutationFn:async e=>{const{error:s}=await r.from("articles").update({status:"published",published_at:(new Date).toISOString()}).eq("id",e);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["articles"]}),T.success("Article published successfully")},onError:e=>{T.error("Failed to publish article: "+e.message)}}),l=E({mutationFn:async e=>{const{data:s,error:t}=await r.functions.invoke("publish-article-to-social",{body:{articleId:e}});if(t)throw t;return s},onSuccess:e=>{e?.success?T.success("Article distributed to social platforms successfully"):T.error(e?.error||"Failed to distribute article")},onError:e=>{T.error("Failed to distribute article: "+e.message)}}),o=E({mutationFn:async e=>{const{error:s}=await r.from("articles").delete().eq("id",e);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["articles"]}),T.success("Article deleted successfully")},onError:e=>{T.error("Failed to delete article: "+e.message)}});return{articles:s.data,isLoading:s.isLoading,generateArticle:t.mutate,isGenerating:t.isPending,generatedArticle:t.data,createArticle:a.mutate,updateArticle:i.mutate,publishArticle:n.mutate,republishArticle:l.mutate,isRepublishing:l.isPending,deleteArticle:o.mutate}}function _e(){const e=I(),{data:s=[],isLoading:t}=K({queryKey:["keywords"],queryFn:async()=>{const{data:e,error:s}=await r.from("keywords").select("*").order("usage_count",{ascending:!0}).order("keyword",{ascending:!0});if(s)throw s;return e}}),{data:a=[]}=K({queryKey:["keywords","unused"],queryFn:async()=>{const{data:e,error:s}=await r.from("keywords").select("*").eq("is_active",!0).order("usage_count",{ascending:!0}).order("last_used_at",{ascending:!0,nullsFirst:!0}).limit(50);if(s)throw s;return e}}),i=E({mutationFn:async e=>{const{data:{session:s}}=await r.auth.getSession();if(!s)throw new Error("Not authenticated");const t=await fetch(`${r.supabaseUrl}/functions/v1/import-keywords`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({keywords:e})});if(!t.ok){const e=await t.json();throw new Error(e.error||"Failed to import keywords")}return t.json()},onSuccess:s=>{e.invalidateQueries({queryKey:["keywords"]}),T.success(s.message||"Keywords imported successfully")},onError:e=>{T.error(e.message||"Failed to import keywords")}}),n=E({mutationFn:async({id:e,updates:s})=>{const{data:t,error:a}=await r.from("keywords").update(s).eq("id",e).select().single();if(a)throw a;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["keywords"]}),T.success("Keyword updated successfully")},onError:e=>{T.error(e.message||"Failed to update keyword")}}),l=E({mutationFn:async e=>{const{error:s}=await r.from("keywords").delete().eq("id",e);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["keywords"]}),T.success("Keyword deleted successfully")},onError:e=>{T.error(e.message||"Failed to delete keyword")}});return{keywords:s,unusedKeywords:a,isLoading:t,importKeywords:e=>i.mutate(e),isImporting:i.isPending,updateKeyword:(e,s)=>n.mutate({id:e,updates:s}),deleteKeyword:e=>l.mutate(e)}}function Se(){const e=I(),s=K({queryKey:["article-webhooks"],queryFn:async()=>{const{data:e,error:s}=await r.from("article_webhooks").select("*").order("created_at",{ascending:!1});if(s)throw s;return e}}),t=E({mutationFn:async e=>{const{data:s}=await r.auth.getUser(),{data:t,error:a}=await r.from("article_webhooks").insert({...e,user_id:s.user?.id}).select().single();if(a)throw a;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["article-webhooks"]}),T.success("Webhook created successfully")},onError:e=>{T.error("Failed to create webhook: "+e.message)}}),a=E({mutationFn:async({id:e,updates:s})=>{const{error:t}=await r.from("article_webhooks").update(s).eq("id",e);if(t)throw t},onSuccess:()=>{e.invalidateQueries({queryKey:["article-webhooks"]}),T.success("Webhook updated successfully")},onError:e=>{T.error("Failed to update webhook: "+e.message)}}),i=E({mutationFn:async e=>{const{error:s}=await r.from("article_webhooks").delete().eq("id",e);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["article-webhooks"]}),T.success("Webhook deleted successfully")},onError:e=>{T.error("Failed to delete webhook: "+e.message)}}),n=E({mutationFn:async e=>{const{data:s,error:t}=await r.functions.invoke("test-article-webhook",{body:{webhookUrl:e}});if(t)throw t;return s},onSuccess:e=>{e?.success?T.success("Test payload sent successfully! Check your Make.com scenario."):T.error(e?.error||"Test failed")},onError:e=>{T.error("Failed to test webhook: "+e.message)}});return{webhooks:s.data,isLoading:s.isLoading,createWebhook:t.mutate,updateWebhook:a.mutate,deleteWebhook:i.mutate,testWebhook:n.mutate,isTesting:n.isPending,testResult:n.data}}function Ce(){const[t,a]=s.useState(!1),[r,f]=s.useState("keyword"),[v,w]=s.useState(""),[N,b]=s.useState(""),[k,_]=s.useState("Real Estate Tips"),[C,P]=s.useState(""),[I,K]=s.useState(""),[E,T]=s.useState(null),{generateArticle:L,isGenerating:D,createArticle:O}=ke(),{unusedKeywords:Q,isLoading:V}=_e();return e.jsxs(i,{open:t,onOpenChange:a,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{className:"gap-2",children:[e.jsx(G,{className:"h-4 w-4"}),"New Article"]})}),e.jsxs(o,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(c,{children:[e.jsx(d,{children:"Generate Blog Article"}),e.jsx(u,{children:"Create SEO-optimized real estate articles with AI assistance"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs(F,{value:r,onValueChange:e=>f(e),children:[e.jsxs(A,{className:"grid w-full grid-cols-2",children:[e.jsx(q,{value:"keyword",children:"From Keyword"}),e.jsx(q,{value:"manual",children:"Manual Topic"})]}),e.jsx(M,{value:"keyword",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"keyword-select",children:"Select Keyword (Optional - auto-selects if empty)"}),e.jsxs(x,{value:v,onValueChange:w,children:[e.jsx(p,{id:"keyword-select",children:e.jsx(j,{placeholder:"Auto-select unused keyword..."})}),e.jsx(g,{children:V?e.jsx(y,{value:"loading",disabled:!0,children:"Loading keywords..."}):0===Q.length?e.jsx(y,{value:"none",disabled:!0,children:"No keywords available"}):Q.map(s=>e.jsxs(y,{value:s.id,children:[s.keyword," (used ",s.usage_count," times)"]},s.id))})]})]})}),e.jsxs(M,{value:"manual",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"topic",children:"Article Topic *"}),e.jsx(h,{id:"topic",placeholder:"e.g., First-Time Homebuyer Tips for 2025",value:N,onChange:e=>b(e.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"keywords",children:"Target Keywords (comma-separated)"}),e.jsx(h,{id:"keywords",placeholder:"e.g., real estate, home buying, mortgage tips",value:C,onChange:e=>P(e.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"category",children:"Category"}),e.jsxs(x,{value:k,onValueChange:_,children:[e.jsx(p,{id:"category",children:e.jsx(j,{})}),e.jsxs(g,{children:[e.jsx(y,{value:"Real Estate Tips",children:"Real Estate Tips"}),e.jsx(y,{value:"Market Insights",children:"Market Insights"}),e.jsx(y,{value:"Buying Guide",children:"Buying Guide"}),e.jsx(y,{value:"Selling Guide",children:"Selling Guide"}),e.jsx(y,{value:"Investment",children:"Investment"}),e.jsx(y,{value:"Neighborhood Guides",children:"Neighborhood Guides"}),e.jsx(y,{value:"Home Improvement",children:"Home Improvement"}),e.jsx(y,{value:"General",children:"General"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"instructions",children:"Custom Instructions (Optional)"}),e.jsx(S,{id:"instructions",placeholder:"Add specific requirements, tone, or focus areas...",value:I,onChange:e=>K(e.target.value),rows:3})]}),e.jsx(l,{onClick:()=>{if("keyword"===r){const e=Q.find(e=>e.id===v);L({topic:e?.keyword,category:k,keywords:e?[e.keyword]:void 0,customInstructions:I||void 0,autoSelectKeyword:!v},{onSuccess:e=>{e.success&&(T(e.article),e.article.keywordId&&w(e.article.keywordId))}})}else{if(!N)return;L({topic:N,category:k,keywords:C?C.split(",").map(e=>e.trim()):void 0,customInstructions:I||void 0,autoSelectKeyword:!1},{onSuccess:e=>{e.success&&T(e.article)}})}},disabled:D||"manual"===r&&!N,className:"w-full gap-2",children:D?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 animate-spin"}),"Generating Article..."]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"h-4 w-4"}),"keyword"!==r||v?"Generate Article with AI":"Auto-Select Keyword & Generate"]})}),E&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:E.title}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Slug: ",E.slug]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:E.excerpt})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{children:"Article Content (Markdown)"}),e.jsx("div",{className:"p-4 bg-background border rounded-lg max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono",children:E.content})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"SEO Title:"}),e.jsx("p",{className:"text-muted-foreground",children:E.seoTitle})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"SEO Description:"}),e.jsx("p",{className:"text-muted-foreground",children:E.seoDescription})]})]}),e.jsx(l,{onClick:()=>{E&&O({title:E.title,slug:E.slug,content:E.content,excerpt:E.excerpt,category:E.category,tags:E.tags,seo_title:E.seoTitle,seo_description:E.seoDescription,seo_keywords:E.tags,keyword_id:"keyword"===r&&(E.keywordId||v)||null,status:"draft"},{onSuccess:()=>{a(!1),T(null),b(""),P(""),K(""),w("")}})},className:"w-full",children:"Save as Draft"})]})]})]})]})}function Fe(){const[t,a]=s.useState(!1),[r,x]=s.useState(""),[p,j]=s.useState(""),[g,y]=s.useState(!0),{createWebhook:f}=Se();return e.jsxs(i,{open:t,onOpenChange:a,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{variant:"outline",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Add Webhook"]})}),e.jsxs(o,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Add Article Webhook"}),e.jsx(u,{children:"Configure a webhook to receive article data when articles are published"})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),r.trim()&&p.trim()&&(f({name:r,webhook_url:p,is_active:g}),x(""),j(""),y(!0),a(!1))},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"name",children:"Webhook Name"}),e.jsx(h,{id:"name",placeholder:"My Social Platform",value:r,onChange:e=>x(e.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"url",children:"Webhook URL"}),e.jsx(h,{id:"url",type:"url",placeholder:"https://api.example.com/webhooks/article",value:p,onChange:e=>j(e.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{htmlFor:"active",children:"Active"}),e.jsx(P,{id:"active",checked:g,onCheckedChange:y})]}),e.jsx(l,{type:"submit",className:"w-full",children:"Create Webhook"})]})]})]})}function Ae(){const[t,a]=s.useState(!1),{importKeywords:r,isImporting:m}=_e(),h=s.useRef(null);return e.jsxs(i,{open:t,onOpenChange:a,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{variant:"outline",children:[e.jsx(J,{className:"h-4 w-4 mr-2"}),"Import Keywords"]})}),e.jsxs(o,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Import Keywords from CSV"}),e.jsx(u,{children:"Upload a CSV file with your keywords. New keywords will be added and existing ones will be skipped."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:[e.jsx("input",{ref:h,type:"file",accept:".csv",onChange:async e=>{const s=e.target.files?.[0];if(s)try{const e=(await s.text()).split("\n").filter(e=>e.trim());if(e.length<2)return void T.error("CSV file is empty or invalid");const t=e[0].split(",").map(e=>e.trim().toLowerCase()),i=e.slice(1).map(e=>{const s=e.split(",").map(e=>e.trim()),a={};return t.forEach((e,t)=>{s[t]&&(a[e]=s[t])}),a}).filter(e=>e.keyword);if(0===i.length)return void T.error("No valid keywords found in CSV");await r(i),a(!1),h.current&&(h.current.value="")}catch(t){T.error("Failed to parse CSV file")}},disabled:m,className:"hidden",id:"csv-upload"}),e.jsx("label",{htmlFor:"csv-upload",className:"cursor-pointer",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[m?e.jsx(W,{className:"h-8 w-8 animate-spin text-primary"}):e.jsx(J,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:m?"Importing...":"Click to upload CSV"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"CSV files only"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"CSV Format:"}),e.jsx("div",{className:"bg-muted p-3 rounded-md text-xs font-mono",children:"keyword,category,difficulty,search_volume,notes"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1 ml-4 list-disc",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"keyword"})," (required): The keyword phrase"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"category"}),": Real Estate, Luxury Real Estate, etc."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"difficulty"}),": easy, medium, or hard"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"search_volume"}),": Monthly search volume (number)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"notes"}),": Any additional notes"]})]})]}),e.jsxs(l,{onClick:()=>{const e=new Blob(["keyword,category,difficulty,search_volume,notes\nreal estate agent portfolio,Real Estate,medium,1000,Example keyword\nluxury home listings,Luxury Real Estate,hard,500,High-value properties\nfirst time home buyer tips,Real Estate,easy,2000,Educational content"],{type:"text/csv"}),s=window.URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download="keywords-template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(s),T.success("Template downloaded")},variant:"secondary",className:"w-full",children:[e.jsx(Z,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})]})]})}function qe(){const[t,a]=s.useState(!1),[m,x]=s.useState(""),[p,j]=s.useState("10"),{suggestions:g,isLoading:y,generateSuggestions:C,isGenerating:F,queueSuggestion:A,rejectSuggestion:q,deleteSuggestion:M,addToKeywords:P,writeArticle:L,isWritingArticle:D}=function(){const e=I(),{data:s=[],isLoading:t}=K({queryKey:["content-suggestions"],queryFn:async()=>{const{data:e,error:s}=await r.from("content_suggestions").select("*").order("priority",{ascending:!1}).order("created_at",{ascending:!1});if(s)throw s;return e}}),a=E({mutationFn:async({customInstructions:e,count:s})=>{const{data:{session:t}}=await r.auth.getSession();if(!t)throw new Error("Not authenticated");const a=await r.functions.invoke("generate-content-suggestions",{body:{customInstructions:e,count:s}});if(a.error)throw new Error(a.error.message||"Failed to generate suggestions");return a.data},onSuccess:()=>{e.invalidateQueries({queryKey:["content-suggestions"]}),T.success("Content suggestions generated successfully")},onError:e=>{T.error(e.message||"Failed to generate suggestions")}}),i=E({mutationFn:async({id:e,updates:s})=>{const{data:t,error:a}=await r.from("content_suggestions").update(s).eq("id",e).select().single();if(a)throw a;return t},onSuccess:()=>{e.invalidateQueries({queryKey:["content-suggestions"]})},onError:e=>{T.error(e.message||"Failed to update suggestion")}}),n=E({mutationFn:async e=>{const{error:s}=await r.from("content_suggestions").delete().eq("id",e);if(s)throw s},onSuccess:()=>{e.invalidateQueries({queryKey:["content-suggestions"]}),T.success("Suggestion deleted")},onError:e=>{T.error(e.message||"Failed to delete suggestion")}}),l=E({mutationFn:async e=>{const s=e.keywords||[e.topic],{data:{session:t}}=await r.auth.getSession();if(!t)throw new Error("Not authenticated");const a=await r.functions.invoke("import-keywords",{body:{keywords:s.map(s=>({keyword:s,category:e.category||"General"}))}});if(a.error)throw new Error(a.error.message||"Failed to add to keywords");return await r.from("content_suggestions").update({status:"completed"}).eq("id",e.id),a.data},onSuccess:()=>{e.invalidateQueries({queryKey:["content-suggestions"]}),e.invalidateQueries({queryKey:["keywords"]}),T.success("Added to keywords successfully")},onError:e=>{T.error(e.message||"Failed to add to keywords")}}),o=E({mutationFn:async e=>{const{data:{session:s}}=await r.auth.getSession();if(!s)throw new Error("Not authenticated");await r.from("content_suggestions").update({status:"queued"}).eq("id",e.id);const t=await r.functions.invoke("generate-article",{body:{topic:e.topic,category:e.category,keywords:e.keywords,autoSelectKeyword:!1}});if(t.error)throw new Error(t.error.message||"Failed to generate article");return await r.from("content_suggestions").update({status:"completed",generated_article_id:t.data?.article?.id}).eq("id",e.id),t.data},onSuccess:()=>{e.invalidateQueries({queryKey:["content-suggestions"]}),e.invalidateQueries({queryKey:["articles"]}),T.success("Article generated successfully")},onError:e=>{T.error(e.message||"Failed to generate article")}});return{suggestions:s,isLoading:t,generateSuggestions:(e,s)=>a.mutate({customInstructions:e,count:s}),isGenerating:a.isPending,updateSuggestion:(e,s)=>i.mutate({id:e,updates:s}),deleteSuggestion:e=>n.mutate(e),queueSuggestion:e=>i.mutate({id:e,updates:{status:"queued"}}),rejectSuggestion:e=>i.mutate({id:e,updates:{status:"rejected"}}),addToKeywords:e=>l.mutate(e),writeArticle:e=>o.mutate(e),isWritingArticle:o.isPending}}(),O=()=>{C(m,parseInt(p)||10),a(!1),x("")},U=e=>{switch(e){case"queued":return"bg-blue-500";case"in_progress":return"bg-yellow-500";case"completed":return"bg-green-500";case"rejected":return"bg-red-500";default:return"bg-gray-500"}},Q=s=>{const t=s||3;return t>=4?e.jsx(ie,{className:"h-3 w-3 text-red-500"}):t>=3?e.jsx(ie,{className:"h-3 w-3 text-orange-500"}):e.jsx(ie,{className:"h-3 w-3 text-gray-500"})},V=g.filter(e=>"pending"===e.status),z=g.filter(e=>"queued"===e.status);return e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"h-5 w-5"}),"AI Content Suggestions"]}),e.jsx(b,{children:"Generate high-value article ideas based on SEO keywords and market trends"})]}),e.jsxs(i,{open:t,onOpenChange:a,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Generate Suggestions"]})}),e.jsxs(o,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Generate Content Suggestions"}),e.jsx(u,{children:"AI will analyze your existing keywords and articles to suggest relevant topics"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Number of Suggestions"}),e.jsx(h,{type:"number",min:"1",max:"50",value:p,onChange:e=>j(e.target.value),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Custom Instructions (Optional)"}),e.jsx(S,{value:m,onChange:e=>x(e.target.value),placeholder:"E.g., Focus on first-time homebuyers in urban areas...",rows:4})]})]}),e.jsxs(f,{children:[e.jsx(l,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(l,{onClick:O,disabled:F,children:[F&&e.jsx(W,{className:"h-4 w-4 mr-2 animate-spin"}),"Generate"]})]})]})]})]})}),e.jsx(k,{children:y?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(W,{className:"h-8 w-8 animate-spin text-primary"})}):g.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:g.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:V.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Queued"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:z.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:g.filter(e=>"completed"===e.status).length})]})]}),e.jsx("div",{className:"space-y-3",children:g.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[Q(s.priority),e.jsx("h4",{className:"font-semibold",children:s.topic}),e.jsx(_,{className:`${U(s.status)} text-white text-xs`,children:s.status||"pending"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(_,{variant:"outline",children:s.category||"General"}),s.keywords?.slice(0,3).map((s,t)=>e.jsxs(_,{variant:"secondary",className:"gap-1",children:[e.jsx(ee,{className:"h-3 w-3"}),s]},t))]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:["pending"===s.status&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",size:"sm",onClick:()=>L(s),disabled:D,title:"Write Article Now",children:D?e.jsx(W,{className:"h-4 w-4 animate-spin"}):e.jsx(se,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>A(s.id),title:"Add to Queue",children:e.jsx(te,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>P(s),title:"Add to Keywords",children:e.jsx(ee,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>q(s.id),title:"Reject",children:e.jsx(ae,{className:"h-4 w-4"})})]}),"completed"===s.status&&e.jsx(l,{variant:"outline",size:"sm",disabled:!0,title:"Completed",children:e.jsx(re,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this suggestion?")&&M(s.id)},title:"Delete",children:e.jsx(B,{className:"h-4 w-4"})})]})]})},s.id))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Y,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No content suggestions yet. Generate AI-powered topic ideas to get started."}),e.jsxs(i,{open:t,onOpenChange:a,children:[e.jsx(n,{asChild:!0,children:e.jsxs(l,{children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Generate First Suggestions"]})}),e.jsxs(o,{children:[e.jsxs(c,{children:[e.jsx(d,{children:"Generate Content Suggestions"}),e.jsx(u,{children:"AI will analyze your existing keywords and articles to suggest relevant topics"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Number of Suggestions"}),e.jsx(h,{type:"number",min:"1",max:"50",value:p,onChange:e=>j(e.target.value),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Custom Instructions (Optional)"}),e.jsx(S,{value:m,onChange:e=>x(e.target.value),placeholder:"E.g., Focus on first-time homebuyers in urban areas...",rows:4})]})]}),e.jsxs(f,{children:[e.jsx(l,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsxs(l,{onClick:O,disabled:F,children:[F&&e.jsx(W,{className:"h-4 w-4 mr-2 animate-spin"}),"Generate"]})]})]})]})]})})]})}function Me(){const[t,a]=s.useState("all"),{articles:r,isLoading:i,deleteArticle:n,publishArticle:o,republishArticle:c,isRepublishing:d}=ke(),{keywords:u,isLoading:m}=_e(),{webhooks:h,isLoading:x,updateWebhook:p,deleteWebhook:j,testWebhook:g,isTesting:y}=Se(),f=e=>{switch(e){case"published":return"bg-green-500";case"scheduled":return"bg-blue-500";case"draft":default:return"bg-gray-500";case"archived":return"bg-orange-500"}};if(i)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(W,{className:"h-8 w-8 animate-spin text-primary"})});const S="all"===t?r:r?.filter(e=>e.status===t);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Blog Articles"}),e.jsx(b,{children:"Manage your real estate blog content and articles"})]}),e.jsx(Ce,{})]})}),e.jsx(k,{children:e.jsxs(F,{value:t,onValueChange:a,children:[e.jsxs(A,{children:[e.jsx(q,{value:"all",children:"All Articles"}),e.jsx(q,{value:"draft",children:"Drafts"}),e.jsx(q,{value:"scheduled",children:"Scheduled"}),e.jsx(q,{value:"published",children:"Published"})]}),e.jsx(M,{value:t,className:"space-y-4 mt-6",children:S&&S.length>0?S.map(s=>e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-lg",children:s.title}),e.jsx(_,{className:`${f(s.status)} text-white`,children:s.status})]}),s.excerpt&&e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[s.excerpt.substring(0,150),"..."]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx(_,{variant:"outline",children:s.category}),s.keyword_id&&e.jsxs(_,{variant:"secondary",className:"gap-1",children:[e.jsx(ee,{className:"h-3 w-3"}),u?.find(e=>e.id===s.keyword_id)?.keyword||"Keyword"]}),s.tags?.slice(0,2).map((s,t)=>e.jsx(_,{variant:"secondary",children:s},t))]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(z,{className:"h-3 w-3"}),s.view_count," views"]}),e.jsxs("span",{children:["Created: ",L(new Date(s.created_at),"MMM d, yyyy")]}),s.published_at&&e.jsxs("span",{children:["Published: ",L(new Date(s.published_at),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",title:"View",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",title:"Edit",children:e.jsx(R,{className:"h-4 w-4"})}),"draft"===s.status&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{confirm("Publish this article?")&&o(s.id)},title:"Publish",children:e.jsx(re,{className:"h-4 w-4"})}),"published"===s.status&&e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{confirm("Re-distribute this article to social platforms?")&&c(s.id)},disabled:d,title:"Re-publish to Social Media",children:d?e.jsx(W,{className:"h-4 w-4 animate-spin"}):e.jsx(V,{className:"h-4 w-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this article?")&&n(s.id)},title:"Delete",children:e.jsx(B,{className:"h-4 w-4"})})]})]})},s.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No articles found"}),e.jsx("div",{className:"mt-4",children:e.jsx(Ce,{})})]})})]})})]}),e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Keyword Management"}),e.jsx(b,{children:"Track SEO keyword usage across articles"})]}),e.jsx(Ae,{})]})}),e.jsx(k,{children:m?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(W,{className:"h-6 w-6 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Keywords"}),e.jsx("p",{className:"text-2xl font-bold",children:u?.length||0})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unused"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:u?.filter(e=>0===e.usage_count).length||0})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Most Used"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Math.max(...u?.map(e=>e.usage_count)||[0])})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Keywords are automatically tracked when articles are published. Import your keywords.csv to get started."})]})})]}),e.jsx(qe,{}),e.jsxs(v,{children:[e.jsx(w,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(N,{children:"Article Webhooks"}),e.jsx(b,{children:"Configure webhooks for automatic article distribution"})]}),e.jsx(Fe,{})]})}),e.jsx(k,{children:x?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(W,{className:"h-6 w-6 animate-spin text-primary"})}):h&&h.length>0?e.jsx("div",{className:"space-y-3",children:h.map(s=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:s.name}),e.jsx(_,{variant:s.is_active?"default":"secondary",children:s.is_active?"Active":"Inactive"})]}),e.jsxs("a",{href:s.webhook_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-muted-foreground hover:text-primary flex items-center gap-1",children:[s.webhook_url,e.jsx(ne,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{checked:s.is_active,onCheckedChange:e=>{p({id:s.id,updates:{is_active:e}})}}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this webhook?")&&j(s.id)},children:e.jsx(B,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"pt-3 border-t",children:e.jsx(l,{variant:"secondary",size:"sm",onClick:()=>g(s.webhook_url),disabled:y,className:"w-full",children:y?e.jsxs(e.Fragment,{children:[e.jsx(W,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Send Test Payload to Make.com"]})})})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No webhooks configured. Add one to automatically send published articles to external platforms."}),e.jsx(Fe,{})]})})]})]})}function Pe(){const{user:s,role:r}=C();return s&&"admin"===r?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(le,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage AI, content, and platform settings"})]})]}),e.jsx(a,{to:"/dashboard",children:e.jsxs(l,{variant:"outline",className:"gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),"Back to Dashboard"]})})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(F,{defaultValue:"ai",className:"space-y-6",children:[e.jsxs(A,{className:"grid w-full grid-cols-8 lg:w-auto",children:[e.jsxs(q,{value:"ai",className:"gap-2",children:[e.jsx(ce,{className:"h-4 w-4"}),"AI Settings"]}),e.jsxs(q,{value:"social",className:"gap-2",children:[e.jsx(de,{className:"h-4 w-4"}),"Social Media"]}),e.jsxs(q,{value:"articles",className:"gap-2",children:[e.jsx(ue,{className:"h-4 w-4"}),"Articles"]}),e.jsxs(q,{value:"keywords",className:"gap-2",children:[e.jsx(me,{className:"h-4 w-4"}),"Keywords"]}),e.jsxs(q,{value:"seo",className:"gap-2",children:[e.jsx(he,{className:"h-4 w-4"}),"SEO"]}),e.jsxs(q,{value:"analytics",className:"gap-2",children:[e.jsx(xe,{className:"h-4 w-4"}),"Search Analytics"]}),e.jsxs(q,{value:"users",className:"gap-2",children:[e.jsx(pe,{className:"h-4 w-4"}),"User Roles"]}),e.jsxs(q,{value:"settings",className:"gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Platform"]})]}),e.jsx(M,{value:"ai",className:"space-y-6",children:e.jsx(fe,{})}),e.jsx(M,{value:"social",className:"space-y-6",children:e.jsx(be,{})}),e.jsx(M,{value:"articles",className:"space-y-6",children:e.jsx(Me,{})}),e.jsx(M,{value:"keywords",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Keyword Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Import and manage keywords from CSV files"})]}),e.jsx(Ae,{})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use the import button to bulk upload keywords from a CSV file. Keywords help improve content generation and SEO optimization."})]})}),e.jsx(M,{value:"seo",className:"space-y-6",children:e.jsx(je,{})}),e.jsx(M,{value:"analytics",className:"space-y-6",children:e.jsx(ge,{})}),e.jsx(M,{value:"users",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"User Role Management"}),e.jsx("p",{className:"text-muted-foreground",children:"User role management interface coming soon..."})]})}),e.jsx(M,{value:"settings",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Platform Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Additional platform configuration coming soon..."})]})})]})})]}):e.jsx(t,{to:"/",replace:!0})}export{Pe as AdminDashboard};
