import{b as i,u as e,d as s}from"./data-O5cD9hjv.js";import{u as t,s as r}from"./supabase-C4LM9fgr.js";function n(){const{user:n}=t(),a=i(),{data:d=[],isLoading:o}=e({queryKey:["listings",n?.id],queryFn:async()=>{if(!n?.id)return[];const{data:i,error:e}=await r.from("listings").select("*").eq("user_id",n.id).order("created_at",{ascending:!1});if(e)throw e;return i},enabled:!!n?.id});return{listings:d,isLoading:o,addListing:s({mutationFn:async i=>{if(!n?.id)throw new Error("User not authenticated");const{data:e,error:s}=await r.from("listings").insert({user_id:n.id,...i}).select().single();if(s)throw s;return e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}}),updateListing:s({mutationFn:async({id:i,...e})=>{const{data:s,error:t}=await r.from("listings").update(e).eq("id",i).select().single();if(t)throw t;return s},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}}),deleteListing:s({mutationFn:async i=>{const{error:e}=await r.from("listings").delete().eq("id",i);if(e)throw e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}})}}export{n as u};
