import{r as o,j as e}from"./react-vendor-CotwlNTQ.js";import{D as B,l as J,m as X,n as Z,G as K,L as j,I as N,S as ee,a as te,b as se,d as ae,e as ne,O as le,j as C}from"./ui-components-XxFWEsul.js";import{I as A,F,f as T,r as E,Y as P,H as $,p as U,e as q,G as z,M as O,P as Y,N as _,aj as Q,a7 as L,X as re,aw as ie,aJ as oe,h as ce,ay as de,az as ue}from"./icons-CcUX9GkC.js";import{u as R}from"./index-sCAK2lXW.js";import{u as me}from"./useLinks-Dv63AFwz.js";import{u as xe,U as he}from"./UpgradeModal-D_pdeQ4u.js";import{L as pe}from"./LimitBanner-jBBOsfXl.js";import"./charts-hR54p0E0.js";import"./utils-BpArqNZu.js";import"./supabase-Ba7v9dZh.js";import"./data-15YcDnrk.js";import"./three-addons-CjyX6BZ_.js";import"./three-D6omocmH.js";import"./state-stores-BuSRU7CA.js";import"./forms-Dr9C5XML.js";const I=[{value:"instagram",label:"Instagram",icon:A},{value:"facebook",label:"Facebook",icon:F},{value:"linkedin",label:"LinkedIn",icon:T},{value:"tiktok",label:"TikTok",icon:E},{value:"youtube",label:"YouTube",icon:P},{value:"zillow",label:"Zillow",icon:$},{value:"realtor",label:"Realtor.com",icon:U},{value:"calendar",label:"Calendar",icon:q},{value:"website",label:"Website",icon:z},{value:"email",label:"Email",icon:O},{value:"phone",label:"Phone",icon:Y},{value:"whatsapp",label:"WhatsApp",icon:_},{value:"document",label:"Document",icon:Q},{value:"link",label:"Link",icon:L}];function ge({open:x,onOpenChange:c,onSave:u}){const[i,s]=o.useState({title:"",url:"",icon:"link",active:!0}),r=t=>{const{name:n,value:g}=t.target;s(v=>({...v,[n]:g}))},h=t=>{t.preventDefault(),u?.(i),c(!1),s({title:"",url:"",icon:"link",active:!0})};return e.jsx(B,{open:x,onOpenChange:c,children:e.jsxs(J,{className:"max-w-md",children:[e.jsxs(X,{children:[e.jsx(Z,{children:"Add Custom Link"}),e.jsx(K,{children:"Add a social media profile or custom link to your bio"})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"title",children:"Link Title *"}),e.jsx(N,{id:"title",name:"title",value:i.title,onChange:r,placeholder:"Schedule a Consultation",required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"url",children:"URL *"}),e.jsx(N,{id:"url",name:"url",type:"url",value:i.url,onChange:r,placeholder:"https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"icon",children:"Icon"}),e.jsxs(ee,{value:i.icon,onValueChange:t=>s(n=>({...n,icon:t})),children:[e.jsx(te,{children:e.jsx(se,{children:(()=>{const t=I.find(g=>g.value===i.icon),n=t?.icon||L;return e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{children:t?.label||"Custom"})]})})()})}),e.jsx(ae,{children:I.map(t=>{const n=t.icon;return e.jsx(ne,{value:t.value,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{children:t.label})]})},t.value)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:i.active,onChange:t=>s(n=>({...n,active:t.target.checked})),className:"rounded border-border"}),e.jsx(j,{htmlFor:"active",className:"cursor-pointer",children:"Active (visible on profile)"})]}),e.jsxs(le,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(C,{type:"submit",children:"Add Link"})]})]})]})})}function be({isOpen:x,onClose:c,onSubmit:u,initialData:i}){const[s,r]=o.useState(i);if(o.useEffect(()=>{r(i)},[i]),!x)return null;const h=t=>{t.preventDefault(),u(s)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg w-full max-w-md",children:[e.jsxs("div",{className:"border-b border-border p-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Edit Link"}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-accent rounded-lg transition-colors",children:e.jsx(re,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(j,{htmlFor:"title",children:"Link Title *"}),e.jsx(N,{id:"title",value:s.title,onChange:t=>r({...s,title:t.target.value}),placeholder:"e.g., My Website",required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"url",children:"URL *"}),e.jsx(N,{id:"url",type:"url",value:s.url,onChange:t=>r({...s,url:t.target.value}),placeholder:"https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(j,{htmlFor:"icon",children:"Icon (optional)"}),e.jsx(N,{id:"icon",value:s.icon||"",onChange:t=>r({...s,icon:t.target.value}),placeholder:"e.g., link, globe, home"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Icon name from Lucide icons"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(C,{type:"button",variant:"outline",onClick:c,className:"flex-1",children:"Cancel"}),e.jsx(C,{type:"submit",className:"flex-1",children:"Save Changes"})]})]})]})})}function fe(x){const{onDelete:c,deleteDelay:u=1e4,undoMessage:i,resourceName:s}=x,{toast:r}=R(),[h,t]=o.useState(new Map),n=o.useRef(h);n.current=h;const g=o.useCallback(async l=>{if(n.current.has(l.id))return;const m=setTimeout(async()=>{try{await c(l.id),t(f=>{const d=new Map(f);return d.delete(l.id),d}),r({title:`${s} deleted`,description:`Your ${s} has been permanently removed.`})}catch{r({title:"Deletion failed",description:`Failed to delete ${s}. Please try again.`,variant:"destructive"}),t(d=>{const w=new Map(d);return w.delete(l.id),w})}},u),b={id:l.id,data:l,timeoutId:m,timestamp:Date.now()};t(f=>{const d=new Map(f);return d.set(l.id,b),d});const{dismiss:p}=r({title:`${s} deleted`,description:i?.(l)||`Deleting ${s} in ${u/1e3} seconds...`,action:{label:"Undo",onClick:()=>{v(l.id),p()}},duration:u})},[c,u,i,s,r]),v=o.useCallback(l=>{const m=n.current.get(l);m&&(clearTimeout(m.timeoutId),t(b=>{const p=new Map(b);return p.delete(l),p}),r({title:"Deletion cancelled",description:`Your ${s} has been restored.`}))},[s,r]),D=o.useCallback(l=>n.current.has(l),[]),M=o.useCallback(()=>Array.from(n.current.values()).map(l=>l.data),[]),S=o.useCallback(()=>{n.current.forEach(l=>{clearTimeout(l.timeoutId)}),t(new Map),n.current.size>0&&r({title:"All deletions cancelled",description:`${n.current.size} ${s}${n.current.size>1?"s":""} restored.`})},[s,r]),y=o.useCallback(async l=>{const m=n.current.get(l);if(m){clearTimeout(m.timeoutId),t(b=>{const p=new Map(b);return p.delete(l),p});try{await c(l),r({title:`${s} deleted`,description:`Your ${s} has been permanently removed.`})}catch{r({title:"Deletion failed",description:`Failed to delete ${s}. Please try again.`,variant:"destructive"})}}},[c,s,r]);return{softDelete:g,undoDelete:v,isPendingDeletion:D,getPendingDeletions:M,cancelAllDeletions:S,forceDelete:y,pendingCount:h.size}}const je=x=>({calendar:q,instagram:A,facebook:F,zillow:$,link:L,linkedin:T,tiktok:E,youtube:P,realtor:U,website:z,email:O,phone:Y,whatsapp:_,document:Q})[x]||L;function $e(){const[x,c]=o.useState(!1),[u,i]=o.useState(!1),[s,r]=o.useState(null),[h,t]=o.useState(!1),{toast:n}=R(),{links:g,isLoading:v,addLink:D,updateLink:M,deleteLink:S}=me(),{subscription:y,canAdd:l,getLimit:m,getUsage:b}=xe(),{softDelete:p,isPendingDeletion:f}=fe({onDelete:async a=>{await S.mutateAsync(a)},deleteDelay:1e4,resourceName:"link",undoMessage:a=>`"${a.title}" will be deleted in 10 seconds. Click Undo to cancel.`}),d=o.useMemo(()=>g.filter(a=>!f(a.id)),[g,f]),w=()=>{if(!l("links")){t(!0);return}c(!0)},G=async a=>{try{await D.mutateAsync(a),n({title:"Link added!",description:"Your custom link has been created successfully."})}catch{n({title:"Error",description:"Failed to add link. Please try again.",variant:"destructive"})}},H=a=>{r(a),i(!0)},V=async(a,k)=>{try{await M.mutateAsync({id:a,...k}),n({title:"Link updated!",description:"Your link has been updated successfully."})}catch{n({title:"Error",description:"Failed to update link. Please try again.",variant:"destructive"})}},W=a=>{p(a)};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Custom Links"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Manage your social and custom links"})]}),e.jsxs("button",{onClick:w,className:"inline-flex items-center gap-2 px-4 py-2.5 sm:py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 active:scale-95 transition-all font-medium min-h-[44px] w-full sm:w-auto justify-center shadow-sm",children:[e.jsx(ie,{className:"h-4 w-4 sm:h-5 sm:w-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Add Link"})]})]}),y&&m("links")!==1/0&&e.jsx(pe,{feature:"links",current:b("links"),limit:m("links")}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-foreground",children:d.length}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Total"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:d.filter(a=>a.is_active).length}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Active"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary",children:d.reduce((a,k)=>a+k.click_count,0)}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Clicks"})]})]}),e.jsx("div",{className:"bg-card border border-border rounded-lg divide-y divide-border",children:v?e.jsx("div",{className:"p-6 sm:p-8 text-center text-muted-foreground text-sm sm:text-base",children:"Loading links..."}):d.length===0?e.jsx("div",{className:"p-6 sm:p-8 text-center text-muted-foreground text-sm sm:text-base",children:'No links yet. Click "Add Link" to create your first link.'}):d.map(a=>e.jsxs("div",{className:"p-3 sm:p-4 flex items-center gap-2 sm:gap-4 hover:bg-accent/50 active:bg-accent/70 transition-colors",children:[e.jsx("button",{className:"cursor-grab active:cursor-grabbing p-1.5 hover:bg-accent rounded hidden sm:block min-h-[44px]","aria-label":"Drag to reorder",children:e.jsx(oe,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center bg-accent rounded-lg flex-shrink-0",children:(()=>{const k=je(a.icon);return e.jsx(k,{className:"h-5 w-5 sm:h-6 sm:w-6 text-foreground"})})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-0.5 sm:mb-1 flex-wrap",children:[e.jsx("h3",{className:"font-medium text-sm sm:text-base text-foreground truncate",children:a.title}),a.is_active?e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full font-medium flex-shrink-0",children:"Active"}):e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gray-100 text-gray-700 text-xs rounded-full font-medium flex-shrink-0",children:"Inactive"})]}),e.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs sm:text-sm text-muted-foreground hover:text-primary active:text-primary flex items-center gap-1 truncate",children:[e.jsx("span",{className:"truncate",children:a.url}),e.jsx(ce,{className:"h-3 w-3 flex-shrink-0"})]}),e.jsxs("div",{className:"sm:hidden mt-1.5 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-semibold text-foreground",children:a.click_count})," clicks"]})]}),e.jsxs("div",{className:"text-right hidden sm:block flex-shrink-0",children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:a.click_count}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"clicks"})]}),e.jsxs("div",{className:"flex items-center gap-0.5 sm:gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>H(a),className:"p-2 sm:p-2.5 hover:bg-accent active:bg-accent/80 rounded-lg transition-all min-w-[44px] min-h-[44px] flex items-center justify-center","aria-label":"Edit link",children:e.jsx(de,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("button",{onClick:()=>W(a),className:"p-2 sm:p-2.5 hover:bg-red-50 active:bg-red-100 rounded-lg transition-all min-w-[44px] min-h-[44px] flex items-center justify-center","aria-label":"Delete link",children:e.jsx(ue,{className:"h-4 w-4 text-red-500"})})]})]},a.id))}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg p-3 sm:p-4",children:e.jsxs("p",{className:"text-xs sm:text-sm text-blue-800 dark:text-blue-200 leading-relaxed",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Drag and drop links to reorder them."}),e.jsx("span",{className:"sm:hidden",children:"Use the edit option to change link details."})," The order here will reflect on your public profile page."]})}),e.jsx(ge,{open:x,onOpenChange:c,onSave:G}),e.jsx(be,{open:u,onOpenChange:i,link:s,onSave:V}),e.jsx(he,{open:h,onOpenChange:t,feature:"links",currentPlan:y?.plan_name||"Free",requiredPlan:"Starter"})]})}export{$e as default};
