import{r as e,j as m}from"./index-CjfB9Lcv.js";import{R as _,P as z,u as x,D as d,M as S,V as w,C as j}from"./react-three-fiber.esm-Besn7eJf.js";function f(){return f=Object.assign?Object.assign.bind():function(a){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var o in t)({}).hasOwnProperty.call(t,o)&&(a[o]=t[o])}return a},f.apply(null,arguments)}const U=()=>parseInt(_.replace(/\D+/g,"")),M=U(),h=M>=154?"opaque_fragment":"output_fragment";class C extends z{constructor(r){super(r),this.onBeforeCompile=(t,o)=>{const{isWebGL2:s}=o.capabilities;t.fragmentShader=t.fragmentShader.replace(`#include <${h}>`,`
        ${s?`#include <${h}>`:`#extension GL_OES_standard_derivatives : enable
#include <${h}>`}
      vec2 cxy = 2.0 * gl_PointCoord - 1.0;
      float r = dot(cxy, cxy);
      float delta = fwidth(r);     
      float mask = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);
      gl_FragColor = vec4(gl_FragColor.rgb, mask * gl_FragColor.a );
      #include <tonemapping_fragment>
      #include <${M>=154?"colorspace_fragment":"encodings_fragment"}>
      `)}}}const F=e.forwardRef((a,r)=>{const[t]=e.useState(()=>new C(null));return e.createElement("primitive",f({},a,{object:t,ref:r,attach:"material"}))});let l,p;const I=e.createContext(null),v=new S,A=new w,D=e.forwardRef(({children:a,range:r,limit:t=1e3,...o},s)=>{const n=e.useRef(null);e.useImperativeHandle(s,()=>n.current,[]);const[u,c]=e.useState([]),[[i,g,b]]=e.useState(()=>[new Float32Array(t*3),Float32Array.from({length:t*3},()=>1),Float32Array.from({length:t},()=>1)]);e.useEffect(()=>{n.current.geometry.attributes.position.needsUpdate=!0}),x(()=>{for(n.current.updateMatrix(),n.current.updateMatrixWorld(),v.copy(n.current.matrixWorld).invert(),n.current.geometry.drawRange.count=Math.min(t,r!==void 0?r:t,u.length),l=0;l<u.length;l++)p=u[l].current,p.getWorldPosition(A).applyMatrix4(v),A.toArray(i,l*3),n.current.geometry.attributes.position.needsUpdate=!0,p.matrixWorldNeedsUpdate=!0,p.color.toArray(g,l*3),n.current.geometry.attributes.color.needsUpdate=!0,b.set([p.size],l),n.current.geometry.attributes.size.needsUpdate=!0});const P=e.useMemo(()=>({getParent:()=>n,subscribe:E=>(c(y=>[...y,E]),()=>c(y=>y.filter(R=>R.current!==E.current)))}),[]);return e.createElement("points",f({userData:{instances:u},matrixAutoUpdate:!1,ref:n,raycast:()=>null},o),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",count:i.length/3,array:i,itemSize:3,usage:d}),e.createElement("bufferAttribute",{attach:"attributes-color",count:g.length/3,array:g,itemSize:3,usage:d}),e.createElement("bufferAttribute",{attach:"attributes-size",count:b.length,array:b,itemSize:1,usage:d})),e.createElement(I.Provider,{value:P},a))}),W=e.forwardRef(({children:a,positions:r,colors:t,sizes:o,stride:s=3,...n},u)=>{const c=e.useRef(null);return e.useImperativeHandle(u,()=>c.current,[]),x(()=>{const i=c.current.geometry.attributes;i.position.needsUpdate=!0,t&&(i.color.needsUpdate=!0),o&&(i.size.needsUpdate=!0)}),e.createElement("points",f({ref:c},n),e.createElement("bufferGeometry",null,e.createElement("bufferAttribute",{attach:"attributes-position",count:r.length/s,array:r,itemSize:s,usage:d}),t&&e.createElement("bufferAttribute",{attach:"attributes-color",count:t.length/s,array:t,itemSize:3,usage:d}),o&&e.createElement("bufferAttribute",{attach:"attributes-size",count:o.length/s,array:o,itemSize:1,usage:d})),a)}),k=e.forwardRef((a,r)=>a.positions instanceof Float32Array?e.createElement(W,f({},a,{ref:r})):e.createElement(D,f({},a,{ref:r})));function O({count:a,color:r}){const t=e.useRef(null),o=e.useMemo(()=>{const s=new Float32Array(a*3);for(let n=0;n<a;n++){const u=(Math.random()-.5)*10,c=(Math.random()-.5)*10,i=(Math.random()-.5)*10;s.set([u,c,i],n*3)}return s},[a]);return x(s=>{t.current&&(t.current.rotation.x=s.clock.getElapsedTime()*.05,t.current.rotation.y=s.clock.getElapsedTime()*.075)}),m.jsx(k,{ref:t,positions:o,stride:3,frustumCulled:!1,children:m.jsx(F,{transparent:!0,color:r,size:.02,sizeAttenuation:!0,depthWrite:!1})})}function V({variant:a,color:r="#2563eb"}){return m.jsx("div",{className:"fixed inset-0 -z-10 opacity-30",children:m.jsxs(j,{camera:{position:[0,0,5],fov:75},children:[m.jsx("ambientLight",{intensity:.5}),a==="particles"&&m.jsx(O,{count:3e3,color:r})]})})}export{V as ThreeDBackground};
