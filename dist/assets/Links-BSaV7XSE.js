import{r as o,j as e,ad as V,ae as J,ap as K,af as X,ag as Z,L as v,I as N,D as ee,F as te,G as se,a1 as A,ai as F,aj as T,aG as E,aH as P,H as $,a3 as q,O as U,bg as O,M as Y,a4 as _,bh as z,J as ae,K as ne,aW as re,B as C,Y as le,b as Q,aq as ie}from"./index-Dg7t10xs.js";import{F as R}from"./file-text-DJi4imDt.js";import{L}from"./link-DUXGHs3w.js";import{u as oe}from"./useLinks-CJ-kKIwy.js";import{u as ce,U as de}from"./UpgradeModal-0V9kMiXm.js";import{L as ue}from"./LimitBanner-Glx-QkL5.js";import{P as me}from"./plus-B4PiA_hc.js";import{G as xe}from"./grip-vertical-Czejf_Ft.js";import{S as he}from"./square-pen-_ENiPF_n.js";import{T as pe}from"./trash-2-DLTqSZQN.js";import"./useMutation-CweEGHKB.js";import"./alert-BgTh4CPa.js";import"./progress-Ck0_HLf-.js";import"./triangle-alert-nF7r4pnY.js";const I=[{value:"instagram",label:"Instagram",icon:A},{value:"facebook",label:"Facebook",icon:F},{value:"linkedin",label:"LinkedIn",icon:T},{value:"tiktok",label:"TikTok",icon:E},{value:"youtube",label:"YouTube",icon:P},{value:"zillow",label:"Zillow",icon:$},{value:"realtor",label:"Realtor.com",icon:q},{value:"calendar",label:"Calendar",icon:U},{value:"website",label:"Website",icon:O},{value:"email",label:"Email",icon:Y},{value:"phone",label:"Phone",icon:_},{value:"whatsapp",label:"WhatsApp",icon:z},{value:"document",label:"Document",icon:R},{value:"link",label:"Link",icon:L}];function ge({open:x,onOpenChange:c,onSave:u}){const[i,s]=o.useState({title:"",url:"",icon:"link",active:!0}),l=t=>{const{name:n,value:g}=t.target;s(j=>({...j,[n]:g}))},h=t=>{t.preventDefault(),u?.(i),c(!1),s({title:"",url:"",icon:"link",active:!0})};return e.jsx(V,{open:x,onOpenChange:c,children:e.jsxs(J,{className:"max-w-md",children:[e.jsxs(K,{children:[e.jsx(X,{children:"Add Custom Link"}),e.jsx(Z,{children:"Add a social media profile or custom link to your bio"})]}),e.jsxs("form",{onSubmit:h,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"title",children:"Link Title *"}),e.jsx(N,{id:"title",name:"title",value:i.title,onChange:l,placeholder:"Schedule a Consultation",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"url",children:"URL *"}),e.jsx(N,{id:"url",name:"url",type:"url",value:i.url,onChange:l,placeholder:"https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"icon",children:"Icon"}),e.jsxs(ee,{value:i.icon,onValueChange:t=>s(n=>({...n,icon:t})),children:[e.jsx(te,{children:e.jsx(se,{children:(()=>{const t=I.find(g=>g.value===i.icon),n=t?.icon||L;return e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{children:t?.label||"Custom"})]})})()})}),e.jsx(ae,{children:I.map(t=>{const n=t.icon;return e.jsx(ne,{value:t.value,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{children:t.label})]})},t.value)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:i.active,onChange:t=>s(n=>({...n,active:t.target.checked})),className:"rounded border-border"}),e.jsx(v,{htmlFor:"active",className:"cursor-pointer",children:"Active (visible on profile)"})]}),e.jsxs(re,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(C,{type:"submit",children:"Add Link"})]})]})]})})}function be({isOpen:x,onClose:c,onSubmit:u,initialData:i}){const[s,l]=o.useState(i);if(o.useEffect(()=>{l(i)},[i]),!x)return null;const h=t=>{t.preventDefault(),u(s)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg w-full max-w-md",children:[e.jsxs("div",{className:"border-b border-border p-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Edit Link"}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-accent rounded-lg transition-colors",children:e.jsx(le,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:h,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(v,{htmlFor:"title",children:"Link Title *"}),e.jsx(N,{id:"title",value:s.title,onChange:t=>l({...s,title:t.target.value}),placeholder:"e.g., My Website",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"url",children:"URL *"}),e.jsx(N,{id:"url",type:"url",value:s.url,onChange:t=>l({...s,url:t.target.value}),placeholder:"https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(v,{htmlFor:"icon",children:"Icon (optional)"}),e.jsx(N,{id:"icon",value:s.icon||"",onChange:t=>l({...s,icon:t.target.value}),placeholder:"e.g., link, globe, home"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Icon name from Lucide icons"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(C,{type:"button",variant:"outline",onClick:c,className:"flex-1",children:"Cancel"}),e.jsx(C,{type:"submit",className:"flex-1",children:"Save Changes"})]})]})]})})}function fe(x){const{onDelete:c,deleteDelay:u=1e4,undoMessage:i,resourceName:s}=x,{toast:l}=Q(),[h,t]=o.useState(new Map),n=o.useRef(h);n.current=h;const g=o.useCallback(async r=>{if(n.current.has(r.id))return;const m=setTimeout(async()=>{try{await c(r.id),t(f=>{const d=new Map(f);return d.delete(r.id),d}),l({title:`${s} deleted`,description:`Your ${s} has been permanently removed.`})}catch{l({title:"Deletion failed",description:`Failed to delete ${s}. Please try again.`,variant:"destructive"}),t(d=>{const w=new Map(d);return w.delete(r.id),w})}},u),b={id:r.id,data:r,timeoutId:m,timestamp:Date.now()};t(f=>{const d=new Map(f);return d.set(r.id,b),d});const{dismiss:p}=l({title:`${s} deleted`,description:i?.(r)||`Deleting ${s} in ${u/1e3} seconds...`,action:{label:"Undo",onClick:()=>{j(r.id),p()}},duration:u})},[c,u,i,s,l]),j=o.useCallback(r=>{const m=n.current.get(r);m&&(clearTimeout(m.timeoutId),t(b=>{const p=new Map(b);return p.delete(r),p}),l({title:"Deletion cancelled",description:`Your ${s} has been restored.`}))},[s,l]),D=o.useCallback(r=>n.current.has(r),[]),M=o.useCallback(()=>Array.from(n.current.values()).map(r=>r.data),[]),S=o.useCallback(()=>{n.current.forEach(r=>{clearTimeout(r.timeoutId)}),t(new Map),n.current.size>0&&l({title:"All deletions cancelled",description:`${n.current.size} ${s}${n.current.size>1?"s":""} restored.`})},[s,l]),y=o.useCallback(async r=>{const m=n.current.get(r);if(m){clearTimeout(m.timeoutId),t(b=>{const p=new Map(b);return p.delete(r),p});try{await c(r),l({title:`${s} deleted`,description:`Your ${s} has been permanently removed.`})}catch{l({title:"Deletion failed",description:`Failed to delete ${s}. Please try again.`,variant:"destructive"})}}},[c,s,l]);return{softDelete:g,undoDelete:j,isPendingDeletion:D,getPendingDeletions:M,cancelAllDeletions:S,forceDelete:y,pendingCount:h.size}}const ve=x=>({calendar:U,instagram:A,facebook:F,zillow:$,link:L,linkedin:T,tiktok:E,youtube:P,realtor:q,website:O,email:Y,phone:_,whatsapp:z,document:R})[x]||L;function Pe(){const[x,c]=o.useState(!1),[u,i]=o.useState(!1),[s,l]=o.useState(null),[h,t]=o.useState(!1),{toast:n}=Q(),{links:g,isLoading:j,addLink:D,updateLink:M,deleteLink:S}=oe(),{subscription:y,canAdd:r,getLimit:m,getUsage:b}=ce(),{softDelete:p,isPendingDeletion:f}=fe({onDelete:async a=>{await S.mutateAsync(a)},deleteDelay:1e4,resourceName:"link",undoMessage:a=>`"${a.title}" will be deleted in 10 seconds. Click Undo to cancel.`}),d=o.useMemo(()=>g.filter(a=>!f(a.id)),[g,f]),w=()=>{if(!r("links")){t(!0);return}c(!0)},G=async a=>{try{await D.mutateAsync(a),n({title:"Link added!",description:"Your custom link has been created successfully."})}catch{n({title:"Error",description:"Failed to add link. Please try again.",variant:"destructive"})}},H=a=>{l(a),i(!0)},W=async(a,k)=>{try{await M.mutateAsync({id:a,...k}),n({title:"Link updated!",description:"Your link has been updated successfully."})}catch{n({title:"Error",description:"Failed to update link. Please try again.",variant:"destructive"})}},B=a=>{p(a)};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Custom Links"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Manage your social and custom links"})]}),e.jsxs("button",{onClick:w,className:"inline-flex items-center gap-2 px-4 py-2.5 sm:py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 active:scale-95 transition-all font-medium min-h-[44px] w-full sm:w-auto justify-center shadow-sm",children:[e.jsx(me,{className:"h-4 w-4 sm:h-5 sm:w-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Add Link"})]})]}),y&&m("links")!==1/0&&e.jsx(ue,{feature:"links",current:b("links"),limit:m("links")}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-foreground",children:d.length}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Total"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:d.filter(a=>a.is_active).length}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Active"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary",children:d.reduce((a,k)=>a+k.click_count,0)}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Clicks"})]})]}),e.jsx("div",{className:"bg-card border border-border rounded-lg divide-y divide-border",children:j?e.jsx("div",{className:"p-6 sm:p-8 text-center text-muted-foreground text-sm sm:text-base",children:"Loading links..."}):d.length===0?e.jsx("div",{className:"p-6 sm:p-8 text-center text-muted-foreground text-sm sm:text-base",children:'No links yet. Click "Add Link" to create your first link.'}):d.map(a=>e.jsxs("div",{className:"p-3 sm:p-4 flex items-center gap-2 sm:gap-4 hover:bg-accent/50 active:bg-accent/70 transition-colors",children:[e.jsx("button",{className:"cursor-grab active:cursor-grabbing p-1.5 hover:bg-accent rounded hidden sm:block min-h-[44px]","aria-label":"Drag to reorder",children:e.jsx(xe,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center bg-accent rounded-lg flex-shrink-0",children:(()=>{const k=ve(a.icon);return e.jsx(k,{className:"h-5 w-5 sm:h-6 sm:w-6 text-foreground"})})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-0.5 sm:mb-1 flex-wrap",children:[e.jsx("h3",{className:"font-medium text-sm sm:text-base text-foreground truncate",children:a.title}),a.is_active?e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full font-medium flex-shrink-0",children:"Active"}):e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gray-100 text-gray-700 text-xs rounded-full font-medium flex-shrink-0",children:"Inactive"})]}),e.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs sm:text-sm text-muted-foreground hover:text-primary active:text-primary flex items-center gap-1 truncate",children:[e.jsx("span",{className:"truncate",children:a.url}),e.jsx(ie,{className:"h-3 w-3 flex-shrink-0"})]}),e.jsxs("div",{className:"sm:hidden mt-1.5 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-semibold text-foreground",children:a.click_count})," clicks"]})]}),e.jsxs("div",{className:"text-right hidden sm:block flex-shrink-0",children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:a.click_count}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"clicks"})]}),e.jsxs("div",{className:"flex items-center gap-0.5 sm:gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>H(a),className:"p-2 sm:p-2.5 hover:bg-accent active:bg-accent/80 rounded-lg transition-all min-w-[44px] min-h-[44px] flex items-center justify-center","aria-label":"Edit link",children:e.jsx(he,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("button",{onClick:()=>B(a),className:"p-2 sm:p-2.5 hover:bg-red-50 active:bg-red-100 rounded-lg transition-all min-w-[44px] min-h-[44px] flex items-center justify-center","aria-label":"Delete link",children:e.jsx(pe,{className:"h-4 w-4 text-red-500"})})]})]},a.id))}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg p-3 sm:p-4",children:e.jsxs("p",{className:"text-xs sm:text-sm text-blue-800 dark:text-blue-200 leading-relaxed",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Drag and drop links to reorder them."}),e.jsx("span",{className:"sm:hidden",children:"Use the edit option to change link details."})," The order here will reflect on your public profile page."]})}),e.jsx(ge,{open:x,onOpenChange:c,onSave:G}),e.jsx(be,{open:u,onOpenChange:i,link:s,onSave:W}),e.jsx(de,{open:h,onOpenChange:t,feature:"links",currentPlan:y?.plan_name||"Free",requiredPlan:"Starter"})]})}export{Pe as default};
