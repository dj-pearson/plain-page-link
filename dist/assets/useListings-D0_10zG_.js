import{b as i,u as e,d as t}from"./data-CgUGl6mg.js";import{u as s,s as r}from"./index-C7_cC08V.js";function n(){const{user:n}=s(),a=i(),{data:d=[],isLoading:o}=e({queryKey:["listings",n?.id],queryFn:async()=>{if(!n?.id)return[];const{data:i,error:e}=await r.from("listings").select("*").eq("user_id",n.id).order("created_at",{ascending:!1});if(e)throw e;return i},enabled:!!n?.id});return{listings:d,isLoading:o,addListing:t({mutationFn:async i=>{if(!n?.id)throw new Error("User not authenticated");const{data:e,error:t}=await r.from("listings").insert({user_id:n.id,...i}).select().single();if(t)throw t;return e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}}),updateListing:t({mutationFn:async({id:i,...e})=>{const{data:t,error:s}=await r.from("listings").update(e).eq("id",i).select().single();if(s)throw s;return t},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}}),deleteListing:t({mutationFn:async i=>{const{error:e}=await r.from("listings").delete().eq("id",i);if(e)throw e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}})}}export{n as u};
