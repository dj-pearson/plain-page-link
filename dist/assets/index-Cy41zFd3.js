import{ay as z,r as s,aO as H,j as d,aN as V,az as G,aA as m,aw as q,aM as J,ax as Q,aP as W}from"./index-CIfNOF3i.js";var y="rovingFocusGroup.onEntryFocus",X={bubbles:!1,cancelable:!0},I="RovingFocusGroup",[_,N,Z]=H(I),[$,ie]=z(I,[Z]),[ee,te]=$(I),O=s.forwardRef((e,r)=>d.jsx(_.Provider,{scope:e.__scopeRovingFocusGroup,children:d.jsx(_.Slot,{scope:e.__scopeRovingFocusGroup,children:d.jsx(oe,{...e,ref:r})})}));O.displayName=I;var oe=s.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:a,orientation:t,loop:w=!1,dir:T,currentTabStopId:v,defaultCurrentTabStopId:C,onCurrentTabStopIdChange:S,onEntryFocus:p,preventScrollOnEntryFocus:c=!1,...b}=e,F=s.useRef(null),g=q(r,F),R=J(T),[E,o]=Q({prop:v,defaultProp:C??null,onChange:S,caller:I}),[i,x]=s.useState(!1),u=W(p),l=N(a),h=s.useRef(!1),[k,P]=s.useState(0);return s.useEffect(()=>{const n=F.current;if(n)return n.addEventListener(y,u),()=>n.removeEventListener(y,u)},[u]),d.jsx(ee,{scope:a,orientation:t,dir:R,loop:w,currentTabStopId:E,onItemFocus:s.useCallback(n=>o(n),[o]),onItemShiftTab:s.useCallback(()=>x(!0),[]),onFocusableItemAdd:s.useCallback(()=>P(n=>n+1),[]),onFocusableItemRemove:s.useCallback(()=>P(n=>n-1),[]),children:d.jsx(G.div,{tabIndex:i||k===0?-1:0,"data-orientation":t,...b,ref:g,style:{outline:"none",...e.style},onMouseDown:m(e.onMouseDown,()=>{h.current=!0}),onFocus:m(e.onFocus,n=>{const L=!h.current;if(n.target===n.currentTarget&&L&&!i){const D=new CustomEvent(y,X);if(n.currentTarget.dispatchEvent(D),!D.defaultPrevented){const A=l().filter(f=>f.focusable),U=A.find(f=>f.active),B=A.find(f=>f.id===E),Y=[U,B,...A].filter(Boolean).map(f=>f.ref.current);j(Y,c)}}h.current=!1}),onBlur:m(e.onBlur,()=>x(!1))})})}),K="RovingFocusGroupItem",M=s.forwardRef((e,r)=>{const{__scopeRovingFocusGroup:a,focusable:t=!0,active:w=!1,tabStopId:T,children:v,...C}=e,S=V(),p=T||S,c=te(K,a),b=c.currentTabStopId===p,F=N(a),{onFocusableItemAdd:g,onFocusableItemRemove:R,currentTabStopId:E}=c;return s.useEffect(()=>{if(t)return g(),()=>R()},[t,g,R]),d.jsx(_.ItemSlot,{scope:a,id:p,focusable:t,active:w,children:d.jsx(G.span,{tabIndex:b?0:-1,"data-orientation":c.orientation,...C,ref:r,onMouseDown:m(e.onMouseDown,o=>{t?c.onItemFocus(p):o.preventDefault()}),onFocus:m(e.onFocus,()=>c.onItemFocus(p)),onKeyDown:m(e.onKeyDown,o=>{if(o.key==="Tab"&&o.shiftKey){c.onItemShiftTab();return}if(o.target!==o.currentTarget)return;const i=se(o,c.orientation,c.dir);if(i!==void 0){if(o.metaKey||o.ctrlKey||o.altKey||o.shiftKey)return;o.preventDefault();let u=F().filter(l=>l.focusable).map(l=>l.ref.current);if(i==="last")u.reverse();else if(i==="prev"||i==="next"){i==="prev"&&u.reverse();const l=u.indexOf(o.currentTarget);u=c.loop?ae(u,l+1):u.slice(l+1)}setTimeout(()=>j(u))}}),children:typeof v=="function"?v({isCurrentTabStop:b,hasTabStop:E!=null}):v})})});M.displayName=K;var re={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function ne(e,r){return r!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function se(e,r,a){const t=ne(e.key,a);if(!(r==="vertical"&&["ArrowLeft","ArrowRight"].includes(t))&&!(r==="horizontal"&&["ArrowUp","ArrowDown"].includes(t)))return re[t]}function j(e,r=!1){const a=document.activeElement;for(const t of e)if(t===a||(t.focus({preventScroll:r}),document.activeElement!==a))return}function ae(e,r){return e.map((a,t)=>e[(r+t)%e.length])}var le=O,fe=M;export{fe as I,le as R,ie as c};
