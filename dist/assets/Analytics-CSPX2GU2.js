import{j as e,r as T}from"./react-vendor-CotwlNTQ.js";import{C as f,f as y,g as v,c as C,o as N,h as w,Z as K,_,$ as L,a0 as j,j as p,a1 as A,a2 as h,B as k,J as D,K as V,M as S,N as B}from"./ui-components-XxFWEsul.js";import{R,L as z,b as P,B as U,d as q,A as E,e as F,C as $,X as M,Y as O,T as H,f as W}from"./charts-hR54p0E0.js";import{f as Y}from"./index-sCAK2lXW.js";import{a0 as X,M as G,P as I,a as J,C as Z,e as Q,a1 as ee,B as se,S as ae,E as te,U as re,aK as le,T as ne}from"./icons-CcUX9GkC.js";import{S as ie}from"./SearchAnalyticsDashboard-Crfl8AoM.js";import{u as ce}from"./useAnalytics-CPuG7fZh.js";import"./utils-BpArqNZu.js";import"./supabase-Ba7v9dZh.js";import"./data-15YcDnrk.js";import"./three-addons-CjyX6BZ_.js";import"./three-D6omocmH.js";import"./state-stores-BuSRU7CA.js";import"./forms-Dr9C5XML.js";function b({title:c,value:o,change:a,changeLabel:r="vs last period",icon:l,iconColor:d="text-blue-600",iconBgColor:n="bg-blue-100",trend:t="neutral"}){const m=t==="up"?"text-green-600":t==="down"?"text-red-600":"text-gray-600",x=t==="up"?"↑":t==="down"?"↓":"•";return e.jsxs(f,{children:[e.jsxs(y,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(v,{className:"text-sm font-medium text-muted-foreground",children:c}),e.jsx("div",{className:C("rounded-full p-2",n),children:e.jsx(l,{className:C("h-4 w-4",d)})})]}),e.jsxs(N,{children:[e.jsx("div",{className:"text-2xl font-bold",children:o}),a!==void 0&&e.jsxs("p",{className:C("text-xs font-medium mt-1",m),children:[x," ",Math.abs(a),"% ",r]})]})]})}function oe({title:c,description:o,data:a,series:r,type:l="line",height:d=300,showLegend:n=!0,yAxisLabel:t}){const m=()=>{const x={data:a,margin:{top:5,right:20,left:0,bottom:5}},g=e.jsxs(e.Fragment,{children:[e.jsx($,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(M,{dataKey:"name",tick:{fontSize:12},tickLine:!1,axisLine:!1}),e.jsx(O,{tick:{fontSize:12},tickLine:!1,axisLine:!1,label:t?{value:t,angle:-90,position:"insideLeft"}:void 0}),e.jsx(H,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}}),n&&e.jsx(W,{})]});switch(l){case"area":return e.jsxs(E,{...x,children:[g,r.map(s=>e.jsx(F,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,fill:s.color,fillOpacity:.2,strokeWidth:2},s.dataKey))]});case"bar":return e.jsxs(U,{...x,children:[g,r.map(s=>e.jsx(q,{dataKey:s.dataKey,name:s.name,fill:s.color,radius:[4,4,0,0]},s.dataKey))]});case"line":default:return e.jsxs(z,{...x,children:[g,r.map(s=>e.jsx(P,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,strokeWidth:2,dot:{r:4},activeDot:{r:6}},s.dataKey))]})}};return e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsx(v,{children:c}),o&&e.jsx(w,{children:o})]}),e.jsx(N,{children:e.jsx(R,{width:"100%",height:d,children:m()})})]})}function de({leads:c,onLeadClick:o}){const[a,r]=T.useState("created_at"),[l,d]=T.useState("desc"),n=s=>{a===s?d(l==="asc"?"desc":"asc"):(r(s),d("desc"))},t=[...c].sort((s,i)=>{let u=0;switch(a){case"created_at":u=new Date(s.created_at).getTime()-new Date(i.created_at).getTime();break;case"name":u=s.name.localeCompare(i.name);break;case"lead_type":u=s.lead_type.localeCompare(i.lead_type);break;case"status":u=s.status.localeCompare(i.status);break}return l==="asc"?u:-u}),m=({field:s})=>a!==s?null:l==="asc"?e.jsx(J,{className:"inline w-4 h-4 ml-1"}):e.jsx(Z,{className:"inline w-4 h-4 ml-1"}),x=s=>{switch(s){case"new":return"bg-blue-100 text-blue-800";case"contacted":return"bg-yellow-100 text-yellow-800";case"qualified":return"bg-green-100 text-green-800";case"converted":return"bg-purple-100 text-purple-800";case"lost":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},g=s=>{switch(s){case"buyer":return"Buyer";case"seller":return"Seller";case"valuation":return"Valuation";case"contact":return"Contact";default:return s}};return e.jsxs(f,{children:[e.jsxs(y,{children:[e.jsx(v,{children:"Recent Leads"}),e.jsxs(w,{children:["Your latest lead submissions (",c.length," total)"]})]}),e.jsx(N,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(K,{children:[e.jsx(_,{children:e.jsxs(L,{children:[e.jsx(j,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>n("name"),className:"hover:bg-transparent",children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Name",e.jsx(m,{field:"name"})]})}),e.jsx(j,{children:"Contact"}),e.jsx(j,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>n("lead_type"),className:"hover:bg-transparent",children:["Type",e.jsx(m,{field:"lead_type"})]})}),e.jsx(j,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>n("status"),className:"hover:bg-transparent",children:["Status",e.jsx(m,{field:"status"})]})}),e.jsx(j,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>n("created_at"),className:"hover:bg-transparent",children:["Date",e.jsx(m,{field:"created_at"})]})}),e.jsx(j,{className:"text-right",children:"Actions"})]})}),e.jsx(A,{children:t.length===0?e.jsx(L,{children:e.jsx(h,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No leads yet. They'll appear here when visitors submit forms."})}):t.map(s=>e.jsxs(L,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>o?.(s),children:[e.jsx(h,{className:"font-medium",children:s.name}),e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("a",{href:`mailto:${s.email}`,className:"flex items-center text-blue-600 hover:underline",onClick:i=>i.stopPropagation(),children:[e.jsx(G,{className:"w-3 h-3 mr-1"}),s.email]}),s.phone&&e.jsxs("a",{href:`tel:${s.phone}`,className:"flex items-center text-blue-600 hover:underline",onClick:i=>i.stopPropagation(),children:[e.jsx(I,{className:"w-3 h-3 mr-1"}),s.phone]})]})}),e.jsx(h,{children:e.jsx(k,{variant:"outline",children:g(s.lead_type)})}),e.jsx(h,{children:e.jsx(k,{className:x(s.status),children:s.status})}),e.jsx(h,{className:"text-sm text-muted-foreground",children:Y(s.created_at)}),e.jsx(h,{className:"text-right",children:e.jsx(p,{variant:"ghost",size:"sm",onClick:i=>{i.stopPropagation(),o?.(s)},children:"View"})})]},s.id))})]})})})]})}function Le(){const[c,o]=T.useState("30d"),{stats:a,viewsData:r,leadsData:l,recentLeads:d,isLoading:n}=ce();return n?e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading..."}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Analytics"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Track your profile performance, lead generation, and search visibility"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(p,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:c==="7d"?"Last 7 days":c==="30d"?"Last 30 days":"Last 90 days"})]}),e.jsxs(p,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Export"})]})]})]}),e.jsxs(D,{defaultValue:"overview",className:"space-y-4 sm:space-y-6",children:[e.jsxs(V,{className:"grid w-full grid-cols-2 sm:w-auto",children:[e.jsxs(S,{value:"overview",className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Profile Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Overview"})]}),e.jsxs(S,{value:"search",className:"gap-2",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Search Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Search"})]})]}),e.jsxs(B,{value:"overview",className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(b,{title:"Total Views",value:a.totalViews.toLocaleString(),icon:te,iconColor:"text-blue-600",iconBgColor:"bg-blue-100"}),e.jsx(b,{title:"Unique Visitors",value:a.uniqueVisitors.toLocaleString(),icon:re,iconColor:"text-green-600",iconBgColor:"bg-green-100"}),e.jsx(b,{title:"Total Leads",value:a.totalLeads,icon:le,iconColor:"text-purple-600",iconBgColor:"bg-purple-100"}),e.jsx(b,{title:"Conversion Rate",value:`${a.conversionRate}%`,icon:ne,iconColor:"text-orange-600",iconBgColor:"bg-orange-100"})]}),e.jsx(oe,{title:"Profile Views",description:"Views and unique visitors over time",data:r.length>0?r:[{name:"No data",views:0,visitors:0}],series:[{dataKey:"views",name:"Total Views",color:"#3B82F6"},{dataKey:"visitors",name:"Unique Visitors",color:"#10B981"}],type:"area",height:window.innerWidth<640?200:300}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(f,{children:[e.jsxs(y,{className:"pb-3 sm:pb-4",children:[e.jsx(v,{className:"text-base sm:text-lg",children:"Leads by Type"}),e.jsx(w,{className:"text-xs sm:text-sm",children:"Distribution of lead inquiries"})]}),e.jsx(N,{children:l.length>0?e.jsx("div",{className:"space-y-2 sm:space-y-3",children:l.map(t=>e.jsxs("div",{className:"flex items-center justify-between py-2 min-h-[44px]",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:t.name})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:"text-xs sm:text-sm text-muted-foreground whitespace-nowrap",children:[t.value," leads"]}),e.jsxs("span",{className:"text-xs sm:text-sm font-semibold min-w-[35px] text-right",children:[a.totalLeads>0?(t.value/a.totalLeads*100).toFixed(0):0,"%"]})]})]},t.name))}):e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:"No leads yet"})})]}),e.jsxs(f,{children:[e.jsxs(y,{className:"pb-3 sm:pb-4",children:[e.jsx(v,{className:"text-base sm:text-lg",children:"Recent Activity"}),e.jsx(w,{className:"text-xs sm:text-sm",children:"Latest profile interactions"})]}),e.jsx(N,{children:e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:a.totalViews>0?`${a.totalViews} profile views`:"No activity yet"})})]})]}),e.jsx(de,{leads:d,onLeadClick:t=>console.log("Lead clicked:",t)})]}),e.jsx(B,{value:"search",className:"space-y-4 sm:space-y-6",children:e.jsx(ie,{})})]})]})}export{Le as default};
