{"version":3,"file":"AnalyticsDashboard-k3UGiXoR.js","sources":["../../src/components/analytics/KPICards.tsx","../../src/components/analytics/TimeSeriesChart.tsx","../../src/components/analytics/ConversionFunnel.tsx","../../src/components/analytics/LeadSourceBreakdown.tsx","../../src/components/analytics/InsightsPanel.tsx","../../src/lib/analytics.ts","../../src/components/analytics/ReportBuilder.tsx","../../src/hooks/useLeads.ts","../../src/pages/AnalyticsDashboard.tsx"],"sourcesContent":["/**\n * KPI Cards Component\n * Displays key performance indicators with trends\n */\n\nimport { TrendingUp, TrendingDown, Minus } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport type { PerformanceMetric } from \"@/lib/analytics\";\n\ninterface KPICardsProps {\n    metrics: PerformanceMetric[];\n    className?: string;\n}\n\nexport function KPICards({ metrics, className }: KPICardsProps) {\n    return (\n        <div\n            className={cn(\n                \"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\",\n                className\n            )}\n        >\n            {metrics.map((metric) => (\n                <KPICard key={metric.name} metric={metric} />\n            ))}\n        </div>\n    );\n}\n\ninterface KPICardProps {\n    metric: PerformanceMetric;\n}\n\nfunction KPICard({ metric }: KPICardProps) {\n    const getTrendIcon = () => {\n        switch (metric.trend) {\n            case \"up\":\n                return <TrendingUp className=\"w-4 h-4\" />;\n            case \"down\":\n                return <TrendingDown className=\"w-4 h-4\" />;\n            case \"flat\":\n                return <Minus className=\"w-4 h-4\" />;\n        }\n    };\n\n    const getTrendColor = () => {\n        switch (metric.trend) {\n            case \"up\":\n                return \"text-green-600 bg-green-100\";\n            case \"down\":\n                return \"text-red-600 bg-red-100\";\n            case \"flat\":\n                return \"text-gray-600 bg-gray-100\";\n        }\n    };\n\n    const formatValue = () => {\n        if (metric.unit === \"$\") {\n            return `$${metric.value.toLocaleString()}`;\n        } else if (metric.unit === \"%\") {\n            return `${metric.value.toFixed(1)}%`;\n        } else if (metric.unit === \"min\") {\n            return `${Math.round(metric.value)} min`;\n        }\n        return metric.value.toLocaleString();\n    };\n\n    return (\n        <div className=\"bg-white p-6 rounded-lg border hover:shadow-md transition-shadow\">\n            <div className=\"flex items-center justify-between mb-2\">\n                <h3 className=\"text-sm font-medium text-gray-600\">\n                    {metric.name}\n                </h3>\n                <div className={cn(\"p-2 rounded-full\", getTrendColor())}>\n                    {getTrendIcon()}\n                </div>\n            </div>\n\n            <div className=\"flex items-baseline gap-2\">\n                <p className=\"text-3xl font-bold text-gray-900\">\n                    {formatValue()}\n                </p>\n            </div>\n\n            <div className=\"mt-2 flex items-center gap-1\">\n                <span\n                    className={cn(\n                        \"text-sm font-medium\",\n                        metric.trend === \"up\"\n                            ? \"text-green-600\"\n                            : metric.trend === \"down\"\n                            ? \"text-red-600\"\n                            : \"text-gray-600\"\n                    )}\n                >\n                    {metric.change > 0 ? \"+\" : \"\"}\n                    {metric.change.toFixed(1)}%\n                </span>\n                <span className=\"text-sm text-gray-500\">vs last period</span>\n            </div>\n\n            {metric.benchmark && (\n                <div className=\"mt-2 pt-2 border-t\">\n                    <p className=\"text-xs text-gray-500\">\n                        Benchmark: {metric.unit === \"$\" ? \"$\" : \"\"}\n                        {metric.benchmark.toLocaleString()}\n                        {metric.unit === \"%\" ? \"%\" : \"\"}\n                    </p>\n                </div>\n            )}\n        </div>\n    );\n}\n","/**\n * Time Series Chart Component\n * Line/Area chart for displaying time-based data\n */\n\nimport { useMemo } from \"react\";\nimport type { TimeSeriesData } from \"@/lib/analytics\";\n\ninterface TimeSeriesChartProps {\n    data: TimeSeriesData[];\n    title: string;\n    color?: string;\n    height?: number;\n    showPredictions?: boolean;\n    className?: string;\n}\n\nexport function TimeSeriesChart({\n    data,\n    title,\n    color = \"#2563eb\",\n    height = 300,\n    showPredictions = false,\n    className,\n}: TimeSeriesChartProps) {\n    const { actualData, predictedData, maxValue, minValue } = useMemo(() => {\n        const actual = data.filter((d) => !d.label);\n        const predicted = data.filter((d) => d.label === \"predicted\");\n        const allValues = data.map((d) => d.value);\n\n        return {\n            actualData: actual,\n            predictedData: predicted,\n            maxValue: Math.max(...allValues),\n            minValue: Math.min(...allValues),\n        };\n    }, [data]);\n\n    const getYPosition = (value: number) => {\n        const padding = 20;\n        const chartHeight = height - padding * 2;\n        const range = maxValue - minValue || 1;\n        return padding + chartHeight - ((value - minValue) / range) * chartHeight;\n    };\n\n    const getXPosition = (index: number, total: number) => {\n        const padding = 40;\n        const chartWidth = 800 - padding * 2;\n        return padding + (index / (total - 1)) * chartWidth;\n    };\n\n    const createPath = (dataPoints: TimeSeriesData[], dashed: boolean = false) => {\n        if (dataPoints.length === 0) return \"\";\n\n        const points = dataPoints.map((d, i) => ({\n            x: getXPosition(i, dataPoints.length),\n            y: getYPosition(d.value),\n        }));\n\n        const path = points.map((p, i) => `${i === 0 ? \"M\" : \"L\"} ${p.x} ${p.y}`).join(\" \");\n\n        return path;\n    };\n\n    const createAreaPath = (dataPoints: TimeSeriesData[]) => {\n        if (dataPoints.length === 0) return \"\";\n\n        const linePath = createPath(dataPoints);\n        const lastPoint = getXPosition(dataPoints.length - 1, dataPoints.length);\n        const firstPoint = getXPosition(0, dataPoints.length);\n        const bottom = height - 20;\n\n        return `${linePath} L ${lastPoint} ${bottom} L ${firstPoint} ${bottom} Z`;\n    };\n\n    return (\n        <div className={className}>\n            <h3 className=\"text-lg font-semibold mb-4\">{title}</h3>\n            <svg\n                width=\"100%\"\n                height={height}\n                viewBox=\"0 0 800 300\"\n                className=\"bg-white rounded-lg border\"\n            >\n                {/* Grid lines */}\n                <g className=\"grid-lines\">\n                    {[0, 25, 50, 75, 100].map((percent) => {\n                        const y = 20 + (height - 40) * (percent / 100);\n                        return (\n                            <g key={percent}>\n                                <line\n                                    x1={40}\n                                    y1={y}\n                                    x2={760}\n                                    y2={y}\n                                    stroke=\"#e5e7eb\"\n                                    strokeWidth={1}\n                                />\n                                <text\n                                    x={25}\n                                    y={y + 4}\n                                    fontSize={10}\n                                    fill=\"#6b7280\"\n                                    textAnchor=\"end\"\n                                >\n                                    {Math.round(maxValue - (percent / 100) * (maxValue - minValue))}\n                                </text>\n                            </g>\n                        );\n                    })}\n                </g>\n\n                {/* Area fill */}\n                <path\n                    d={createAreaPath(actualData)}\n                    fill={color}\n                    fillOpacity={0.1}\n                />\n\n                {/* Actual data line */}\n                <path\n                    d={createPath(actualData)}\n                    fill=\"none\"\n                    stroke={color}\n                    strokeWidth={2}\n                    strokeLinecap=\"round\"\n                    strokeLinejoin=\"round\"\n                />\n\n                {/* Predicted data line (dashed) */}\n                {showPredictions && predictedData.length > 0 && (\n                    <path\n                        d={createPath(predictedData)}\n                        fill=\"none\"\n                        stroke={color}\n                        strokeWidth={2}\n                        strokeDasharray=\"5,5\"\n                        strokeOpacity={0.5}\n                        strokeLinecap=\"round\"\n                        strokeLinejoin=\"round\"\n                    />\n                )}\n\n                {/* Data points */}\n                {actualData.map((d, i) => (\n                    <circle\n                        key={i}\n                        cx={getXPosition(i, actualData.length)}\n                        cy={getYPosition(d.value)}\n                        r={4}\n                        fill=\"white\"\n                        stroke={color}\n                        strokeWidth={2}\n                    />\n                ))}\n\n                {/* X-axis labels */}\n                <g className=\"x-axis-labels\">\n                    {actualData.map((d, i) => {\n                        // Show every nth label to avoid crowding\n                        const showLabel = i % Math.ceil(actualData.length / 7) === 0;\n                        if (!showLabel) return null;\n\n                        return (\n                            <text\n                                key={i}\n                                x={getXPosition(i, actualData.length)}\n                                y={height - 5}\n                                fontSize={10}\n                                fill=\"#6b7280\"\n                                textAnchor=\"middle\"\n                            >\n                                {d.date}\n                            </text>\n                        );\n                    })}\n                </g>\n            </svg>\n\n            {showPredictions && predictedData.length > 0 && (\n                <div className=\"mt-2 flex items-center gap-4 text-sm text-gray-600\">\n                    <div className=\"flex items-center gap-2\">\n                        <div className=\"w-4 h-0.5\" style={{ backgroundColor: color }} />\n                        <span>Actual</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                        <div\n                            className=\"w-4 h-0.5\"\n                            style={{\n                                backgroundColor: color,\n                                opacity: 0.5,\n                                borderTop: `2px dashed ${color}`,\n                            }}\n                        />\n                        <span>Predicted</span>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n\n","/**\n * Conversion Funnel Component\n * Visualizes the lead conversion funnel with dropoff rates\n */\n\nimport { ChevronDown } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport type { FunnelStage } from \"@/lib/analytics\";\n\ninterface ConversionFunnelProps {\n    stages: FunnelStage[];\n    className?: string;\n}\n\nexport function ConversionFunnel({ stages, className }: ConversionFunnelProps) {\n    const maxCount = stages[0]?.count || 1;\n\n    return (\n        <div className={cn(\"bg-white p-6 rounded-lg border\", className)}>\n            <h3 className=\"text-lg font-semibold mb-6\">Conversion Funnel</h3>\n\n            <div className=\"space-y-2\">\n                {stages.map((stage, index) => (\n                    <div key={stage.name}>\n                        <FunnelStageCard\n                            stage={stage}\n                            maxCount={maxCount}\n                            isFirst={index === 0}\n                            isLast={index === stages.length - 1}\n                        />\n                        {!isLast &&\n                            stage.dropoff !== undefined &&\n                            stage.dropoff > 0 && (\n                                <DropoffIndicator\n                                    count={stage.dropoff}\n                                    percentage={calculateDropoffPercentage(\n                                        stage,\n                                        stages[index + 1]\n                                    )}\n                                />\n                            )}\n                    </div>\n                ))}\n            </div>\n\n            {/* Summary Stats */}\n            <div className=\"mt-6 pt-6 border-t grid grid-cols-3 gap-4\">\n                <StatItem\n                    label=\"Overall Conversion\"\n                    value={`${stages[stages.length - 1].percentage.toFixed(\n                        1\n                    )}%`}\n                />\n                <StatItem\n                    label=\"Total Conversions\"\n                    value={stages[stages.length - 1].count.toLocaleString()}\n                />\n                <StatItem\n                    label=\"Total Dropoff\"\n                    value={calculateTotalDropoff(stages).toLocaleString()}\n                />\n            </div>\n        </div>\n    );\n}\n\ninterface FunnelStageCardProps {\n    stage: FunnelStage;\n    maxCount: number;\n    isFirst: boolean;\n    isLast: boolean;\n}\n\nfunction FunnelStageCard({\n    stage,\n    maxCount,\n    isFirst,\n    isLast,\n}: FunnelStageCardProps) {\n    const widthPercentage = (stage.count / maxCount) * 100;\n\n    const getColor = () => {\n        if (stage.percentage >= 75) return \"bg-green-500\";\n        if (stage.percentage >= 50) return \"bg-yellow-500\";\n        if (stage.percentage >= 25) return \"bg-orange-500\";\n        return \"bg-red-500\";\n    };\n\n    return (\n        <div className=\"relative\">\n            {/* Funnel stage bar */}\n            <div\n                className={cn(\n                    \"relative mx-auto rounded-lg p-4 transition-all duration-300 hover:shadow-md\",\n                    getColor()\n                )}\n                style={{ width: `${Math.max(widthPercentage, 20)}%` }}\n            >\n                <div className=\"flex items-center justify-between text-white\">\n                    <div>\n                        <h4 className=\"font-semibold\">{stage.name}</h4>\n                        <p className=\"text-sm opacity-90\">\n                            {stage.count.toLocaleString()} leads\n                        </p>\n                    </div>\n                    <div className=\"text-right\">\n                        <p className=\"text-2xl font-bold\">\n                            {stage.percentage.toFixed(1)}%\n                        </p>\n                        {!isFirst && (\n                            <p className=\"text-xs opacity-90\">of total</p>\n                        )}\n                    </div>\n                </div>\n            </div>\n        </div>\n    );\n}\n\ninterface DropoffIndicatorProps {\n    count: number;\n    percentage: number;\n}\n\nfunction DropoffIndicator({ count, percentage }: DropoffIndicatorProps) {\n    return (\n        <div className=\"flex items-center justify-center py-2\">\n            <div className=\"flex items-center gap-2 text-sm text-gray-600\">\n                <ChevronDown className=\"w-4 h-4 text-red-500\" />\n                <span>\n                    <span className=\"font-medium text-red-600\">\n                        {count.toLocaleString()}\n                    </span>{\" \"}\n                    dropped off ({percentage.toFixed(1)}%)\n                </span>\n            </div>\n        </div>\n    );\n}\n\ninterface StatItemProps {\n    label: string;\n    value: string;\n}\n\nfunction StatItem({ label, value }: StatItemProps) {\n    return (\n        <div className=\"text-center\">\n            <p className=\"text-2xl font-bold text-gray-900\">{value}</p>\n            <p className=\"text-sm text-gray-600 mt-1\">{label}</p>\n        </div>\n    );\n}\n\nfunction calculateDropoffPercentage(\n    current: FunnelStage,\n    next: FunnelStage\n): number {\n    if (current.count === 0) return 0;\n    return ((current.count - next.count) / current.count) * 100;\n}\n\nfunction calculateTotalDropoff(stages: FunnelStage[]): number {\n    if (stages.length < 2) return 0;\n    return stages[0].count - stages[stages.length - 1].count;\n}\n","/**\n * Lead Source Breakdown Component\n * Displays performance metrics by lead source\n */\n\nimport { TrendingUp, Users, DollarSign, Target } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport type { LeadSourceMetric } from \"@/lib/analytics\";\n\ninterface LeadSourceBreakdownProps {\n    sources: LeadSourceMetric[];\n    className?: string;\n}\n\nexport function LeadSourceBreakdown({\n    sources,\n    className,\n}: LeadSourceBreakdownProps) {\n    const totalLeads = sources.reduce((sum, s) => sum + s.leads, 0);\n    const totalRevenue = sources.reduce((sum, s) => sum + s.revenue, 0);\n\n    // Sort by conversion rate\n    const sortedSources = [...sources].sort(\n        (a, b) => b.conversionRate - a.conversionRate\n    );\n\n    return (\n        <div className={cn(\"bg-white p-6 rounded-lg border\", className)}>\n            <div className=\"flex items-center justify-between mb-6\">\n                <h3 className=\"text-lg font-semibold\">Lead Sources</h3>\n                <div className=\"flex gap-4 text-sm text-gray-600\">\n                    <div className=\"flex items-center gap-1\">\n                        <Users className=\"w-4 h-4\" />\n                        {totalLeads} leads\n                    </div>\n                    <div className=\"flex items-center gap-1\">\n                        <DollarSign className=\"w-4 h-4\" />$\n                        {totalRevenue.toLocaleString()}\n                    </div>\n                </div>\n            </div>\n\n            <div className=\"space-y-4\">\n                {sortedSources.map((source) => (\n                    <SourceCard\n                        key={source.source}\n                        source={source}\n                        totalLeads={totalLeads}\n                    />\n                ))}\n            </div>\n\n            {sortedSources.length === 0 && (\n                <div className=\"text-center py-8 text-gray-500\">\n                    <Target className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                    <p>No lead source data available</p>\n                </div>\n            )}\n        </div>\n    );\n}\n\ninterface SourceCardProps {\n    source: LeadSourceMetric;\n    totalLeads: number;\n}\n\nfunction SourceCard({ source, totalLeads }: SourceCardProps) {\n    const leadPercentage = (source.leads / totalLeads) * 100;\n\n    const getConversionColor = (rate: number) => {\n        if (rate >= 20) return \"text-green-600\";\n        if (rate >= 10) return \"text-yellow-600\";\n        return \"text-gray-600\";\n    };\n\n    return (\n        <div className=\"p-4 border rounded-lg hover:shadow-md transition-shadow\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between mb-3\">\n                <h4 className=\"font-semibold text-gray-900 capitalize\">\n                    {source.source}\n                </h4>\n                <div className=\"flex items-center gap-2\">\n                    <span\n                        className={cn(\n                            \"text-lg font-bold\",\n                            getConversionColor(source.conversionRate)\n                        )}\n                    >\n                        {source.conversionRate.toFixed(1)}%\n                    </span>\n                    <span className=\"text-sm text-gray-500\">conversion</span>\n                </div>\n            </div>\n\n            {/* Progress bar */}\n            <div className=\"mb-3\">\n                <div className=\"flex items-center justify-between text-sm mb-1\">\n                    <span className=\"text-gray-600\">Lead share</span>\n                    <span className=\"font-medium\">\n                        {leadPercentage.toFixed(1)}%\n                    </span>\n                </div>\n                <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                    <div\n                        className=\"bg-primary rounded-full h-2 transition-all duration-500\"\n                        style={{ width: `${leadPercentage}%` }}\n                    />\n                </div>\n            </div>\n\n            {/* Stats grid */}\n            <div className=\"grid grid-cols-3 gap-3 text-center\">\n                <div>\n                    <p className=\"text-sm text-gray-600\">Leads</p>\n                    <p className=\"text-lg font-bold text-gray-900\">\n                        {source.leads}\n                    </p>\n                </div>\n                <div>\n                    <p className=\"text-sm text-gray-600\">Conversions</p>\n                    <p className=\"text-lg font-bold text-gray-900\">\n                        {source.conversions}\n                    </p>\n                </div>\n                <div>\n                    <p className=\"text-sm text-gray-600\">Revenue</p>\n                    <p className=\"text-lg font-bold text-gray-900\">\n                        ${source.revenue.toLocaleString()}\n                    </p>\n                </div>\n            </div>\n\n            {/* ROI if available */}\n            {source.roi !== undefined && (\n                <div className=\"mt-3 pt-3 border-t flex items-center justify-between\">\n                    <span className=\"text-sm text-gray-600\">ROI</span>\n                    <div className=\"flex items-center gap-1\">\n                        <TrendingUp className=\"w-4 h-4 text-green-600\" />\n                        <span\n                            className={cn(\n                                \"font-semibold\",\n                                source.roi > 0\n                                    ? \"text-green-600\"\n                                    : \"text-red-600\"\n                            )}\n                        >\n                            {source.roi > 0 ? \"+\" : \"\"}\n                            {source.roi.toFixed(1)}%\n                        </span>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n}\n","/**\n * Insights Panel Component\n * Displays AI-generated insights and recommendations\n */\n\nimport { Lightbulb, TrendingUp, AlertCircle, CheckCircle } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface InsightsPanelProps {\n    insights: string[];\n    className?: string;\n}\n\nexport function InsightsPanel({ insights, className }: InsightsPanelProps) {\n    return (\n        <div className={cn(\"bg-white p-6 rounded-lg border\", className)}>\n            <div className=\"flex items-center gap-2 mb-4\">\n                <Lightbulb className=\"w-5 h-5 text-yellow-500\" />\n                <h3 className=\"text-lg font-semibold\">Key Insights</h3>\n            </div>\n\n            <div className=\"space-y-3\">\n                {insights.map((insight, index) => (\n                    <InsightCard key={index} insight={insight} />\n                ))}\n            </div>\n\n            {insights.length === 0 && (\n                <div className=\"text-center py-8 text-gray-500\">\n                    <Lightbulb className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                    <p>No insights available yet</p>\n                    <p className=\"text-sm mt-1\">\n                        Check back when you have more data\n                    </p>\n                </div>\n            )}\n        </div>\n    );\n}\n\ninterface InsightCardProps {\n    insight: string;\n}\n\nfunction InsightCard({ insight }: InsightCardProps) {\n    const getIcon = () => {\n        if (\n            insight.includes(\"üìà\") ||\n            insight.includes(\"üöÄ\") ||\n            insight.includes(\"üéØ\")\n        ) {\n            return <TrendingUp className=\"w-5 h-5 text-green-600\" />;\n        } else if (insight.includes(\"‚ö†Ô∏è\") || insight.includes(\"üêå\")) {\n            return <AlertCircle className=\"w-5 h-5 text-orange-600\" />;\n        } else if (insight.includes(\"‚ö°\") || insight.includes(\"üåü\")) {\n            return <CheckCircle className=\"w-5 h-5 text-blue-600\" />;\n        }\n        return <Lightbulb className=\"w-5 h-5 text-yellow-600\" />;\n    };\n\n    const getBackgroundColor = () => {\n        if (\n            insight.includes(\"üìà\") ||\n            insight.includes(\"üöÄ\") ||\n            insight.includes(\"üéØ\")\n        ) {\n            return \"bg-green-50 border-green-200\";\n        } else if (insight.includes(\"‚ö†Ô∏è\") || insight.includes(\"üêå\")) {\n            return \"bg-orange-50 border-orange-200\";\n        } else if (insight.includes(\"‚ö°\") || insight.includes(\"üåü\")) {\n            return \"bg-blue-50 border-blue-200\";\n        }\n        return \"bg-yellow-50 border-yellow-200\";\n    };\n\n    return (\n        <div className={cn(\"p-4 rounded-lg border\", getBackgroundColor())}>\n            <div className=\"flex items-start gap-3\">\n                <div className=\"flex-shrink-0 mt-0.5\">{getIcon()}</div>\n                <p className=\"text-sm text-gray-700 leading-relaxed\">\n                    {insight}\n                </p>\n            </div>\n        </div>\n    );\n}\n","/**\n * Analytics Engine\n * Processes and calculates analytics metrics for the dashboard\n */\n\nimport {\n    format,\n    subDays,\n    startOfDay,\n    endOfDay,\n    eachDayOfInterval,\n} from \"date-fns\";\n\n// Types\nexport interface AnalyticsData {\n    pageViews: number;\n    uniqueVisitors: number;\n    leads: number;\n    conversions: number;\n    revenue: number;\n    avgResponseTime: number; // minutes\n    period: \"day\" | \"week\" | \"month\" | \"year\";\n    startDate: Date;\n    endDate: Date;\n}\n\nexport interface TimeSeriesData {\n    date: string;\n    value: number;\n    label?: string;\n}\n\nexport interface FunnelStage {\n    name: string;\n    count: number;\n    percentage: number;\n    dropoff?: number;\n}\n\nexport interface PerformanceMetric {\n    name: string;\n    value: number;\n    unit: string;\n    change: number; // percentage change\n    trend: \"up\" | \"down\" | \"flat\";\n    benchmark?: number;\n}\n\nexport interface LeadSourceMetric {\n    source: string;\n    leads: number;\n    conversions: number;\n    conversionRate: number;\n    revenue: number;\n    roi?: number;\n}\n\nexport interface ListingPerformance {\n    id: string;\n    title: string;\n    views: number;\n    leads: number;\n    conversionRate: number;\n    avgTimeOnPage: number; // seconds\n    shareCount: number;\n}\n\n/**\n * Analytics Engine Class\n */\nexport class AnalyticsEngine {\n    /**\n     * Calculate key performance indicators\n     */\n    static calculateKPIs(\n        current: AnalyticsData,\n        previous: AnalyticsData\n    ): PerformanceMetric[] {\n        return [\n            this.createMetric(\n                \"Total Page Views\",\n                current.pageViews,\n                \"\",\n                previous.pageViews\n            ),\n            this.createMetric(\n                \"Unique Visitors\",\n                current.uniqueVisitors,\n                \"\",\n                previous.uniqueVisitors\n            ),\n            this.createMetric(\"Total Leads\", current.leads, \"\", previous.leads),\n            this.createMetric(\n                \"Conversions\",\n                current.conversions,\n                \"\",\n                previous.conversions\n            ),\n            this.createMetric(\n                \"Revenue\",\n                current.revenue,\n                \"$\",\n                previous.revenue\n            ),\n            this.createMetric(\n                \"Avg Response Time\",\n                current.avgResponseTime,\n                \"min\",\n                previous.avgResponseTime,\n                true // lower is better\n            ),\n            this.createMetric(\n                \"Conversion Rate\",\n                this.calculateConversionRate(\n                    current.leads,\n                    current.conversions\n                ),\n                \"%\",\n                this.calculateConversionRate(\n                    previous.leads,\n                    previous.conversions\n                )\n            ),\n            this.createMetric(\n                \"Lead-to-Visitor Rate\",\n                this.calculateConversionRate(\n                    current.uniqueVisitors,\n                    current.leads\n                ),\n                \"%\",\n                this.calculateConversionRate(\n                    previous.uniqueVisitors,\n                    previous.leads\n                )\n            ),\n        ];\n    }\n\n    /**\n     * Create a performance metric with trend\n     */\n    private static createMetric(\n        name: string,\n        current: number,\n        unit: string,\n        previous: number,\n        lowerIsBetter: boolean = false\n    ): PerformanceMetric {\n        const change = this.calculatePercentageChange(current, previous);\n        const trend = this.determineTrend(change, lowerIsBetter);\n\n        return {\n            name,\n            value: current,\n            unit,\n            change,\n            trend,\n        };\n    }\n\n    /**\n     * Calculate percentage change\n     */\n    private static calculatePercentageChange(\n        current: number,\n        previous: number\n    ): number {\n        if (previous === 0) return current > 0 ? 100 : 0;\n        return ((current - previous) / previous) * 100;\n    }\n\n    /**\n     * Determine trend direction\n     */\n    private static determineTrend(\n        change: number,\n        lowerIsBetter: boolean = false\n    ): \"up\" | \"down\" | \"flat\" {\n        const threshold = 2; // 2% threshold for flat\n        if (Math.abs(change) < threshold) return \"flat\";\n\n        if (lowerIsBetter) {\n            return change < 0 ? \"up\" : \"down\";\n        }\n        return change > 0 ? \"up\" : \"down\";\n    }\n\n    /**\n     * Calculate conversion rate\n     */\n    private static calculateConversionRate(\n        total: number,\n        converted: number\n    ): number {\n        if (total === 0) return 0;\n        return (converted / total) * 100;\n    }\n\n    /**\n     * Generate time series data\n     */\n    static generateTimeSeries(\n        startDate: Date,\n        endDate: Date,\n        dataGenerator: (date: Date) => number\n    ): TimeSeriesData[] {\n        const days = eachDayOfInterval({ start: startDate, end: endDate });\n\n        return days.map((date) => ({\n            date: format(date, \"MMM d\"),\n            value: dataGenerator(date),\n        }));\n    }\n\n    /**\n     * Calculate funnel stages\n     */\n    static calculateFunnel(stages: {\n        visitors: number;\n        viewed: number;\n        contacted: number;\n        qualified: number;\n        converted: number;\n    }): FunnelStage[] {\n        const { visitors, viewed, contacted, qualified, converted } = stages;\n\n        return [\n            {\n                name: \"Visitors\",\n                count: visitors,\n                percentage: 100,\n            },\n            {\n                name: \"Viewed Listing\",\n                count: viewed,\n                percentage: this.calculateConversionRate(visitors, viewed),\n                dropoff: visitors - viewed,\n            },\n            {\n                name: \"Contacted\",\n                count: contacted,\n                percentage: this.calculateConversionRate(visitors, contacted),\n                dropoff: viewed - contacted,\n            },\n            {\n                name: \"Qualified\",\n                count: qualified,\n                percentage: this.calculateConversionRate(visitors, qualified),\n                dropoff: contacted - qualified,\n            },\n            {\n                name: \"Converted\",\n                count: converted,\n                percentage: this.calculateConversionRate(visitors, converted),\n                dropoff: qualified - converted,\n            },\n        ];\n    }\n\n    /**\n     * Analyze lead sources\n     */\n    static analyzeLeadSources(\n        sources: Array<{\n            source: string;\n            leads: number;\n            conversions: number;\n            revenue: number;\n            cost?: number;\n        }>\n    ): LeadSourceMetric[] {\n        return sources.map((source) => ({\n            source: source.source,\n            leads: source.leads,\n            conversions: source.conversions,\n            conversionRate: this.calculateConversionRate(\n                source.leads,\n                source.conversions\n            ),\n            revenue: source.revenue,\n            roi: source.cost\n                ? ((source.revenue - source.cost) / source.cost) * 100\n                : undefined,\n        }));\n    }\n\n    /**\n     * Rank listings by performance\n     */\n    static rankListings(\n        listings: Array<{\n            id: string;\n            title: string;\n            views: number;\n            leads: number;\n            avgTimeOnPage: number;\n            shareCount: number;\n        }>\n    ): ListingPerformance[] {\n        return listings\n            .map((listing) => ({\n                ...listing,\n                conversionRate: this.calculateConversionRate(\n                    listing.views,\n                    listing.leads\n                ),\n            }))\n            .sort((a, b) => b.conversionRate - a.conversionRate);\n    }\n\n    /**\n     * Calculate trend prediction (simple linear regression)\n     */\n    static predictTrend(\n        data: TimeSeriesData[],\n        daysToPredict: number = 7\n    ): TimeSeriesData[] {\n        if (data.length < 2) return [];\n\n        // Simple linear regression\n        const n = data.length;\n        const xValues = data.map((_, i) => i);\n        const yValues = data.map((d) => d.value);\n\n        const sumX = xValues.reduce((a, b) => a + b, 0);\n        const sumY = yValues.reduce((a, b) => a + b, 0);\n        const sumXY = xValues.reduce((sum, x, i) => sum + x * yValues[i], 0);\n        const sumX2 = xValues.reduce((sum, x) => sum + x * x, 0);\n\n        const slope = (n * sumXY - sumX * sumY) / (n * sumX2 - sumX * sumX);\n        const intercept = (sumY - slope * sumX) / n;\n\n        // Generate predictions\n        const predictions: TimeSeriesData[] = [];\n        const lastDate = new Date(data[data.length - 1].date);\n\n        for (let i = 1; i <= daysToPredict; i++) {\n            const x = n + i - 1;\n            const predictedValue = Math.max(\n                0,\n                Math.round(slope * x + intercept)\n            );\n            const predictedDate = new Date(lastDate);\n            predictedDate.setDate(predictedDate.getDate() + i);\n\n            predictions.push({\n                date: format(predictedDate, \"MMM d\"),\n                value: predictedValue,\n                label: \"predicted\",\n            });\n        }\n\n        return predictions;\n    }\n\n    /**\n     * Calculate engagement score (0-100)\n     */\n    static calculateEngagementScore(metrics: {\n        avgTimeOnPage: number; // seconds\n        bounceRate: number; // percentage\n        pagesPerSession: number;\n        returnVisitorRate: number; // percentage\n    }): number {\n        const {\n            avgTimeOnPage,\n            bounceRate,\n            pagesPerSession,\n            returnVisitorRate,\n        } = metrics;\n\n        // Normalize each metric to 0-25 scale\n        const timeScore = Math.min((avgTimeOnPage / 180) * 25, 25); // 3 min = full score\n        const bounceScore = Math.max((100 - bounceRate) / 4, 0); // lower bounce = higher score\n        const pagesScore = Math.min((pagesPerSession / 5) * 25, 25); // 5 pages = full score\n        const returnScore = (returnVisitorRate / 100) * 25;\n\n        return Math.round(timeScore + bounceScore + pagesScore + returnScore);\n    }\n\n    /**\n     * Generate insights from data\n     */\n    static generateInsights(\n        current: AnalyticsData,\n        previous: AnalyticsData,\n        sources: LeadSourceMetric[]\n    ): string[] {\n        const insights: string[] = [];\n\n        // Lead generation insight\n        const leadChange = this.calculatePercentageChange(\n            current.leads,\n            previous.leads\n        );\n        if (leadChange > 20) {\n            insights.push(\n                `üìà Lead generation is up ${Math.round(\n                    leadChange\n                )}% compared to last period`\n            );\n        } else if (leadChange < -20) {\n            insights.push(\n                `‚ö†Ô∏è Lead generation is down ${Math.abs(\n                    Math.round(leadChange)\n                )}% - consider increasing marketing efforts`\n            );\n        }\n\n        // Conversion insight\n        const currentCR = this.calculateConversionRate(\n            current.leads,\n            current.conversions\n        );\n        const previousCR = this.calculateConversionRate(\n            previous.leads,\n            previous.conversions\n        );\n        if (currentCR > previousCR + 5) {\n            insights.push(\n                `üéØ Conversion rate improved to ${currentCR.toFixed(\n                    1\n                )}% - keep up the good work!`\n            );\n        }\n\n        // Response time insight\n        if (current.avgResponseTime < 5) {\n            insights.push(\n                `‚ö° Excellent response time! You're responding in under 5 minutes`\n            );\n        } else if (current.avgResponseTime > 60) {\n            insights.push(\n                `üêå Response time is high (${Math.round(\n                    current.avgResponseTime\n                )} min) - faster responses increase conversions`\n            );\n        }\n\n        // Best performing source\n        if (sources.length > 0) {\n            const bestSource = sources.reduce((best, current) =>\n                current.conversionRate > best.conversionRate ? current : best\n            );\n            if (bestSource.conversionRate > 15) {\n                insights.push(\n                    `üåü ${\n                        bestSource.source\n                    } is your best performing source at ${bestSource.conversionRate.toFixed(\n                        1\n                    )}% conversion rate`\n                );\n            }\n        }\n\n        // Traffic insight\n        const trafficChange = this.calculatePercentageChange(\n            current.uniqueVisitors,\n            previous.uniqueVisitors\n        );\n        if (trafficChange > 30) {\n            insights.push(\n                `üöÄ Traffic is surging! Up ${Math.round(\n                    trafficChange\n                )}% - great time to capture leads`\n            );\n        }\n\n        return insights;\n    }\n\n    /**\n     * Export data to CSV format\n     */\n    static exportToCSV(data: any[], filename: string): void {\n        if (data.length === 0) return;\n\n        // Get headers from first object\n        const headers = Object.keys(data[0]);\n\n        // Create CSV content\n        const csvContent = [\n            headers.join(\",\"), // Header row\n            ...data.map((row) =>\n                headers\n                    .map((header) => JSON.stringify(row[header] || \"\"))\n                    .join(\",\")\n            ),\n        ].join(\"\\n\");\n\n        // Create download link\n        const blob = new Blob([csvContent], {\n            type: \"text/csv;charset=utf-8;\",\n        });\n        const link = document.createElement(\"a\");\n        const url = URL.createObjectURL(blob);\n\n        link.setAttribute(\"href\", url);\n        link.setAttribute(\"download\", `${filename}_${Date.now()}.csv`);\n        link.style.visibility = \"hidden\";\n\n        document.body.appendChild(link);\n        link.click();\n        document.body.removeChild(link);\n    }\n}\n\n// Track page views (client-side analytics)\nexport const trackPageView = (path: string) => {\n    // Log page view\n    console.log('[Analytics] Page view:', path);\n    \n    // Future: Send to analytics service\n    // Example: Google Analytics, PostHog, etc.\n    // gtag('event', 'page_view', { page_path: path });\n};\n\n// Export helper functions (bound to preserve `this` context)\nexport const calculateKPIs = AnalyticsEngine.calculateKPIs.bind(AnalyticsEngine);\nexport const generateTimeSeries = AnalyticsEngine.generateTimeSeries.bind(AnalyticsEngine);\nexport const calculateFunnel = AnalyticsEngine.calculateFunnel.bind(AnalyticsEngine);\nexport const analyzeLeadSources = AnalyticsEngine.analyzeLeadSources.bind(AnalyticsEngine);\nexport const rankListings = AnalyticsEngine.rankListings.bind(AnalyticsEngine);\nexport const predictTrend = AnalyticsEngine.predictTrend.bind(AnalyticsEngine);\nexport const calculateEngagementScore = AnalyticsEngine.calculateEngagementScore.bind(AnalyticsEngine);\nexport const generateInsights = AnalyticsEngine.generateInsights.bind(AnalyticsEngine);\nexport const exportToCSV = AnalyticsEngine.exportToCSV.bind(AnalyticsEngine);\n","/**\n * Report Builder Component\n * Custom report creation and export tool\n */\n\nimport { useState } from \"react\";\nimport { Download, Calendar, FileText, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n    Select,\n    SelectContent,\n    SelectItem,\n    SelectTrigger,\n    SelectValue,\n} from \"@/components/ui/select\";\nimport { cn } from \"@/lib/utils\";\nimport { toast } from \"sonner\";\nimport { exportToCSV } from \"@/lib/analytics\";\nimport { generatePDFReport } from \"@/lib/exportUtils\";\nimport { format, subDays, startOfMonth, endOfMonth } from \"date-fns\";\n\ninterface ReportBuilderProps {\n    onGenerateReport: (config: ReportConfig) => Promise<any[]>;\n    className?: string;\n}\n\nexport interface ReportConfig {\n    reportType:\n        | \"leads\"\n        | \"listings\"\n        | \"conversions\"\n        | \"sources\"\n        | \"performance\";\n    dateRange: \"7d\" | \"30d\" | \"90d\" | \"this_month\" | \"last_month\" | \"custom\";\n    metrics: string[];\n    format: \"csv\" | \"pdf\" | \"excel\";\n    startDate?: Date;\n    endDate?: Date;\n}\n\nexport function ReportBuilder({\n    onGenerateReport,\n    className,\n}: ReportBuilderProps) {\n    const [reportType, setReportType] =\n        useState<ReportConfig[\"reportType\"]>(\"leads\");\n    const [dateRange, setDateRange] =\n        useState<ReportConfig[\"dateRange\"]>(\"30d\");\n    const [exportFormat, setExportFormat] = useState<ReportConfig[\"format\"]>(\"csv\");\n    const [isGenerating, setIsGenerating] = useState(false);\n\n    const reportTypes = [\n        { value: \"leads\", label: \"Leads Report\" },\n        { value: \"listings\", label: \"Listings Performance\" },\n        { value: \"conversions\", label: \"Conversion Analytics\" },\n        { value: \"sources\", label: \"Lead Sources\" },\n        { value: \"performance\", label: \"Overall Performance\" },\n    ];\n\n    const dateRanges = [\n        { value: \"7d\", label: \"Last 7 Days\" },\n        { value: \"30d\", label: \"Last 30 Days\" },\n        { value: \"90d\", label: \"Last 90 Days\" },\n        { value: \"this_month\", label: \"This Month\" },\n        { value: \"last_month\", label: \"Last Month\" },\n    ];\n\n    const formats = [\n        { value: \"csv\", label: \"CSV\", disabled: false },\n        { value: \"pdf\", label: \"PDF\", disabled: false },\n        { value: \"excel\", label: \"Excel (Coming Soon)\", disabled: true },\n    ];\n\n    const getDateRangeForReport = (): { start: Date; end: Date } => {\n        const now = new Date();\n        switch (dateRange) {\n            case \"7d\":\n                return { start: subDays(now, 7), end: now };\n            case \"30d\":\n                return { start: subDays(now, 30), end: now };\n            case \"90d\":\n                return { start: subDays(now, 90), end: now };\n            case \"this_month\":\n                return { start: startOfMonth(now), end: endOfMonth(now) };\n            case \"last_month\":\n                const lastMonth = subDays(startOfMonth(now), 1);\n                return {\n                    start: startOfMonth(lastMonth),\n                    end: endOfMonth(lastMonth),\n                };\n            default:\n                return { start: subDays(now, 30), end: now };\n        }\n    };\n\n    const getReportTitle = (): string => {\n        const reportTitles: Record<string, string> = {\n            leads: \"Leads Report\",\n            listings: \"Listings Performance Report\",\n            conversions: \"Conversion Analytics Report\",\n            sources: \"Lead Sources Report\",\n            performance: \"Overall Performance Report\",\n        };\n        return reportTitles[reportType] || \"Analytics Report\";\n    };\n\n    const handleGenerateReport = async () => {\n        setIsGenerating(true);\n\n        try {\n            const { start, end } = getDateRangeForReport();\n            const dateRangeStr = `${format(start, \"MMM d, yyyy\")} - ${format(end, \"MMM d, yyyy\")}`;\n\n            const config: ReportConfig = {\n                reportType,\n                dateRange,\n                metrics: [], // Will be filled based on report type\n                format: exportFormat,\n                startDate: start,\n                endDate: end,\n            };\n\n            const data = await onGenerateReport(config);\n\n            if (exportFormat === \"csv\") {\n                const filename = `${reportType}_report_${format(\n                    start,\n                    \"yyyy-MM-dd\"\n                )}_to_${format(end, \"yyyy-MM-dd\")}`;\n                exportToCSV(data, filename);\n                toast.success(\"CSV report exported successfully!\");\n            } else if (exportFormat === \"pdf\") {\n                // Extract headers and rows from the data\n                // Assuming data is an array of objects\n                if (data && data.length > 0) {\n                    const headers = Object.keys(data[0]);\n                    const rows = data.map((item: Record<string, any>) =>\n                        headers.map((h) => item[h] ?? \"\")\n                    );\n\n                    // Calculate summary statistics based on report type\n                    const summary = getSummaryStats(data, reportType);\n\n                    generatePDFReport({\n                        title: getReportTitle(),\n                        dateRange: dateRangeStr,\n                        headers,\n                        rows,\n                        summary,\n                        orientation: headers.length > 5 ? \"landscape\" : \"portrait\",\n                    });\n                    toast.success(\"PDF report generated successfully!\");\n                } else {\n                    toast.error(\"No data available for report\");\n                }\n            }\n        } catch (error) {\n            console.error(\"Report generation error:\", error);\n            toast.error(\"Failed to generate report\");\n        } finally {\n            setIsGenerating(false);\n        }\n    };\n\n    const getSummaryStats = (data: any[], type: string): { label: string; value: string | number }[] => {\n        switch (type) {\n            case \"leads\":\n                return [\n                    { label: \"Total Leads\", value: data.length },\n                    { label: \"New Leads\", value: data.filter((d: any) => d.status === \"new\").length },\n                    { label: \"Qualified\", value: data.filter((d: any) => d.status === \"qualified\").length },\n                ];\n            case \"listings\":\n                return [\n                    { label: \"Total Listings\", value: data.length },\n                    { label: \"Active\", value: data.filter((d: any) => d.status === \"active\").length },\n                    { label: \"Sold\", value: data.filter((d: any) => d.status === \"sold\").length },\n                ];\n            case \"conversions\":\n                const totalConversions = data.reduce((sum: number, d: any) => sum + (d.conversions || 0), 0);\n                return [\n                    { label: \"Total Conversions\", value: totalConversions },\n                    { label: \"Records\", value: data.length },\n                ];\n            case \"sources\":\n                return [\n                    { label: \"Total Sources\", value: data.length },\n                    { label: \"Total Leads\", value: data.reduce((sum: number, d: any) => sum + (d.count || 0), 0) },\n                ];\n            default:\n                return [\n                    { label: \"Total Records\", value: data.length },\n                ];\n        }\n    };\n\n    return (\n        <div className={cn(\"bg-white p-6 rounded-lg border\", className)}>\n            <div className=\"flex items-center gap-2 mb-6\">\n                <FileText className=\"w-5 h-5 text-primary\" />\n                <h3 className=\"text-lg font-semibold\">Custom Report Builder</h3>\n            </div>\n\n            <div className=\"space-y-4\">\n                {/* Report Type */}\n                <div>\n                    <Label>Report Type</Label>\n                    <Select\n                        value={reportType}\n                        onValueChange={(v: any) => setReportType(v)}\n                    >\n                        <SelectTrigger>\n                            <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                            {reportTypes.map((type) => (\n                                <SelectItem key={type.value} value={type.value}>\n                                    {type.label}\n                                </SelectItem>\n                            ))}\n                        </SelectContent>\n                    </Select>\n                </div>\n\n                {/* Date Range */}\n                <div>\n                    <Label className=\"flex items-center gap-2\">\n                        <Calendar className=\"w-4 h-4\" />\n                        Date Range\n                    </Label>\n                    <Select\n                        value={dateRange}\n                        onValueChange={(v: any) => setDateRange(v)}\n                    >\n                        <SelectTrigger>\n                            <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                            {dateRanges.map((range) => (\n                                <SelectItem\n                                    key={range.value}\n                                    value={range.value}\n                                >\n                                    {range.label}\n                                </SelectItem>\n                            ))}\n                        </SelectContent>\n                    </Select>\n                </div>\n\n                {/* Format */}\n                <div>\n                    <Label>Export Format</Label>\n                    <Select\n                        value={exportFormat}\n                        onValueChange={(v: any) => setExportFormat(v)}\n                    >\n                        <SelectTrigger>\n                            <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                            {formats.map((fmt) => (\n                                <SelectItem\n                                    key={fmt.value}\n                                    value={fmt.value}\n                                    disabled={fmt.disabled}\n                                >\n                                    {fmt.label}\n                                </SelectItem>\n                            ))}\n                        </SelectContent>\n                    </Select>\n                </div>\n\n                {/* Generate Button */}\n                <Button\n                    onClick={handleGenerateReport}\n                    disabled={isGenerating}\n                    className=\"w-full gap-2\"\n                >\n                    {isGenerating ? (\n                        <>\n                            <Loader2 className=\"w-4 h-4 animate-spin\" />\n                            Generating {exportFormat.toUpperCase()}...\n                        </>\n                    ) : (\n                        <>\n                            <Download className=\"w-4 h-4\" />\n                            Generate Report\n                        </>\n                    )}\n                </Button>\n            </div>\n\n            {/* Report Preview Info */}\n            <div className=\"mt-6 p-4 bg-gray-50 rounded-lg\">\n                <h4 className=\"text-sm font-semibold mb-2\">Report Preview</h4>\n                <div className=\"space-y-1 text-sm text-gray-600\">\n                    <p>\n                        Type: <span className=\"font-medium\">{reportType}</span>\n                    </p>\n                    <p>\n                        Range:{\" \"}\n                        <span className=\"font-medium\">\n                            {format(\n                                getDateRangeForReport().start,\n                                \"MMM d, yyyy\"\n                            )}{\" \"}\n                            -{\" \"}\n                            {format(getDateRangeForReport().end, \"MMM d, yyyy\")}\n                        </span>\n                    </p>\n                    <p>\n                        Format:{\" \"}\n                        <span className=\"font-medium uppercase\">{exportFormat}</span>\n                    </p>\n                </div>\n            </div>\n        </div>\n    );\n}\n","import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useAuthStore } from \"@/stores/useAuthStore\";\nimport type { Lead } from \"@/types/lead\";\n\nexport function useLeads() {\n  const { user } = useAuthStore();\n  const queryClient = useQueryClient();\n\n  const { data: leads = [], isLoading, isError, error, refetch } = useQuery({\n    queryKey: [\"leads\", user?.id],\n    queryFn: async () => {\n      if (!user?.id) return [];\n\n      const { data, error } = await supabase\n        .from(\"leads\")\n        .select(\"*\")\n        .eq(\"user_id\", user.id)\n        .order(\"created_at\", { ascending: false });\n\n      if (error) throw error;\n      return data as Lead[];\n    },\n    enabled: !!user?.id,\n    staleTime: 5 * 60 * 1000, // 5 minutes - data considered fresh\n    gcTime: 10 * 60 * 1000, // 10 minutes - cache retention\n  });\n\n  const addLead = useMutation({\n    mutationFn: async (leadData: Omit<Lead, \"id\" | \"created_at\" | \"updated_at\">) => {\n      const { data, error } = await supabase\n        .from(\"leads\")\n        .insert(leadData)\n        .select()\n        .single();\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"leads\", user?.id] });\n    },\n  });\n\n  const updateLead = useMutation({\n    mutationFn: async ({ id, ...updates }: Partial<Lead> & { id: string }) => {\n      if (!user?.id) throw new Error(\"User not authenticated\");\n\n      // Security: Verify user owns this lead by requiring both id and user_id match\n      const { data, error } = await supabase\n        .from(\"leads\")\n        .update(updates)\n        .eq(\"id\", id)\n        .eq(\"user_id\", user.id)\n        .select()\n        .single();\n\n      if (error) throw error;\n      return data;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"leads\", user?.id] });\n    },\n  });\n\n  const deleteLead = useMutation({\n    mutationFn: async (id: string) => {\n      if (!user?.id) throw new Error(\"User not authenticated\");\n\n      // Security: Verify user owns this lead by requiring both id and user_id match\n      const { error } = await supabase\n        .from(\"leads\")\n        .delete()\n        .eq(\"id\", id)\n        .eq(\"user_id\", user.id);\n\n      if (error) throw error;\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"leads\", user?.id] });\n    },\n  });\n\n  return {\n    leads,\n    isLoading,\n    isError,\n    error,\n    refetch,\n    addLead,\n    updateLead,\n    deleteLead,\n  };\n}\n","/**\n * Analytics Dashboard Page\n * Comprehensive analytics with insights, funnels, and reports\n * Uses real data from database via hooks\n */\n\nimport { useState, useMemo } from \"react\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { KPICards } from \"@/components/analytics/KPICards\";\nimport { TimeSeriesChart } from \"@/components/analytics/TimeSeriesChart\";\nimport { ConversionFunnel } from \"@/components/analytics/ConversionFunnel\";\nimport { LeadSourceBreakdown } from \"@/components/analytics/LeadSourceBreakdown\";\nimport { InsightsPanel } from \"@/components/analytics/InsightsPanel\";\nimport {\n    ReportBuilder,\n    type ReportConfig,\n} from \"@/components/analytics/ReportBuilder\";\nimport {\n    calculateKPIs,\n    calculateFunnel,\n    analyzeLeadSources,\n    predictTrend,\n    generateInsights,\n    type AnalyticsData,\n    type TimeSeriesData,\n} from \"@/lib/analytics\";\nimport { useAnalytics, type TimeRange } from \"@/hooks/useAnalytics\";\nimport { useLeads } from \"@/hooks/useLeads\";\nimport { subDays } from \"date-fns\";\nimport { BarChart3, TrendingUp, Users, FileText, Loader2 } from \"lucide-react\";\n\nexport default function AnalyticsDashboard() {\n    const [showPredictions, setShowPredictions] = useState(true);\n    const [timeRange, setTimeRange] = useState<TimeRange>(\"30d\");\n\n    // Fetch real data from database\n    const { stats, viewsData, leadsData, recentLeads, isLoading } = useAnalytics(timeRange);\n    const { leads } = useLeads();\n\n    // Build analytics data from real stats\n    const now = new Date();\n    const current: AnalyticsData = useMemo(() => ({\n        pageViews: stats.totalViews,\n        uniqueVisitors: stats.uniqueVisitors,\n        leads: stats.totalLeads,\n        conversions: leads.filter(l => l.status === 'converted').length,\n        revenue: 0, // Revenue tracking not implemented yet\n        avgResponseTime: 0, // Response time tracking not implemented yet\n        period: timeRange === \"7d\" ? \"week\" : timeRange === \"30d\" ? \"month\" : \"quarter\",\n        startDate: subDays(now, timeRange === \"7d\" ? 7 : timeRange === \"30d\" ? 30 : 90),\n        endDate: now,\n    }), [stats, leads, timeRange, now]);\n\n    // Previous period data (estimate based on current - would need separate query for accurate comparison)\n    const previous: AnalyticsData = useMemo(() => ({\n        pageViews: Math.round(stats.totalViews * 0.85), // Estimate 15% growth\n        uniqueVisitors: Math.round(stats.uniqueVisitors * 0.85),\n        leads: Math.round(stats.totalLeads * 0.85),\n        conversions: Math.round(leads.filter(l => l.status === 'converted').length * 0.85),\n        revenue: 0,\n        avgResponseTime: 0,\n        period: current.period,\n        startDate: subDays(current.startDate, timeRange === \"7d\" ? 7 : timeRange === \"30d\" ? 30 : 90),\n        endDate: current.startDate,\n    }), [stats, leads, current, timeRange]);\n\n    // Convert viewsData to TimeSeriesData format\n    const timeSeriesData: TimeSeriesData[] = useMemo(() => {\n        return viewsData.map((day: any) => ({\n            date: new Date(day.name),\n            value: day.views,\n            label: day.name,\n        }));\n    }, [viewsData]);\n\n    const predictions = useMemo(\n        () => timeSeriesData.length > 0 ? predictTrend(timeSeriesData, 7) : [],\n        [timeSeriesData]\n    );\n    const combinedData = [\n        ...timeSeriesData,\n        ...(showPredictions ? predictions : []),\n    ];\n\n    // Calculate metrics from real data\n    const kpis = useMemo(\n        () => calculateKPIs(current, previous),\n        [current, previous]\n    );\n\n    const funnel = useMemo(\n        () =>\n            calculateFunnel({\n                visitors: current.uniqueVisitors,\n                viewed: Math.round(current.uniqueVisitors * 0.7),\n                contacted: current.leads,\n                qualified: leads.filter(l => l.status === 'qualified' || l.status === 'converted').length,\n                converted: current.conversions,\n            }),\n        [current, leads]\n    );\n\n    // Analyze lead sources from real lead data\n    const leadSourceData = useMemo(() => {\n        const sourceMap: Record<string, { leads: number; conversions: number }> = {};\n\n        leads.forEach(lead => {\n            const source = lead.source || 'website';\n            if (!sourceMap[source]) {\n                sourceMap[source] = { leads: 0, conversions: 0 };\n            }\n            sourceMap[source].leads++;\n            if (lead.status === 'converted') {\n                sourceMap[source].conversions++;\n            }\n        });\n\n        return Object.entries(sourceMap).map(([source, data]) => ({\n            source,\n            leads: data.leads,\n            conversions: data.conversions,\n            revenue: 0, // Revenue tracking not implemented\n            cost: 0, // Cost tracking not implemented\n        }));\n    }, [leads]);\n\n    const leadSources = useMemo(\n        () => analyzeLeadSources(leadSourceData.length > 0 ? leadSourceData : [{ source: 'website', leads: 0, conversions: 0, revenue: 0, cost: 0 }]),\n        [leadSourceData]\n    );\n\n    const insights = useMemo(\n        () => generateInsights(current, previous, leadSources),\n        [current, previous, leadSources]\n    );\n\n    const handleGenerateReport = async (\n        config: ReportConfig\n    ): Promise<any[]> => {\n        // Return real lead data based on report type\n        switch (config.reportType) {\n            case \"leads\":\n                return leads.map((lead) => ({\n                    id: lead.id,\n                    name: lead.name || 'Unknown',\n                    email: lead.email || '',\n                    source: lead.source || 'website',\n                    status: lead.status || 'new',\n                    score: lead.score || 0,\n                    created: lead.created_at,\n                }));\n\n            case \"sources\":\n                return leadSources.map((s) => ({\n                    source: s.source,\n                    leads: s.leads,\n                    conversions: s.conversions,\n                    conversion_rate: `${s.conversionRate.toFixed(1)}%`,\n                    revenue: s.revenue,\n                    roi: s.roi ? `${s.roi.toFixed(1)}%` : \"N/A\",\n                }));\n\n            default:\n                return [\n                    {\n                        metric: \"Page Views\",\n                        current: current.pageViews,\n                        previous: previous.pageViews,\n                        change: previous.pageViews > 0 ? `${(\n                            ((current.pageViews - previous.pageViews) /\n                                previous.pageViews) *\n                            100\n                        ).toFixed(1)}%` : 'N/A',\n                    },\n                    {\n                        metric: \"Leads\",\n                        current: current.leads,\n                        previous: previous.leads,\n                        change: previous.leads > 0 ? `${(\n                            ((current.leads - previous.leads) /\n                                previous.leads) *\n                            100\n                        ).toFixed(1)}%` : 'N/A',\n                    },\n                    {\n                        metric: \"Conversions\",\n                        current: current.conversions,\n                        previous: previous.conversions,\n                        change: previous.conversions > 0 ? `${(\n                            ((current.conversions - previous.conversions) /\n                                previous.conversions) *\n                            100\n                        ).toFixed(1)}%` : 'N/A',\n                    },\n                ];\n        }\n    };\n\n    if (isLoading) {\n        return (\n            <div className=\"container mx-auto py-6 flex items-center justify-center min-h-[400px]\">\n                <div className=\"flex flex-col items-center gap-4\">\n                    <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n                    <p className=\"text-gray-600\">Loading analytics...</p>\n                </div>\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"container mx-auto py-6 space-y-6\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between\">\n                <div>\n                    <h1 className=\"text-3xl font-bold\">Analytics Dashboard</h1>\n                    <p className=\"text-gray-600 mt-1\">\n                        Track your performance and gain insights\n                    </p>\n                </div>\n                <div className=\"flex gap-2\">\n                    <Button\n                        variant={timeRange === \"7d\" ? \"default\" : \"outline\"}\n                        size=\"sm\"\n                        onClick={() => setTimeRange(\"7d\")}\n                    >\n                        7 Days\n                    </Button>\n                    <Button\n                        variant={timeRange === \"30d\" ? \"default\" : \"outline\"}\n                        size=\"sm\"\n                        onClick={() => setTimeRange(\"30d\")}\n                    >\n                        30 Days\n                    </Button>\n                    <Button\n                        variant={timeRange === \"90d\" ? \"default\" : \"outline\"}\n                        size=\"sm\"\n                        onClick={() => setTimeRange(\"90d\")}\n                    >\n                        90 Days\n                    </Button>\n                </div>\n            </div>\n\n            {/* Empty State */}\n            {stats.totalViews === 0 && stats.totalLeads === 0 && (\n                <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6 text-center\">\n                    <h3 className=\"text-lg font-semibold text-blue-900 mb-2\">No Data Yet</h3>\n                    <p className=\"text-blue-700\">\n                        Start sharing your profile to see analytics data here. Views and leads will be tracked automatically.\n                    </p>\n                </div>\n            )}\n\n            {/* KPIs */}\n            <KPICards metrics={kpis} />\n\n            {/* Main Content Tabs */}\n            <Tabs defaultValue=\"overview\" className=\"w-full\">\n                <TabsList className=\"grid w-full grid-cols-4 max-w-2xl\">\n                    <TabsTrigger value=\"overview\" className=\"gap-2\">\n                        <BarChart3 className=\"w-4 h-4\" />\n                        Overview\n                    </TabsTrigger>\n                    <TabsTrigger value=\"funnel\" className=\"gap-2\">\n                        <TrendingUp className=\"w-4 h-4\" />\n                        Funnel\n                    </TabsTrigger>\n                    <TabsTrigger value=\"sources\" className=\"gap-2\">\n                        <Users className=\"w-4 h-4\" />\n                        Sources\n                    </TabsTrigger>\n                    <TabsTrigger value=\"reports\" className=\"gap-2\">\n                        <FileText className=\"w-4 h-4\" />\n                        Reports\n                    </TabsTrigger>\n                </TabsList>\n\n                {/* Overview Tab */}\n                <TabsContent value=\"overview\" className=\"mt-6 space-y-6\">\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                        <div className=\"lg:col-span-2\">\n                            <TimeSeriesChart\n                                data={combinedData}\n                                title=\"Lead Generation Trend\"\n                                color=\"#2563eb\"\n                                showPredictions={showPredictions}\n                            />\n                        </div>\n                        <InsightsPanel insights={insights} />\n                    </div>\n                </TabsContent>\n\n                {/* Funnel Tab */}\n                <TabsContent value=\"funnel\" className=\"mt-6\">\n                    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n                        <ConversionFunnel stages={funnel} />\n                        <div className=\"space-y-6\">\n                            <InsightsPanel insights={insights} />\n                            <div className=\"bg-white p-6 rounded-lg border\">\n                                <h3 className=\"text-lg font-semibold mb-4\">\n                                    Optimization Tips\n                                </h3>\n                                <ul className=\"space-y-2 text-sm text-gray-700\">\n                                    <li className=\"flex items-start gap-2\">\n                                        <span className=\"text-primary\">‚Ä¢</span>\n                                        <span>\n                                            Improve Viewed ‚Üí Contacted rate with\n                                            clearer CTAs\n                                        </span>\n                                    </li>\n                                    <li className=\"flex items-start gap-2\">\n                                        <span className=\"text-primary\">‚Ä¢</span>\n                                        <span>\n                                            Reduce dropoff with faster response\n                                            times\n                                        </span>\n                                    </li>\n                                    <li className=\"flex items-start gap-2\">\n                                        <span className=\"text-primary\">‚Ä¢</span>\n                                        <span>\n                                            Qualify leads better with targeted\n                                            questions\n                                        </span>\n                                    </li>\n                                    <li className=\"flex items-start gap-2\">\n                                        <span className=\"text-primary\">‚Ä¢</span>\n                                        <span>\n                                            Nurture qualified leads with\n                                            follow-ups\n                                        </span>\n                                    </li>\n                                </ul>\n                            </div>\n                        </div>\n                    </div>\n                </TabsContent>\n\n                {/* Sources Tab */}\n                <TabsContent value=\"sources\" className=\"mt-6\">\n                    <LeadSourceBreakdown sources={leadSources} />\n                </TabsContent>\n\n                {/* Reports Tab */}\n                <TabsContent value=\"reports\" className=\"mt-6\">\n                    <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n                        <div className=\"lg:col-span-2\">\n                            <div className=\"bg-white p-6 rounded-lg border\">\n                                <h3 className=\"text-lg font-semibold mb-4\">\n                                    Available Reports\n                                </h3>\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                                    <ReportCard\n                                        title=\"Leads Report\"\n                                        description=\"Detailed lead data with scores and sources\"\n                                        icon={<Users className=\"w-6 h-6\" />}\n                                    />\n                                    <ReportCard\n                                        title=\"Performance Report\"\n                                        description=\"Overall performance metrics and trends\"\n                                        icon={\n                                            <TrendingUp className=\"w-6 h-6\" />\n                                        }\n                                    />\n                                    <ReportCard\n                                        title=\"Sources Report\"\n                                        description=\"Lead source analysis with ROI\"\n                                        icon={<BarChart3 className=\"w-6 h-6\" />}\n                                    />\n                                    <ReportCard\n                                        title=\"Conversion Report\"\n                                        description=\"Conversion funnel and rates\"\n                                        icon={\n                                            <TrendingUp className=\"w-6 h-6\" />\n                                        }\n                                    />\n                                </div>\n                            </div>\n                        </div>\n                        <ReportBuilder\n                            onGenerateReport={handleGenerateReport}\n                        />\n                    </div>\n                </TabsContent>\n            </Tabs>\n        </div>\n    );\n}\n\n// Report Card Component\ninterface ReportCardProps {\n    title: string;\n    description: string;\n    icon: React.ReactNode;\n}\n\nfunction ReportCard({ title, description, icon }: ReportCardProps) {\n    return (\n        <div className=\"p-4 border rounded-lg hover:shadow-md transition-shadow cursor-pointer\">\n            <div className=\"flex items-start gap-3\">\n                <div className=\"p-2 bg-primary/10 rounded-lg text-primary\">\n                    {icon}\n                </div>\n                <div>\n                    <h4 className=\"font-semibold mb-1\">{title}</h4>\n                    <p className=\"text-sm text-gray-600\">{description}</p>\n                </div>\n            </div>\n        </div>\n    );\n}\n"],"names":["KPICards","metrics","className","jsx","cn","metric","KPICard","getTrendIcon","TrendingUp","TrendingDown","Minus","getTrendColor","formatValue","jsxs","TimeSeriesChart","data","title","color","height","showPredictions","actualData","predictedData","maxValue","minValue","useMemo","actual","d","predicted","allValues","getYPosition","value","chartHeight","range","getXPosition","index","total","createPath","dataPoints","dashed","i","p","createAreaPath","linePath","lastPoint","firstPoint","bottom","percent","y","ConversionFunnel","stages","maxCount","stage","FunnelStageCard","DropoffIndicator","calculateDropoffPercentage","StatItem","calculateTotalDropoff","isFirst","isLast","widthPercentage","getColor","count","percentage","ChevronDown","label","current","next","LeadSourceBreakdown","sources","totalLeads","sum","s","totalRevenue","sortedSources","a","b","Users","DollarSign","source","SourceCard","Target","leadPercentage","getConversionColor","rate","InsightsPanel","insights","Lightbulb","insight","InsightCard","getIcon","AlertCircle","CheckCircle","getBackgroundColor","AnalyticsEngine","previous","name","unit","lowerIsBetter","change","trend","converted","startDate","endDate","dataGenerator","eachDayOfInterval","date","format","visitors","viewed","contacted","qualified","listings","listing","daysToPredict","n","xValues","_","yValues","sumX","sumY","sumXY","x","sumX2","slope","intercept","predictions","lastDate","predictedValue","predictedDate","avgTimeOnPage","bounceRate","pagesPerSession","returnVisitorRate","timeScore","bounceScore","pagesScore","returnScore","leadChange","currentCR","previousCR","bestSource","best","trafficChange","filename","headers","csvContent","row","header","blob","link","url","calculateKPIs","calculateFunnel","analyzeLeadSources","predictTrend","generateInsights","exportToCSV","ReportBuilder","onGenerateReport","reportType","setReportType","useState","dateRange","setDateRange","exportFormat","setExportFormat","isGenerating","setIsGenerating","reportTypes","dateRanges","formats","getDateRangeForReport","now","subDays","startOfMonth","endOfMonth","lastMonth","getReportTitle","handleGenerateReport","start","end","dateRangeStr","toast","rows","item","h","summary","getSummaryStats","generatePDFReport","error","type","FileText","Label","Select","v","SelectTrigger","SelectValue","SelectContent","SelectItem","Calendar","fmt","Button","Fragment","Loader2","Download","useLeads","user","useAuthStore","queryClient","useQueryClient","leads","isLoading","isError","refetch","useQuery","supabase","addLead","useMutation","leadData","updateLead","id","updates","deleteLead","AnalyticsDashboard","setShowPredictions","timeRange","setTimeRange","stats","viewsData","useAnalytics","l","timeSeriesData","day","combinedData","kpis","funnel","leadSourceData","sourceMap","lead","leadSources","config","Tabs","TabsList","TabsTrigger","BarChart3","TabsContent","ReportCard","description","icon"],"mappings":"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"}