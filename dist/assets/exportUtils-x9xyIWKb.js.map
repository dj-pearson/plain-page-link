{"version":3,"file":"exportUtils-x9xyIWKb.js","sources":["../../src/lib/exportUtils.ts"],"sourcesContent":["/**\n * Export Utilities for Analytics Data\n * Supports CSV and PDF export formats\n */\n\nimport { jsPDF } from 'jspdf';\nimport autoTable from 'jspdf-autotable';\n\nexport interface ExportData {\n    headers: string[];\n    rows: (string | number)[][];\n    title?: string;\n    dateRange?: string;\n}\n\nexport interface PDFReportOptions {\n    title: string;\n    subtitle?: string;\n    dateRange?: string;\n    headers: string[];\n    rows: (string | number)[][];\n    summary?: {\n        label: string;\n        value: string | number;\n    }[];\n    footer?: string;\n    orientation?: 'portrait' | 'landscape';\n    theme?: 'striped' | 'grid' | 'plain';\n}\n\n/**\n * Export data to CSV format\n */\nexport function exportToCSV(data: ExportData): void {\n    const { headers, rows, title } = data;\n\n    // Create CSV content\n    let csvContent = '';\n\n    // Add title if provided\n    if (title) {\n        csvContent += `${title}\\n\\n`;\n    }\n\n    // Add headers\n    csvContent += headers.join(',') + '\\n';\n\n    // Add rows\n    rows.forEach((row) => {\n        const escapedRow = row.map((cell) => {\n            // Escape cells containing commas or quotes\n            const cellStr = String(cell);\n            if (cellStr.includes(',') || cellStr.includes('\"') || cellStr.includes('\\n')) {\n                return `\"${cellStr.replace(/\"/g, '\"\"')}\"`;\n            }\n            return cellStr;\n        });\n        csvContent += escapedRow.join(',') + '\\n';\n    });\n\n    // Create blob and download\n    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n    const link = document.createElement('a');\n    const url = URL.createObjectURL(blob);\n\n    const filename = `${title?.replace(/\\s+/g, '_') || 'export'}_${\n        new Date().toISOString().split('T')[0]\n    }.csv`;\n\n    link.setAttribute('href', url);\n    link.setAttribute('download', filename);\n    link.style.visibility = 'hidden';\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n    URL.revokeObjectURL(url);\n}\n\n/**\n * Export data to PDF format using jsPDF\n * Creates a professional, downloadable PDF report\n */\nexport function exportToPDF(data: ExportData): void {\n    const { headers, rows, title, dateRange } = data;\n\n    generatePDFReport({\n        title: title || 'Analytics Report',\n        dateRange,\n        headers,\n        rows,\n    });\n}\n\n/**\n * Generate a professional PDF report with jsPDF\n */\nexport function generatePDFReport(options: PDFReportOptions): void {\n    const {\n        title,\n        subtitle,\n        dateRange,\n        headers,\n        rows,\n        summary,\n        footer,\n        orientation = 'portrait',\n        theme = 'striped',\n    } = options;\n\n    // Create new PDF document\n    const doc = new jsPDF({\n        orientation,\n        unit: 'mm',\n        format: 'a4',\n    });\n\n    const pageWidth = doc.internal.pageSize.getWidth();\n    const pageHeight = doc.internal.pageSize.getHeight();\n    const margin = 20;\n    let yPosition = margin;\n\n    // Brand colors\n    const primaryColor: [number, number, number] = [37, 99, 235]; // #2563eb\n    const textColor: [number, number, number] = [31, 41, 55]; // #1f2937\n    const mutedColor: [number, number, number] = [107, 114, 128]; // #6b7280\n\n    // Add header with logo placeholder\n    doc.setFillColor(...primaryColor);\n    doc.rect(0, 0, pageWidth, 35, 'F');\n\n    // Title\n    doc.setFont('helvetica', 'bold');\n    doc.setFontSize(20);\n    doc.setTextColor(255, 255, 255);\n    doc.text(title, margin, 20);\n\n    // Subtitle or date range\n    if (subtitle || dateRange) {\n        doc.setFont('helvetica', 'normal');\n        doc.setFontSize(11);\n        doc.setTextColor(220, 220, 220);\n        doc.text(subtitle || dateRange || '', margin, 28);\n    }\n\n    yPosition = 50;\n\n    // Summary cards (if provided)\n    if (summary && summary.length > 0) {\n        const cardWidth = (pageWidth - margin * 2 - (summary.length - 1) * 10) / summary.length;\n        const cardHeight = 25;\n\n        summary.forEach((item, index) => {\n            const xPos = margin + index * (cardWidth + 10);\n\n            // Card background\n            doc.setFillColor(249, 250, 251); // #f9fafb\n            doc.setDrawColor(229, 231, 235); // #e5e7eb\n            doc.roundedRect(xPos, yPosition, cardWidth, cardHeight, 3, 3, 'FD');\n\n            // Label\n            doc.setFont('helvetica', 'normal');\n            doc.setFontSize(9);\n            doc.setTextColor(...mutedColor);\n            doc.text(item.label, xPos + 5, yPosition + 8);\n\n            // Value\n            doc.setFont('helvetica', 'bold');\n            doc.setFontSize(14);\n            doc.setTextColor(...textColor);\n            doc.text(String(item.value), xPos + 5, yPosition + 19);\n        });\n\n        yPosition += cardHeight + 15;\n    }\n\n    // Data table\n    autoTable(doc, {\n        head: [headers],\n        body: rows.map(row => row.map(cell => String(cell))),\n        startY: yPosition,\n        margin: { left: margin, right: margin },\n        theme,\n        headStyles: {\n            fillColor: primaryColor,\n            textColor: [255, 255, 255],\n            fontStyle: 'bold',\n            fontSize: 10,\n            cellPadding: 4,\n        },\n        bodyStyles: {\n            textColor: textColor,\n            fontSize: 9,\n            cellPadding: 3,\n        },\n        alternateRowStyles: {\n            fillColor: [249, 250, 251], // #f9fafb\n        },\n        styles: {\n            overflow: 'linebreak',\n            cellWidth: 'auto',\n        },\n        columnStyles: {\n            0: { cellWidth: 'auto' },\n        },\n        didDrawPage: (data) => {\n            // Add page number\n            const pageNumber = doc.internal.pages.length - 1;\n            doc.setFont('helvetica', 'normal');\n            doc.setFontSize(8);\n            doc.setTextColor(...mutedColor);\n            doc.text(\n                `Page ${pageNumber}`,\n                pageWidth / 2,\n                pageHeight - 10,\n                { align: 'center' }\n            );\n        },\n    });\n\n    // Footer\n    const finalY = (doc as any).lastAutoTable?.finalY || yPosition + 50;\n\n    if (finalY < pageHeight - 40) {\n        doc.setDrawColor(229, 231, 235);\n        doc.line(margin, finalY + 10, pageWidth - margin, finalY + 10);\n\n        doc.setFont('helvetica', 'normal');\n        doc.setFontSize(8);\n        doc.setTextColor(...mutedColor);\n\n        const footerText = footer || `Generated on ${new Date().toLocaleString()} | AgentBio.net`;\n        doc.text(footerText, margin, finalY + 18);\n\n        // Add AgentBio branding\n        doc.setFont('helvetica', 'bold');\n        doc.setTextColor(...primaryColor);\n        doc.text('AgentBio Intelligence', pageWidth - margin, finalY + 18, { align: 'right' });\n    }\n\n    // Generate filename\n    const filename = `${title.replace(/\\s+/g, '_').toLowerCase()}_${\n        new Date().toISOString().split('T')[0]\n    }.pdf`;\n\n    // Download the PDF\n    doc.save(filename);\n}\n\n/**\n * Export data to PDF format (legacy - opens print dialog)\n * Use generatePDFReport for direct PDF download\n */\nexport function exportToPDFPrint(data: ExportData): void {\n    const { headers, rows, title, dateRange } = data;\n\n    // Create a simple HTML table for PDF\n    let htmlContent = `\n        <!DOCTYPE html>\n        <html>\n        <head>\n            <meta charset=\"utf-8\">\n            <title>${title || 'Analytics Report'}</title>\n            <style>\n                body {\n                    font-family: Arial, sans-serif;\n                    padding: 40px;\n                    color: #333;\n                }\n                h1 {\n                    color: #2563eb;\n                    margin-bottom: 10px;\n                }\n                .date-range {\n                    color: #666;\n                    font-size: 14px;\n                    margin-bottom: 30px;\n                }\n                table {\n                    width: 100%;\n                    border-collapse: collapse;\n                    margin-top: 20px;\n                }\n                th {\n                    background-color: #2563eb;\n                    color: white;\n                    padding: 12px;\n                    text-align: left;\n                    font-weight: 600;\n                }\n                td {\n                    padding: 10px 12px;\n                    border-bottom: 1px solid #e5e7eb;\n                }\n                tr:nth-child(even) {\n                    background-color: #f9fafb;\n                }\n                .footer {\n                    margin-top: 40px;\n                    padding-top: 20px;\n                    border-top: 1px solid #e5e7eb;\n                    color: #666;\n                    font-size: 12px;\n                    text-align: center;\n                }\n            </style>\n        </head>\n        <body>\n            <h1>${title || 'Analytics Report'}</h1>\n            ${dateRange ? `<div class=\"date-range\">${dateRange}</div>` : ''}\n            <table>\n                <thead>\n                    <tr>\n                        ${headers.map((h) => `<th>${h}</th>`).join('')}\n                    </tr>\n                </thead>\n                <tbody>\n                    ${rows\n                        .map(\n                            (row) =>\n                                `<tr>${row.map((cell) => `<td>${cell}</td>`).join('')}</tr>`\n                        )\n                        .join('')}\n                </tbody>\n            </table>\n            <div class=\"footer\">\n                Generated on ${new Date().toLocaleString()} | AgentBio.net Analytics\n            </div>\n        </body>\n        </html>\n    `;\n\n    // Create a new window and print\n    const printWindow = window.open('', '', 'height=600,width=800');\n    if (printWindow) {\n        printWindow.document.write(htmlContent);\n        printWindow.document.close();\n\n        // Wait for content to load, then print\n        printWindow.onload = () => {\n            printWindow.print();\n            // Close after printing (optional)\n            setTimeout(() => {\n                printWindow.close();\n            }, 100);\n        };\n    }\n}\n\n/**\n * Format analytics data for export\n */\nexport function formatAnalyticsForExport(\n    queries: Array<{ query: string; clicks: number; impressions: number; ctr: number; position: number }>,\n    title: string = 'Search Analytics Report',\n    dateRange?: string\n): ExportData {\n    return {\n        title,\n        dateRange,\n        headers: ['Query', 'Clicks', 'Impressions', 'CTR', 'Avg. Position'],\n        rows: queries.map((q) => [\n            q.query,\n            q.clicks,\n            q.impressions,\n            `${(q.ctr * 100).toFixed(2)}%`,\n            q.position.toFixed(1),\n        ]),\n    };\n}\n\n/**\n * Format leads data for export\n */\nexport function formatLeadsForExport(\n    leads: Array<{\n        name: string;\n        email: string;\n        phone?: string;\n        type: string;\n        status: string;\n        created_at: string;\n    }>,\n    title: string = 'Leads Report',\n    dateRange?: string\n): ExportData {\n    return {\n        title,\n        dateRange,\n        headers: ['Name', 'Email', 'Phone', 'Type', 'Status', 'Date'],\n        rows: leads.map((lead) => [\n            lead.name,\n            lead.email,\n            lead.phone || 'N/A',\n            lead.type,\n            lead.status,\n            new Date(lead.created_at).toLocaleDateString(),\n        ]),\n    };\n}\n\n/**\n * Format listings data for export\n */\nexport function formatListingsForExport(\n    listings: Array<{\n        title: string;\n        price: number;\n        status: string;\n        bedrooms: number;\n        bathrooms: number;\n        square_feet?: number;\n    }>,\n    title: string = 'Listings Report',\n    dateRange?: string\n): ExportData {\n    return {\n        title,\n        dateRange,\n        headers: ['Property', 'Price', 'Beds', 'Baths', 'Sq Ft', 'Status'],\n        rows: listings.map((listing) => [\n            listing.title,\n            `$${listing.price.toLocaleString()}`,\n            listing.bedrooms,\n            listing.bathrooms,\n            listing.square_feet || 'N/A',\n            listing.status,\n        ]),\n    };\n}\n"],"names":["exportToCSV","data","headers","rows","title","csvContent","row","escapedRow","cell","cellStr","blob","link","url","filename","exportToPDF","dateRange","generatePDFReport","options","subtitle","summary","footer","orientation","theme","doc","jsPDF","pageWidth","pageHeight","margin","yPosition","primaryColor","textColor","mutedColor","cardWidth","cardHeight","item","index","xPos","autoTable","pageNumber","finalY","footerText","formatAnalyticsForExport","queries","q"],"mappings":"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"}