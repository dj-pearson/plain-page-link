import{b as i,u as e,d as t}from"./data-ChU7VID-.js";import{u as s,s as n}from"./index-DxTo7WPx.js";function r(){const{user:r}=s(),a=i(),{data:d=[],isLoading:o}=e({queryKey:["listings",null==r?void 0:r.id],queryFn:async()=>{if(!(null==r?void 0:r.id))return[];const{data:i,error:e}=await n.from("listings").select("*").eq("user_id",r.id).order("created_at",{ascending:!1});if(e)throw e;return i},enabled:!!(null==r?void 0:r.id)});return{listings:d,isLoading:o,addListing:t({mutationFn:async i=>{if(!(null==r?void 0:r.id))throw new Error("User not authenticated");const{data:e,error:t}=await n.from("listings").insert({user_id:r.id,...i}).select().single();if(t)throw t;return e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",null==r?void 0:r.id]})}}),updateListing:t({mutationFn:async({id:i,...e})=>{const{data:t,error:s}=await n.from("listings").update(e).eq("id",i).select().single();if(s)throw s;return t},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",null==r?void 0:r.id]})}}),deleteListing:t({mutationFn:async i=>{const{error:e}=await n.from("listings").delete().eq("id",i);if(e)throw e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",null==r?void 0:r.id]})}})}}export{r as u};
