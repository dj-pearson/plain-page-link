import{u as i,c as e,a as t,d as s,s as r}from"./data-OhSCRAps.js";function n(){const{user:n}=i(),a=e(),{data:d=[],isLoading:o}=t({queryKey:["listings",n?.id],queryFn:async()=>{if(!n?.id)return[];const{data:i,error:e}=await r.from("listings").select("*").eq("user_id",n.id).order("created_at",{ascending:!1});if(e)throw e;return i},enabled:!!n?.id});return{listings:d,isLoading:o,addListing:s({mutationFn:async i=>{if(!n?.id)throw new Error("User not authenticated");const{data:e,error:t}=await r.from("listings").insert({user_id:n.id,...i}).select().single();if(t)throw t;return e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}}),updateListing:s({mutationFn:async({id:i,...e})=>{const{data:t,error:s}=await r.from("listings").update(e).eq("id",i).select().single();if(s)throw s;return t},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}}),deleteListing:s({mutationFn:async i=>{const{error:e}=await r.from("listings").delete().eq("id",i);if(e)throw e},onSuccess:()=>{a.invalidateQueries({queryKey:["listings",n?.id]})}})}}export{n as u};
