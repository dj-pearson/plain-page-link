import{r as e,j as s,g as t}from"./react-vendor-CGQ4_CNL.js";import{D as a,l as r,m as i,n as l,G as n,L as o,I as d,S as c,a as m,b as h,d as u,e as p,T as x,O as g,j}from"./ui-components-BeQXH7on.js";import{a6 as b,X as v,u as f,F as y,ak as N,f as w,b as C,ae as S,I as F,L as q,J as k,aw as P,S as L,ax as _,ay as I,az as $}from"./icons-BX9Iz4zT.js";import{a as A,u as z,s as D}from"./index-DND4zJty.js";import{u as T}from"./useListings-q1TLxKXf.js";import{u as U,U as M}from"./UpgradeModal-C5-PgU58.js";import{L as E}from"./LimitBanner-CM4efDH1.js";import{u as B}from"./useProfile-D7IPm_z9.js";import{K as O}from"./KeyboardShortcutsHelper-B_EJEQZS.js";import"./charts-D_q0pR-d.js";import"./utils-wmY8hpgz.js";import"./supabase-D5NmozDF.js";import"./data-O5cD9hjv.js";import"./three-addons-DQ5hBofG.js";import"./three-BxgHQpUo.js";import"./forms-BzNDvv3d.js";function R({open:t,onOpenChange:f,onSave:y}){const[N,w]=e.useState({address:"",city:"",state:"",zipCode:"",price:"",beds:3,baths:2,sqft:"",lotSize:"",propertyType:"single-family",status:"active",description:"",mlsNumber:"",yearBuilt:"",images:[]}),[C,S]=e.useState([]),F=e=>{const{name:s,value:t}=e.target;w(e=>({...e,[s]:t}))},q=(e,s)=>{const t=parseInt(s)||0;w(s=>({...s,[e]:t}))};return s.jsx(a,{open:t,onOpenChange:f,children:s.jsxs(r,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(i,{children:[s.jsx(l,{children:"Add New Property Listing"}),s.jsx(n,{children:"Fill in the details for your property listing"})]}),s.jsxs("form",{onSubmit:e=>{e.preventDefault(),y?.(N),f(!1),w({address:"",city:"",state:"",zipCode:"",price:"",beds:3,baths:2,sqft:"",lotSize:"",propertyType:"single-family",status:"active",description:"",mlsNumber:"",yearBuilt:"",images:[]}),S([])},className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Property Address"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx(o,{htmlFor:"address",children:"Street Address *"}),s.jsx(d,{id:"address",name:"address",value:N.address,onChange:F,placeholder:"123 Main Street",required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"city",children:"City *"}),s.jsx(d,{id:"city",name:"city",value:N.city,onChange:F,required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs("div",{children:[s.jsx(o,{htmlFor:"state",children:"State *"}),s.jsx(d,{id:"state",name:"state",value:N.state,onChange:F,maxLength:2,placeholder:"CA",required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"zipCode",children:"Zip *"}),s.jsx(d,{id:"zipCode",name:"zipCode",value:N.zipCode,onChange:F,placeholder:"94102",required:!0})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-semibold text-sm",children:"Property Details"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(o,{htmlFor:"price",children:"Price *"}),s.jsx(d,{id:"price",name:"price",value:N.price,onChange:F,placeholder:"1,250,000",required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"propertyType",children:"Property Type *"}),s.jsxs(c,{value:N.propertyType,onValueChange:e=>w(s=>({...s,propertyType:e})),children:[s.jsx(m,{children:s.jsx(h,{})}),s.jsxs(u,{children:[s.jsx(p,{value:"single-family",children:"Single Family"}),s.jsx(p,{value:"condo",children:"Condo"}),s.jsx(p,{value:"townhouse",children:"Townhouse"}),s.jsx(p,{value:"multi-family",children:"Multi-Family"}),s.jsx(p,{value:"land",children:"Land"}),s.jsx(p,{value:"commercial",children:"Commercial"})]})]})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"beds",children:"Bedrooms *"}),s.jsx(d,{id:"beds",type:"number",value:N.beds,onChange:e=>q("beds",e.target.value),min:0,required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"baths",children:"Bathrooms *"}),s.jsx(d,{id:"baths",type:"number",value:N.baths,onChange:e=>q("baths",e.target.value),min:0,step:.5,required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"sqft",children:"Square Feet *"}),s.jsx(d,{id:"sqft",name:"sqft",value:N.sqft,onChange:F,placeholder:"2,400",required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"lotSize",children:"Lot Size"}),s.jsx(d,{id:"lotSize",name:"lotSize",value:N.lotSize,onChange:F,placeholder:"0.25 acres"})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"status",children:"Status *"}),s.jsxs(c,{value:N.status,onValueChange:e=>w(s=>({...s,status:e})),children:[s.jsx(m,{children:s.jsx(h,{})}),s.jsxs(u,{children:[s.jsx(p,{value:"active",children:"Active"}),s.jsx(p,{value:"pending",children:"Pending"}),s.jsx(p,{value:"sold",children:"Sold"}),s.jsx(p,{value:"off-market",children:"Off Market"})]})]})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"yearBuilt",children:"Year Built"}),s.jsx(d,{id:"yearBuilt",name:"yearBuilt",value:N.yearBuilt,onChange:F,placeholder:"2015"})]})]})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"description",children:"Description"}),s.jsx(x,{id:"description",name:"description",value:N.description,onChange:F,rows:4,placeholder:"Beautiful property with stunning views..."})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"mlsNumber",children:"MLS Number"}),s.jsx(d,{id:"mlsNumber",name:"mlsNumber",value:N.mlsNumber,onChange:F,placeholder:"ML81234567"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(o,{children:"Property Photos"}),s.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center hover:bg-accent/50 transition-colors cursor-pointer",children:[s.jsx("input",{type:"file",multiple:!0,accept:"image/*",onChange:e=>{const s=Array.from(e.target.files||[]);w(e=>({...e,images:[...e.images,...s]})),s.forEach(e=>{const s=new FileReader;s.onloadend=()=>{S(e=>[...e,s.result])},s.readAsDataURL(e)})},className:"hidden",id:"image-upload"}),s.jsxs("label",{htmlFor:"image-upload",className:"cursor-pointer",children:[s.jsx(b,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Click to upload or drag and drop"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG up to 5MB (max 25 images)"})]})]}),C.length>0&&s.jsx("div",{className:"grid grid-cols-4 gap-3",children:C.map((e,t)=>s.jsxs("div",{className:"relative group",children:[s.jsx("img",{src:e,alt:`Preview ${t+1}`,className:"w-full h-24 object-cover rounded-lg"}),s.jsx("button",{type:"button",onClick:()=>(e=>{w(s=>({...s,images:s.images.filter((s,t)=>t!==e)})),S(s=>s.filter((s,t)=>t!==e))})(t),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:s.jsx(v,{className:"h-3 w-3"})})]},t))})]}),s.jsxs(g,{children:[s.jsx(j,{type:"button",variant:"outline",onClick:()=>f(!1),children:"Cancel"}),s.jsx(j,{type:"submit",children:"Add Listing"})]})]})]})})}function G({isOpen:t,onClose:a,onSubmit:r,initialData:i}){const[l,n]=e.useState(i);if(e.useEffect(()=>{n(i)},[i]),!t)return null;return s.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-card border border-border rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-card border-b border-border p-4 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Edit Property Listing"}),s.jsx("button",{onClick:a,className:"p-2 hover:bg-accent rounded-lg transition-colors",children:s.jsx(v,{className:"w-5 h-5"})})]}),s.jsxs("form",{onSubmit:e=>{e.preventDefault(),r(l)},className:"p-6 space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"col-span-2",children:[s.jsx(o,{htmlFor:"address",children:"Street Address *"}),s.jsx(d,{id:"address",value:l.address,onChange:e=>n({...l,address:e.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"city",children:"City *"}),s.jsx(d,{id:"city",value:l.city,onChange:e=>n({...l,city:e.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"price",children:"Price *"}),s.jsx(d,{id:"price",value:l.price,onChange:e=>n({...l,price:e.target.value}),placeholder:"$450,000",required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"beds",children:"Bedrooms *"}),s.jsx(d,{id:"beds",type:"number",value:l.beds,onChange:e=>n({...l,beds:parseInt(e.target.value)}),required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"baths",children:"Bathrooms *"}),s.jsx(d,{id:"baths",type:"number",value:l.baths,onChange:e=>n({...l,baths:parseInt(e.target.value)}),required:!0})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"sqft",children:"Square Feet"}),s.jsx(d,{id:"sqft",type:"number",value:l.sqft||"",onChange:e=>n({...l,sqft:parseInt(e.target.value)||void 0})})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"status",children:"Status *"}),s.jsxs(c,{value:l.status,onValueChange:e=>n({...l,status:e}),children:[s.jsx(m,{children:s.jsx(h,{})}),s.jsxs(u,{children:[s.jsx(p,{value:"active",children:"Active"}),s.jsx(p,{value:"pending",children:"Pending"}),s.jsx(p,{value:"under_contract",children:"Under Contract"}),s.jsx(p,{value:"sold",children:"Sold"})]})]})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"property_type",children:"Property Type"}),s.jsxs(c,{value:l.property_type||"",onValueChange:e=>n({...l,property_type:e}),children:[s.jsx(m,{children:s.jsx(h,{placeholder:"Select type"})}),s.jsxs(u,{children:[s.jsx(p,{value:"single_family",children:"Single Family"}),s.jsx(p,{value:"condo",children:"Condo"}),s.jsx(p,{value:"townhouse",children:"Townhouse"}),s.jsx(p,{value:"multi_family",children:"Multi-Family"}),s.jsx(p,{value:"land",children:"Land"})]})]})]}),s.jsxs("div",{children:[s.jsx(o,{htmlFor:"mls_number",children:"MLS Number"}),s.jsx(d,{id:"mls_number",value:l.mls_number||"",onChange:e=>n({...l,mls_number:e.target.value})})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(o,{htmlFor:"description",children:"Description"}),s.jsx(x,{id:"description",value:l.description||"",onChange:e=>n({...l,description:e.target.value}),rows:4,placeholder:"Describe the property features..."})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx(o,{htmlFor:"image",children:"Image URL"}),s.jsx(d,{id:"image",type:"url",value:l.image||"",onChange:e=>n({...l,image:e.target.value}),placeholder:"https://example.com/image.jpg"})]})]}),s.jsxs("div",{className:"flex gap-3 pt-4",children:[s.jsx(j,{type:"button",variant:"outline",onClick:a,className:"flex-1",children:"Cancel"}),s.jsx(j,{type:"submit",className:"flex-1",children:"Save Changes"})]})]})]})})}const Y=5242880,V=["image/jpeg","image/jpg","image/png","image/webp"];function H({open:t,onOpenChange:o,listing:d,agentName:c="Your Real Estate Agent"}){const{toast:m}=z(),[h,u]=e.useState(!1),[p,g]=e.useState((()=>{const e=[];if(e.push("ðŸ¡ NEW LISTING ALERT! ðŸ¡"),e.push(""),e.push(`ðŸ“ ${d.address}, ${d.city}`),e.push(`ðŸ’° ${b(d.price)}`),d.beds||d.baths){const s=[];d.beds&&s.push(`${d.beds} beds`),d.baths&&s.push(`${d.baths} baths`),e.push(`ðŸ›ï¸ ${s.join(" | ")}`)}return d.sqft&&e.push(`ðŸ“ ${d.sqft.toLocaleString()} sq ft`),e.push(""),e.push(`Don't miss out on this ${d.property_type||"amazing property"}!`),e.push(""),e.push("ðŸ“ž Contact me for details or to schedule a showing!"),e.push(""),e.push("#RealEstate #NewListing #HomesForSale #DreamHome #Property"),d.city&&e.push(`#${d.city.replace(/\s+/g,"")}RealEstate`),e.join("\n")})()),b=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(e),q=async()=>{try{await navigator.clipboard.writeText(p),u(!0),m({title:"Copied!",description:"Post text copied to clipboard"}),setTimeout(()=>u(!1),2e3)}catch(e){m({title:"Failed to copy",description:"Please copy manually",variant:"destructive"})}};return s.jsx(a,{open:t,onOpenChange:o,children:s.jsxs(r,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsxs(i,{children:[s.jsxs(l,{className:"text-2xl flex items-center gap-2",children:[s.jsx(f,{className:"h-6 w-6 text-blue-600"}),"Share Your New Listing"]}),s.jsx(n,{children:"Post automatically generated - customize and share on social media"})]}),s.jsxs("div",{className:"space-y-6",children:[d.image&&s.jsxs("div",{className:"relative rounded-lg overflow-hidden border border-border",children:[s.jsx("img",{src:d.image,alt:d.address,className:"w-full h-48 object-cover"}),s.jsx("div",{className:"absolute top-2 right-2 bg-green-600 text-white px-3 py-1 rounded-full text-sm font-bold",children:"NEW"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Post Caption"}),s.jsx(x,{value:p,onChange:e=>g(e.target.value),rows:12,className:"font-sans text-sm resize-none",placeholder:"Customize your post..."}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"ðŸ’¡ Tip: Add your phone number or website for easy contact"}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[p.length," characters"]})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[s.jsxs(j,{onClick:()=>{const e=encodeURIComponent(window.location.origin),s=encodeURIComponent(p);window.open(`https://www.facebook.com/sharer/sharer.php?u=${e}&quote=${s}`,"_blank")},variant:"outline",className:"justify-start",children:[s.jsx(y,{className:"h-4 w-4 mr-2 text-blue-600"}),"Facebook"]}),s.jsxs(j,{onClick:()=>{const e=encodeURIComponent(p.substring(0,280));window.open(`https://twitter.com/intent/tweet?text=${e}`,"_blank")},variant:"outline",className:"justify-start",children:[s.jsx(N,{className:"h-4 w-4 mr-2 text-sky-500"}),"Twitter/X"]}),s.jsxs(j,{onClick:()=>{const e=encodeURIComponent(window.location.origin);window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${e}`,"_blank")},variant:"outline",className:"justify-start",children:[s.jsx(w,{className:"h-4 w-4 mr-2 text-blue-700"}),"LinkedIn"]}),s.jsxs(j,{onClick:async()=>{if(navigator.share)try{await navigator.share({title:`New Listing: ${d.address}`,text:p})}catch(e){}else q()},variant:"outline",className:"justify-start",children:[s.jsx(f,{className:"h-4 w-4 mr-2"}),"More..."]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(j,{onClick:q,variant:"secondary",className:"flex-1",children:h?s.jsxs(s.Fragment,{children:[s.jsx(C,{className:"h-4 w-4 mr-2 text-green-600"}),"Copied!"]}):s.jsxs(s.Fragment,{children:[s.jsx(S,{className:"h-4 w-4 mr-2"}),"Copy Text"]})}),s.jsxs(j,{onClick:()=>o(!1),variant:"outline",children:[s.jsx(v,{className:"h-4 w-4 mr-2"}),"Close"]})]})]}),s.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(F,{className:"h-5 w-5 text-purple-600 flex-shrink-0 mt-0.5"}),s.jsxs("div",{className:"text-sm",children:[s.jsx("p",{className:"font-semibold text-purple-900 mb-1",children:"For Instagram:"}),s.jsx("p",{className:"text-purple-800",children:"Copy the text above and paste it when creating your Instagram post. Don't forget to upload your listing photo!"})]})]})}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-sm mb-2 text-blue-900",children:"ðŸ“± Social Media Best Practices"}),s.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[s.jsx("li",{children:"â€¢ Post during peak hours (7-9 AM or 5-7 PM)"}),s.jsx("li",{children:"â€¢ Use high-quality photos (first photo is most important)"}),s.jsx("li",{children:"â€¢ Include local hashtags for better reach"}),s.jsx("li",{children:"â€¢ Respond quickly to comments and DMs"}),s.jsx("li",{children:"â€¢ Share to Instagram Stories for 24-hour visibility"})]})]})]})]})})}function J({listingId:t,currentStatus:a,onStatusChange:r}){const[i,l]=e.useState(a),[n,o]=e.useState(!1),[d,x]=e.useState(!1),{toast:g}=z(),j=[{value:"active",label:"Active",color:"text-green-600"},{value:"pending",label:"Pending",color:"text-yellow-600"},{value:"sold",label:"Sold",color:"text-blue-600"},{value:"under_contract",label:"Under Contract",color:"text-purple-600"},{value:"off_market",label:"Off Market",color:"text-gray-600"}],b=j.find(e=>e.value===i);return s.jsx("div",{className:"relative inline-block",children:s.jsxs(c,{value:i,onValueChange:async e=>{o(!0),l(e);try{const{error:s}=await D.from("listings").update({status:e}).eq("id",t);if(s)throw s;x(!0),setTimeout(()=>x(!1),2e3);const a=j.find(s=>s.value===e)?.label||e;g({title:"Status Updated",description:`Listing marked as ${a}`}),r?.(e)}catch(s){l(a),g({title:"Update Failed",description:"Failed to update listing status. Please try again.",variant:"destructive"})}finally{o(!1)}},disabled:n,children:[s.jsx(m,{className:`w-[140px] h-8 text-xs ${b?.color||""} ${n?"opacity-50":""}`,children:s.jsxs("div",{className:"flex items-center gap-2",children:[n&&s.jsx(q,{className:"h-3 w-3 animate-spin"}),d&&!n&&s.jsx(k,{className:"h-3 w-3 text-green-600"}),s.jsx(h,{})]})}),s.jsx(u,{children:j.map(e=>s.jsx(p,{value:e.value,className:e.color,children:e.label},e.value))})]})})}function W(){const[a,r]=e.useState(""),[i,l]=e.useState(!1),[n,o]=e.useState(null),[d,c]=e.useState(!1),[m,h]=e.useState(!1),[u,p]=e.useState(null),{toast:x}=z(),{listings:g,addListing:j,deleteListing:b}=T(),{uploadListingImages:v}=function(){const{user:s}=A(),{toast:t}=z(),[a,r]=e.useState(!1),[i,l]=e.useState({current:0,total:0,percentage:0}),n=e=>V.includes(e.type)?e.size>Y?`File too large: ${e.name}. Maximum size is 5MB`:null:`Invalid file type: ${e.name}. Please upload JPG, PNG, or WEBP images`,o=async e=>{if(!s?.id||0===e.length)return!1;try{const s=e.map(e=>{const s=e.match(/listings\/(.+)$/);return s?s[1]:null}).filter(Boolean);if(0===s.length)return!1;const{error:t}=await D.storage.from("listings").remove(s);if(t)throw t;return!0}catch(t){return!1}};return{uploadListingImages:async(e,a)=>{if(!s?.id)return t({title:"Error",description:"You must be logged in to upload images",variant:"destructive"}),[];if(0===e.length)return[];if(e.length>25)return t({title:"Too many images",description:"You can upload a maximum of 25 images per listing",variant:"destructive"}),[];for(const s of e){const e=n(s);if(e)return t({title:"Invalid file",description:e,variant:"destructive"}),[]}r(!0),l({current:0,total:e.length,percentage:0});const i=[];try{for(let t=0;t<e.length;t++){const r=e[t],n=r.name.split(".").pop(),o=Date.now(),d=Math.random().toString(36).substring(7),c=`${s.id}/${a||o}/${d}.${n}`,{error:m}=await D.storage.from("listings").upload(c,r,{cacheControl:"3600",upsert:!1});if(m)throw new Error(`Failed to upload ${r.name}: ${m.message}`);const{data:{publicUrl:h}}=D.storage.from("listings").getPublicUrl(c);i.push(h);const u={current:t+1,total:e.length,percentage:Math.round((t+1)/e.length*100)};l(u)}return i.length>0&&t({title:"Success",description:`Successfully uploaded ${i.length} image${i.length>1?"s":""}`}),i}catch(d){return t({title:"Upload failed",description:d instanceof Error?d.message:"Failed to upload images. Please try again.",variant:"destructive"}),i.length>0&&await o(i),[]}finally{r(!1),l({current:0,total:0,percentage:0})}},deleteListingImages:o,uploading:a,progress:i,acceptedTypes:V.join(", "),maxSize:Y,maxImages:25}}(),{subscription:f,canAdd:y,getLimit:N,getUsage:w}=U(),{profile:C}=B(),S=t(),F=[{key:"n",description:"Add new listing",action:()=>q(),category:"Actions"},{key:"d",description:"Go to Dashboard",action:()=>S("/dashboard"),category:"Navigation"},{key:"l",description:"Go to Leads",action:()=>S("/dashboard/leads"),category:"Navigation"},{key:"a",description:"Go to Analytics",action:()=>S("/dashboard/analytics"),category:"Navigation"}],q=()=>{if(!y("listings"))return c(!0),void x({title:"Upgrade required",description:"Your plan limit has been reached for listings."});l(!0)};return s.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Property Listings"}),s.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Manage your active and sold properties"})]}),s.jsxs("button",{id:"add-property-button",onClick:e=>{e.preventDefault(),e.stopPropagation(),q()},className:"inline-flex items-center gap-2 px-4 py-2.5 sm:py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 active:scale-95 transition-all font-medium min-h-[44px] w-full sm:w-auto justify-center shadow-sm",style:{position:"relative",zIndex:10},children:[s.jsx(P,{className:"h-4 w-4 sm:h-5 sm:w-5"}),s.jsx("span",{className:"text-sm sm:text-base",children:"Add Property"})]})]}),f&&N("listings")!==1/0&&s.jsx(E,{feature:"listings",current:w("listings"),limit:N("listings")}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),s.jsx("input",{type:"text",placeholder:"Search properties...",value:a,onChange:e=>r(e.target.value),className:"w-full pl-10 pr-4 py-2.5 sm:py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm sm:text-base min-h-[44px]"})]}),s.jsxs("button",{className:"inline-flex items-center justify-center gap-2 px-4 py-2.5 sm:py-2 bg-background border border-border rounded-lg hover:bg-accent active:scale-95 transition-all min-h-[44px] w-full sm:w-auto",children:[s.jsx(_,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm sm:text-base",children:"Filters"})]})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4",children:[s.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"text-xl sm:text-2xl font-bold text-foreground",children:g.length}),s.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Total"})]}),s.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:g.filter(e=>"active"===e.status).length}),s.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Active"})]}),s.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"text-xl sm:text-2xl font-bold text-yellow-600",children:g.filter(e=>"pending"===e.status).length}),s.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Pending"})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:g.map(e=>s.jsxs("div",{className:"bg-card border border-border rounded-lg overflow-hidden hover:shadow-lg active:shadow-xl transition-all group",children:[s.jsxs("div",{className:"relative h-44 sm:h-48 overflow-hidden",children:[s.jsx("img",{src:e.image,alt:e.address,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}),s.jsx("div",{className:"absolute top-2 sm:top-3 left-2 sm:left-3",children:s.jsx(J,{listingId:e.id,currentStatus:e.status,onStatusChange:s=>{e.status=s}})}),s.jsxs("div",{className:"absolute top-2 sm:top-3 right-2 sm:right-3 flex gap-1.5 sm:gap-2",children:[s.jsx("button",{onClick:()=>o(e),className:"p-2 sm:p-2.5 bg-white/90 backdrop-blur-sm rounded-full hover:bg-white active:scale-90 transition-all shadow-md min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Edit listing","aria-label":"Edit listing",children:s.jsx(I,{className:"h-4 w-4"})}),s.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this listing?"))try{await b.mutateAsync(e),x({title:"Listing deleted",description:"Property listing has been removed."})}catch(s){x({title:"Error",description:"Failed to delete listing.",variant:"destructive"})}})(e.id),className:"p-2 sm:p-2.5 bg-white/90 backdrop-blur-sm rounded-full hover:bg-white active:scale-90 transition-all text-red-600 shadow-md min-w-[44px] min-h-[44px] flex items-center justify-center",title:"Delete listing","aria-label":"Delete listing",children:s.jsx($,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"p-3 sm:p-4",children:[s.jsxs("div",{className:"mb-2 sm:mb-3",children:[s.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary mb-1",children:e.price}),s.jsx("div",{className:"font-medium text-sm sm:text-base text-foreground",children:e.address}),s.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground",children:e.city})]}),s.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 text-xs sm:text-sm text-muted-foreground mb-3 sm:mb-4 flex-wrap",children:[s.jsxs("span",{children:[e.beds," beds"]}),s.jsx("span",{children:"â€¢"}),s.jsxs("span",{children:[e.baths," baths"]}),e.sqft&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"â€¢"}),s.jsxs("span",{className:"whitespace-nowrap",children:[e.sqft.toLocaleString()," sqft"]})]})]}),s.jsx("div",{className:"flex items-center justify-between pt-2 sm:pt-3 border-t border-border",children:s.jsxs("div",{className:"text-xs sm:text-sm text-muted-foreground",children:["Listed ",new Date(e.created_at).toLocaleDateString()]})})]})]},e.id))}),0===g.length&&s.jsxs("div",{className:"text-center py-8 sm:py-12 px-4",children:[s.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 bg-accent rounded-full mb-3 sm:mb-4",children:s.jsx(P,{className:"h-7 w-7 sm:h-8 sm:w-8 text-muted-foreground"})}),s.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1 sm:mb-2",children:"No properties yet"}),s.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-4 sm:mb-6 max-w-sm mx-auto",children:"Start by adding your first property listing"}),s.jsxs("button",{onClick:()=>l(!0),className:"inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 active:scale-95 transition-all font-medium min-h-[44px] shadow-md",children:[s.jsx(P,{className:"h-5 w-5"}),s.jsx("span",{className:"text-sm sm:text-base",children:"Add Your First Property"})]})]}),s.jsx(R,{open:i,onOpenChange:l,onSave:async e=>{try{let s=[];if(e.images&&e.images.length>0&&(s=await v(e.images),0===s.length))return;const t={address:e.address,city:e.city,price:e.price,beds:e.beds,baths:e.baths,sqft:parseInt(e.sqft)||null,status:e.status,image:s[0]||null,photos:s.length>0?s:null,description:e.description||null,mls_number:e.mlsNumber||null,property_type:e.propertyType||null};await j.mutateAsync(t),p({address:e.address,city:e.city,price:e.price,beds:e.beds,baths:e.baths,sqft:parseInt(e.sqft)||void 0,property_type:e.propertyType,image:s[0]||void 0}),x({title:"Listing added!",description:"Your property listing has been created successfully."}),l(!1),h(!0)}catch(s){x({title:"Error",description:"Failed to add listing. Please try again.",variant:"destructive"})}}}),n&&s.jsx(G,{isOpen:!!n,onClose:()=>o(null),onSubmit:async e=>{if(n)try{const{data:{user:s}}=await D.auth.getUser();if(!s)throw new Error("Not authenticated");const{error:t}=await D.from("listings").update({address:e.address,city:e.city,price:e.price,beds:e.beds,baths:e.baths,sqft:e.sqft,status:e.status,image:e.image,description:e.description,mls_number:e.mls_number,property_type:e.property_type,updated_at:(new Date).toISOString()}).eq("id",n.id).eq("user_id",s.id);if(t)throw t;x({title:"Listing updated!",description:"Your property listing has been updated successfully."}),o(null),window.location.reload()}catch(s){x({title:"Error",description:"Failed to update listing. Please try again.",variant:"destructive"})}},initialData:{address:n.address,city:n.city,price:n.price,beds:n.beds,baths:n.baths,sqft:n.sqft,status:n.status,image:n.image,description:n.description,mls_number:n.mls_number,property_type:n.property_type}}),s.jsx(M,{open:d,onOpenChange:c,feature:"listings",currentPlan:f?.plan_name||"Free",requiredPlan:"Starter"}),u&&s.jsx(H,{open:m,onOpenChange:h,listing:u,agentName:C?.full_name}),s.jsx(O,{shortcuts:F})]})}export{W as default};
