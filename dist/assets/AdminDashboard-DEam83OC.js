import{a7 as ae,aR as le,z as L,ae as c,s as w,x as R,r as N,j as e,af as H,bk as se,B as j,ag as X,ar as J,ah as Z,ai as Y,L as k,I as P,F as U,G as z,J as $,K as B,N as b,a_ as ue,k as q,C as W,c as O,d as G,bS as Le,e as Q,f as V,O as T,T as he,n as Ae,bK as re,Q as We,m as ye,bT as Oe,am as Ge,Z as Pe,Y as Qe,g as ce,a2 as je,D as qe,ac as be,as as Ve,p as Re,bU as Ue,h as ze,A as $e,an as Be,aa as He,a1 as Xe}from"./index-DoeiSATn.js";import{T as xe,a as ge,b as I,c as K}from"./tabs-BNuwQuSa.js";import{S as ne}from"./switch-D7RqyB7h.js";import{u as S}from"./useMutation-ClI0Md-v.js";import{P as te}from"./plus-CtxVz5tL.js";import{S as de}from"./send-BrOhd2zH.js";import{S as Te}from"./square-pen-CvvvbsKp.js";import{U as Ne}from"./upload-BS4m_4OM.js";import{L as me}from"./lightbulb-DcIbEZ2Q.js";import{C as Je}from"./circle-x-CdVaRmmC.js";import{T as ke}from"./triangle-alert-BILEwcgy.js";import{D as Ze,S as Ye}from"./SEOManager-ByjAFWEJ.js";import{S as es}from"./SearchAnalyticsDashboard-Cr4eTu2v.js";import{S as _e}from"./settings-CCDRu39f.js";import{F as ss}from"./file-text-DoWgWOfE.js";import"./index-f7Xbm4rL.js";import"./refresh-cw-BA9qULNX.js";import"./bell-C1PvMRN9.js";import"./formatDistanceToNow-DkfJiJkE.js";import"./play-CpCafR3h.js";import"./trash-2-Bagb5aey.js";import"./table-bZ-WMe3K.js";import"./trending-down-DFp_wL3Z.js";import"./minus-BdLBW4DB.js";import"./link-D53vjWBX.js";import"./image-CLHo-Zv2.js";import"./repeat-Cn-cx7In.js";import"./copy--_BlwCA-.js";import"./mouse-pointer-DzgZuZsD.js";import"./popover-BiO4UYFh.js";import"./checkbox-DQxIof8a.js";import"./filter-D67-V4YN.js";import"./exportUtils-BPvM-NT1.js";import"./dropdown-menu-bkFipzGO.js";const ts=ae("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);const fe=ae("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);const as=ae("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);const rs=ae("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);const is=ae("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);const ns=ae("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);const ie=ae("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);function ls(){const r=le(),m=L({queryKey:["ai-models"],queryFn:async()=>{const{data:s,error:t}=await w.from("ai_models").select("*").order("provider",{ascending:!0});if(t)throw t;return s}}),u=L({queryKey:["ai-configuration"],queryFn:async()=>{const{data:s,error:t}=await w.from("ai_configuration").select("*");if(t)throw t;return s}}),h=S({mutationFn:async({key:s,value:t})=>{const{error:x}=await w.from("ai_configuration").update({setting_value:t,updated_at:new Date().toISOString(),updated_by:(await w.auth.getUser()).data.user?.id}).eq("setting_key",s);if(x)throw x},onSuccess:()=>{r.invalidateQueries({queryKey:["ai-configuration"]}),c.success("Configuration updated")},onError:s=>{c.error("Failed to update: "+s.message)}}),i=S({mutationFn:async({id:s,isActive:t})=>{const{error:x}=await w.from("ai_models").update({is_active:t}).eq("id",s);if(x)throw x},onSuccess:()=>{r.invalidateQueries({queryKey:["ai-models"]}),c.success("Model status updated")},onError:s=>{c.error("Failed to update model: "+s.message)}}),o=S({mutationFn:async s=>{const{error:t}=await w.from("ai_models").insert([s]);if(t)throw t},onSuccess:()=>{r.invalidateQueries({queryKey:["ai-models"]}),c.success("Model added successfully")},onError:s=>{c.error("Failed to add model: "+s.message)}}),d=S({mutationFn:async s=>{const{data:t,error:x}=await R.invoke("test-ai-model",{body:{model:s}});if(x)throw x;return t},onSuccess:s=>{s.success?c.success(s.message):c.error(s.error)},onError:s=>{c.error("Model test failed: "+s.message)}}),n=s=>{const t=u.data?.find(x=>x.setting_key===s);if(!t)return"";try{return JSON.parse(t.setting_value)}catch{return t.setting_value}},a=(s,t)=>{h.mutate({key:s,value:JSON.stringify(t)})};return{models:m.data,config:u.data,isLoading:m.isLoading||u.isLoading,getConfigValue:n,handleUpdateConfig:a,toggleModel:i.mutate,addModel:o.mutate,testModel:d.mutate,isTestingModel:d.isPending,isAddingModel:o.isPending}}function os({onAdd:r,isAdding:m}){const[u,h]=N.useState(!1),[i,o]=N.useState({provider:"",model_name:"",model_id:"",description:"",context_window:2e5,max_output_tokens:8192,supports_vision:!0,is_active:!0,auth_type:"bearer",secret_name:"",api_endpoint:""}),d=n=>{n.preventDefault(),r(i),h(!1),o({provider:"",model_name:"",model_id:"",description:"",context_window:2e5,max_output_tokens:8192,supports_vision:!0,is_active:!0,auth_type:"bearer",secret_name:"",api_endpoint:""})};return e.jsxs(H,{open:u,onOpenChange:h,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{className:"gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Add New Model"]})}),e.jsx(X,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:d,children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Add New AI Model"}),e.jsx(Y,{children:"Configure a new AI model with authentication and endpoint details"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"provider",children:"Provider Name *"}),e.jsx(P,{id:"provider",placeholder:"e.g., Anthropic",value:i.provider,onChange:n=>o({...i,provider:n.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"model_name",children:"Display Name *"}),e.jsx(P,{id:"model_name",placeholder:"e.g., Claude Sonnet 4.5",value:i.model_name,onChange:n=>o({...i,model_name:n.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"model_id",children:"Model ID *"}),e.jsx(P,{id:"model_id",placeholder:"e.g., claude-sonnet-4-5-20250929",value:i.model_id,onChange:n=>o({...i,model_id:n.target.value}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The exact model identifier for API calls"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"description",children:"Description"}),e.jsx(P,{id:"description",placeholder:"Brief description of model capabilities",value:i.description,onChange:n=>o({...i,description:n.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"auth_type",children:"Authentication Type *"}),e.jsxs(U,{value:i.auth_type,onValueChange:n=>o({...i,auth_type:n}),children:[e.jsx(z,{id:"auth_type",children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(b,{value:"bearer",children:"Bearer Token"}),e.jsx(b,{value:"x-api-key",children:"X-API-Key Header"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How the API key is sent (Bearer for most, X-API-Key for Anthropic)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"secret_name",children:"Supabase Secret Name *"}),e.jsx(P,{id:"secret_name",placeholder:"e.g., CLAUDE_API_KEY",value:i.secret_name,onChange:n=>o({...i,secret_name:n.target.value}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Name of the secret stored in Supabase (must be added to Supabase secrets)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"api_endpoint",children:"API Endpoint *"}),e.jsx(P,{id:"api_endpoint",placeholder:"e.g., https://api.anthropic.com/v1/messages",value:i.api_endpoint,onChange:n=>o({...i,api_endpoint:n.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"context_window",children:"Context Window"}),e.jsx(P,{id:"context_window",type:"number",value:i.context_window,onChange:n=>o({...i,context_window:parseInt(n.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"max_output_tokens",children:"Max Output Tokens"}),e.jsx(P,{id:"max_output_tokens",type:"number",value:i.max_output_tokens,onChange:n=>o({...i,max_output_tokens:parseInt(n.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"supports_vision",children:"Supports Vision"}),e.jsx(ne,{id:"supports_vision",checked:i.supports_vision,onCheckedChange:n=>o({...i,supports_vision:n})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"is_active",children:"Active"}),e.jsx(ne,{id:"is_active",checked:i.is_active,onCheckedChange:n=>o({...i,is_active:n})})]})]}),e.jsxs(ue,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>h(!1),children:"Cancel"}),e.jsxs(j,{type:"submit",disabled:m,children:[m&&e.jsx(q,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Model"]})]})]})})]})}function cs(){const{models:r,isLoading:m,getConfigValue:u,handleUpdateConfig:h,toggleModel:i,addModel:o,testModel:d,isTestingModel:n,isAddingModel:a}=ls();if(m)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(q,{className:"h-8 w-8 animate-spin text-primary"})});const s=u("default_model");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(W,{children:[e.jsxs(O,{children:[e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"AI Model Configuration"]}),e.jsx(Q,{children:"Configure AI models and settings for content generation"})]}),e.jsxs(V,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"default-model",children:"Default AI Model"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(U,{value:s,onValueChange:t=>h("default_model",t),children:[e.jsx(z,{id:"default-model",children:e.jsx($,{placeholder:"Select a model"})}),e.jsx(B,{children:r?.map(t=>e.jsxs(b,{value:t.model_id,children:[t.model_name," (",t.provider,")"]},t.id))})]}),e.jsx(j,{variant:"outline",size:"icon",onClick:()=>d(s),disabled:n,title:"Test AI Model",children:n?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(rs,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"temp-precise",children:"Precise Temperature"}),e.jsx(P,{id:"temp-precise",type:"number",step:"0.1",min:"0",max:"1",value:u("temperature_precise"),onChange:t=>h("temperature_precise",parseFloat(t.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For data extraction and precise tasks"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"temp-creative",children:"Creative Temperature"}),e.jsx(P,{id:"temp-creative",type:"number",step:"0.1",min:"0",max:"1",value:u("temperature_creative"),onChange:t=>h("temperature_creative",parseFloat(t.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For content generation and creative tasks"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"tokens-standard",children:"Standard Max Tokens"}),e.jsx(P,{id:"tokens-standard",type:"number",step:"100",value:u("max_tokens_standard"),onChange:t=>h("max_tokens_standard",parseInt(t.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"tokens-large",children:"Large Content Max Tokens"}),e.jsx(P,{id:"tokens-large",type:"number",step:"100",value:u("max_tokens_large"),onChange:t=>h("max_tokens_large",parseInt(t.target.value))})]})]})]})]}),e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Available AI Models"}),e.jsx(Q,{children:"Manage which models are available for selection"})]}),e.jsx(os,{onAdd:o,isAdding:a})]})}),e.jsx(V,{children:e.jsx("div",{className:"space-y-4",children:r?.map(t=>e.jsxs("div",{className:"flex items-start justify-between p-4 border rounded-lg gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:t.model_name}),e.jsx(T,{variant:"outline",className:"text-xs",children:t.provider})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Context: ",t.context_window.toLocaleString()," tokens"]}),e.jsxs("span",{children:["Max Output: ",t.max_output_tokens.toLocaleString()," tokens"]}),t.supports_vision&&e.jsx("span",{children:"âœ“ Vision"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2 text-xs",children:[e.jsx(T,{variant:"secondary",children:t.auth_type==="bearer"?"Bearer Token":"X-API-Key"}),e.jsxs(T,{variant:"secondary",children:["Secret: ",t.secret_name]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 font-mono truncate",children:t.api_endpoint})]}),e.jsx(ne,{checked:t.is_active,onCheckedChange:x=>i({id:t.id,isActive:x})})]},t.id))})})]})]})}function ve(){const r=le(),m=L({queryKey:["social-media-posts"],queryFn:async()=>{const{data:l,error:p}=await w.from("social_media_posts").select("*").order("created_at",{ascending:!1});if(p)throw p;return l}}),u=L({queryKey:["marketing-posts"],queryFn:async()=>{const{data:l,error:p}=await w.from("social_media_posts").select("*").eq("content_type","marketing").order("created_at",{ascending:!1});if(p)throw p;return l}}),h=L({queryKey:["social-media-webhooks"],queryFn:async()=>{const{data:l,error:p}=await w.from("social_media_webhooks").select("*").order("name",{ascending:!0});if(p)throw p;return l}}),i=S({mutationFn:async l=>{const{data:p,error:f}=await R.invoke("generate-social-post",{body:l});if(f)throw f;return p},onSuccess:l=>{l.success?c.success("Content generated successfully!"):c.error(l.error||"Generation failed")},onError:l=>{c.error("Failed to generate content: "+l.message)}}),o=S({mutationFn:async l=>{const{data:p}=await w.auth.getUser(),{data:f,error:A}=await w.from("social_media_posts").insert({...l,created_by:p.user?.id}).select().single();if(A)throw A;return f},onSuccess:()=>{r.invalidateQueries({queryKey:["social-media-posts"]}),c.success("Post created successfully")},onError:l=>{c.error("Failed to create post: "+l.message)}}),d=S({mutationFn:async({id:l,updates:p})=>{const{error:f}=await w.from("social_media_posts").update(p).eq("id",l);if(f)throw f},onSuccess:()=>{r.invalidateQueries({queryKey:["social-media-posts"]}),c.success("Post updated successfully")},onError:l=>{c.error("Failed to update post: "+l.message)}}),n=S({mutationFn:async l=>{const{error:p}=await w.from("social_media_posts").delete().eq("id",l);if(p)throw p},onSuccess:()=>{r.invalidateQueries({queryKey:["social-media-posts"]}),c.success("Post deleted successfully")},onError:l=>{c.error("Failed to delete post: "+l.message)}}),a=S({mutationFn:async l=>{const{data:p,error:f}=await w.from("social_media_webhooks").insert(l).select().single();if(f)throw f;return p},onSuccess:()=>{r.invalidateQueries({queryKey:["social-media-webhooks"]}),c.success("Webhook created successfully")},onError:l=>{c.error("Failed to create webhook: "+l.message)}}),s=S({mutationFn:async({id:l,updates:p})=>{const{error:f}=await w.from("social_media_webhooks").update(p).eq("id",l);if(f)throw f},onSuccess:()=>{r.invalidateQueries({queryKey:["social-media-webhooks"]}),c.success("Webhook updated successfully")},onError:l=>{c.error("Failed to update webhook: "+l.message)}}),t=S({mutationFn:async l=>{const{error:p}=await w.from("social_media_webhooks").delete().eq("id",l);if(p)throw p},onSuccess:()=>{r.invalidateQueries({queryKey:["social-media-webhooks"]}),c.success("Webhook deleted successfully")},onError:l=>{c.error("Failed to delete webhook: "+l.message)}}),x=S({mutationFn:async l=>{const{data:p,error:f}=await R.invoke("test-social-webhook",{body:{webhookId:l}});if(f)throw f;return p},onSuccess:l=>{l.success?c.success("Test webhook sent successfully!"):c.error("Test webhook failed: "+(l.error||"Unknown error"))},onError:l=>{c.error("Failed to test webhook: "+l.message)}}),_=S({mutationFn:async l=>{const{data:p,error:f}=await R.invoke("generate-marketing-post",{body:{webhookUrl:l}});if(f)throw f;return p},onSuccess:l=>{r.invalidateQueries({queryKey:["marketing-posts"]}),l.success?c.success(l.message):c.error(l.error||"Failed to generate post")},onError:l=>{c.error("Failed to generate post: "+l.message)}}),C=S({mutationFn:async({postId:l,webhookUrl:p})=>{const{data:f}=await w.from("social_media_posts").select("post_content").eq("id",l).single();if(!f)throw new Error("Post not found");if(!(await fetch(p,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(f.post_content)})).ok)throw new Error("Webhook delivery failed");return await w.from("social_media_posts").update({status:"posted",posted_at:new Date().toISOString(),webhook_urls:[p]}).eq("id",l),{success:!0}},onSuccess:()=>{r.invalidateQueries({queryKey:["marketing-posts"]}),c.success("Post resent successfully")},onError:l=>{console.error("Failed to retry post:",l),c.error("Failed to resend post")}});return{posts:m.data,marketingPosts:u.data,webhooks:h.data,isLoading:m.isLoading||h.isLoading||u.isLoading,generatePost:i.mutate,isGenerating:i.isPending,generatedContent:i.data,createPost:o.mutate,updatePost:d.mutate,deletePost:n.mutate,createWebhook:a.mutate,updateWebhook:s.mutate,deleteWebhook:t.mutate,testWebhook:x.mutate,isTestingWebhook:x.isPending,generateMarketingPost:_.mutate,isGeneratingMarketingPost:_.isPending,marketingPostData:_.data,retryMarketingPost:C.mutate,isRetryingPost:C.isPending}}function Se(){const[r,m]=N.useState(!1),[u,h]=N.useState("property_highlight"),[i,o]=N.useState("listing_of_the_day"),[d,n]=N.useState("combined"),[a,s]=N.useState(""),[t,x]=N.useState(""),[_,C]=N.useState(""),[l,p]=N.useState(null),{generatePost:f,isGenerating:A,createPost:D}=ve(),{data:g}=L({queryKey:["listings-for-social"],queryFn:async()=>{const{data:M,error:F}=await w.from("listings").select("id, address, price, status").eq("status","active").order("created_at",{ascending:!1}).limit(20);if(F)throw F;return M}}),E=()=>{f({contentType:u,subjectType:i,platformType:d,listingId:a||void 0,customPrompt:t||void 0},{onSuccess:M=>{M.success&&p(M.content)}})},y=()=>{l&&D({content_type:u,subject_type:i,platform_type:d,post_content:l,post_title:_||`${u} - ${new Date().toLocaleDateString()}`,listing_id:a||null,status:"draft",ai_prompt_used:t||void 0},{onSuccess:()=>{m(!1),p(null),C(""),x("")}})};return e.jsxs(H,{open:r,onOpenChange:m,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{className:"gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"Create Post"]})}),e.jsxs(X,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Create Social Media Post"}),e.jsx(Y,{children:"Generate AI-powered social media content for your real estate business"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"content-type",children:"Content Type"}),e.jsxs(U,{value:u,onValueChange:h,children:[e.jsx(z,{id:"content-type",children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(b,{value:"property_highlight",children:"Property Highlight"}),e.jsx(b,{value:"market_update",children:"Market Update"}),e.jsx(b,{value:"agent_tip",children:"Agent Tip"}),e.jsx(b,{value:"community_spotlight",children:"Community Spotlight"}),e.jsx(b,{value:"success_story",children:"Success Story"}),e.jsx(b,{value:"general",children:"General"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"subject-type",children:"Subject Type"}),e.jsxs(U,{value:i,onValueChange:o,children:[e.jsx(z,{id:"subject-type",children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(b,{value:"listing_of_the_day",children:"Listing of the Day"}),e.jsx(b,{value:"market_analysis",children:"Market Analysis"}),e.jsx(b,{value:"buyer_seller_tip",children:"Buyer/Seller Tip"}),e.jsx(b,{value:"neighborhood_feature",children:"Neighborhood Feature"}),e.jsx(b,{value:"testimonial_highlight",children:"Testimonial Highlight"}),e.jsx(b,{value:"special_announcement",children:"Special Announcement"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"platform-type",children:"Platform"}),e.jsxs(U,{value:d,onValueChange:n,children:[e.jsx(z,{id:"platform-type",children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(b,{value:"combined",children:"All Platforms"}),e.jsx(b,{value:"twitter_threads",children:"Twitter/X Threads"}),e.jsx(b,{value:"facebook_linkedin",children:"Facebook/LinkedIn"}),e.jsx(b,{value:"instagram",children:"Instagram"})]})]})]}),u==="property_highlight"&&g&&g.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"listing",children:"Select Property (Optional)"}),e.jsxs(U,{value:a,onValueChange:s,children:[e.jsx(z,{id:"listing",children:e.jsx($,{placeholder:"Choose a listing..."})}),e.jsx(B,{children:g.map(M=>e.jsxs(b,{value:M.id,children:[M.address," - ",M.price]},M.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"custom-prompt",children:"Custom Instructions (Optional)"}),e.jsx(he,{id:"custom-prompt",placeholder:"Add any specific instructions for the AI...",value:t,onChange:M=>x(M.target.value),rows:3})]}),e.jsx(j,{onClick:E,disabled:A,className:"w-full gap-2",children:A?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"h-4 w-4"}),"Generate with AI"]})}),l&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"post-title",children:"Post Title"}),e.jsx(P,{id:"post-title",placeholder:"Enter a title for this post...",value:_,onChange:M=>C(M.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Generated Content"}),e.jsx("div",{className:"p-4 bg-background border rounded-lg whitespace-pre-wrap text-sm",children:l[d]||l.raw})]}),e.jsx(j,{onClick:y,className:"w-full",children:"Save as Draft"})]})]})]})]})}function ds(){const[r,m]=N.useState(!1),[u,h]=N.useState(""),[i,o]=N.useState(""),[d,n]=N.useState(""),[a,s]=N.useState(!0),{createWebhook:t}=ve(),x=_=>{if(_.preventDefault(),!u.trim()){c.error("Please enter a webhook name");return}if(!i){c.error("Please select a platform");return}if(!d.trim()){c.error("Please enter a webhook URL");return}t({name:u,platform:i,webhook_url:d,is_active:a,headers:{}}),h(""),o(""),n(""),s(!0),m(!1)};return e.jsxs(H,{open:r,onOpenChange:m,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{variant:"outline",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Add Webhook"]})}),e.jsxs(X,{children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Add Social Media Webhook"}),e.jsx(Y,{children:"Configure a webhook to automatically distribute posts to your platforms"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"name",children:"Webhook Name"}),e.jsx(P,{id:"name",placeholder:"My Make.com Workflow",value:u,onChange:_=>h(_.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"platform",children:"Platform *"}),e.jsxs(U,{value:i,onValueChange:o,children:[e.jsx(z,{id:"platform",children:e.jsx($,{placeholder:"Select platform"})}),e.jsxs(B,{children:[e.jsx(b,{value:"make",children:"Make.com"}),e.jsx(b,{value:"zapier",children:"Zapier"}),e.jsx(b,{value:"n8n",children:"n8n"}),e.jsx(b,{value:"custom",children:"Custom"}),e.jsx(b,{value:"facebook",children:"Facebook"}),e.jsx(b,{value:"instagram",children:"Instagram"}),e.jsx(b,{value:"linkedin",children:"LinkedIn"}),e.jsx(b,{value:"twitter",children:"Twitter/X"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"url",children:"Webhook URL"}),e.jsx(P,{id:"url",type:"url",placeholder:"https://hook.example.com/webhook/social",value:d,onChange:_=>n(_.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"active",children:"Active"}),e.jsx(ne,{id:"active",checked:a,onCheckedChange:s})]}),e.jsx(j,{type:"submit",className:"w-full",children:"Create Webhook"})]})]})]})}function us(){const[r,m]=N.useState("all"),{posts:u,marketingPosts:h,webhooks:i,isLoading:o,deletePost:d,updateWebhook:n,deleteWebhook:a,testWebhook:s,isTestingWebhook:t,generateMarketingPost:x,isGeneratingMarketingPost:_,marketingPostData:C,retryMarketingPost:l,isRetryingPost:p}=ve(),f=g=>{switch(g){case"posted":return"bg-green-500";case"scheduled":return"bg-blue-500";case"draft":return"bg-gray-500";case"archived":return"bg-orange-500";default:return"bg-gray-500"}},A=g=>g.split("_").map(E=>E.charAt(0).toUpperCase()+E.slice(1)).join(" ");if(o)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(q,{className:"h-8 w-8 animate-spin text-primary"})});const D=r==="all"?u:u?.filter(g=>g.status===r);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Social Media Content"}),e.jsx(Q,{children:"Manage and generate social media posts for your real estate business"})]}),e.jsx(Se,{})]})}),e.jsx(V,{children:e.jsxs(xe,{value:r,onValueChange:m,children:[e.jsxs(ge,{children:[e.jsx(I,{value:"all",children:"All Posts"}),e.jsx(I,{value:"draft",children:"Drafts"}),e.jsx(I,{value:"scheduled",children:"Scheduled"}),e.jsx(I,{value:"posted",children:"Posted"})]}),e.jsx(K,{value:r,className:"space-y-4 mt-6",children:D&&D.length>0?D.map(g=>e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:g.post_title||"Untitled Post"}),e.jsx(T,{className:`${f(g.status)} text-white`,children:g.status})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-muted-foreground mb-3",children:[e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(T,{variant:"outline",children:A(g.content_type)})}),e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(T,{variant:"outline",children:A(g.subject_type)})}),e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(T,{variant:"outline",children:A(g.platform_type)})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Created: ",re(new Date(g.created_at),"MMM d, yyyy h:mm a")]}),g.scheduled_for&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(We,{className:"h-3 w-3"}),"Scheduled: ",re(new Date(g.scheduled_for),"MMM d, yyyy h:mm a")]}),g.posted_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(de,{className:"h-3 w-3"}),"Posted: ",re(new Date(g.posted_at),"MMM d, yyyy h:mm a")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",children:e.jsx(Te,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this post?")&&d(g.id)},children:e.jsx(ie,{className:"h-4 w-4"})})]})]})},g.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No posts found"}),e.jsx(Se,{})]})})]})})]}),e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Webhook Configuration"}),e.jsx(Q,{children:"Configure webhooks for automatic post distribution"})]}),e.jsx(ds,{})]})}),e.jsx(V,{children:i&&i.length>0?e.jsx("div",{className:"space-y-3",children:i.map(g=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(as,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:g.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g.platform}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 truncate max-w-md",children:g.webhook_url})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>s(g.id),disabled:t,title:"Test webhook with sample post",children:t?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(de,{className:"h-4 w-4"})}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>n({id:g.id,updates:{is_active:!g.is_active}}),children:g.is_active?e.jsx(ns,{className:"h-5 w-5 text-green-600"}):e.jsx(is,{className:"h-5 w-5 text-gray-400"})}),e.jsx(j,{variant:"ghost",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this webhook?")&&a(g.id)},children:e.jsx(ie,{className:"h-4 w-4"})})]})]},g.id))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No webhooks configured yet. Add a webhook to automatically distribute posts."})})})]}),e.jsxs(W,{children:[e.jsxs(O,{children:[e.jsx(G,{children:"Marketing Post Generator"}),e.jsx(Q,{children:"Generate unique, catchy social media posts to drive agent signups"})]}),e.jsxs(V,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{onClick:()=>x(),disabled:_,className:"flex-1",children:_?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Generate New Post"]})}),i&&i.length>0&&e.jsx(j,{variant:"outline",onClick:()=>{const g=i.find(E=>E.is_active);g&&x(g.webhook_url)},disabled:_||!i.some(g=>g.is_active),children:"Generate & Send"})]}),C&&C.payload&&e.jsxs("div",{className:"space-y-4 mt-4 border-t pt-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Long Form (LinkedIn/Facebook):"}),e.jsx("div",{className:"bg-muted p-4 rounded-lg text-sm whitespace-pre-wrap",children:C.payload.longFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Short Form (Twitter/Threads):"}),e.jsx("div",{className:"bg-muted p-4 rounded-lg text-sm",children:C.payload.shortFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Hashtags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:C.payload.hashtags.map((g,E)=>e.jsx(T,{variant:"secondary",children:g},E))})]})]})]})]}),e.jsxs(W,{children:[e.jsxs(O,{children:[e.jsx(G,{children:"Marketing Post History"}),e.jsx(Q,{children:"View and redeploy previously generated marketing posts"})]}),e.jsx(V,{children:h&&h.length>0?e.jsx("div",{className:"space-y-4",children:h.map(g=>{const E=g.post_content;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{className:`${f(g.status)} text-white`,children:g.status}),e.jsx("span",{className:"text-sm text-muted-foreground",children:re(new Date(g.created_at),"MMM d, yyyy h:mm a")})]}),e.jsxs("div",{className:"flex gap-2",children:[i&&i.length>0&&e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{const y=i.find(M=>M.is_active);y&&l({postId:g.id,webhookUrl:y.webhook_url})},disabled:p||!i.some(y=>y.is_active),children:p?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(de,{className:"h-4 w-4 mr-2"}),"Resend"]})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this post?")&&d(g.id)},children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Long Form:"}),e.jsx("div",{className:"bg-muted p-3 rounded text-sm whitespace-pre-wrap",children:E.longFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Short Form:"}),e.jsx("div",{className:"bg-muted p-3 rounded text-sm",children:E.shortFormPost})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:E.hashtags?.map((y,M)=>e.jsx(T,{variant:"secondary",className:"text-xs",children:y},M))})]})]},g.id)})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No marketing posts generated yet. Create your first one above!"})})})]})]})}function Ee(){const r=le(),m=L({queryKey:["articles"],queryFn:async()=>{const{data:s,error:t}=await w.from("articles").select("*").order("created_at",{ascending:!1});if(t)throw t;return s}}),u=S({mutationFn:async s=>{const{data:t,error:x}=await R.invoke("generate-article",{body:s});if(x)throw x;return t},onSuccess:s=>{s.success?c.success("Article generated successfully!"):c.error(s.error||"Generation failed")},onError:s=>{c.error("Failed to generate article: "+s.message)}}),h=S({mutationFn:async s=>{const{data:t}=await w.auth.getUser(),{data:x,error:_}=await w.from("articles").insert({...s,author_id:t.user?.id}).select().single();if(_)throw _;return x},onSuccess:()=>{r.invalidateQueries({queryKey:["articles"]}),c.success("Article created successfully")},onError:s=>{c.error("Failed to create article: "+s.message)}}),i=S({mutationFn:async({id:s,updates:t})=>{const{error:x}=await w.from("articles").update(t).eq("id",s);if(x)throw x},onSuccess:()=>{r.invalidateQueries({queryKey:["articles"]}),c.success("Article updated successfully")},onError:s=>{c.error("Failed to update article: "+s.message)}}),o=S({mutationFn:async s=>{const{error:t}=await w.from("articles").update({status:"published",published_at:new Date().toISOString()}).eq("id",s);if(t)throw t},onSuccess:()=>{r.invalidateQueries({queryKey:["articles"]}),c.success("Article published successfully")},onError:s=>{c.error("Failed to publish article: "+s.message)}}),d=(s,t)=>{o.mutate(s,{onSuccess:()=>{t?.onSuccess?.()},onError:x=>{t?.onError?.(x)}})},n=S({mutationFn:async s=>{const{data:t,error:x}=await R.invoke("publish-article-to-social",{body:{articleId:s}});if(x)throw x;return t},onSuccess:s=>{s?.success?c.success("Article distributed to social platforms successfully"):c.error(s?.error||"Failed to distribute article")},onError:s=>{c.error("Failed to distribute article: "+s.message)}}),a=S({mutationFn:async s=>{const{error:t}=await w.from("articles").delete().eq("id",s);if(t)throw t},onSuccess:()=>{r.invalidateQueries({queryKey:["articles"]}),c.success("Article deleted successfully")},onError:s=>{c.error("Failed to delete article: "+s.message)}});return{articles:m.data,isLoading:m.isLoading,generateArticle:u.mutate,isGenerating:u.isPending,generatedArticle:u.data,createArticle:h.mutate,updateArticle:i.mutate,publishArticle:d,isPublishing:o.isPending,republishArticle:n.mutate,isRepublishing:n.isPending,deleteArticle:a.mutate}}function we(){const r=le(),{data:m=[],isLoading:u}=L({queryKey:["keywords"],queryFn:async()=>{const{data:n,error:a}=await w.from("keywords").select("*").order("usage_count",{ascending:!0}).order("keyword",{ascending:!0});if(a)throw a;return n}}),{data:h=[]}=L({queryKey:["keywords","unused"],queryFn:async()=>{const{data:n,error:a}=await w.from("keywords").select("*").eq("is_active",!0).order("usage_count",{ascending:!0}).order("last_used_at",{ascending:!0,nullsFirst:!0}).limit(50);if(a)throw a;return n}}),i=S({mutationFn:async n=>Oe("import-keywords",{method:"POST",body:{keywords:n},auth:!0}),onSuccess:n=>{r.invalidateQueries({queryKey:["keywords"]}),c.success(n.message||"Keywords imported successfully")},onError:n=>{c.error(n.message||"Failed to import keywords")}}),o=S({mutationFn:async({id:n,updates:a})=>{const{data:s,error:t}=await w.from("keywords").update(a).eq("id",n).select().single();if(t)throw t;return s},onSuccess:()=>{r.invalidateQueries({queryKey:["keywords"]}),c.success("Keyword updated successfully")},onError:n=>{c.error(n.message||"Failed to update keyword")}}),d=S({mutationFn:async n=>{const{error:a}=await w.from("keywords").delete().eq("id",n);if(a)throw a},onSuccess:()=>{r.invalidateQueries({queryKey:["keywords"]}),c.success("Keyword deleted successfully")},onError:n=>{c.error(n.message||"Failed to delete keyword")}});return{keywords:m,unusedKeywords:h,isLoading:u,importKeywords:n=>i.mutate(n),isImporting:i.isPending,updateKeyword:(n,a)=>o.mutate({id:n,updates:a}),deleteKeyword:n=>d.mutate(n)}}function Ie(){const r=le(),m=L({queryKey:["article-webhooks"],queryFn:async()=>{const{data:d,error:n}=await w.from("article_webhooks").select("*").order("created_at",{ascending:!1});if(n)throw n;return d}}),u=S({mutationFn:async d=>{const{data:n}=await w.auth.getUser(),{data:a,error:s}=await w.from("article_webhooks").insert({...d,user_id:n.user?.id}).select().single();if(s)throw s;return a},onSuccess:()=>{r.invalidateQueries({queryKey:["article-webhooks"]}),c.success("Webhook created successfully")},onError:d=>{c.error("Failed to create webhook: "+d.message)}}),h=S({mutationFn:async({id:d,updates:n})=>{const{error:a}=await w.from("article_webhooks").update(n).eq("id",d);if(a)throw a},onSuccess:()=>{r.invalidateQueries({queryKey:["article-webhooks"]}),c.success("Webhook updated successfully")},onError:d=>{c.error("Failed to update webhook: "+d.message)}}),i=S({mutationFn:async d=>{const{error:n}=await w.from("article_webhooks").delete().eq("id",d);if(n)throw n},onSuccess:()=>{r.invalidateQueries({queryKey:["article-webhooks"]}),c.success("Webhook deleted successfully")},onError:d=>{c.error("Failed to delete webhook: "+d.message)}}),o=S({mutationFn:async d=>{const{data:n,error:a}=await R.invoke("test-article-webhook",{body:{webhookUrl:d}});if(a)throw a;return n},onSuccess:d=>{d?.success?c.success("Test payload sent successfully! Check your Make.com scenario."):c.error(d?.error||"Test failed")},onError:d=>{c.error("Failed to test webhook: "+d.message)}});return{webhooks:m.data,isLoading:m.isLoading,createWebhook:u.mutate,updateWebhook:h.mutate,deleteWebhook:i.mutate,testWebhook:o.mutate,isTesting:o.isPending,testResult:o.data}}function Ce(){const[r,m]=N.useState(!1),[u,h]=N.useState("keyword"),[i,o]=N.useState(""),[d,n]=N.useState(""),[a,s]=N.useState("Real Estate Tips"),[t,x]=N.useState(""),[_,C]=N.useState(""),[l,p]=N.useState(null),{generateArticle:f,isGenerating:A,createArticle:D}=Ee(),{unusedKeywords:g,isLoading:E}=we(),y=()=>{if(u==="keyword"){const F=g.find(ee=>ee.id===i);f({topic:F?.keyword,category:a,keywords:F?[F.keyword]:void 0,customInstructions:_||void 0,autoSelectKeyword:!i},{onSuccess:ee=>{ee.success&&(p(ee.article),ee.article.keywordId&&o(ee.article.keywordId))}})}else{if(!d)return;f({topic:d,category:a,keywords:t?t.split(",").map(F=>F.trim()):void 0,customInstructions:_||void 0,autoSelectKeyword:!1},{onSuccess:F=>{F.success&&p(F.article)}})}},M=()=>{l&&D({title:l.title,slug:l.slug,content:l.content,excerpt:l.excerpt,category:l.category,tags:l.tags,seo_title:l.seoTitle,seo_description:l.seoDescription,seo_keywords:l.tags,keyword_id:u==="keyword"&&(l.keywordId||i)||null,status:"draft"},{onSuccess:()=>{m(!1),p(null),n(""),x(""),C(""),o("")}})};return e.jsxs(H,{open:r,onOpenChange:m,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{className:"gap-2",children:[e.jsx(te,{className:"h-4 w-4"}),"New Article"]})}),e.jsxs(X,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Generate Blog Article"}),e.jsx(Y,{children:"Create SEO-optimized real estate articles with AI assistance"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs(xe,{value:u,onValueChange:F=>h(F),children:[e.jsxs(ge,{className:"grid w-full grid-cols-2",children:[e.jsx(I,{value:"keyword",children:"From Keyword"}),e.jsx(I,{value:"manual",children:"Manual Topic"})]}),e.jsx(K,{value:"keyword",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"keyword-select",children:"Select Keyword (Optional - auto-selects if empty)"}),e.jsxs(U,{value:i,onValueChange:o,children:[e.jsx(z,{id:"keyword-select",children:e.jsx($,{placeholder:"Auto-select unused keyword..."})}),e.jsx(B,{children:E?e.jsx(b,{value:"loading",disabled:!0,children:"Loading keywords..."}):g.length===0?e.jsx(b,{value:"none",disabled:!0,children:"No keywords available"}):g.map(F=>e.jsxs(b,{value:F.id,children:[F.keyword," (used ",F.usage_count," times)"]},F.id))})]})]})}),e.jsxs(K,{value:"manual",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"topic",children:"Article Topic *"}),e.jsx(P,{id:"topic",placeholder:"e.g., First-Time Homebuyer Tips for 2025",value:d,onChange:F=>n(F.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"keywords",children:"Target Keywords (comma-separated)"}),e.jsx(P,{id:"keywords",placeholder:"e.g., real estate, home buying, mortgage tips",value:t,onChange:F=>x(F.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"category",children:"Category"}),e.jsxs(U,{value:a,onValueChange:s,children:[e.jsx(z,{id:"category",children:e.jsx($,{})}),e.jsxs(B,{children:[e.jsx(b,{value:"Real Estate Tips",children:"Real Estate Tips"}),e.jsx(b,{value:"Market Insights",children:"Market Insights"}),e.jsx(b,{value:"Buying Guide",children:"Buying Guide"}),e.jsx(b,{value:"Selling Guide",children:"Selling Guide"}),e.jsx(b,{value:"Investment",children:"Investment"}),e.jsx(b,{value:"Neighborhood Guides",children:"Neighborhood Guides"}),e.jsx(b,{value:"Home Improvement",children:"Home Improvement"}),e.jsx(b,{value:"General",children:"General"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"instructions",children:"Custom Instructions (Optional)"}),e.jsx(he,{id:"instructions",placeholder:"Add specific requirements, tone, or focus areas...",value:_,onChange:F=>C(F.target.value),rows:3})]}),e.jsx(j,{onClick:y,disabled:A||u==="manual"&&!d,className:"w-full gap-2",children:A?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 animate-spin"}),"Generating Article..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"h-4 w-4"}),u==="keyword"&&!i?"Auto-Select Keyword & Generate":"Generate Article with AI"]})}),l&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:l.title}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Slug: ",l.slug]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:l.excerpt})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Article Content (Markdown)"}),e.jsx("div",{className:"p-4 bg-background border rounded-lg max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono",children:l.content})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"SEO Title:"}),e.jsx("p",{className:"text-muted-foreground",children:l.seoTitle})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"SEO Description:"}),e.jsx("p",{className:"text-muted-foreground",children:l.seoDescription})]})]}),e.jsx(j,{onClick:M,className:"w-full",children:"Save as Draft"})]})]})]})]})}function Fe(){const[r,m]=N.useState(!1),[u,h]=N.useState(""),[i,o]=N.useState(""),[d,n]=N.useState(!0),{createWebhook:a}=Ie(),s=t=>{t.preventDefault(),!(!u.trim()||!i.trim())&&(a({name:u,webhook_url:i,is_active:d}),h(""),o(""),n(!0),m(!1))};return e.jsxs(H,{open:r,onOpenChange:m,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{variant:"outline",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Add Webhook"]})}),e.jsxs(X,{children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Add Article Webhook"}),e.jsx(Y,{children:"Configure a webhook to receive article data when articles are published"})]}),e.jsxs("form",{onSubmit:s,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"name",children:"Webhook Name"}),e.jsx(P,{id:"name",placeholder:"My Social Platform",value:u,onChange:t=>h(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"url",children:"Webhook URL"}),e.jsx(P,{id:"url",type:"url",placeholder:"https://api.example.com/webhooks/article",value:i,onChange:t=>o(t.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"active",children:"Active"}),e.jsx(ne,{id:"active",checked:d,onCheckedChange:n})]}),e.jsx(j,{type:"submit",className:"w-full",children:"Create Webhook"})]})]})]})}function Ke(){const[r,m]=N.useState(!1),{importKeywords:u,isImporting:h}=we(),i=N.useRef(null),o=()=>{const n=`keyword,category,difficulty,search_volume,notes
real estate agent portfolio,Real Estate,medium,1000,Example keyword
luxury home listings,Luxury Real Estate,hard,500,High-value properties
first time home buyer tips,Real Estate,easy,2000,Educational content`,a=new Blob([n],{type:"text/csv"}),s=window.URL.createObjectURL(a),t=document.createElement("a");t.href=s,t.download="keywords-template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(s),c.success("Template downloaded")},d=async n=>{const a=n.target.files?.[0];if(a)try{const t=(await a.text()).split(`
`).filter(C=>C.trim());if(t.length<2){c.error("CSV file is empty or invalid");return}const x=t[0].split(",").map(C=>C.trim().toLowerCase()),_=t.slice(1).map(C=>{const l=C.split(",").map(f=>f.trim()),p={};return x.forEach((f,A)=>{l[A]&&(p[f]=l[A])}),p}).filter(C=>C.keyword);if(_.length===0){c.error("No valid keywords found in CSV");return}await u(_),m(!1),i.current&&(i.current.value="")}catch(s){console.error("Error parsing CSV:",s),c.error("Failed to parse CSV file")}};return e.jsxs(H,{open:r,onOpenChange:m,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{variant:"outline",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Import Keywords"]})}),e.jsxs(X,{children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Import Keywords from CSV"}),e.jsx(Y,{children:"Upload a CSV file with your keywords. New keywords will be added and existing ones will be skipped."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:[e.jsx("input",{ref:i,type:"file",accept:".csv",onChange:d,disabled:h,className:"hidden",id:"csv-upload"}),e.jsx("label",{htmlFor:"csv-upload",className:"cursor-pointer",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[h?e.jsx(q,{className:"h-8 w-8 animate-spin text-primary"}):e.jsx(Ne,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:h?"Importing...":"Click to upload CSV"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"CSV files only"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"CSV Format:"}),e.jsx("div",{className:"bg-muted p-3 rounded-md text-xs font-mono",children:"keyword,category,difficulty,search_volume,notes"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1 ml-4 list-disc",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"keyword"})," (required): The keyword phrase"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"category"}),": Real Estate, Luxury Real Estate, etc."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"difficulty"}),": easy, medium, or hard"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"search_volume"}),": Monthly search volume (number)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"notes"}),": Any additional notes"]})]})]}),e.jsxs(j,{onClick:o,variant:"secondary",className:"w-full",children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})]})]})}function hs(){const r=le(),{data:m=[],isLoading:u}=L({queryKey:["content-suggestions"],queryFn:async()=>{const{data:a,error:s}=await w.from("content_suggestions").select("*").order("priority",{ascending:!1}).order("created_at",{ascending:!1});if(s)throw s;return a}}),h=S({mutationFn:async({customInstructions:a,count:s})=>{const{data:{session:t}}=await w.auth.getSession();if(!t)throw new Error("Not authenticated");const x=await R.invoke("generate-content-suggestions",{body:{customInstructions:a,count:s}});if(x.error)throw new Error(x.error.message||"Failed to generate suggestions");return x.data},onSuccess:()=>{r.invalidateQueries({queryKey:["content-suggestions"]}),c.success("Content suggestions generated successfully")},onError:a=>{c.error(a.message||"Failed to generate suggestions")}}),i=S({mutationFn:async({id:a,updates:s})=>{const{data:t,error:x}=await w.from("content_suggestions").update(s).eq("id",a).select().single();if(x)throw x;return t},onSuccess:()=>{r.invalidateQueries({queryKey:["content-suggestions"]})},onError:a=>{c.error(a.message||"Failed to update suggestion")}}),o=S({mutationFn:async a=>{const{error:s}=await w.from("content_suggestions").delete().eq("id",a);if(s)throw s},onSuccess:()=>{r.invalidateQueries({queryKey:["content-suggestions"]}),c.success("Suggestion deleted")},onError:a=>{c.error(a.message||"Failed to delete suggestion")}}),d=S({mutationFn:async a=>{const s=a.keywords||[a.topic],{data:{session:t}}=await w.auth.getSession();if(!t)throw new Error("Not authenticated");const x=await R.invoke("import-keywords",{body:{keywords:s.map(_=>({keyword:_,category:a.category||"General"}))}});if(x.error)throw new Error(x.error.message||"Failed to add to keywords");return await w.from("content_suggestions").update({status:"completed"}).eq("id",a.id),x.data},onSuccess:()=>{r.invalidateQueries({queryKey:["content-suggestions"]}),r.invalidateQueries({queryKey:["keywords"]}),c.success("Added to keywords successfully")},onError:a=>{c.error(a.message||"Failed to add to keywords")}}),n=S({mutationFn:async a=>{const{data:{session:s}}=await w.auth.getSession();if(!s)throw new Error("Not authenticated");await w.from("content_suggestions").update({status:"queued"}).eq("id",a.id);const t=await R.invoke("generate-article",{body:{topic:a.topic,category:a.category,keywords:a.keywords,autoSelectKeyword:!1}});if(t.error)throw new Error(t.error.message||"Failed to generate article");return await w.from("content_suggestions").update({status:"completed",generated_article_id:t.data?.article?.id}).eq("id",a.id),t.data},onSuccess:()=>{r.invalidateQueries({queryKey:["content-suggestions"]}),r.invalidateQueries({queryKey:["articles"]}),c.success("Article generated successfully")},onError:a=>{c.error(a.message||"Failed to generate article")}});return{suggestions:m,isLoading:u,generateSuggestions:(a,s)=>h.mutate({customInstructions:a,count:s}),isGenerating:h.isPending,updateSuggestion:(a,s)=>i.mutate({id:a,updates:s}),deleteSuggestion:a=>o.mutate(a),queueSuggestion:a=>i.mutate({id:a,updates:{status:"queued"}}),rejectSuggestion:a=>i.mutate({id:a,updates:{status:"rejected"}}),addToKeywords:a=>d.mutate(a),writeArticle:a=>n.mutate(a),isWritingArticle:n.isPending}}function ms(){const[r,m]=N.useState(!1),[u,h]=N.useState(""),[i,o]=N.useState("10"),{suggestions:d,isLoading:n,generateSuggestions:a,isGenerating:s,queueSuggestion:t,rejectSuggestion:x,deleteSuggestion:_,addToKeywords:C,writeArticle:l,isWritingArticle:p}=hs(),f=()=>{a(u,parseInt(i)||10),m(!1),h("")},A=y=>{switch(y){case"queued":return"bg-blue-500";case"in_progress":return"bg-yellow-500";case"completed":return"bg-green-500";case"rejected":return"bg-red-500";default:return"bg-gray-500"}},D=y=>{const M=y||3;return M>=4?e.jsx(je,{className:"h-3 w-3 text-red-500"}):M>=3?e.jsx(je,{className:"h-3 w-3 text-orange-500"}):e.jsx(je,{className:"h-3 w-3 text-gray-500"})},g=d.filter(y=>y.status==="pending"),E=d.filter(y=>y.status==="queued");return e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5"}),"AI Content Suggestions"]}),e.jsx(Q,{children:"Generate high-value article ideas based on SEO keywords and market trends"})]}),e.jsxs(H,{open:r,onOpenChange:m,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Generate Suggestions"]})}),e.jsxs(X,{children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Generate Content Suggestions"}),e.jsx(Y,{children:"AI will analyze your existing keywords and articles to suggest relevant topics"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Number of Suggestions"}),e.jsx(P,{type:"number",min:"1",max:"50",value:i,onChange:y=>o(y.target.value),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Custom Instructions (Optional)"}),e.jsx(he,{value:u,onChange:y=>h(y.target.value),placeholder:"E.g., Focus on first-time homebuyers in urban areas...",rows:4})]})]}),e.jsxs(ue,{children:[e.jsx(j,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsxs(j,{onClick:f,disabled:s,children:[s&&e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Generate"]})]})]})]})]})}),e.jsx(V,{children:n?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(q,{className:"h-8 w-8 animate-spin text-primary"})}):d.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:d.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:g.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Queued"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:E.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.filter(y=>y.status==="completed").length})]})]}),e.jsx("div",{className:"space-y-3",children:d.map(y=>e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[D(y.priority),e.jsx("h4",{className:"font-semibold",children:y.topic}),e.jsx(T,{className:`${A(y.status)} text-white text-xs`,children:y.status||"pending"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(T,{variant:"outline",children:y.category||"General"}),y.keywords?.slice(0,3).map((M,F)=>e.jsxs(T,{variant:"secondary",className:"gap-1",children:[e.jsx(fe,{className:"h-3 w-3"}),M]},F))]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[y.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{variant:"outline",size:"sm",onClick:()=>l(y),disabled:p,title:"Write Article Now",children:p?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(Pe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>t(y.id),title:"Add to Queue",children:e.jsx(Qe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>C(y),title:"Add to Keywords",children:e.jsx(fe,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>x(y.id),title:"Reject",children:e.jsx(Je,{className:"h-4 w-4"})})]}),y.status==="completed"&&e.jsx(j,{variant:"outline",size:"sm",disabled:!0,title:"Completed",children:e.jsx(ce,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this suggestion?")&&_(y.id)},title:"Delete",children:e.jsx(ie,{className:"h-4 w-4"})})]})]})},y.id))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(me,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No content suggestions yet. Generate AI-powered topic ideas to get started."}),e.jsxs(H,{open:r,onOpenChange:m,children:[e.jsx(se,{asChild:!0,children:e.jsxs(j,{children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Generate First Suggestions"]})}),e.jsxs(X,{children:[e.jsxs(J,{children:[e.jsx(Z,{children:"Generate Content Suggestions"}),e.jsx(Y,{children:"AI will analyze your existing keywords and articles to suggest relevant topics"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Number of Suggestions"}),e.jsx(P,{type:"number",min:"1",max:"50",value:i,onChange:y=>o(y.target.value),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Custom Instructions (Optional)"}),e.jsx(he,{value:u,onChange:y=>h(y.target.value),placeholder:"E.g., Focus on first-time homebuyers in urban areas...",rows:4})]})]}),e.jsxs(ue,{children:[e.jsx(j,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsxs(j,{onClick:f,disabled:s,children:[s&&e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Generate"]})]})]})]})]})})]})}function xs(r){const m=[],u=[],h=[],i=[],o=r.seo_title||r.title;!o||o.length===0?m.push("SEO title is missing"):o.length<30?u.push(`SEO title is too short (${o.length}/30 minimum characters)`):o.length>60?u.push(`SEO title is too long (${o.length}/60 maximum characters)`):i.push(`SEO title length is optimal (${o.length} characters)`);const d=r.seo_description||r.excerpt;!d||d.length===0?m.push("Meta description is missing"):d.length<120?u.push(`Meta description is too short (${d.length}/120 minimum characters)`):d.length>160?u.push(`Meta description is too long (${d.length}/160 maximum characters)`):i.push(`Meta description length is optimal (${d.length} characters)`);const n=r.seo_keywords||[];if(!n||n.length===0?u.push("No SEO keywords defined"):n.length<3?h.push(`Consider adding more keywords (${n.length}/3+ recommended)`):i.push(`Keywords defined (${n.length} keywords)`),!r.slug||r.slug.length===0?m.push("Article slug is missing"):r.slug.includes(" ")?m.push("Slug contains spaces - should use hyphens"):/^[a-z0-9-]+$/.test(r.slug)?i.push("Slug is properly formatted"):u.push("Slug contains special characters - consider using only lowercase letters, numbers, and hyphens"),!r.content||r.content.length===0)m.push("Article content is empty");else{const l=r.content.split(/\s+/).filter(Boolean).length;l<300?u.push(`Content is thin (${l} words) - aim for 300+ words for better SEO`):l<800?h.push(`Content has ${l} words - consider expanding to 800+ for comprehensive coverage`):i.push(`Content length is good (${l} words)`);const p=r.content.includes("## "),f=r.content.includes("### ");!p&&!f?h.push("Consider adding subheadings (## or ###) for better content structure"):i.push("Content has proper heading structure"),r.content.includes("](")||h.push("Consider adding internal or external links for better SEO")}!r.excerpt||r.excerpt.length===0?u.push("Article excerpt is missing - used for previews and social sharing"):r.excerpt.length>200?h.push("Excerpt is long - consider shortening to under 200 characters"):i.push("Excerpt is defined"),r.featured_image_url?i.push("Featured image is set"):h.push("Consider adding a featured image for social sharing and visual appeal"),r.category?i.push("Category is defined"):u.push("Article category is not set"),!r.tags||r.tags.length===0?h.push("Consider adding tags for better content organization"):i.push(`Tags defined (${r.tags.length} tags)`);const a=m.length+u.length+h.length+i.length,s=i.length*10,t=h.length*2,x=u.length*5,_=m.length*15;let C=Math.max(0,Math.min(100,100-_-x-t+Math.floor(s/a*10)));return m.length===0&&C<50&&(C=50),{score:C,errors:m,warnings:u,suggestions:h,passed:i}}function Me(r){return r>=80?"text-green-600":r>=60?"text-yellow-600":r>=40?"text-orange-600":"text-red-600"}function gs(r){return r>=80?"Excellent":r>=60?"Good":r>=40?"Needs Improvement":"Poor"}function ps(r){return r>=80?"bg-green-500":r>=60?"bg-yellow-500":r>=40?"bg-orange-500":"bg-red-500"}function js({article:r,open:m,onOpenChange:u,onPublish:h,isPublishing:i=!1}){const o=N.useMemo(()=>r?xs(r):null,[r]);if(!r||!o)return null;const d=o.errors.length===0,n=o.warnings.length>0||o.suggestions.length>0;return e.jsx(H,{open:m,onOpenChange:u,children:e.jsxs(X,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(J,{children:[e.jsxs(Z,{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5"}),"Pre-Publish SEO Validation"]}),e.jsxs(Y,{children:['Review SEO requirements before publishing "',r.title,'"']})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4 p-4 border rounded-lg bg-muted/30",children:[e.jsxs("div",{className:"flex-shrink-0",children:[e.jsx("div",{className:`text-4xl font-bold ${Me(o.score)}`,children:o.score}),e.jsx("div",{className:`text-sm font-medium ${Me(o.score)}`,children:gs(o.score)})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:"SEO Score"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full ${ps(o.score)} transition-all duration-500`,style:{width:`${o.score}%`}})})]})]}),o.errors.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-600 font-medium",children:[e.jsx(be,{className:"h-4 w-4"}),"Critical Issues (",o.errors.length,")"]}),e.jsx("div",{className:"space-y-2",children:o.errors.map((a,s)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-red-50 border border-red-200 rounded-lg text-sm",children:[e.jsx(be,{className:"h-4 w-4 text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-red-800",children:a})]},s))})]}),o.warnings.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-600 font-medium",children:[e.jsx(ke,{className:"h-4 w-4"}),"Warnings (",o.warnings.length,")"]}),e.jsx("div",{className:"space-y-2",children:o.warnings.map((a,s)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm",children:[e.jsx(ke,{className:"h-4 w-4 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-yellow-800",children:a})]},s))})]}),o.suggestions.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-600 font-medium",children:[e.jsx(me,{className:"h-4 w-4"}),"Suggestions (",o.suggestions.length,")"]}),e.jsx("div",{className:"space-y-2",children:o.suggestions.map((a,s)=>e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-blue-50 border border-blue-200 rounded-lg text-sm",children:[e.jsx(me,{className:"h-4 w-4 text-blue-500 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-blue-800",children:a})]},s))})]}),o.passed.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-green-600 font-medium",children:[e.jsx(ce,{className:"h-4 w-4"}),"Passed (",o.passed.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:o.passed.map((a,s)=>e.jsxs(T,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(ce,{className:"h-3 w-3 mr-1"}),a]},s))})]})]}),e.jsxs(ue,{className:"flex-col sm:flex-row gap-2",children:[e.jsx(j,{variant:"outline",onClick:()=>u(!1),children:"Cancel"}),d?n?e.jsx(j,{onClick:h,disabled:i,variant:"default",className:"bg-yellow-600 hover:bg-yellow-700",children:i?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Publishing..."]}):"Publish Anyway"}):e.jsx(j,{onClick:h,disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Publishing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Publish Article"]})}):e.jsx(j,{disabled:!0,variant:"destructive",children:"Fix Critical Issues First"})]})]})})}function ys(){const[r,m]=N.useState("all"),[u,h]=N.useState(!1),[i,o]=N.useState(null),[d,n]=N.useState(!1),{articles:a,isLoading:s,deleteArticle:t,publishArticle:x,republishArticle:_,isRepublishing:C}=Ee(),{keywords:l,isLoading:p}=we(),{webhooks:f,isLoading:A,updateWebhook:D,deleteWebhook:g,testWebhook:E,isTesting:y}=Ie(),M=v=>{o(v),h(!0)},F=()=>{i&&(n(!0),x(i.id,{onSuccess:()=>{h(!1),o(null),n(!1)},onError:()=>{n(!1)}}))},ee=v=>{switch(v){case"published":return"bg-green-500";case"scheduled":return"bg-blue-500";case"draft":return"bg-gray-500";case"archived":return"bg-orange-500";default:return"bg-gray-500"}};if(s)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(q,{className:"h-8 w-8 animate-spin text-primary"})});const pe=r==="all"?a:a?.filter(v=>v.status===r);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Blog Articles"}),e.jsx(Q,{children:"Manage your real estate blog content and articles"})]}),e.jsx(Ce,{})]})}),e.jsx(V,{children:e.jsxs(xe,{value:r,onValueChange:m,children:[e.jsxs(ge,{children:[e.jsx(I,{value:"all",children:"All Articles"}),e.jsx(I,{value:"draft",children:"Drafts"}),e.jsx(I,{value:"scheduled",children:"Scheduled"}),e.jsx(I,{value:"published",children:"Published"})]}),e.jsx(K,{value:r,className:"space-y-4 mt-6",children:pe&&pe.length>0?pe.map(v=>e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-lg",children:v.title}),e.jsx(T,{className:`${ee(v.status)} text-white`,children:v.status})]}),v.excerpt&&e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[v.excerpt.substring(0,150),"..."]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx(T,{variant:"outline",children:v.category}),v.keyword_id&&e.jsxs(T,{variant:"secondary",className:"gap-1",children:[e.jsx(fe,{className:"h-3 w-3"}),l?.find(oe=>oe.id===v.keyword_id)?.keyword||"Keyword"]}),v.tags?.slice(0,2).map((oe,De)=>e.jsx(T,{variant:"secondary",children:oe},De))]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ye,{className:"h-3 w-3"}),v.view_count," views"]}),e.jsxs("span",{children:["Created: ",re(new Date(v.created_at),"MMM d, yyyy")]}),v.published_at&&e.jsxs("span",{children:["Published: ",re(new Date(v.published_at),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:"outline",size:"sm",title:"View",children:e.jsx(ye,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",title:"Edit",children:e.jsx(Te,{className:"h-4 w-4"})}),v.status==="draft"&&e.jsx(j,{variant:"outline",size:"sm",onClick:()=>M(v),title:"Publish",children:e.jsx(ce,{className:"h-4 w-4"})}),v.status==="published"&&e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{confirm("Re-distribute this article to social platforms?")&&_(v.id)},disabled:C,title:"Re-publish to Social Media",children:C?e.jsx(q,{className:"h-4 w-4 animate-spin"}):e.jsx(de,{className:"h-4 w-4"})}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this article?")&&t(v.id)},title:"Delete",children:e.jsx(ie,{className:"h-4 w-4"})})]})]})},v.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No articles found"}),e.jsx("div",{className:"mt-4",children:e.jsx(Ce,{})})]})})]})})]}),e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Keyword Management"}),e.jsx(Q,{children:"Track SEO keyword usage across articles"})]}),e.jsx(Ke,{})]})}),e.jsx(V,{children:p?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(q,{className:"h-6 w-6 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Keywords"}),e.jsx("p",{className:"text-2xl font-bold",children:l?.length||0})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unused"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:l?.filter(v=>v.usage_count===0).length||0})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Most Used"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Math.max(...l?.map(v=>v.usage_count)||[0])})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Keywords are automatically tracked when articles are published. Import your keywords.csv to get started."})]})})]}),e.jsx(ms,{}),e.jsxs(W,{children:[e.jsx(O,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Article Webhooks"}),e.jsx(Q,{children:"Configure webhooks for automatic article distribution"})]}),e.jsx(Fe,{})]})}),e.jsx(V,{children:A?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(q,{className:"h-6 w-6 animate-spin text-primary"})}):f&&f.length>0?e.jsx("div",{className:"space-y-3",children:f.map(v=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:v.name}),e.jsx(T,{variant:v.is_active?"default":"secondary",children:v.is_active?"Active":"Inactive"})]}),e.jsxs("a",{href:v.webhook_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-muted-foreground hover:text-primary flex items-center gap-1",children:[v.webhook_url,e.jsx(Ve,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ne,{checked:v.is_active,onCheckedChange:oe=>{D({id:v.id,updates:{is_active:oe}})}}),e.jsx(j,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this webhook?")&&g(v.id)},children:e.jsx(ie,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"pt-3 border-t",children:e.jsx(j,{variant:"secondary",size:"sm",onClick:()=>E(v.webhook_url),disabled:y,className:"w-full",children:y?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Send Test Payload to Make.com"]})})})]},v.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No webhooks configured. Add one to automatically send published articles to external platforms."}),e.jsx(Fe,{})]})})]}),e.jsx(js,{article:i,open:u,onOpenChange:v=>{h(v),v||o(null)},onPublish:F,isPublishing:d})]})}function Ys(){const{user:r,role:m}=Re();return!r||m!=="admin"?e.jsx(Ue,{to:"/",replace:!0}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(_e,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage AI, content, and platform settings"})]})]}),e.jsx(ze,{to:"/dashboard",children:e.jsxs(j,{variant:"outline",className:"gap-2",children:[e.jsx($e,{className:"h-4 w-4"}),"Back to Dashboard"]})})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(xe,{defaultValue:"ai",className:"space-y-6",children:[e.jsxs(ge,{className:"grid w-full grid-cols-8 lg:w-auto",children:[e.jsxs(I,{value:"ai",className:"gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"AI Settings"]}),e.jsxs(I,{value:"social",className:"gap-2",children:[e.jsx(Be,{className:"h-4 w-4"}),"Social Media"]}),e.jsxs(I,{value:"articles",className:"gap-2",children:[e.jsx(ss,{className:"h-4 w-4"}),"Articles"]}),e.jsxs(I,{value:"keywords",className:"gap-2",children:[e.jsx(Ze,{className:"h-4 w-4"}),"Keywords"]}),e.jsxs(I,{value:"seo",className:"gap-2",children:[e.jsx(qe,{className:"h-4 w-4"}),"SEO"]}),e.jsxs(I,{value:"analytics",className:"gap-2",children:[e.jsx(He,{className:"h-4 w-4"}),"Search Analytics"]}),e.jsxs(I,{value:"users",className:"gap-2",children:[e.jsx(Xe,{className:"h-4 w-4"}),"User Roles"]}),e.jsxs(I,{value:"settings",className:"gap-2",children:[e.jsx(_e,{className:"h-4 w-4"}),"Platform"]})]}),e.jsx(K,{value:"ai",className:"space-y-6",children:e.jsx(cs,{})}),e.jsx(K,{value:"social",className:"space-y-6",children:e.jsx(us,{})}),e.jsx(K,{value:"articles",className:"space-y-6",children:e.jsx(ys,{})}),e.jsx(K,{value:"keywords",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Keyword Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Import and manage keywords from CSV files"})]}),e.jsx(Ke,{})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use the import button to bulk upload keywords from a CSV file. Keywords help improve content generation and SEO optimization."})]})}),e.jsx(K,{value:"seo",className:"space-y-6",children:e.jsx(Ye,{})}),e.jsx(K,{value:"analytics",className:"space-y-6",children:e.jsx(es,{})}),e.jsx(K,{value:"users",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"User Role Management"}),e.jsx("p",{className:"text-muted-foreground",children:"User role management interface coming soon..."})]})}),e.jsx(K,{value:"settings",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Platform Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Additional platform configuration coming soon..."})]})})]})})]})}export{Ys as AdminDashboard};
