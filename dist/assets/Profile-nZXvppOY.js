import{F as E,K as _,r as b,s as m,j as e}from"./index-CH8a_jH7.js";import{u as C}from"./useProfile-D1yjrkFD.js";import{u as w}from"./use-toast-DTZfmZso.js";import{S as k}from"./save-CNxUnxma.js";import"./useMutation-DQof0gk2.js";/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=E("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),N=5*1024*1024,P=["image/jpeg","image/jpg","image/png","image/webp"];function S(){const{user:r}=_(),{toast:i}=w(),[x,p]=b.useState(!1),l=s=>P.includes(s.type)?s.size>N?"File size must be less than 5MB":null:"Please upload a JPG, PNG, or WEBP image";return{uploadAvatar:async s=>{if(!(r!=null&&r.id))return i({title:"Error",description:"You must be logged in to upload an avatar",variant:"destructive"}),null;const a=l(s);if(a)return i({title:"Invalid file",description:a,variant:"destructive"}),null;p(!0);try{const o=s.name.split(".").pop(),n=`${r.id}/avatar.${o}`,{data:d}=await m.storage.from("avatars").list(r.id);d&&d.length>0&&await m.storage.from("avatars").remove(d.map(g=>`${r.id}/${g.name}`));const{error:f}=await m.storage.from("avatars").upload(n,s,{cacheControl:"3600",upsert:!0});if(f)throw f;const{data:{publicUrl:c}}=m.storage.from("avatars").getPublicUrl(n),{error:u}=await m.from("profiles").update({avatar_url:c}).eq("id",r.id);if(u)throw u;return i({title:"Success",description:"Profile picture updated successfully"}),c}catch(o){return console.error("Error uploading avatar:",o),i({title:"Error",description:"Failed to upload profile picture. Please try again.",variant:"destructive"}),null}finally{p(!1)}},uploading:x,acceptedTypes:P.join(", "),maxSize:N}}function B(){var c,u,g;const{profile:r,isLoading:i,updateProfile:x}=C(),{uploadAvatar:p,uploading:l}=S(),{toast:h}=w(),s=b.useRef(null),[a,o]=b.useState({full_name:"",username:"",bio:"",avatar_url:""});b.useEffect(()=>{r&&o({full_name:r.full_name||"",username:r.username||"",bio:r.bio||"",avatar_url:r.avatar_url||""})},[r]);const n=t=>{o({...a,[t.target.name]:t.target.value})},d=async t=>{var j;const v=(j=t.target.files)==null?void 0:j[0];if(!v)return;const y=await p(v);y&&o({...a,avatar_url:y})},f=async t=>{t.preventDefault();try{await x.mutateAsync(a),h({title:"Profile updated!",description:"Your profile has been saved successfully."})}catch{h({title:"Error",description:"Failed to update profile. Please try again.",variant:"destructive"})}};return i?e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading..."}):e.jsxs("form",{onSubmit:f,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Edit Profile"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Update your agent information and contact details"})]}),e.jsxs("button",{type:"submit",className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium",children:[e.jsx(k,{className:"h-4 w-4"}),"Save Changes"]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Profile Photo"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[a.avatar_url?e.jsx("img",{src:a.avatar_url,alt:"Profile",className:"w-24 h-24 rounded-full object-cover"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-primary/10 flex items-center justify-center text-3xl font-bold text-primary",children:((c=a.full_name)==null?void 0:c.split(" ").map(t=>t[0]).join(""))||((g=(u=a.username)==null?void 0:u[0])==null?void 0:g.toUpperCase())||"?"}),e.jsx("button",{type:"button",onClick:()=>{var t;return(t=s.current)==null?void 0:t.click()},disabled:l,className:"absolute bottom-0 right-0 p-2 bg-primary text-primary-foreground rounded-full hover:bg-primary/90 transition-colors disabled:opacity-50",children:e.jsx(F,{className:"h-4 w-4"})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-foreground mb-1",children:"Upload Photo"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"JPG, PNG or WEBP. Max size 5MB."}),e.jsx("button",{type:"button",onClick:()=>{var t;return(t=s.current)==null?void 0:t.click()},disabled:l,className:"px-4 py-2 bg-background border border-border rounded-lg hover:bg-accent transition-colors text-sm font-medium disabled:opacity-50",children:l?"Uploading...":"Choose File"}),e.jsx("input",{ref:s,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:d,className:"hidden"})]})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Full Name"}),e.jsx("input",{type:"text",name:"full_name",value:a.full_name,onChange:n,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Username *"}),e.jsx("input",{type:"text",name:"username",value:a.username,onChange:n,required:!0,className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"})]})]})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground mb-4",children:"Professional Bio"}),e.jsx("textarea",{name:"bio",value:a.bio,onChange:n,rows:6,maxLength:500,placeholder:"Tell potential clients about your experience, specialties, and what makes you unique...",className:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary resize-none"}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[a.bio.length,"/500 characters"]})]})]})}export{B as default};
