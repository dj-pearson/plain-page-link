import{a9 as _,j as e,C as j,c as f,d as y,W as C,f as b,e as N,r as T,B as p,Y as M,M as P,a8 as F,Q as A,bJ as z,bK as Y,bL as $,h as q,o as E,ae as I,g as U,R as W,ao as G,ac as H,F as O,m as X,a2 as J,a3 as Q}from"./index-Dqp2k1py.js";import{g as Z,B as D,X as R,Y as K,f as ee,R as se,L as ae,a as te,T as ie,b as re,c as ne,d as le,e as k,h as g,i as oe,j as h}from"./table-B8P6r8Qi.js";import{A as ce,a as de,C as me,S as xe}from"./SearchAnalyticsDashboard-M4EXiwHh.js";import{L as S}from"./lightbulb-B7FXKsqC.js";import{T as he,a as pe,b as V,c as B}from"./tabs-54ZmhUku.js";import{D as ue,a as ge,b as je,c as L}from"./dropdown-menu-KQonIvog.js";import{u as fe}from"./useAnalytics-Dof2-WTt.js";import"./useMutation-Cc-9CBVE.js";import"./circle-x-BjPVtgNs.js";import"./mouse-pointer-CDsaA2hl.js";import"./file-text-BQVFFYgF.js";import"./trending-down-Dod1spdn.js";import"./minus-B6VoiwoP.js";import"./popover-BrpO0DgG.js";import"./checkbox-DRkot6ZK.js";import"./filter-DBWDY1nG.js";import"./exportUtils-ONScMiwb.js";import"./refresh-cw-CZhCe3Q-.js";import"./settings-lM--hMT6.js";import"./index-BpCpig5b.js";const ye=_("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function w({title:i,value:l,change:t,changeLabel:d="vs last period",icon:a,iconColor:o="text-blue-600",iconBgColor:c="bg-blue-100",trend:n="neutral"}){const m=n==="up"?"text-green-600":n==="down"?"text-red-600":"text-gray-600",r=n==="up"?"↑":n==="down"?"↓":"•";return e.jsxs(j,{children:[e.jsxs(f,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(y,{className:"text-sm font-medium text-muted-foreground",children:i}),e.jsx("div",{className:C("rounded-full p-2",c),children:e.jsx(a,{className:C("h-4 w-4",o)})})]}),e.jsxs(b,{children:[e.jsx("div",{className:"text-2xl font-bold",children:l}),t!==void 0&&e.jsxs("p",{className:C("text-xs font-medium mt-1",m),children:[r," ",Math.abs(t),"% ",d]})]})]})}var be=Z({chartName:"BarChart",GraphicalChild:D,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:R},{axisType:"yAxis",AxisComp:K}],formatAxisMap:ee});function ve({title:i,description:l,data:t,series:d,type:a="line",height:o=300,showLegend:c=!0,yAxisLabel:n}){const m=()=>{const r={data:t,margin:{top:5,right:20,left:0,bottom:5}},v=e.jsxs(e.Fragment,{children:[e.jsx(me,{strokeDasharray:"3 3",className:"stroke-muted"}),e.jsx(R,{dataKey:"name",tick:{fontSize:12},tickLine:!1,axisLine:!1}),e.jsx(K,{tick:{fontSize:12},tickLine:!1,axisLine:!1,label:n?{value:n,angle:-90,position:"insideLeft"}:void 0}),e.jsx(ie,{contentStyle:{backgroundColor:"white",border:"1px solid #e5e7eb",borderRadius:"8px"}}),c&&e.jsx(re,{})]});switch(a){case"area":return e.jsxs(ce,{...r,children:[v,d.map(s=>e.jsx(de,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,fill:s.color,fillOpacity:.2,strokeWidth:2},s.dataKey))]});case"bar":return e.jsxs(be,{...r,children:[v,d.map(s=>e.jsx(D,{dataKey:s.dataKey,name:s.name,fill:s.color,radius:[4,4,0,0]},s.dataKey))]});case"line":default:return e.jsxs(ae,{...r,children:[v,d.map(s=>e.jsx(te,{type:"monotone",dataKey:s.dataKey,name:s.name,stroke:s.color,strokeWidth:2,dot:{r:4},activeDot:{r:6}},s.dataKey))]})}};return e.jsxs(j,{children:[e.jsxs(f,{children:[e.jsx(y,{children:i}),l&&e.jsx(N,{children:l})]}),e.jsx(b,{children:e.jsx(se,{width:"100%",height:o,children:m()})})]})}function we({leads:i,onLeadClick:l}){const[t,d]=T.useState("created_at"),[a,o]=T.useState("desc"),c=s=>{t===s?o(a==="asc"?"desc":"asc"):(d(s),o("desc"))},n=[...i].sort((s,x)=>{let u=0;switch(t){case"created_at":u=new Date(s.created_at).getTime()-new Date(x.created_at).getTime();break;case"name":u=s.name.localeCompare(x.name);break;case"lead_type":u=s.lead_type.localeCompare(x.lead_type);break;case"status":u=s.status.localeCompare(x.status);break}return a==="asc"?u:-u}),m=({field:s})=>t!==s?null:a==="asc"?e.jsx(Y,{className:"inline w-4 h-4 ml-1"}):e.jsx($,{className:"inline w-4 h-4 ml-1"}),r=s=>{switch(s){case"new":return"bg-blue-100 text-blue-800";case"contacted":return"bg-yellow-100 text-yellow-800";case"qualified":return"bg-green-100 text-green-800";case"converted":return"bg-purple-100 text-purple-800";case"lost":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},v=s=>{switch(s){case"buyer":return"Buyer";case"seller":return"Seller";case"valuation":return"Valuation";case"contact":return"Contact";default:return s}};return e.jsxs(j,{children:[e.jsxs(f,{children:[e.jsx(y,{children:"Recent Leads"}),e.jsxs(N,{children:["Your latest lead submissions (",i.length," total)"]})]}),e.jsx(b,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(ne,{children:[e.jsx(le,{children:e.jsxs(k,{children:[e.jsx(g,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>c("name"),className:"hover:bg-transparent",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Name",e.jsx(m,{field:"name"})]})}),e.jsx(g,{children:"Contact"}),e.jsx(g,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>c("lead_type"),className:"hover:bg-transparent",children:["Type",e.jsx(m,{field:"lead_type"})]})}),e.jsx(g,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>c("status"),className:"hover:bg-transparent",children:["Status",e.jsx(m,{field:"status"})]})}),e.jsx(g,{children:e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>c("created_at"),className:"hover:bg-transparent",children:["Date",e.jsx(m,{field:"created_at"})]})}),e.jsx(g,{className:"text-right",children:"Actions"})]})}),e.jsx(oe,{children:n.length===0?e.jsx(k,{children:e.jsx(h,{colSpan:6,className:"text-center text-muted-foreground py-8",children:"No leads yet. They'll appear here when visitors submit forms."})}):n.map(s=>e.jsxs(k,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>l?.(s),children:[e.jsx(h,{className:"font-medium",children:s.name}),e.jsx(h,{children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm",children:[e.jsxs("a",{href:`mailto:${s.email}`,className:"flex items-center text-blue-600 hover:underline",onClick:x=>x.stopPropagation(),children:[e.jsx(P,{className:"w-3 h-3 mr-1"}),s.email]}),s.phone&&e.jsxs("a",{href:`tel:${s.phone}`,className:"flex items-center text-blue-600 hover:underline",onClick:x=>x.stopPropagation(),children:[e.jsx(F,{className:"w-3 h-3 mr-1"}),s.phone]})]})}),e.jsx(h,{children:e.jsx(A,{variant:"outline",children:v(s.lead_type)})}),e.jsx(h,{children:e.jsx(A,{className:r(s.status),children:s.status})}),e.jsx(h,{className:"text-sm text-muted-foreground",children:z(s.created_at)}),e.jsx(h,{className:"text-right",children:e.jsx(p,{variant:"ghost",size:"sm",onClick:x=>{x.stopPropagation(),l?.(s)},children:"View"})})]},s.id))})]})})})]})}function Ne({stats:i,previousStats:l,listingsCount:t=0,linksCount:d=0}){const a=[],o=l?(i.totalViews-l.totalViews)/(l.totalViews||1)*100:0,c=l?(i.totalLeads-l.totalLeads)/(l.totalLeads||1)*100:0;o>20&&a.push({id:"views-growth",type:"positive",title:`Profile views up ${o.toFixed(0)}%`,description:"Your profile is getting great visibility! Keep sharing your link on social media."}),c>15&&a.push({id:"leads-growth",type:"positive",title:`Leads increased ${c.toFixed(0)}%`,description:"Your lead generation is accelerating. Make sure to respond quickly to maintain momentum.",action:{label:"Check leads",href:"/dashboard/leads"}}),i.conversionRate>5&&a.push({id:"high-conversion",type:"positive",title:`Strong ${i.conversionRate}% conversion rate`,description:"You're converting visitors to leads at an excellent rate!"}),i.totalViews>100&&i.conversionRate<2&&a.push({id:"low-conversion",type:"warning",title:"Conversion rate could be higher",description:"You're getting views but not many leads. Try adding clear call-to-action buttons.",action:{label:"Add CTAs",href:"/dashboard/links"}}),i.totalViews<50&&t>0&&a.push({id:"low-traffic",type:"warning",title:"Profile needs more visibility",description:"Share your profile link on Instagram, Facebook, and email signatures to increase traffic."}),t===0?a.push({id:"no-listings",type:"warning",title:"Add your first listing",description:"Profiles with property listings get 3x more leads. Showcase what you're selling!",action:{label:"Add listing",href:"/dashboard/listings"}}):t<3&&a.push({id:"few-listings",type:"tip",title:"Add more listings",description:"Agents with 5+ listings convert 40% better. Add more properties to build credibility.",action:{label:"Add listings",href:"/dashboard/listings"}}),d===0&&a.push({id:"no-links",type:"tip",title:"Add custom links",description:"Link to your website, calendar, and social media to give visitors more ways to connect.",action:{label:"Add links",href:"/dashboard/links"}}),i.totalViews>0&&i.totalLeads===0&&a.push({id:"no-leads-yet",type:"tip",title:"First lead tips",description:"Add contact forms, showcase testimonials, and ensure your phone/email are visible.",action:{label:"Edit profile",href:"/dashboard/profile"}}),o<-20&&a.push({id:"views-declining",type:"warning",title:`Views down ${Math.abs(o).toFixed(0)}%`,description:"Increase your social media activity and consider updating your listings to boost visibility."}),a.length===0&&a.push({id:"keep-going",type:"positive",title:"You're doing great!",description:"Keep your profile updated with fresh listings and share it regularly to maintain growth."});const n=r=>{switch(r){case"positive":return e.jsx(U,{className:"w-5 h-5 text-green-600"});case"warning":return e.jsx(I,{className:"w-5 h-5 text-orange-600"});case"tip":return e.jsx(S,{className:"w-5 h-5 text-blue-600"})}},m=r=>{switch(r){case"positive":return"bg-green-50 border-green-200";case"warning":return"bg-orange-50 border-orange-200";case"tip":return"bg-blue-50 border-blue-200"}};return e.jsxs(j,{children:[e.jsx(f,{className:"pb-3",children:e.jsxs(y,{className:"text-lg flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5 text-primary"}),"Insights & Recommendations"]})}),e.jsx(b,{children:e.jsx("div",{className:"space-y-3",children:a.slice(0,5).map(r=>e.jsx("div",{className:`p-4 rounded-lg border ${m(r.type)}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:n(r.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-semibold text-gray-900 text-sm mb-1",children:r.title}),e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:r.description}),r.action&&e.jsxs(q,{to:r.action.href,className:"inline-flex items-center gap-1 text-sm font-medium text-blue-600 hover:text-blue-700",children:[r.action.label,e.jsx(E,{className:"w-4 h-4"})]})]})]})},r.id))})})]})}function Ie(){const[i,l]=T.useState("30d"),{stats:t,viewsData:d,leadsData:a,recentLeads:o,isLoading:c}=fe(i);return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:"Loading..."}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Analytics"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Track your profile performance, lead generation, and search visibility"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(ue,{children:[e.jsx(ge,{asChild:!0,children:e.jsxs(p,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:i==="7d"?"Last 7 days":i==="30d"?"Last 30 days":"Last 90 days"})]})}),e.jsxs(je,{align:"end",children:[e.jsx(L,{onClick:()=>l("7d"),children:"Last 7 days"}),e.jsx(L,{onClick:()=>l("30d"),children:"Last 30 days"}),e.jsx(L,{onClick:()=>l("90d"),children:"Last 90 days"})]})]}),e.jsxs(p,{variant:"outline",size:"sm",className:"flex-1 sm:flex-none",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"text-xs sm:text-sm",children:"Export"})]})]})]}),e.jsxs(he,{defaultValue:"overview",className:"space-y-4 sm:space-y-6",children:[e.jsxs(pe,{className:"grid w-full grid-cols-2 sm:w-auto",children:[e.jsxs(V,{value:"overview",className:"gap-2",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Profile Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Overview"})]}),e.jsxs(V,{value:"search",className:"gap-2",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Search Analytics"}),e.jsx("span",{className:"sm:hidden",children:"Search"})]})]}),e.jsxs(B,{value:"overview",className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(w,{title:"Total Views",value:t.totalViews.toLocaleString(),icon:X,iconColor:"text-blue-600",iconBgColor:"bg-blue-100"}),e.jsx(w,{title:"Unique Visitors",value:t.uniqueVisitors.toLocaleString(),icon:J,iconColor:"text-green-600",iconBgColor:"bg-green-100"}),e.jsx(w,{title:"Total Leads",value:t.totalLeads,icon:ye,iconColor:"text-purple-600",iconBgColor:"bg-purple-100"}),e.jsx(w,{title:"Conversion Rate",value:`${t.conversionRate}%`,icon:Q,iconColor:"text-orange-600",iconBgColor:"bg-orange-100"})]}),e.jsx(Ne,{stats:t,listingsCount:0,linksCount:0}),e.jsx(ve,{title:"Profile Views",description:"Views and unique visitors over time",data:d.length>0?d:[{name:"No data",views:0,visitors:0}],series:[{dataKey:"views",name:"Total Views",color:"#3B82F6"},{dataKey:"visitors",name:"Unique Visitors",color:"#10B981"}],type:"area",height:window.innerWidth<640?200:300}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs(j,{children:[e.jsxs(f,{className:"pb-3 sm:pb-4",children:[e.jsx(y,{className:"text-base sm:text-lg",children:"Leads by Type"}),e.jsx(N,{className:"text-xs sm:text-sm",children:"Distribution of lead inquiries"})]}),e.jsx(b,{children:a.length>0?e.jsx("div",{className:"space-y-2 sm:space-y-3",children:a.map(n=>e.jsxs("div",{className:"flex items-center justify-between py-2 min-h-[44px]",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-primary flex-shrink-0"}),e.jsx("span",{className:"text-xs sm:text-sm font-medium",children:n.name})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsxs("span",{className:"text-xs sm:text-sm text-muted-foreground whitespace-nowrap",children:[n.value," leads"]}),e.jsxs("span",{className:"text-xs sm:text-sm font-semibold min-w-[35px] text-right",children:[t.totalLeads>0?(n.value/t.totalLeads*100).toFixed(0):0,"%"]})]})]},n.name))}):e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:"No leads yet"})})]}),e.jsxs(j,{children:[e.jsxs(f,{className:"pb-3 sm:pb-4",children:[e.jsx(y,{className:"text-base sm:text-lg",children:"Recent Activity"}),e.jsx(N,{className:"text-xs sm:text-sm",children:"Latest profile interactions"})]}),e.jsx(b,{children:e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground text-center py-6 sm:py-8",children:t.totalViews>0?`${t.totalViews} profile views`:"No activity yet"})})]})]}),e.jsx(we,{leads:o,onLeadClick:n=>console.log("Lead clicked:",n)})]}),e.jsx(B,{value:"search",className:"space-y-4 sm:space-y-6",children:e.jsx(xe,{})})]})]})}export{Ie as default};
