{"version":3,"file":"UpgradeModal-CbLtxpd7.js","sources":["../../node_modules/lucide-react/dist/esm/icons/crown.js","../../src/hooks/useSubscriptionLimits.ts","../../src/components/UpgradeModal.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.354.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Crown = createLucideIcon(\"Crown\", [\n  [\"path\", { d: \"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14\", key: \"zkxr6b\" }]\n]);\n\nexport { Crown as default };\n//# sourceMappingURL=crown.js.map\n","import { useQuery } from \"@tanstack/react-query\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useAuthStore } from \"@/stores/useAuthStore\";\n\nexport interface SubscriptionLimits {\n  plan_name: string;\n  max_listings: number;\n  max_links: number;\n  max_testimonials: number;\n  analytics_history_days: number;\n  custom_domain_enabled: boolean;\n  remove_branding: boolean;\n  priority_support: boolean;\n}\n\nexport interface UsageCounts {\n  listings: number;\n  links: number;\n  testimonials: number;\n}\n\nexport function useSubscriptionLimits() {\n  const { user } = useAuthStore();\n\n  const { data: subscription, isLoading: subscriptionLoading } = useQuery({\n    queryKey: [\"subscription\", user?.id],\n    queryFn: async () => {\n      if (!user?.id) return null;\n\n      const { data, error } = await supabase\n        .from(\"subscriptions\")\n        .select(\"*\")\n        .eq(\"user_id\", user.id)\n        .single();\n\n      if (error) throw error;\n      return data as SubscriptionLimits;\n    },\n    enabled: !!user?.id,\n  });\n\n  const { data: usage, isLoading: usageLoading } = useQuery({\n    queryKey: [\"usage\", user?.id],\n    queryFn: async () => {\n      if (!user?.id) return { listings: 0, links: 0, testimonials: 0 };\n\n      const [listings, links, testimonials] = await Promise.all([\n        supabase.from(\"listings\").select(\"id\", { count: \"exact\" }).eq(\"user_id\", user.id),\n        supabase.from(\"links\").select(\"id\", { count: \"exact\" }).eq(\"user_id\", user.id),\n        supabase.from(\"testimonials\").select(\"id\", { count: \"exact\" }).eq(\"user_id\", user.id),\n      ]);\n\n      return {\n        listings: listings.count || 0,\n        links: links.count || 0,\n        testimonials: testimonials.count || 0,\n      };\n    },\n    enabled: !!user?.id,\n  });\n\n  const canAdd = (feature: keyof UsageCounts) => {\n    if (!subscription || !usage) return false;\n    \n    const limit = subscription[`max_${feature}` as keyof SubscriptionLimits] as number;\n    const current = usage[feature];\n    \n    // -1 means unlimited\n    if (limit === -1) return true;\n    \n    return current < limit;\n  };\n\n  const hasFeature = (feature: keyof Pick<SubscriptionLimits, 'custom_domain_enabled' | 'remove_branding' | 'priority_support'>) => {\n    return subscription?.[feature] || false;\n  };\n\n  const getLimit = (feature: keyof UsageCounts) => {\n    if (!subscription) return 0;\n    const limit = subscription[`max_${feature}` as keyof SubscriptionLimits] as number;\n    return limit === -1 ? Infinity : limit;\n  };\n\n  const getUsage = (feature: keyof UsageCounts) => {\n    return usage?.[feature] || 0;\n  };\n\n  const getRemainingCount = (feature: keyof UsageCounts) => {\n    const limit = getLimit(feature);\n    const current = getUsage(feature);\n    return limit === Infinity ? Infinity : Math.max(0, limit - current);\n  };\n\n  return {\n    subscription,\n    usage,\n    isLoading: subscriptionLoading || usageLoading,\n    canAdd,\n    hasFeature,\n    getLimit,\n    getUsage,\n    getRemainingCount,\n  };\n}","import { Link } from \"react-router-dom\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Zap, TrendingUp, Crown } from \"lucide-react\";\n\ninterface UpgradeModalProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  feature: string;\n  currentPlan?: string;\n  requiredPlan?: string;\n}\n\nconst featureRecommendations: Record<string, { plan: string; icon: typeof Zap }> = {\n  listings: { plan: \"Starter\", icon: TrendingUp },\n  testimonials: { plan: \"Starter\", icon: Crown },\n  links: { plan: \"Starter\", icon: TrendingUp },\n  custom_domain: { plan: \"Professional\", icon: Crown },\n  lead_export: { plan: \"Starter\", icon: TrendingUp },\n  analytics: { plan: \"Professional\", icon: TrendingUp },\n  premium_themes: { plan: \"Professional\", icon: Crown },\n};\n\nexport function UpgradeModal({\n  open,\n  onOpenChange,\n  feature,\n  currentPlan = \"Free\",\n  requiredPlan,\n}: UpgradeModalProps) {\n  const recommendation = featureRecommendations[feature] || { plan: \"Professional\", icon: Zap };\n  const Icon = recommendation.icon;\n  const suggestedPlan = requiredPlan || recommendation.plan;\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader>\n          <div className=\"flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 mx-auto mb-4\">\n            <Icon className=\"w-6 h-6 text-primary\" />\n          </div>\n          <DialogTitle className=\"text-center text-2xl\">\n            Upgrade to unlock {feature.replace(/_/g, \" \")}\n          </DialogTitle>\n          <DialogDescription className=\"text-center pt-2\">\n            You've reached the limit of your <Badge variant=\"secondary\">{currentPlan}</Badge> plan.\n            Upgrade to <Badge variant=\"default\">{suggestedPlan}</Badge> to unlock this feature.\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"bg-muted/50 rounded-lg p-4 my-4\">\n          <h4 className=\"font-semibold mb-2\">What you'll get:</h4>\n          <ul className=\"space-y-2 text-sm\">\n            {feature === \"listings\" && (\n              <>\n                <li className=\"flex items-center gap-2\">✓ Up to 20 active listings (Starter)</li>\n                <li className=\"flex items-center gap-2\">✓ Featured property showcase</li>\n                <li className=\"flex items-center gap-2\">✓ Sold properties tracking</li>\n              </>\n            )}\n            {feature === \"testimonials\" && (\n              <>\n                <li className=\"flex items-center gap-2\">✓ Up to 10 testimonials (Starter)</li>\n                <li className=\"flex items-center gap-2\">✓ Client reviews showcase</li>\n                <li className=\"flex items-center gap-2\">✓ Rating display</li>\n              </>\n            )}\n            {feature === \"links\" && (\n              <>\n                <li className=\"flex items-center gap-2\">✓ Up to 15 custom links (Starter)</li>\n                <li className=\"flex items-center gap-2\">✓ Link analytics</li>\n                <li className=\"flex items-center gap-2\">✓ Custom icons</li>\n              </>\n            )}\n            {feature === \"lead_export\" && (\n              <>\n                <li className=\"flex items-center gap-2\">✓ Export all leads to CSV</li>\n                <li className=\"flex items-center gap-2\">✓ CRM integration ready</li>\n                <li className=\"flex items-center gap-2\">✓ Lead management tools</li>\n              </>\n            )}\n            {feature === \"custom_domain\" && (\n              <>\n                <li className=\"flex items-center gap-2\">✓ Connect your own domain</li>\n                <li className=\"flex items-center gap-2\">✓ Professional branding</li>\n                <li className=\"flex items-center gap-2\">✓ SSL certificate included</li>\n              </>\n            )}\n            {feature === \"premium_themes\" && (\n              <>\n                <li className=\"flex items-center gap-2\">✓ 10+ premium themes</li>\n                <li className=\"flex items-center gap-2\">✓ 3D animated backgrounds</li>\n                <li className=\"flex items-center gap-2\">✓ Advanced customization</li>\n              </>\n            )}\n          </ul>\n        </div>\n\n        <DialogFooter className=\"gap-2 sm:gap-0\">\n          <Button variant=\"outline\" onClick={() => onOpenChange(false)}>\n            Maybe Later\n          </Button>\n          <Link to=\"/pricing\">\n            <Button className=\"w-full sm:w-auto\">\n              <Zap className=\"w-4 h-4 mr-2\" />\n              View Plans\n            </Button>\n          </Link>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}"],"names":["Crown","createLucideIcon","useSubscriptionLimits","user","useAuthStore","subscription","subscriptionLoading","useQuery","data","error","supabase","usage","usageLoading","listings","links","testimonials","canAdd","feature","limit","current","hasFeature","getLimit","getUsage","featureRecommendations","TrendingUp","UpgradeModal","open","onOpenChange","currentPlan","requiredPlan","recommendation","Zap","Icon","suggestedPlan","Dialog","jsxs","DialogContent","DialogHeader","jsx","DialogTitle","DialogDescription","Badge","Fragment","DialogFooter","Button","Link"],"mappings":"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","x_google_ignoreList":[0]}