import{g as W,r,j as e}from"./react-vendor-CotwlNTQ.js";import{u as $,a as R,c as J,g as V}from"./state-stores-BuSRU7CA.js";import{j as l,C as I,B as j,D as Q,l as X,m as Z,n as ee,G as se,I as te,J as ae,K as ie,M as L,N as q,L as le}from"./ui-components-XxFWEsul.js";import{u as o}from"./utils-BpArqNZu.js";import{s as re}from"./supabase-Ba7v9dZh.js";import{aw as N,G as H,n as A,ay as oe,E as D,h as ne,az as E,g as ce,a2 as de,aV as ue,aW as me,an as he,aH as pe,aI as xe,aE as ge,aJ as ye,ae as fe,a4 as be}from"./icons-CcUX9GkC.js";import{p as ve,g as je,B as Ne}from"./themeUtils-Cjs3lxGo.js";import"./charts-hR54p0E0.js";const we={id:"luxury-agent",name:"Luxury Agent",description:"Professional layout for luxury real estate specialists",category:"real-estate",blocks:[{type:"bio",visible:!0,config:{type:"bio",title:"Your Name",subtitle:"Luxury Real Estate Specialist",description:"Specializing in high-end properties and exclusive listings. Let me help you find your dream home in the most prestigious neighborhoods.",showSocialLinks:!0,showContactButton:!0}},{type:"listings",visible:!0,config:{type:"listings",title:"Featured Luxury Properties",layout:"grid",filter:"featured",maxItems:6,showPrices:!0,showStatus:!0}},{type:"social",visible:!0,config:{type:"social",title:"Connect With Me",links:[],layout:"horizontal",iconSize:"medium"}},{type:"contact",visible:!0,config:{type:"contact",title:"Schedule a Consultation",fields:[{id:"name",type:"text",label:"Name",placeholder:"Your name",required:!0},{id:"email",type:"email",label:"Email",placeholder:"your@email.com",required:!0},{id:"phone",type:"phone",label:"Phone",placeholder:"(555) 555-5555",required:!1},{id:"interest",type:"select",label:"I'm interested in",placeholder:"Select one",required:!0,options:["Buying","Selling","Both"]},{id:"message",type:"textarea",label:"Tell me about your goals",placeholder:"What can I help you with?",required:!0}],submitButtonText:"Request Consultation",successMessage:"Thank you! I'll be in touch within 24 hours."}}]},ke={id:"first-time-buyer",name:"First-Time Buyer Specialist",description:"Friendly layout for agents helping first-time buyers",category:"real-estate",blocks:[{type:"bio",visible:!0,config:{type:"bio",title:"Your Name",subtitle:"First-Time Homebuyer Specialist",description:"Making your first home purchase stress-free! I guide first-time buyers through every step of the process with patience and expertise.",showSocialLinks:!0,showContactButton:!0}},{type:"text",visible:!0,config:{type:"text",content:"ðŸ  New to homebuying? You're in the right place! I'll walk you through every step, from getting pre-approved to closing day.",align:"center",fontSize:"medium"}},{type:"listings",visible:!0,config:{type:"listings",title:"Starter Homes & Condos",layout:"grid",filter:"active",maxItems:6,showPrices:!0,showStatus:!0}},{type:"link",visible:!0,config:{type:"link",title:"ðŸ“š First-Time Buyer Guide (Free Download)",url:"#",style:"button",openInNewTab:!1}},{type:"contact",visible:!0,config:{type:"contact",title:"Let's Get Started!",fields:[{id:"name",type:"text",label:"Name",placeholder:"Your name",required:!0},{id:"email",type:"email",label:"Email",placeholder:"your@email.com",required:!0},{id:"phone",type:"phone",label:"Phone",placeholder:"(555) 555-5555",required:!1},{id:"timeline",type:"select",label:"When are you looking to buy?",placeholder:"Select timeframe",required:!0,options:["1-3 months","3-6 months","6-12 months","Just exploring"]}],submitButtonText:"Start My Journey",successMessage:"Exciting! I'll reach out soon to help you find your first home."}},{type:"social",visible:!0,config:{type:"social",title:"Follow for Home Buying Tips",links:[],layout:"horizontal",iconSize:"large"}}]},Se={id:"investor-focused",name:"Investment Property Specialist",description:"Perfect for agents working with real estate investors",category:"real-estate",blocks:[{type:"bio",visible:!0,config:{type:"bio",title:"Your Name",subtitle:"Investment Property Specialist",description:"Helping investors build wealth through strategic real estate acquisitions. Data-driven analysis and proven ROI.",showSocialLinks:!0,showContactButton:!0}},{type:"listings",visible:!0,config:{type:"listings",title:"Investment Opportunities",layout:"list",filter:"active",maxItems:8,showPrices:!0,showStatus:!0}},{type:"text",visible:!0,config:{type:"text",content:"ðŸ’° All properties analyzed for cap rate, cash-on-cash return, and appreciation potential.",align:"center",fontSize:"medium"}},{type:"link",visible:!0,config:{type:"link",title:"ðŸ“Š Market Analysis Report",url:"#",style:"button",openInNewTab:!1}},{type:"contact",visible:!0,config:{type:"contact",title:"Discuss Investment Strategy",fields:[{id:"name",type:"text",label:"Name",placeholder:"Your name",required:!0},{id:"email",type:"email",label:"Email",placeholder:"your@email.com",required:!0},{id:"investment_type",type:"select",label:"Investment Type",placeholder:"Select type",required:!0,options:["Single Family Rental","Multi-Family","Commercial","Fix & Flip","Mixed Use"]},{id:"budget",type:"select",label:"Investment Budget",placeholder:"Select range",required:!1,options:["Under $250K","$250K - $500K","$500K - $1M","Over $1M"]}],submitButtonText:"Get Investment Analysis",successMessage:"I'll prepare a custom market analysis for you."}},{type:"social",visible:!0,config:{type:"social",title:"Connect for Market Insights",links:[],layout:"horizontal",iconSize:"medium"}}]},Pe={id:"simple-clean",name:"Simple & Clean",description:"Minimalist layout that works for any real estate professional",category:"general",blocks:[{type:"bio",visible:!0,config:{type:"bio",title:"Your Name",subtitle:"Real Estate Professional",description:"Helping clients buy and sell properties with expertise and dedication.",showSocialLinks:!1,showContactButton:!0}},{type:"listings",visible:!0,config:{type:"listings",title:"Current Listings",layout:"grid",filter:"active",maxItems:6,showPrices:!0,showStatus:!1}},{type:"contact",visible:!0,config:{type:"contact",title:"Get in Touch",fields:[{id:"name",type:"text",label:"Name",placeholder:"Your name",required:!0},{id:"email",type:"email",label:"Email",placeholder:"your@email.com",required:!0},{id:"message",type:"textarea",label:"Message",placeholder:"How can I help?",required:!0}],submitButtonText:"Send Message",successMessage:"Thanks! I'll get back to you soon."}}]},Y=[we,ke,Se,Pe];function Ce(g,d,u){return g.blocks.map((h,p)=>({...h,id:`block_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,order:p}))}function Te(){const g=W(),{user:d,profile:u}=$(),{setPage:m,loadUserPages:h,setAsActivePage:p}=R(),[x,w]=r.useState([]),[t,k]=r.useState(!0),[c,n]=r.useState(null),[F,y]=r.useState(!1);r.useEffect(()=>{f()},[]);const f=async()=>{try{const s=await h();w(s)}catch(s){console.error("Failed to load pages:",s),o.error("Failed to load pages")}finally{k(!1)}},S=()=>{if(!d||!u){o.error("Please log in to create a page");return}y(!0)},P=s=>{if(!d||!u){o.error("Please log in to create a page");return}const i=J(d.id,u.username||"my-page");if(s){const b=Y.find(v=>v.id===s);b&&(i.blocks=Ce(b,d.id,i.slug),o.success(`Created page from "${b.name}" template!`))}m(i),y(!1),g("/dashboard/page-builder")},C=s=>{m(s),g("/dashboard/page-builder")},M=async s=>{n(s);try{await p(s),await f()}catch(i){console.error("Failed to set active page:",i)}finally{n(null)}},z=async s=>{if(confirm("Are you sure you want to delete this page?"))try{const{error:i}=await re.from("custom_pages").delete().eq("id",s);if(i)throw i;o.success("Page deleted successfully"),await f()}catch(i){console.error("Failed to delete page:",i),o.error("Failed to delete page")}};return t?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("p",{className:"text-muted-foreground",children:"Loading pages..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Your Pages"}),e.jsx("p",{className:"text-muted-foreground",children:"Create custom link-in-bio pages"})]}),e.jsxs(l,{onClick:S,className:"gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),"Create New Page"]})]}),x.length===0?e.jsx(I,{className:"p-12 text-center",children:e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx(H,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No pages yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Create your first custom page to get started"}),e.jsxs(l,{onClick:S,className:"gap-2",children:[e.jsx(N,{className:"h-4 w-4"}),"Create Your First Page"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(s=>{const i=s.is_active||!1;return e.jsxs(I,{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg truncate",children:s.title}),e.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["/",s.slug]})]}),i&&e.jsxs(j,{variant:"default",className:"gap-1",children:[e.jsx(A,{className:"h-3 w-3"}),"Active"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{variant:s.published?"default":"secondary",children:s.published?"Published":"Draft"}),e.jsxs(j,{variant:"outline",children:[s.blocks.length," blocks"]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>C(s),className:"gap-2 w-full",children:[e.jsx(oe,{className:"h-4 w-4"}),"Edit"]}),s.published&&e.jsxs(e.Fragment,{children:[e.jsx(l,{variant:"outline",size:"sm",asChild:!0,className:"gap-2 w-full",children:e.jsxs("a",{href:`/p/${s.slug}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(D,{className:"h-4 w-4"}),"Preview",e.jsx(ne,{className:"h-3 w-3 ml-auto"})]})}),!i&&e.jsxs(l,{variant:"default",size:"sm",onClick:()=>M(s.id),disabled:c===s.id,className:"gap-2 w-full",children:[e.jsx(A,{className:"h-4 w-4"}),c===s.id?"Setting...":"Set as Active"]})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>z(s.id),className:"gap-2 w-full text-destructive hover:text-destructive",children:[e.jsx(E,{className:"h-4 w-4"}),"Delete"]})]}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:s.description})]},s.id)})}),e.jsx(Q,{open:F,onOpenChange:y,children:e.jsxs(X,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(Z,{children:[e.jsx(ee,{children:"Choose a Template"}),e.jsx(se,{children:"Start with a pre-built template or create a blank page"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4",children:[e.jsx(I,{className:"p-6 cursor-pointer hover:border-primary transition-colors",onClick:()=>P(null),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded",children:e.jsx(N,{className:"h-6 w-6"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Blank Page"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Start from scratch"})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground flex-1",children:"Create a completely custom page by adding blocks one at a time."})]})}),Y.map(s=>e.jsx(I,{className:"p-6 cursor-pointer hover:border-primary transition-colors",onClick:()=>P(s.id),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded",children:e.jsx(ce,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.name}),e.jsxs(j,{variant:"outline",className:"mt-1",children:[s.blocks.length," blocks"]})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground flex-1",children:s.description})]})},s.id))]})]})})]})}function qe(){const{user:g,profile:d}=$(),[u,m]=r.useState(!0),[h,p]=r.useState(null),[x,w]=r.useState(!1),{page:t,selectedBlockId:k,isPreviewMode:c,isSaving:n,canUndo:F,canRedo:y,setPage:f,selectBlock:S,addBlockToPage:P,removeBlockFromPage:C,duplicatePageBlock:M,toggleBlockVisible:z,undo:s,redo:i,togglePreviewMode:b,savePage:v,publishPage:G,updatePageMeta:_}=R();r.useEffect(()=>{m(!t)},[t]),r.useEffect(()=>{t?.theme&&ve(t.theme)},[t?.theme]),r.useEffect(()=>{if(!t||n)return;const a=setTimeout(async()=>{try{await v();const B=new Date;p(B),console.log("Auto-saved at",B.toLocaleTimeString())}catch(B){console.error("Auto-save failed:",B),o.error("Auto-save failed - please save manually")}},3e3);return()=>clearTimeout(a)},[t,n,v]);const K=async()=>{try{await v(),p(new Date),o.success("Page saved successfully!")}catch{o.error("Failed to save page")}},O=async()=>{try{await G(),o.success("Page published successfully!")}catch{o.error("Failed to publish page")}},T=t?.blocks.find(a=>a.id===k),U=V();return u||!t?e.jsx("div",{className:"container mx-auto py-8",children:e.jsx(Te,{})}):e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[!c&&e.jsxs("div",{className:"w-64 bg-white border-r flex flex-col",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h2",{className:"font-semibold text-lg",children:"Add Blocks"})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:U.map(a=>e.jsx("button",{onClick:()=>P(a.type),className:"w-full p-3 text-left rounded-lg border hover:border-primary hover:bg-primary/5 transition-colors group",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-5 h-5 text-gray-400 group-hover:text-primary"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500",children:a.description})]})]})},a.type))})]}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>{f(null),m(!0)},children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),"Back to Pages"]}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-2"}),e.jsx(l,{variant:"outline",size:"sm",onClick:s,disabled:!F(),children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx(l,{variant:"outline",size:"sm",onClick:i,disabled:!y(),children:e.jsx(me,{className:"w-4 h-4"})}),e.jsx("div",{className:"w-px h-6 bg-gray-300 mx-2"}),e.jsx(te,{type:"text",value:t.title,onChange:a=>_({title:a.target.value}),className:"w-64",placeholder:"Page Title"}),e.jsx(j,{variant:t.published?"default":"secondary",children:t.published?"Published":"Draft"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{variant:"outline",size:"sm",onClick:b,children:c?e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 mr-2"}),"Edit"]}):e.jsxs(e.Fragment,{children:[e.jsx(D,{className:"w-4 h-4 mr-2"}),"Preview"]})}),e.jsxs("div",{className:"flex border rounded-md",children:[e.jsx(l,{variant:x?"ghost":"default",size:"sm",onClick:()=>w(!1),className:"rounded-r-none",title:"Desktop Preview",children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx(l,{variant:x?"default":"ghost",size:"sm",onClick:()=>w(!0),className:"rounded-l-none",title:"Mobile Preview",children:e.jsx(xe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(l,{variant:"outline",size:"sm",onClick:K,disabled:n,children:[e.jsx(ge,{className:"w-4 h-4 mr-2"}),n?"Saving...":"Save"]}),h&&!n&&e.jsxs("span",{className:"text-xs text-gray-500",children:["Saved ",h.toLocaleTimeString()]})]}),e.jsxs(l,{size:"sm",onClick:O,disabled:n,children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Publish"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsx("div",{className:"mx-auto rounded-lg shadow-lg min-h-full transition-all duration-300",style:{...je(t.theme),backgroundColor:t.theme.colors.background,color:t.theme.colors.text,fontFamily:`'${t.theme.fonts.body}', sans-serif`,maxWidth:x?"375px":"672px"},children:e.jsx("div",{className:"p-8",style:{display:"flex",flexDirection:"column",gap:t.theme.spacing==="compact"?"1rem":t.theme.spacing==="spacious"?"3rem":"2rem"},children:t.blocks.length===0?e.jsxs("div",{className:"text-center py-20 text-gray-500",children:[e.jsx(N,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"font-medium",children:"Your page is empty"}),e.jsx("p",{className:"text-sm mt-1",children:"Add blocks from the left sidebar to get started"})]}):t.blocks.map(a=>e.jsxs("div",{className:"relative group",children:[!c&&e.jsxs("div",{className:"absolute -left-12 top-0 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-1",children:[e.jsx("button",{className:"p-1 bg-white border rounded hover:bg-gray-50",title:"Drag to reorder",children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>M(a.id),className:"p-1 bg-white border rounded hover:bg-gray-50",title:"Duplicate",children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>z(a.id),className:"p-1 bg-white border rounded hover:bg-gray-50",title:a.visible?"Hide":"Show",children:a.visible?e.jsx(D,{className:"w-4 h-4"}):e.jsx(be,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>C(a.id),className:"p-1 bg-white border rounded hover:bg-red-50 text-red-600",title:"Delete",children:e.jsx(E,{className:"w-4 h-4"})})]}),e.jsx(Ne,{block:a,isEditing:!c,isSelected:k===a.id,onSelect:()=>S(a.id),userId:t.userId})]},a.id))})})})]}),!c&&T&&e.jsxs("div",{className:"w-80 bg-white border-l flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b",children:[e.jsx("h2",{className:"font-semibold text-lg",children:"Block Settings"}),e.jsx("p",{className:"text-sm text-gray-600",children:T.type})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs(ae,{defaultValue:"content",className:"w-full",children:[e.jsxs(ie,{className:"grid w-full grid-cols-2",children:[e.jsx(L,{value:"content",children:"Content"}),e.jsx(L,{value:"style",children:"Style"})]}),e.jsxs(q,{value:"content",className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{children:"Block Type"}),e.jsx("p",{className:"text-sm text-gray-600 capitalize",children:T.type})]}),e.jsx("div",{className:"p-4 bg-gray-50 rounded text-sm text-gray-600",children:"Block-specific settings will appear here"})]}),e.jsx(q,{value:"style",className:"space-y-4 mt-4",children:e.jsx("div",{className:"p-4 bg-gray-50 rounded text-sm text-gray-600",children:"Style settings coming soon"})})]})}),e.jsx("div",{className:"p-4 border-t",children:e.jsxs(l,{variant:"outline",className:"w-full",onClick:()=>C(T.id),children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Delete Block"]})})]})]})}export{qe as default};
