import{u as e}from"./data-BSV-JHVV.js";import{e as s,s as a,D as i,q as n,v as t,r,t as l,n as c,y as o,B as m}from"./index-D3fNu3MD.js";import{j as d}from"./ui-components-Exjq5lCY.js";import{L as x}from"./react-vendor-CmKLYqnR.js";import{aA as u,T as p,Z as g}from"./icons-C4ubqulC.js";function h(){const{user:i}=s(),{data:n,isLoading:t}=e({queryKey:["subscription",i?.id],queryFn:async()=>{if(!i?.id)return null;const{data:e,error:s}=await a.from("subscriptions").select("*").eq("user_id",i.id).single();if(s)throw s;return e},enabled:!!i?.id}),{data:r,isLoading:l}=e({queryKey:["usage",i?.id],queryFn:async()=>{if(!i?.id)return{listings:0,links:0,testimonials:0};const[e,s,n]=await Promise.all([a.from("listings").select("id",{count:"exact"}).eq("user_id",i.id),a.from("links").select("id",{count:"exact"}).eq("user_id",i.id),a.from("testimonials").select("id",{count:"exact"}).eq("user_id",i.id)]);return{listings:e.count||0,links:s.count||0,testimonials:n.count||0}},enabled:!!i?.id}),c=e=>{if(!n)return 0;const s=n[`max_${e}`];return-1===s?1/0:s},o=e=>r?.[e]||0;return{subscription:n,usage:r,isLoading:t||l,canAdd:e=>{if(!n||!r)return!1;const s=n[`max_${e}`],a=r[e];return-1===s||a<s},hasFeature:e=>n?.[e]||!1,getLimit:c,getUsage:o,getRemainingCount:e=>{const s=c(e),a=o(e);return s===1/0?1/0:Math.max(0,s-a)}}}const f={listings:{plan:"Starter",icon:p},testimonials:{plan:"Starter",icon:u},links:{plan:"Starter",icon:p},custom_domain:{plan:"Professional",icon:u},lead_export:{plan:"Starter",icon:p},analytics:{plan:"Professional",icon:p},premium_themes:{plan:"Professional",icon:u}};function j({open:e,onOpenChange:s,feature:a,currentPlan:u="Free",requiredPlan:p}){const h=f[a]||{plan:"Professional",icon:g},j=h.icon,N=p||h.plan;return d.jsx(i,{open:e,onOpenChange:s,children:d.jsxs(n,{className:"sm:max-w-md",children:[d.jsxs(t,{children:[d.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-primary/10 mx-auto mb-4",children:d.jsx(j,{className:"w-6 h-6 text-primary"})}),d.jsxs(r,{className:"text-center text-2xl",children:["Upgrade to unlock ",a.replace(/_/g," ")]}),d.jsxs(l,{className:"text-center pt-2",children:["You've reached the limit of your ",d.jsx(c,{variant:"secondary",children:u})," plan. Upgrade to ",d.jsx(c,{variant:"default",children:N})," to unlock this feature."]})]}),d.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 my-4",children:[d.jsx("h4",{className:"font-semibold mb-2",children:"What you'll get:"}),d.jsxs("ul",{className:"space-y-2 text-sm",children:["listings"===a&&d.jsxs(d.Fragment,{children:[d.jsx("li",{className:"flex items-center gap-2",children:"✓ Up to 20 active listings (Starter)"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Featured property showcase"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Sold properties tracking"})]}),"testimonials"===a&&d.jsxs(d.Fragment,{children:[d.jsx("li",{className:"flex items-center gap-2",children:"✓ Up to 10 testimonials (Starter)"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Client reviews showcase"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Rating display"})]}),"links"===a&&d.jsxs(d.Fragment,{children:[d.jsx("li",{className:"flex items-center gap-2",children:"✓ Up to 15 custom links (Starter)"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Link analytics"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Custom icons"})]}),"lead_export"===a&&d.jsxs(d.Fragment,{children:[d.jsx("li",{className:"flex items-center gap-2",children:"✓ Export all leads to CSV"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ CRM integration ready"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Lead management tools"})]}),"custom_domain"===a&&d.jsxs(d.Fragment,{children:[d.jsx("li",{className:"flex items-center gap-2",children:"✓ Connect your own domain"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Professional branding"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ SSL certificate included"})]}),"premium_themes"===a&&d.jsxs(d.Fragment,{children:[d.jsx("li",{className:"flex items-center gap-2",children:"✓ 10+ premium themes"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ 3D animated backgrounds"}),d.jsx("li",{className:"flex items-center gap-2",children:"✓ Advanced customization"})]})]})]}),d.jsxs(o,{className:"gap-2 sm:gap-0",children:[d.jsx(m,{variant:"outline",onClick:()=>s(!1),children:"Maybe Later"}),d.jsx(x,{to:"/pricing",children:d.jsxs(m,{className:"w-full sm:w-auto",children:[d.jsx(g,{className:"w-4 h-4 mr-2"}),"View Plans"]})})]})]})})}export{j as U,h as u};
