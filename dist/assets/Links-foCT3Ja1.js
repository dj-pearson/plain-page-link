import{j as e}from"./ui-components-BVcxtRPO.js";import{a as s}from"./react-vendor-C-nlL3mM.js";import{D as t,q as a,v as n,r as l,t as i,L as r,I as c,i as o,j as d,k as m,l as u,m as x,y as h,B as p,u as b}from"./index-DaY6aqCQ.js";import{I as g,F as j,f,r as v,Y as k,H as N,p as y,e as w,G as C,M as D,P as L,N as A,aj as S,a7 as F,X as M,aw as $,aJ as I,h as T,ay as P,az as z}from"./icons-DY7PeTgX.js";import{u as U}from"./useLinks-vgI-qXQj.js";import{u as E,U as Y}from"./UpgradeModal-CvSoQx50.js";import{L as _}from"./LimitBanner-h6qBV6aK.js";import"./three-addons-DnpzVjSZ.js";import"./three-BxgHQpUo.js";import"./charts-0kk6gfc_.js";import"./utils-BFXzl0jT.js";import"./data-Fj1_3-5A.js";import"./supabase-e0K7yNyG.js";import"./forms-fDlK0wSk.js";import"./alert-DgYo9KWT.js";import"./progress-C0qARqgu.js";const q=[{value:"instagram",label:"Instagram",icon:g},{value:"facebook",label:"Facebook",icon:j},{value:"linkedin",label:"LinkedIn",icon:f},{value:"tiktok",label:"TikTok",icon:v},{value:"youtube",label:"YouTube",icon:k},{value:"zillow",label:"Zillow",icon:N},{value:"realtor",label:"Realtor.com",icon:y},{value:"calendar",label:"Calendar",icon:w},{value:"website",label:"Website",icon:C},{value:"email",label:"Email",icon:D},{value:"phone",label:"Phone",icon:L},{value:"whatsapp",label:"WhatsApp",icon:A},{value:"document",label:"Document",icon:S},{value:"link",label:"Link",icon:F}];function O({open:b,onOpenChange:g,onSave:j}){const[f,v]=s.useState({title:"",url:"",icon:"link",active:!0}),k=e=>{const{name:s,value:t}=e.target;v(e=>({...e,[s]:t}))};return e.jsx(t,{open:b,onOpenChange:g,children:e.jsxs(a,{className:"max-w-md",children:[e.jsxs(n,{children:[e.jsx(l,{children:"Add Custom Link"}),e.jsx(i,{children:"Add a social media profile or custom link to your bio"})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),j?.(f),g(!1),v({title:"",url:"",icon:"link",active:!0})},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"title",children:"Link Title *"}),e.jsx(c,{id:"title",name:"title",value:f.title,onChange:k,placeholder:"Schedule a Consultation",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"url",children:"URL *"}),e.jsx(c,{id:"url",name:"url",type:"url",value:f.url,onChange:k,placeholder:"https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"icon",children:"Icon"}),e.jsxs(o,{value:f.icon,onValueChange:e=>v(s=>({...s,icon:e})),children:[e.jsx(d,{children:e.jsx(m,{children:(()=>{const s=q.find(e=>e.value===f.icon),t=s?.icon||F;return e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx("span",{children:s?.label||"Custom"})]})})()})}),e.jsx(u,{children:q.map(s=>{const t=s.icon;return e.jsx(x,{value:s.value,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx("span",{children:s.label})]})},s.value)})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"active",checked:f.active,onChange:e=>v(s=>({...s,active:e.target.checked})),className:"rounded border-border"}),e.jsx(r,{htmlFor:"active",className:"cursor-pointer",children:"Active (visible on profile)"})]}),e.jsxs(h,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>g(!1),children:"Cancel"}),e.jsx(p,{type:"submit",children:"Add Link"})]})]})]})})}function R({isOpen:t,onClose:a,onSubmit:n,initialData:l}){const[i,o]=s.useState(l);if(s.useEffect(()=>{o(l)},[l]),!t)return null;return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg w-full max-w-md",children:[e.jsxs("div",{className:"border-b border-border p-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Edit Link"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-accent rounded-lg transition-colors",children:e.jsx(M,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:e=>{e.preventDefault(),n(i)},className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(r,{htmlFor:"title",children:"Link Title *"}),e.jsx(c,{id:"title",value:i.title,onChange:e=>o({...i,title:e.target.value}),placeholder:"e.g., My Website",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"url",children:"URL *"}),e.jsx(c,{id:"url",type:"url",value:i.url,onChange:e=>o({...i,url:e.target.value}),placeholder:"https://example.com",required:!0})]}),e.jsxs("div",{children:[e.jsx(r,{htmlFor:"icon",children:"Icon (optional)"}),e.jsx(c,{id:"icon",value:i.icon||"",onChange:e=>o({...i,icon:e.target.value}),placeholder:"e.g., link, globe, home"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Icon name from Lucide icons"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:a,className:"flex-1",children:"Cancel"}),e.jsx(p,{type:"submit",className:"flex-1",children:"Save Changes"})]})]})]})})}function W(){const[t,a]=s.useState(!1),[n,l]=s.useState(!1),[i,r]=s.useState(null),[c,o]=s.useState(!1),{toast:d}=b(),{links:m,isLoading:u,addLink:x,updateLink:h,deleteLink:p}=U(),{subscription:M,canAdd:q,getLimit:W,getUsage:B}=E(),{softDelete:G,isPendingDeletion:H}=function(e){const{onDelete:t,deleteDelay:a=1e4,undoMessage:n,resourceName:l}=e,{toast:i}=b(),[r,c]=s.useState(new Map),o=s.useRef(r);o.current=r;const d=s.useCallback(async e=>{if(o.current.has(e.id))return;const s=setTimeout(async()=>{try{await t(e.id),c(s=>{const t=new Map(s);return t.delete(e.id),t}),i({title:`${l} deleted`,description:`Your ${l} has been permanently removed.`})}catch(s){i({title:"Deletion failed",description:`Failed to delete ${l}. Please try again.`,variant:"destructive"}),c(s=>{const t=new Map(s);return t.delete(e.id),t})}},a),r={id:e.id,data:e,timeoutId:s,timestamp:Date.now()};c(s=>{const t=new Map(s);return t.set(e.id,r),t});const{dismiss:d}=i({title:`${l} deleted`,description:n?.(e)||`Deleting ${l} in ${a/1e3} seconds...`,action:{label:"Undo",onClick:()=>{m(e.id),d()}},duration:a})},[t,a,n,l,i]),m=s.useCallback(e=>{const s=o.current.get(e);s&&(clearTimeout(s.timeoutId),c(s=>{const t=new Map(s);return t.delete(e),t}),i({title:"Deletion cancelled",description:`Your ${l} has been restored.`}))},[l,i]),u=s.useCallback(e=>o.current.has(e),[]),x=s.useCallback(()=>Array.from(o.current.values()).map(e=>e.data),[]),h=s.useCallback(()=>{o.current.forEach(e=>{clearTimeout(e.timeoutId)}),c(new Map),o.current.size>0&&i({title:"All deletions cancelled",description:`${o.current.size} ${l}${o.current.size>1?"s":""} restored.`})},[l,i]),p=s.useCallback(async e=>{const s=o.current.get(e);if(s){clearTimeout(s.timeoutId),c(s=>{const t=new Map(s);return t.delete(e),t});try{await t(e),i({title:`${l} deleted`,description:`Your ${l} has been permanently removed.`})}catch(a){i({title:"Deletion failed",description:`Failed to delete ${l}. Please try again.`,variant:"destructive"})}}},[t,l,i]);return{softDelete:d,undoDelete:m,isPendingDeletion:u,getPendingDeletions:x,cancelAllDeletions:h,forceDelete:p,pendingCount:r.size}}({onDelete:async e=>{await p.mutateAsync(e)},deleteDelay:1e4,resourceName:"link",undoMessage:e=>`"${e.title}" will be deleted in 10 seconds. Click Undo to cancel.`}),J=s.useMemo(()=>m.filter(e=>!H(e.id)),[m,H]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Custom Links"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Manage your social and custom links"})]}),e.jsxs("button",{onClick:()=>{q("links")?a(!0):o(!0)},className:"inline-flex items-center gap-2 px-4 py-2.5 sm:py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 active:scale-95 transition-all font-medium min-h-[44px] w-full sm:w-auto justify-center shadow-sm",children:[e.jsx($,{className:"h-4 w-4 sm:h-5 sm:w-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Add Link"})]})]}),M&&W("links")!==1/0&&e.jsx(_,{feature:"links",current:B("links"),limit:W("links")}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-foreground",children:J.length}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Total"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:J.filter(e=>e.is_active).length}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Active"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-3 sm:p-4 hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary",children:J.reduce((e,s)=>e+s.click_count,0)}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Clicks"})]})]}),e.jsx("div",{className:"bg-card border border-border rounded-lg divide-y divide-border",children:u?e.jsx("div",{className:"p-6 sm:p-8 text-center text-muted-foreground text-sm sm:text-base",children:"Loading links..."}):0===J.length?e.jsx("div",{className:"p-6 sm:p-8 text-center text-muted-foreground text-sm sm:text-base",children:'No links yet. Click "Add Link" to create your first link.'}):J.map(s=>e.jsxs("div",{className:"p-3 sm:p-4 flex items-center gap-2 sm:gap-4 hover:bg-accent/50 active:bg-accent/70 transition-colors",children:[e.jsx("button",{className:"cursor-grab active:cursor-grabbing p-1.5 hover:bg-accent rounded hidden sm:block min-h-[44px]","aria-label":"Drag to reorder",children:e.jsx(I,{className:"h-5 w-5 text-muted-foreground"})}),e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center bg-accent rounded-lg flex-shrink-0",children:(()=>{const t=(a=s.icon,{calendar:w,instagram:g,facebook:j,zillow:N,link:F,linkedin:f,tiktok:v,youtube:k,realtor:y,website:C,email:D,phone:L,whatsapp:A,document:S}[a]||F);var a;return e.jsx(t,{className:"h-5 w-5 sm:h-6 sm:w-6 text-foreground"})})()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 mb-0.5 sm:mb-1 flex-wrap",children:[e.jsx("h3",{className:"font-medium text-sm sm:text-base text-foreground truncate",children:s.title}),s.is_active?e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full font-medium flex-shrink-0",children:"Active"}):e.jsx("span",{className:"px-1.5 sm:px-2 py-0.5 bg-gray-100 text-gray-700 text-xs rounded-full font-medium flex-shrink-0",children:"Inactive"})]}),e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs sm:text-sm text-muted-foreground hover:text-primary active:text-primary flex items-center gap-1 truncate",children:[e.jsx("span",{className:"truncate",children:s.url}),e.jsx(T,{className:"h-3 w-3 flex-shrink-0"})]}),e.jsxs("div",{className:"sm:hidden mt-1.5 text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-semibold text-foreground",children:s.click_count})," clicks"]})]}),e.jsxs("div",{className:"text-right hidden sm:block flex-shrink-0",children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:s.click_count}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"clicks"})]}),e.jsxs("div",{className:"flex items-center gap-0.5 sm:gap-1 flex-shrink-0",children:[e.jsx("button",{onClick:()=>(e=>{r(e),l(!0)})(s),className:"p-2 sm:p-2.5 hover:bg-accent active:bg-accent/80 rounded-lg transition-all min-w-[44px] min-h-[44px] flex items-center justify-center","aria-label":"Edit link",children:e.jsx(P,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("button",{onClick:()=>(e=>{G(e)})(s),className:"p-2 sm:p-2.5 hover:bg-red-50 active:bg-red-100 rounded-lg transition-all min-w-[44px] min-h-[44px] flex items-center justify-center","aria-label":"Delete link",children:e.jsx(z,{className:"h-4 w-4 text-red-500"})})]})]},s.id))}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg p-3 sm:p-4",children:e.jsxs("p",{className:"text-xs sm:text-sm text-blue-800 dark:text-blue-200 leading-relaxed",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," ",e.jsx("span",{className:"hidden sm:inline",children:"Drag and drop links to reorder them."}),e.jsx("span",{className:"sm:hidden",children:"Use the edit option to change link details."})," The order here will reflect on your public profile page."]})}),e.jsx(O,{open:t,onOpenChange:a,onSave:async e=>{try{await x.mutateAsync(e),d({title:"Link added!",description:"Your custom link has been created successfully."})}catch(s){d({title:"Error",description:"Failed to add link. Please try again.",variant:"destructive"})}}}),e.jsx(R,{open:n,onOpenChange:l,link:i,onSave:async(e,s)=>{try{await h.mutateAsync({id:e,...s}),d({title:"Link updated!",description:"Your link has been updated successfully."})}catch(t){d({title:"Error",description:"Failed to update link. Please try again.",variant:"destructive"})}}}),e.jsx(Y,{open:c,onOpenChange:o,feature:"links",currentPlan:M?.plan_name||"Free",requiredPlan:"Starter"})]})}export{W as default};
