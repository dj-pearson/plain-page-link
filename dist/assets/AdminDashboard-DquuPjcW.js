import{F as B,a8 as ie,u as D,a$ as o,s as h,r as _,j as e,Q as $,b5 as X,B as f,R as Z,T as J,V as Y,a3 as ee,a4 as k,I as q,i as V,k as U,l as R,m as z,n as b,a7 as ue,D as P,C as L,b as W,c as G,d as O,e as Q,o as I,a5 as oe,bi as be,b6 as te,p as Me,E as he,a9 as Ae,Z as Ne,a1 as ke,a2 as de,X as qe,K as Te,bj as Pe,L as Ie,A as Ke,bk as Ee,h as De,M as Le}from"./index-CH8a_jH7.js";import{T as le,a as ce,b as K,c as E}from"./tabs-41VQSFaO.js";import{S as re}from"./switch-BZnz4g4b.js";import{u as S}from"./useMutation-DQof0gk2.js";import{P as se}from"./plus-mX94DPLf.js";import{S as _e}from"./square-pen-WI1F4rAb.js";import{U as ge}from"./upload-BKMneLgQ.js";import{L as je}from"./lightbulb-BHjns8XL.js";import{C as We}from"./clock-BK33_tLh.js";import{C as Ge}from"./circle-x-CvQby9dB.js";import{D as Oe,S as Qe}from"./SEOManager-DElE72V3.js";import{S as ye}from"./settings-CUQ_j_F4.js";import{F as Ve}from"./file-text-Dh5rzuof.js";import"./use-toast-DTZfmZso.js";import"./bell-Dj91HGWQ.js";import"./link-VZwDK9yb.js";import"./image-CiB_cqit.js";import"./copy-BUA-1-5Z.js";import"./shield-B37rwZVo.js";/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=B("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=B("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=B("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=B("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=B("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=B("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=B("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=B("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.354.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=B("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]);function Xe(){const c=ie(),j=D({queryKey:["ai-models"],queryFn:async()=>{const{data:a,error:t}=await h.from("ai_models").select("*").order("provider",{ascending:!0});if(t)throw t;return a}}),d=D({queryKey:["ai-configuration"],queryFn:async()=>{const{data:a,error:t}=await h.from("ai_configuration").select("*");if(t)throw t;return a}}),y=S({mutationFn:async({key:a,value:t})=>{var w;const{error:x}=await h.from("ai_configuration").update({setting_value:t,updated_at:new Date().toISOString(),updated_by:(w=(await h.auth.getUser()).data.user)==null?void 0:w.id}).eq("setting_key",a);if(x)throw x},onSuccess:()=>{c.invalidateQueries({queryKey:["ai-configuration"]}),o.success("Configuration updated")},onError:a=>{o.error("Failed to update: "+a.message)}}),n=S({mutationFn:async({id:a,isActive:t})=>{const{error:x}=await h.from("ai_models").update({is_active:t}).eq("id",a);if(x)throw x},onSuccess:()=>{c.invalidateQueries({queryKey:["ai-models"]}),o.success("Model status updated")},onError:a=>{o.error("Failed to update model: "+a.message)}}),p=S({mutationFn:async a=>{const{error:t}=await h.from("ai_models").insert([a]);if(t)throw t},onSuccess:()=>{c.invalidateQueries({queryKey:["ai-models"]}),o.success("Model added successfully")},onError:a=>{o.error("Failed to add model: "+a.message)}}),l=S({mutationFn:async a=>{const{data:t,error:x}=await h.functions.invoke("test-ai-model",{body:{model:a}});if(x)throw x;return t},onSuccess:a=>{a.success?o.success(a.message):o.error(a.error)},onError:a=>{o.error("Model test failed: "+a.message)}}),i=a=>{var x;const t=(x=d.data)==null?void 0:x.find(w=>w.setting_key===a);if(!t)return"";try{return JSON.parse(t.setting_value)}catch{return t.setting_value}},s=(a,t)=>{y.mutate({key:a,value:JSON.stringify(t)})};return{models:j.data,config:d.data,isLoading:j.isLoading||d.isLoading,getConfigValue:i,handleUpdateConfig:s,toggleModel:n.mutate,addModel:p.mutate,testModel:l.mutate,isTestingModel:l.isPending,isAddingModel:p.isPending}}function Ze({onAdd:c,isAdding:j}){const[d,y]=_.useState(!1),[n,p]=_.useState({provider:"",model_name:"",model_id:"",description:"",context_window:2e5,max_output_tokens:8192,supports_vision:!0,is_active:!0,auth_type:"bearer",secret_name:"",api_endpoint:""}),l=i=>{i.preventDefault(),c(n),y(!1),p({provider:"",model_name:"",model_id:"",description:"",context_window:2e5,max_output_tokens:8192,supports_vision:!0,is_active:!0,auth_type:"bearer",secret_name:"",api_endpoint:""})};return e.jsxs($,{open:d,onOpenChange:y,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Add New Model"]})}),e.jsx(Z,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:l,children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Add New AI Model"}),e.jsx(ee,{children:"Configure a new AI model with authentication and endpoint details"})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"provider",children:"Provider Name *"}),e.jsx(q,{id:"provider",placeholder:"e.g., Anthropic",value:n.provider,onChange:i=>p({...n,provider:i.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"model_name",children:"Display Name *"}),e.jsx(q,{id:"model_name",placeholder:"e.g., Claude Sonnet 4.5",value:n.model_name,onChange:i=>p({...n,model_name:i.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"model_id",children:"Model ID *"}),e.jsx(q,{id:"model_id",placeholder:"e.g., claude-sonnet-4-5-20250929",value:n.model_id,onChange:i=>p({...n,model_id:i.target.value}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"The exact model identifier for API calls"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"description",children:"Description"}),e.jsx(q,{id:"description",placeholder:"Brief description of model capabilities",value:n.description,onChange:i=>p({...n,description:i.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"auth_type",children:"Authentication Type *"}),e.jsxs(V,{value:n.auth_type,onValueChange:i=>p({...n,auth_type:i}),children:[e.jsx(U,{id:"auth_type",children:e.jsx(R,{})}),e.jsxs(z,{children:[e.jsx(b,{value:"bearer",children:"Bearer Token"}),e.jsx(b,{value:"x-api-key",children:"X-API-Key Header"})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"How the API key is sent (Bearer for most, X-API-Key for Anthropic)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"secret_name",children:"Supabase Secret Name *"}),e.jsx(q,{id:"secret_name",placeholder:"e.g., CLAUDE_API_KEY",value:n.secret_name,onChange:i=>p({...n,secret_name:i.target.value}),required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Name of the secret stored in Supabase (must be added to Supabase secrets)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"api_endpoint",children:"API Endpoint *"}),e.jsx(q,{id:"api_endpoint",placeholder:"e.g., https://api.anthropic.com/v1/messages",value:n.api_endpoint,onChange:i=>p({...n,api_endpoint:i.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"context_window",children:"Context Window"}),e.jsx(q,{id:"context_window",type:"number",value:n.context_window,onChange:i=>p({...n,context_window:parseInt(i.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"max_output_tokens",children:"Max Output Tokens"}),e.jsx(q,{id:"max_output_tokens",type:"number",value:n.max_output_tokens,onChange:i=>p({...n,max_output_tokens:parseInt(i.target.value)})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"supports_vision",children:"Supports Vision"}),e.jsx(re,{id:"supports_vision",checked:n.supports_vision,onCheckedChange:i=>p({...n,supports_vision:i})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"is_active",children:"Active"}),e.jsx(re,{id:"is_active",checked:n.is_active,onCheckedChange:i=>p({...n,is_active:i})})]})]}),e.jsxs(ue,{children:[e.jsx(f,{type:"button",variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsxs(f,{type:"submit",disabled:j,children:[j&&e.jsx(P,{className:"mr-2 h-4 w-4 animate-spin"}),"Add Model"]})]})]})})]})}function Je(){const{models:c,isLoading:j,getConfigValue:d,handleUpdateConfig:y,toggleModel:n,addModel:p,testModel:l,isTestingModel:i,isAddingModel:s}=Xe();if(j)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"})});const a=d("default_model");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsxs(W,{children:[e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-5 w-5"}),"AI Model Configuration"]}),e.jsx(O,{children:"Configure AI models and settings for content generation"})]}),e.jsxs(Q,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"default-model",children:"Default AI Model"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(V,{value:a,onValueChange:t=>y("default_model",t),children:[e.jsx(U,{id:"default-model",children:e.jsx(R,{placeholder:"Select a model"})}),e.jsx(z,{children:c==null?void 0:c.map(t=>e.jsxs(b,{value:t.model_id,children:[t.model_name," (",t.provider,")"]},t.id))})]}),e.jsx(f,{variant:"outline",size:"icon",onClick:()=>l(a),disabled:i,title:"Test AI Model",children:i?e.jsx(P,{className:"h-4 w-4 animate-spin"}):e.jsx(Be,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"temp-precise",children:"Precise Temperature"}),e.jsx(q,{id:"temp-precise",type:"number",step:"0.1",min:"0",max:"1",value:d("temperature_precise"),onChange:t=>y("temperature_precise",parseFloat(t.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For data extraction and precise tasks"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"temp-creative",children:"Creative Temperature"}),e.jsx(q,{id:"temp-creative",type:"number",step:"0.1",min:"0",max:"1",value:d("temperature_creative"),onChange:t=>y("temperature_creative",parseFloat(t.target.value))}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"For content generation and creative tasks"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"tokens-standard",children:"Standard Max Tokens"}),e.jsx(q,{id:"tokens-standard",type:"number",step:"100",value:d("max_tokens_standard"),onChange:t=>y("max_tokens_standard",parseInt(t.target.value))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"tokens-large",children:"Large Content Max Tokens"}),e.jsx(q,{id:"tokens-large",type:"number",step:"100",value:d("max_tokens_large"),onChange:t=>y("max_tokens_large",parseInt(t.target.value))})]})]})]})]}),e.jsxs(L,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Available AI Models"}),e.jsx(O,{children:"Manage which models are available for selection"})]}),e.jsx(Ze,{onAdd:p,isAdding:s})]})}),e.jsx(Q,{children:e.jsx("div",{className:"space-y-4",children:c==null?void 0:c.map(t=>e.jsxs("div",{className:"flex items-start justify-between p-4 border rounded-lg gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:t.model_name}),e.jsx(I,{variant:"outline",className:"text-xs",children:t.provider})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Context: ",t.context_window.toLocaleString()," tokens"]}),e.jsxs("span",{children:["Max Output: ",t.max_output_tokens.toLocaleString()," tokens"]}),t.supports_vision&&e.jsx("span",{children:"âœ“ Vision"})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-2 text-xs",children:[e.jsx(I,{variant:"secondary",children:t.auth_type==="bearer"?"Bearer Token":"X-API-Key"}),e.jsxs(I,{variant:"secondary",children:["Secret: ",t.secret_name]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2 font-mono truncate",children:t.api_endpoint})]}),e.jsx(re,{checked:t.is_active,onCheckedChange:x=>n({id:t.id,isActive:x})})]},t.id))})})]})]})}function xe(){const c=ie(),j=D({queryKey:["social-media-posts"],queryFn:async()=>{const{data:r,error:g}=await h.from("social_media_posts").select("*").order("created_at",{ascending:!1});if(g)throw g;return r}}),d=D({queryKey:["marketing-posts"],queryFn:async()=>{const{data:r,error:g}=await h.from("social_media_posts").select("*").eq("content_type","marketing").order("created_at",{ascending:!1});if(g)throw g;return r}}),y=D({queryKey:["social-media-webhooks"],queryFn:async()=>{const{data:r,error:g}=await h.from("social_media_webhooks").select("*").order("name",{ascending:!0});if(g)throw g;return r}}),n=S({mutationFn:async r=>{const{data:g,error:N}=await h.functions.invoke("generate-social-post",{body:r});if(N)throw N;return g},onSuccess:r=>{r.success?o.success("Content generated successfully!"):o.error(r.error||"Generation failed")},onError:r=>{o.error("Failed to generate content: "+r.message)}}),p=S({mutationFn:async r=>{var m;const{data:g}=await h.auth.getUser(),{data:N,error:M}=await h.from("social_media_posts").insert({...r,created_by:(m=g.user)==null?void 0:m.id}).select().single();if(M)throw M;return N},onSuccess:()=>{c.invalidateQueries({queryKey:["social-media-posts"]}),o.success("Post created successfully")},onError:r=>{o.error("Failed to create post: "+r.message)}}),l=S({mutationFn:async({id:r,updates:g})=>{const{error:N}=await h.from("social_media_posts").update(g).eq("id",r);if(N)throw N},onSuccess:()=>{c.invalidateQueries({queryKey:["social-media-posts"]}),o.success("Post updated successfully")},onError:r=>{o.error("Failed to update post: "+r.message)}}),i=S({mutationFn:async r=>{const{error:g}=await h.from("social_media_posts").delete().eq("id",r);if(g)throw g},onSuccess:()=>{c.invalidateQueries({queryKey:["social-media-posts"]}),o.success("Post deleted successfully")},onError:r=>{o.error("Failed to delete post: "+r.message)}}),s=S({mutationFn:async r=>{const{data:g,error:N}=await h.from("social_media_webhooks").insert(r).select().single();if(N)throw N;return g},onSuccess:()=>{c.invalidateQueries({queryKey:["social-media-webhooks"]}),o.success("Webhook created successfully")},onError:r=>{o.error("Failed to create webhook: "+r.message)}}),a=S({mutationFn:async({id:r,updates:g})=>{const{error:N}=await h.from("social_media_webhooks").update(g).eq("id",r);if(N)throw N},onSuccess:()=>{c.invalidateQueries({queryKey:["social-media-webhooks"]}),o.success("Webhook updated successfully")},onError:r=>{o.error("Failed to update webhook: "+r.message)}}),t=S({mutationFn:async r=>{const{error:g}=await h.from("social_media_webhooks").delete().eq("id",r);if(g)throw g},onSuccess:()=>{c.invalidateQueries({queryKey:["social-media-webhooks"]}),o.success("Webhook deleted successfully")},onError:r=>{o.error("Failed to delete webhook: "+r.message)}}),x=S({mutationFn:async r=>{const{data:g,error:N}=await h.functions.invoke("test-social-webhook",{body:{webhookId:r}});if(N)throw N;return g},onSuccess:r=>{r.success?o.success("Test webhook sent successfully!"):o.error("Test webhook failed: "+(r.error||"Unknown error"))},onError:r=>{o.error("Failed to test webhook: "+r.message)}}),w=S({mutationFn:async r=>{const{data:g,error:N}=await h.functions.invoke("generate-marketing-post",{body:{webhookUrl:r}});if(N)throw N;return g},onSuccess:r=>{c.invalidateQueries({queryKey:["marketing-posts"]}),r.success?o.success(r.message):o.error(r.error||"Failed to generate post")},onError:r=>{o.error("Failed to generate post: "+r.message)}}),A=S({mutationFn:async({postId:r,webhookUrl:g})=>{const{data:N}=await h.from("social_media_posts").select("post_content").eq("id",r).single();if(!N)throw new Error("Post not found");if(!(await fetch(g,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(N.post_content)})).ok)throw new Error("Webhook delivery failed");return await h.from("social_media_posts").update({status:"posted",posted_at:new Date().toISOString(),webhook_urls:[g]}).eq("id",r),{success:!0}},onSuccess:()=>{c.invalidateQueries({queryKey:["marketing-posts"]}),o.success("Post resent successfully")},onError:r=>{console.error("Failed to retry post:",r),o.error("Failed to resend post")}});return{posts:j.data,marketingPosts:d.data,webhooks:y.data,isLoading:j.isLoading||y.isLoading||d.isLoading,generatePost:n.mutate,isGenerating:n.isPending,generatedContent:n.data,createPost:p.mutate,updatePost:l.mutate,deletePost:i.mutate,createWebhook:s.mutate,updateWebhook:a.mutate,deleteWebhook:t.mutate,testWebhook:x.mutate,isTestingWebhook:x.isPending,generateMarketingPost:w.mutate,isGeneratingMarketingPost:w.isPending,marketingPostData:w.data,retryMarketingPost:A.mutate,isRetryingPost:A.isPending}}function fe(){const[c,j]=_.useState(!1),[d,y]=_.useState("property_highlight"),[n,p]=_.useState("listing_of_the_day"),[l,i]=_.useState("combined"),[s,a]=_.useState(""),[t,x]=_.useState(""),[w,A]=_.useState(""),[r,g]=_.useState(null),{generatePost:N,isGenerating:M,createPost:m}=xe(),{data:u}=D({queryKey:["listings-for-social"],queryFn:async()=>{const{data:F,error:C}=await h.from("listings").select("id, address, price, status").eq("status","active").order("created_at",{ascending:!1}).limit(20);if(C)throw C;return F}}),T=()=>{N({contentType:d,subjectType:n,platformType:l,listingId:s||void 0,customPrompt:t||void 0},{onSuccess:F=>{F.success&&g(F.content)}})},v=()=>{r&&m({content_type:d,subject_type:n,platform_type:l,post_content:r,post_title:w||`${d} - ${new Date().toLocaleDateString()}`,listing_id:s||null,status:"draft",ai_prompt_used:t||void 0},{onSuccess:()=>{j(!1),g(null),A(""),x("")}})};return e.jsxs($,{open:c,onOpenChange:j,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"Create Post"]})}),e.jsxs(Z,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Create Social Media Post"}),e.jsx(ee,{children:"Generate AI-powered social media content for your real estate business"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"content-type",children:"Content Type"}),e.jsxs(V,{value:d,onValueChange:y,children:[e.jsx(U,{id:"content-type",children:e.jsx(R,{})}),e.jsxs(z,{children:[e.jsx(b,{value:"property_highlight",children:"Property Highlight"}),e.jsx(b,{value:"market_update",children:"Market Update"}),e.jsx(b,{value:"agent_tip",children:"Agent Tip"}),e.jsx(b,{value:"community_spotlight",children:"Community Spotlight"}),e.jsx(b,{value:"success_story",children:"Success Story"}),e.jsx(b,{value:"general",children:"General"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"subject-type",children:"Subject Type"}),e.jsxs(V,{value:n,onValueChange:p,children:[e.jsx(U,{id:"subject-type",children:e.jsx(R,{})}),e.jsxs(z,{children:[e.jsx(b,{value:"listing_of_the_day",children:"Listing of the Day"}),e.jsx(b,{value:"market_analysis",children:"Market Analysis"}),e.jsx(b,{value:"buyer_seller_tip",children:"Buyer/Seller Tip"}),e.jsx(b,{value:"neighborhood_feature",children:"Neighborhood Feature"}),e.jsx(b,{value:"testimonial_highlight",children:"Testimonial Highlight"}),e.jsx(b,{value:"special_announcement",children:"Special Announcement"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"platform-type",children:"Platform"}),e.jsxs(V,{value:l,onValueChange:i,children:[e.jsx(U,{id:"platform-type",children:e.jsx(R,{})}),e.jsxs(z,{children:[e.jsx(b,{value:"combined",children:"All Platforms"}),e.jsx(b,{value:"twitter_threads",children:"Twitter/X Threads"}),e.jsx(b,{value:"facebook_linkedin",children:"Facebook/LinkedIn"}),e.jsx(b,{value:"instagram",children:"Instagram"})]})]})]}),d==="property_highlight"&&u&&u.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"listing",children:"Select Property (Optional)"}),e.jsxs(V,{value:s,onValueChange:a,children:[e.jsx(U,{id:"listing",children:e.jsx(R,{placeholder:"Choose a listing..."})}),e.jsx(z,{children:u.map(F=>e.jsxs(b,{value:F.id,children:[F.address," - ",F.price]},F.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"custom-prompt",children:"Custom Instructions (Optional)"}),e.jsx(oe,{id:"custom-prompt",placeholder:"Add any specific instructions for the AI...",value:t,onChange:F=>x(F.target.value),rows:3})]}),e.jsx(f,{onClick:T,disabled:M,className:"w-full gap-2",children:M?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4"}),"Generate with AI"]})}),r&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"post-title",children:"Post Title"}),e.jsx(q,{id:"post-title",placeholder:"Enter a title for this post...",value:w,onChange:F=>A(F.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Generated Content"}),e.jsx("div",{className:"p-4 bg-background border rounded-lg whitespace-pre-wrap text-sm",children:r[l]||r.raw})]}),e.jsx(f,{onClick:v,className:"w-full",children:"Save as Draft"})]})]})]})]})}function Ye(){const[c,j]=_.useState(!1),[d,y]=_.useState(""),[n,p]=_.useState(""),[l,i]=_.useState(""),[s,a]=_.useState(!0),{createWebhook:t}=xe(),x=w=>{if(w.preventDefault(),!d.trim()){o.error("Please enter a webhook name");return}if(!n){o.error("Please select a platform");return}if(!l.trim()){o.error("Please enter a webhook URL");return}t({name:d,platform:n,webhook_url:l,is_active:s,headers:{}}),y(""),p(""),i(""),a(!0),j(!1)};return e.jsxs($,{open:c,onOpenChange:j,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{variant:"outline",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Webhook"]})}),e.jsxs(Z,{children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Add Social Media Webhook"}),e.jsx(ee,{children:"Configure a webhook to automatically distribute posts to your platforms"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"name",children:"Webhook Name"}),e.jsx(q,{id:"name",placeholder:"My Make.com Workflow",value:d,onChange:w=>y(w.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"platform",children:"Platform *"}),e.jsxs(V,{value:n,onValueChange:p,children:[e.jsx(U,{id:"platform",children:e.jsx(R,{placeholder:"Select platform"})}),e.jsxs(z,{children:[e.jsx(b,{value:"make",children:"Make.com"}),e.jsx(b,{value:"zapier",children:"Zapier"}),e.jsx(b,{value:"n8n",children:"n8n"}),e.jsx(b,{value:"custom",children:"Custom"}),e.jsx(b,{value:"facebook",children:"Facebook"}),e.jsx(b,{value:"instagram",children:"Instagram"}),e.jsx(b,{value:"linkedin",children:"LinkedIn"}),e.jsx(b,{value:"twitter",children:"Twitter/X"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"url",children:"Webhook URL"}),e.jsx(q,{id:"url",type:"url",placeholder:"https://hook.example.com/webhook/social",value:l,onChange:w=>i(w.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"active",children:"Active"}),e.jsx(re,{id:"active",checked:s,onCheckedChange:a})]}),e.jsx(f,{type:"submit",className:"w-full",children:"Create Webhook"})]})]})]})}function es(){const[c,j]=_.useState("all"),{posts:d,marketingPosts:y,webhooks:n,isLoading:p,deletePost:l,updateWebhook:i,deleteWebhook:s,testWebhook:a,isTestingWebhook:t,generateMarketingPost:x,isGeneratingMarketingPost:w,marketingPostData:A,retryMarketingPost:r,isRetryingPost:g}=xe(),N=u=>{switch(u){case"posted":return"bg-green-500";case"scheduled":return"bg-blue-500";case"draft":return"bg-gray-500";case"archived":return"bg-orange-500";default:return"bg-gray-500"}},M=u=>u.split("_").map(T=>T.charAt(0).toUpperCase()+T.slice(1)).join(" ");if(p)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"})});const m=c==="all"?d:d==null?void 0:d.filter(u=>u.status===c);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Social Media Content"}),e.jsx(O,{children:"Manage and generate social media posts for your real estate business"})]}),e.jsx(fe,{})]})}),e.jsx(Q,{children:e.jsxs(le,{value:c,onValueChange:j,children:[e.jsxs(ce,{children:[e.jsx(K,{value:"all",children:"All Posts"}),e.jsx(K,{value:"draft",children:"Drafts"}),e.jsx(K,{value:"scheduled",children:"Scheduled"}),e.jsx(K,{value:"posted",children:"Posted"})]}),e.jsx(E,{value:c,className:"space-y-4 mt-6",children:m&&m.length>0?m.map(u=>e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold",children:u.post_title||"Untitled Post"}),e.jsx(I,{className:`${N(u.status)} text-white`,children:u.status})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm text-muted-foreground mb-3",children:[e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(I,{variant:"outline",children:M(u.content_type)})}),e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(I,{variant:"outline",children:M(u.subject_type)})}),e.jsx("span",{className:"inline-flex items-center gap-1",children:e.jsx(I,{variant:"outline",children:M(u.platform_type)})})]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Created: ",te(new Date(u.created_at),"MMM d, yyyy h:mm a")]}),u.scheduled_for&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Me,{className:"h-3 w-3"}),"Scheduled: ",te(new Date(u.scheduled_for),"MMM d, yyyy h:mm a")]}),u.posted_at&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ne,{className:"h-3 w-3"}),"Posted: ",te(new Date(u.posted_at),"MMM d, yyyy h:mm a")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this post?")&&l(u.id)},children:e.jsx(ae,{className:"h-4 w-4"})})]})]})},u.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No posts found"}),e.jsx(fe,{})]})})]})})]}),e.jsxs(L,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Webhook Configuration"}),e.jsx(O,{children:"Configure webhooks for automatic post distribution"})]}),e.jsx(Ye,{})]})}),e.jsx(Q,{children:n&&n.length>0?e.jsx("div",{className:"space-y-3",children:n.map(u=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ze,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:u.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:u.platform}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1 truncate max-w-md",children:u.webhook_url})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>a(u.id),disabled:t,title:"Test webhook with sample post",children:t?e.jsx(P,{className:"h-4 w-4 animate-spin"}):e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>i({id:u.id,updates:{is_active:!u.is_active}}),children:u.is_active?e.jsx($e,{className:"h-5 w-5 text-green-600"}):e.jsx(He,{className:"h-5 w-5 text-gray-400"})}),e.jsx(f,{variant:"ghost",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this webhook?")&&s(u.id)},children:e.jsx(ae,{className:"h-4 w-4"})})]})]},u.id))}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No webhooks configured yet. Add a webhook to automatically distribute posts."})})})]}),e.jsxs(L,{children:[e.jsxs(W,{children:[e.jsx(G,{children:"Marketing Post Generator"}),e.jsx(O,{children:"Generate unique, catchy social media posts to drive agent signups"})]}),e.jsxs(Q,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{onClick:()=>x(),disabled:w,className:"flex-1",children:w?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Generate New Post"]})}),n&&n.length>0&&e.jsx(f,{variant:"outline",onClick:()=>{const u=n.find(T=>T.is_active);u&&x(u.webhook_url)},disabled:w||!n.some(u=>u.is_active),children:"Generate & Send"})]}),A&&A.payload&&e.jsxs("div",{className:"space-y-4 mt-4 border-t pt-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Long Form (LinkedIn/Facebook):"}),e.jsx("div",{className:"bg-muted p-4 rounded-lg text-sm whitespace-pre-wrap",children:A.payload.longFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Short Form (Twitter/Threads):"}),e.jsx("div",{className:"bg-muted p-4 rounded-lg text-sm",children:A.payload.shortFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-2",children:"Hashtags:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:A.payload.hashtags.map((u,T)=>e.jsx(I,{variant:"secondary",children:u},T))})]})]})]})]}),e.jsxs(L,{children:[e.jsxs(W,{children:[e.jsx(G,{children:"Marketing Post History"}),e.jsx(O,{children:"View and redeploy previously generated marketing posts"})]}),e.jsx(Q,{children:y&&y.length>0?e.jsx("div",{className:"space-y-4",children:y.map(u=>{var v;const T=u.post_content;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:`${N(u.status)} text-white`,children:u.status}),e.jsx("span",{className:"text-sm text-muted-foreground",children:te(new Date(u.created_at),"MMM d, yyyy h:mm a")})]}),e.jsxs("div",{className:"flex gap-2",children:[n&&n.length>0&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{const F=n.find(C=>C.is_active);F&&r({postId:u.id,webhookUrl:F.webhook_url})},disabled:g||!n.some(F=>F.is_active),children:g?e.jsx(P,{className:"h-4 w-4 animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Resend"]})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{confirm("Are you sure you want to delete this post?")&&l(u.id)},children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Long Form:"}),e.jsx("div",{className:"bg-muted p-3 rounded text-sm whitespace-pre-wrap",children:T.longFormPost})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-1",children:"Short Form:"}),e.jsx("div",{className:"bg-muted p-3 rounded text-sm",children:T.shortFormPost})]}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(v=T.hashtags)==null?void 0:v.map((F,C)=>e.jsx(I,{variant:"secondary",className:"text-xs",children:F},C))})]})]},u.id)})}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"No marketing posts generated yet. Create your first one above!"})})})]})]})}function Ce(){const c=ie(),j=D({queryKey:["articles"],queryFn:async()=>{const{data:s,error:a}=await h.from("articles").select("*").order("created_at",{ascending:!1});if(a)throw a;return s}}),d=S({mutationFn:async s=>{const{data:a,error:t}=await h.functions.invoke("generate-article",{body:s});if(t)throw t;return a},onSuccess:s=>{s.success?o.success("Article generated successfully!"):o.error(s.error||"Generation failed")},onError:s=>{o.error("Failed to generate article: "+s.message)}}),y=S({mutationFn:async s=>{var w;const{data:a}=await h.auth.getUser(),{data:t,error:x}=await h.from("articles").insert({...s,author_id:(w=a.user)==null?void 0:w.id}).select().single();if(x)throw x;return t},onSuccess:()=>{c.invalidateQueries({queryKey:["articles"]}),o.success("Article created successfully")},onError:s=>{o.error("Failed to create article: "+s.message)}}),n=S({mutationFn:async({id:s,updates:a})=>{const{error:t}=await h.from("articles").update(a).eq("id",s);if(t)throw t},onSuccess:()=>{c.invalidateQueries({queryKey:["articles"]}),o.success("Article updated successfully")},onError:s=>{o.error("Failed to update article: "+s.message)}}),p=S({mutationFn:async s=>{const{error:a}=await h.from("articles").update({status:"published",published_at:new Date().toISOString()}).eq("id",s);if(a)throw a},onSuccess:()=>{c.invalidateQueries({queryKey:["articles"]}),o.success("Article published successfully")},onError:s=>{o.error("Failed to publish article: "+s.message)}}),l=S({mutationFn:async s=>{const{data:a,error:t}=await h.functions.invoke("publish-article-to-social",{body:{articleId:s}});if(t)throw t;return a},onSuccess:s=>{s!=null&&s.success?o.success("Article distributed to social platforms successfully"):o.error((s==null?void 0:s.error)||"Failed to distribute article")},onError:s=>{o.error("Failed to distribute article: "+s.message)}}),i=S({mutationFn:async s=>{const{error:a}=await h.from("articles").delete().eq("id",s);if(a)throw a},onSuccess:()=>{c.invalidateQueries({queryKey:["articles"]}),o.success("Article deleted successfully")},onError:s=>{o.error("Failed to delete article: "+s.message)}});return{articles:j.data,isLoading:j.isLoading,generateArticle:d.mutate,isGenerating:d.isPending,generatedArticle:d.data,createArticle:y.mutate,updateArticle:n.mutate,publishArticle:p.mutate,republishArticle:l.mutate,isRepublishing:l.isPending,deleteArticle:i.mutate}}function pe(){const c=ie(),{data:j=[],isLoading:d}=D({queryKey:["keywords"],queryFn:async()=>{const{data:i,error:s}=await h.from("keywords").select("*").order("usage_count",{ascending:!0}).order("keyword",{ascending:!0});if(s)throw s;return i}}),{data:y=[]}=D({queryKey:["keywords","unused"],queryFn:async()=>{const{data:i,error:s}=await h.from("keywords").select("*").eq("is_active",!0).order("usage_count",{ascending:!0}).order("last_used_at",{ascending:!0,nullsFirst:!0}).limit(50);if(s)throw s;return i}}),n=S({mutationFn:async i=>{const{data:{session:s}}=await h.auth.getSession();if(!s)throw new Error("Not authenticated");const a=await fetch(`${h.supabaseUrl}/functions/v1/import-keywords`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({keywords:i})});if(!a.ok){const t=await a.json();throw new Error(t.error||"Failed to import keywords")}return a.json()},onSuccess:i=>{c.invalidateQueries({queryKey:["keywords"]}),o.success(i.message||"Keywords imported successfully")},onError:i=>{o.error(i.message||"Failed to import keywords")}}),p=S({mutationFn:async({id:i,updates:s})=>{const{data:a,error:t}=await h.from("keywords").update(s).eq("id",i).select().single();if(t)throw t;return a},onSuccess:()=>{c.invalidateQueries({queryKey:["keywords"]}),o.success("Keyword updated successfully")},onError:i=>{o.error(i.message||"Failed to update keyword")}}),l=S({mutationFn:async i=>{const{error:s}=await h.from("keywords").delete().eq("id",i);if(s)throw s},onSuccess:()=>{c.invalidateQueries({queryKey:["keywords"]}),o.success("Keyword deleted successfully")},onError:i=>{o.error(i.message||"Failed to delete keyword")}});return{keywords:j,unusedKeywords:y,isLoading:d,importKeywords:i=>n.mutate(i),isImporting:n.isPending,updateKeyword:(i,s)=>p.mutate({id:i,updates:s}),deleteKeyword:i=>l.mutate(i)}}function Se(){const c=ie(),j=D({queryKey:["article-webhooks"],queryFn:async()=>{const{data:l,error:i}=await h.from("article_webhooks").select("*").order("created_at",{ascending:!1});if(i)throw i;return l}}),d=S({mutationFn:async l=>{var t;const{data:i}=await h.auth.getUser(),{data:s,error:a}=await h.from("article_webhooks").insert({...l,user_id:(t=i.user)==null?void 0:t.id}).select().single();if(a)throw a;return s},onSuccess:()=>{c.invalidateQueries({queryKey:["article-webhooks"]}),o.success("Webhook created successfully")},onError:l=>{o.error("Failed to create webhook: "+l.message)}}),y=S({mutationFn:async({id:l,updates:i})=>{const{error:s}=await h.from("article_webhooks").update(i).eq("id",l);if(s)throw s},onSuccess:()=>{c.invalidateQueries({queryKey:["article-webhooks"]}),o.success("Webhook updated successfully")},onError:l=>{o.error("Failed to update webhook: "+l.message)}}),n=S({mutationFn:async l=>{const{error:i}=await h.from("article_webhooks").delete().eq("id",l);if(i)throw i},onSuccess:()=>{c.invalidateQueries({queryKey:["article-webhooks"]}),o.success("Webhook deleted successfully")},onError:l=>{o.error("Failed to delete webhook: "+l.message)}}),p=S({mutationFn:async l=>{const{data:i,error:s}=await h.functions.invoke("test-article-webhook",{body:{webhookUrl:l}});if(s)throw s;return i},onSuccess:l=>{l!=null&&l.success?o.success("Test payload sent successfully! Check your Make.com scenario."):o.error((l==null?void 0:l.error)||"Test failed")},onError:l=>{o.error("Failed to test webhook: "+l.message)}});return{webhooks:j.data,isLoading:j.isLoading,createWebhook:d.mutate,updateWebhook:y.mutate,deleteWebhook:n.mutate,testWebhook:p.mutate,isTesting:p.isPending,testResult:p.data}}function ve(){const[c,j]=_.useState(!1),[d,y]=_.useState("keyword"),[n,p]=_.useState(""),[l,i]=_.useState(""),[s,a]=_.useState("Real Estate Tips"),[t,x]=_.useState(""),[w,A]=_.useState(""),[r,g]=_.useState(null),{generateArticle:N,isGenerating:M,createArticle:m}=Ce(),{unusedKeywords:u,isLoading:T}=pe(),v=()=>{if(d==="keyword"){const C=u.find(H=>H.id===n);N({topic:C==null?void 0:C.keyword,category:s,keywords:C?[C.keyword]:void 0,customInstructions:w||void 0,autoSelectKeyword:!n},{onSuccess:H=>{H.success&&(g(H.article),H.article.keywordId&&p(H.article.keywordId))}})}else{if(!l)return;N({topic:l,category:s,keywords:t?t.split(",").map(C=>C.trim()):void 0,customInstructions:w||void 0,autoSelectKeyword:!1},{onSuccess:C=>{C.success&&g(C.article)}})}},F=()=>{r&&m({title:r.title,slug:r.slug,content:r.content,excerpt:r.excerpt,category:r.category,tags:r.tags,seo_title:r.seoTitle,seo_description:r.seoDescription,seo_keywords:r.tags,keyword_id:d==="keyword"&&(r.keywordId||n)||null,status:"draft"},{onSuccess:()=>{j(!1),g(null),i(""),x(""),A(""),p("")}})};return e.jsxs($,{open:c,onOpenChange:j,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{className:"gap-2",children:[e.jsx(se,{className:"h-4 w-4"}),"New Article"]})}),e.jsxs(Z,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Generate Blog Article"}),e.jsx(ee,{children:"Create SEO-optimized real estate articles with AI assistance"})]}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs(le,{value:d,onValueChange:C=>y(C),children:[e.jsxs(ce,{className:"grid w-full grid-cols-2",children:[e.jsx(K,{value:"keyword",children:"From Keyword"}),e.jsx(K,{value:"manual",children:"Manual Topic"})]}),e.jsx(E,{value:"keyword",className:"space-y-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"keyword-select",children:"Select Keyword (Optional - auto-selects if empty)"}),e.jsxs(V,{value:n,onValueChange:p,children:[e.jsx(U,{id:"keyword-select",children:e.jsx(R,{placeholder:"Auto-select unused keyword..."})}),e.jsx(z,{children:T?e.jsx(b,{value:"loading",disabled:!0,children:"Loading keywords..."}):u.length===0?e.jsx(b,{value:"none",disabled:!0,children:"No keywords available"}):u.map(C=>e.jsxs(b,{value:C.id,children:[C.keyword," (used ",C.usage_count," times)"]},C.id))})]})]})}),e.jsxs(E,{value:"manual",className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"topic",children:"Article Topic *"}),e.jsx(q,{id:"topic",placeholder:"e.g., First-Time Homebuyer Tips for 2025",value:l,onChange:C=>i(C.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"keywords",children:"Target Keywords (comma-separated)"}),e.jsx(q,{id:"keywords",placeholder:"e.g., real estate, home buying, mortgage tips",value:t,onChange:C=>x(C.target.value)})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"category",children:"Category"}),e.jsxs(V,{value:s,onValueChange:a,children:[e.jsx(U,{id:"category",children:e.jsx(R,{})}),e.jsxs(z,{children:[e.jsx(b,{value:"Real Estate Tips",children:"Real Estate Tips"}),e.jsx(b,{value:"Market Insights",children:"Market Insights"}),e.jsx(b,{value:"Buying Guide",children:"Buying Guide"}),e.jsx(b,{value:"Selling Guide",children:"Selling Guide"}),e.jsx(b,{value:"Investment",children:"Investment"}),e.jsx(b,{value:"Neighborhood Guides",children:"Neighborhood Guides"}),e.jsx(b,{value:"Home Improvement",children:"Home Improvement"}),e.jsx(b,{value:"General",children:"General"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"instructions",children:"Custom Instructions (Optional)"}),e.jsx(oe,{id:"instructions",placeholder:"Add specific requirements, tone, or focus areas...",value:w,onChange:C=>A(C.target.value),rows:3})]}),e.jsx(f,{onClick:v,disabled:M||d==="manual"&&!l,className:"w-full gap-2",children:M?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 animate-spin"}),"Generating Article..."]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"h-4 w-4"}),d==="keyword"&&!n?"Auto-Select Keyword & Generate":"Generate Article with AI"]})}),r&&e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:r.title}),e.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:["Slug: ",r.slug]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:r.excerpt})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{children:"Article Content (Markdown)"}),e.jsx("div",{className:"p-4 bg-background border rounded-lg max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm font-mono",children:r.content})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"SEO Title:"}),e.jsx("p",{className:"text-muted-foreground",children:r.seoTitle})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"SEO Description:"}),e.jsx("p",{className:"text-muted-foreground",children:r.seoDescription})]})]}),e.jsx(f,{onClick:F,className:"w-full",children:"Save as Draft"})]})]})]})]})}function we(){const[c,j]=_.useState(!1),[d,y]=_.useState(""),[n,p]=_.useState(""),[l,i]=_.useState(!0),{createWebhook:s}=Se(),a=t=>{t.preventDefault(),!(!d.trim()||!n.trim())&&(s({name:d,webhook_url:n,is_active:l}),y(""),p(""),i(!0),j(!1))};return e.jsxs($,{open:c,onOpenChange:j,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{variant:"outline",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Add Webhook"]})}),e.jsxs(Z,{children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Add Article Webhook"}),e.jsx(ee,{children:"Configure a webhook to receive article data when articles are published"})]}),e.jsxs("form",{onSubmit:a,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"name",children:"Webhook Name"}),e.jsx(q,{id:"name",placeholder:"My Social Platform",value:d,onChange:t=>y(t.target.value),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{htmlFor:"url",children:"Webhook URL"}),e.jsx(q,{id:"url",type:"url",placeholder:"https://api.example.com/webhooks/article",value:n,onChange:t=>p(t.target.value),required:!0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(k,{htmlFor:"active",children:"Active"}),e.jsx(re,{id:"active",checked:l,onCheckedChange:i})]}),e.jsx(f,{type:"submit",className:"w-full",children:"Create Webhook"})]})]})]})}function Fe(){const[c,j]=_.useState(!1),{importKeywords:d,isImporting:y}=pe(),n=_.useRef(null),p=()=>{const i=`keyword,category,difficulty,search_volume,notes
real estate agent portfolio,Real Estate,medium,1000,Example keyword
luxury home listings,Luxury Real Estate,hard,500,High-value properties
first time home buyer tips,Real Estate,easy,2000,Educational content`,s=new Blob([i],{type:"text/csv"}),a=window.URL.createObjectURL(s),t=document.createElement("a");t.href=a,t.download="keywords-template.csv",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(a),o.success("Template downloaded")},l=async i=>{var a;const s=(a=i.target.files)==null?void 0:a[0];if(s)try{const x=(await s.text()).split(`
`).filter(r=>r.trim());if(x.length<2){o.error("CSV file is empty or invalid");return}const w=x[0].split(",").map(r=>r.trim().toLowerCase()),A=x.slice(1).map(r=>{const g=r.split(",").map(M=>M.trim()),N={};return w.forEach((M,m)=>{g[m]&&(N[M]=g[m])}),N}).filter(r=>r.keyword);if(A.length===0){o.error("No valid keywords found in CSV");return}await d(A),j(!1),n.current&&(n.current.value="")}catch(t){console.error("Error parsing CSV:",t),o.error("Failed to parse CSV file")}};return e.jsxs($,{open:c,onOpenChange:j,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{variant:"outline",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Import Keywords"]})}),e.jsxs(Z,{children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Import Keywords from CSV"}),e.jsx(ee,{children:"Upload a CSV file with your keywords. New keywords will be added and existing ones will be skipped."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed rounded-lg p-6 text-center",children:[e.jsx("input",{ref:n,type:"file",accept:".csv",onChange:l,disabled:y,className:"hidden",id:"csv-upload"}),e.jsx("label",{htmlFor:"csv-upload",className:"cursor-pointer",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[y?e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"}):e.jsx(ge,{className:"h-8 w-8 text-muted-foreground"}),e.jsx("p",{className:"text-sm font-medium",children:y?"Importing...":"Click to upload CSV"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"CSV files only"})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"CSV Format:"}),e.jsx("div",{className:"bg-muted p-3 rounded-md text-xs font-mono",children:"keyword,category,difficulty,search_volume,notes"}),e.jsxs("ul",{className:"text-xs text-muted-foreground space-y-1 ml-4 list-disc",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"keyword"})," (required): The keyword phrase"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"category"}),": Real Estate, Luxury Real Estate, etc."]}),e.jsxs("li",{children:[e.jsx("strong",{children:"difficulty"}),": easy, medium, or hard"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"search_volume"}),": Monthly search volume (number)"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"notes"}),": Any additional notes"]})]})]}),e.jsxs(f,{onClick:p,variant:"secondary",className:"w-full",children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Download Template"]})]})]})]})}function ss(){const c=ie(),{data:j=[],isLoading:d}=D({queryKey:["content-suggestions"],queryFn:async()=>{const{data:s,error:a}=await h.from("content_suggestions").select("*").order("priority",{ascending:!1}).order("created_at",{ascending:!1});if(a)throw a;return s}}),y=S({mutationFn:async({customInstructions:s,count:a})=>{const{data:{session:t}}=await h.auth.getSession();if(!t)throw new Error("Not authenticated");const x=await h.functions.invoke("generate-content-suggestions",{body:{customInstructions:s,count:a}});if(x.error)throw new Error(x.error.message||"Failed to generate suggestions");return x.data},onSuccess:()=>{c.invalidateQueries({queryKey:["content-suggestions"]}),o.success("Content suggestions generated successfully")},onError:s=>{o.error(s.message||"Failed to generate suggestions")}}),n=S({mutationFn:async({id:s,updates:a})=>{const{data:t,error:x}=await h.from("content_suggestions").update(a).eq("id",s).select().single();if(x)throw x;return t},onSuccess:()=>{c.invalidateQueries({queryKey:["content-suggestions"]})},onError:s=>{o.error(s.message||"Failed to update suggestion")}}),p=S({mutationFn:async s=>{const{error:a}=await h.from("content_suggestions").delete().eq("id",s);if(a)throw a},onSuccess:()=>{c.invalidateQueries({queryKey:["content-suggestions"]}),o.success("Suggestion deleted")},onError:s=>{o.error(s.message||"Failed to delete suggestion")}}),l=S({mutationFn:async s=>{const a=s.keywords||[s.topic],{data:{session:t}}=await h.auth.getSession();if(!t)throw new Error("Not authenticated");const x=await h.functions.invoke("import-keywords",{body:{keywords:a.map(w=>({keyword:w,category:s.category||"General"}))}});if(x.error)throw new Error(x.error.message||"Failed to add to keywords");return await h.from("content_suggestions").update({status:"completed"}).eq("id",s.id),x.data},onSuccess:()=>{c.invalidateQueries({queryKey:["content-suggestions"]}),c.invalidateQueries({queryKey:["keywords"]}),o.success("Added to keywords successfully")},onError:s=>{o.error(s.message||"Failed to add to keywords")}}),i=S({mutationFn:async s=>{var x,w;const{data:{session:a}}=await h.auth.getSession();if(!a)throw new Error("Not authenticated");await h.from("content_suggestions").update({status:"queued"}).eq("id",s.id);const t=await h.functions.invoke("generate-article",{body:{topic:s.topic,category:s.category,keywords:s.keywords,autoSelectKeyword:!1}});if(t.error)throw new Error(t.error.message||"Failed to generate article");return await h.from("content_suggestions").update({status:"completed",generated_article_id:(w=(x=t.data)==null?void 0:x.article)==null?void 0:w.id}).eq("id",s.id),t.data},onSuccess:()=>{c.invalidateQueries({queryKey:["content-suggestions"]}),c.invalidateQueries({queryKey:["articles"]}),o.success("Article generated successfully")},onError:s=>{o.error(s.message||"Failed to generate article")}});return{suggestions:j,isLoading:d,generateSuggestions:(s,a)=>y.mutate({customInstructions:s,count:a}),isGenerating:y.isPending,updateSuggestion:(s,a)=>n.mutate({id:s,updates:a}),deleteSuggestion:s=>p.mutate(s),queueSuggestion:s=>n.mutate({id:s,updates:{status:"queued"}}),rejectSuggestion:s=>n.mutate({id:s,updates:{status:"rejected"}}),addToKeywords:s=>l.mutate(s),writeArticle:s=>i.mutate(s),isWritingArticle:i.isPending}}function ts(){const[c,j]=_.useState(!1),[d,y]=_.useState(""),[n,p]=_.useState("10"),{suggestions:l,isLoading:i,generateSuggestions:s,isGenerating:a,queueSuggestion:t,rejectSuggestion:x,deleteSuggestion:w,addToKeywords:A,writeArticle:r,isWritingArticle:g}=ss(),N=()=>{s(d,parseInt(n)||10),j(!1),y("")},M=v=>{switch(v){case"queued":return"bg-blue-500";case"in_progress":return"bg-yellow-500";case"completed":return"bg-green-500";case"rejected":return"bg-red-500";default:return"bg-gray-500"}},m=v=>{const F=v||3;return F>=4?e.jsx(de,{className:"h-3 w-3 text-red-500"}):F>=3?e.jsx(de,{className:"h-3 w-3 text-orange-500"}):e.jsx(de,{className:"h-3 w-3 text-gray-500"})},u=l.filter(v=>v.status==="pending"),T=l.filter(v=>v.status==="queued");return e.jsxs(L,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(G,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"h-5 w-5"}),"AI Content Suggestions"]}),e.jsx(O,{children:"Generate high-value article ideas based on SEO keywords and market trends"})]}),e.jsxs($,{open:c,onOpenChange:j,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Generate Suggestions"]})}),e.jsxs(Z,{children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Generate Content Suggestions"}),e.jsx(ee,{children:"AI will analyze your existing keywords and articles to suggest relevant topics"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Number of Suggestions"}),e.jsx(q,{type:"number",min:"1",max:"50",value:n,onChange:v=>p(v.target.value),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Custom Instructions (Optional)"}),e.jsx(oe,{value:d,onChange:v=>y(v.target.value),placeholder:"E.g., Focus on first-time homebuyers in urban areas...",rows:4})]})]}),e.jsxs(ue,{children:[e.jsx(f,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsxs(f,{onClick:N,disabled:a,children:[a&&e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}),"Generate"]})]})]})]})]})}),e.jsx(Q,{children:i?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"})}):l.length>0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold",children:l.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:u.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Queued"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:T.length})]}),e.jsxs("div",{className:"border rounded-lg p-3",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:l.filter(v=>v.status==="completed").length})]})]}),e.jsx("div",{className:"space-y-3",children:l.map(v=>{var F;return e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[m(v.priority),e.jsx("h4",{className:"font-semibold",children:v.topic}),e.jsx(I,{className:`${M(v.status)} text-white text-xs`,children:v.status||"pending"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx(I,{variant:"outline",children:v.category||"General"}),(F=v.keywords)==null?void 0:F.slice(0,3).map((C,H)=>e.jsxs(I,{variant:"secondary",className:"gap-1",children:[e.jsx(me,{className:"h-3 w-3"}),C]},H))]})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[v.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(f,{variant:"outline",size:"sm",onClick:()=>r(v),disabled:g,title:"Write Article Now",children:g?e.jsx(P,{className:"h-4 w-4 animate-spin"}):e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>t(v.id),title:"Add to Queue",children:e.jsx(We,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>A(v),title:"Add to Keywords",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>x(v.id),title:"Reject",children:e.jsx(Ge,{className:"h-4 w-4"})})]}),v.status==="completed"&&e.jsx(f,{variant:"outline",size:"sm",disabled:!0,title:"Completed",children:e.jsx(ke,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this suggestion?")&&w(v.id)},title:"Delete",children:e.jsx(ae,{className:"h-4 w-4"})})]})]})},v.id)})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(je,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"No content suggestions yet. Generate AI-powered topic ideas to get started."}),e.jsxs($,{open:c,onOpenChange:j,children:[e.jsx(X,{asChild:!0,children:e.jsxs(f,{children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Generate First Suggestions"]})}),e.jsxs(Z,{children:[e.jsxs(J,{children:[e.jsx(Y,{children:"Generate Content Suggestions"}),e.jsx(ee,{children:"AI will analyze your existing keywords and articles to suggest relevant topics"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Number of Suggestions"}),e.jsx(q,{type:"number",min:"1",max:"50",value:n,onChange:v=>p(v.target.value),placeholder:"10"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Custom Instructions (Optional)"}),e.jsx(oe,{value:d,onChange:v=>y(v.target.value),placeholder:"E.g., Focus on first-time homebuyers in urban areas...",rows:4})]})]}),e.jsxs(ue,{children:[e.jsx(f,{variant:"outline",onClick:()=>j(!1),children:"Cancel"}),e.jsxs(f,{onClick:N,disabled:a,children:[a&&e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}),"Generate"]})]})]})]})]})})]})}function as(){const[c,j]=_.useState("all"),{articles:d,isLoading:y,deleteArticle:n,publishArticle:p,republishArticle:l,isRepublishing:i}=Ce(),{keywords:s,isLoading:a}=pe(),{webhooks:t,isLoading:x,updateWebhook:w,deleteWebhook:A,testWebhook:r,isTesting:g}=Se(),N=m=>{switch(m){case"published":return"bg-green-500";case"scheduled":return"bg-blue-500";case"draft":return"bg-gray-500";case"archived":return"bg-orange-500";default:return"bg-gray-500"}};if(y)return e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsx(P,{className:"h-8 w-8 animate-spin text-primary"})});const M=c==="all"?d:d==null?void 0:d.filter(m=>m.status===c);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(L,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Blog Articles"}),e.jsx(O,{children:"Manage your real estate blog content and articles"})]}),e.jsx(ve,{})]})}),e.jsx(Q,{children:e.jsxs(le,{value:c,onValueChange:j,children:[e.jsxs(ce,{children:[e.jsx(K,{value:"all",children:"All Articles"}),e.jsx(K,{value:"draft",children:"Drafts"}),e.jsx(K,{value:"scheduled",children:"Scheduled"}),e.jsx(K,{value:"published",children:"Published"})]}),e.jsx(E,{value:c,className:"space-y-4 mt-6",children:M&&M.length>0?M.map(m=>{var u,T;return e.jsx("div",{className:"border rounded-lg p-4 hover:border-primary transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h4",{className:"font-semibold text-lg",children:m.title}),e.jsx(I,{className:`${N(m.status)} text-white`,children:m.status})]}),m.excerpt&&e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[m.excerpt.substring(0,150),"..."]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3",children:[e.jsx(I,{variant:"outline",children:m.category}),m.keyword_id&&e.jsxs(I,{variant:"secondary",className:"gap-1",children:[e.jsx(me,{className:"h-3 w-3"}),((u=s==null?void 0:s.find(v=>v.id===m.keyword_id))==null?void 0:u.keyword)||"Keyword"]}),(T=m.tags)==null?void 0:T.slice(0,2).map((v,F)=>e.jsx(I,{variant:"secondary",children:v},F))]}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"h-3 w-3"}),m.view_count," views"]}),e.jsxs("span",{children:["Created: ",te(new Date(m.created_at),"MMM d, yyyy")]}),m.published_at&&e.jsxs("span",{children:["Published: ",te(new Date(m.published_at),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{variant:"outline",size:"sm",title:"View",children:e.jsx(he,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",title:"Edit",children:e.jsx(_e,{className:"h-4 w-4"})}),m.status==="draft"&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{confirm("Publish this article?")&&p(m.id)},title:"Publish",children:e.jsx(ke,{className:"h-4 w-4"})}),m.status==="published"&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{confirm("Re-distribute this article to social platforms?")&&l(m.id)},disabled:i,title:"Re-publish to Social Media",children:i?e.jsx(P,{className:"h-4 w-4 animate-spin"}):e.jsx(ne,{className:"h-4 w-4"})}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this article?")&&n(m.id)},title:"Delete",children:e.jsx(ae,{className:"h-4 w-4"})})]})]})},m.id)}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"No articles found"}),e.jsx("div",{className:"mt-4",children:e.jsx(ve,{})})]})})]})})]}),e.jsxs(L,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Keyword Management"}),e.jsx(O,{children:"Track SEO keyword usage across articles"})]}),e.jsx(Fe,{})]})}),e.jsx(Q,{children:a?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(P,{className:"h-6 w-6 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Keywords"}),e.jsx("p",{className:"text-2xl font-bold",children:(s==null?void 0:s.length)||0})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Unused"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:(s==null?void 0:s.filter(m=>m.usage_count===0).length)||0})]}),e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Most Used"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Math.max(...(s==null?void 0:s.map(m=>m.usage_count))||[0])})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Keywords are automatically tracked when articles are published. Import your keywords.csv to get started."})]})})]}),e.jsx(ts,{}),e.jsxs(L,{children:[e.jsx(W,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(G,{children:"Article Webhooks"}),e.jsx(O,{children:"Configure webhooks for automatic article distribution"})]}),e.jsx(we,{})]})}),e.jsx(Q,{children:x?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx(P,{className:"h-6 w-6 animate-spin text-primary"})}):t&&t.length>0?e.jsx("div",{className:"space-y-3",children:t.map(m=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h4",{className:"font-semibold",children:m.name}),e.jsx(I,{variant:m.is_active?"default":"secondary",children:m.is_active?"Active":"Inactive"})]}),e.jsxs("a",{href:m.webhook_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-muted-foreground hover:text-primary flex items-center gap-1",children:[m.webhook_url,e.jsx(qe,{className:"h-3 w-3"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{checked:m.is_active,onCheckedChange:u=>{w({id:m.id,updates:{is_active:u}})}}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{confirm("Delete this webhook?")&&A(m.id)},children:e.jsx(ae,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"pt-3 border-t",children:e.jsx(f,{variant:"secondary",size:"sm",onClick:()=>r(m.webhook_url),disabled:g,className:"w-full",children:g?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Send Test Payload to Make.com"]})})})]},m.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"No webhooks configured. Add one to automatically send published articles to external platforms."}),e.jsx(we,{})]})})]})]})}function Ns(){const{user:c,role:j}=Te();return!c||j!=="admin"?e.jsx(Pe,{to:"/",replace:!0}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ye,{className:"h-8 w-8 text-primary"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Admin Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage AI, content, and platform settings"})]})]}),e.jsx(Ie,{to:"/dashboard",children:e.jsxs(f,{variant:"outline",className:"gap-2",children:[e.jsx(Ke,{className:"h-4 w-4"}),"Back to Dashboard"]})})]})})}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs(le,{defaultValue:"ai",className:"space-y-6",children:[e.jsxs(ce,{className:"grid w-full grid-cols-7 lg:w-auto",children:[e.jsxs(K,{value:"ai",className:"gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"AI Settings"]}),e.jsxs(K,{value:"social",className:"gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Social Media"]}),e.jsxs(K,{value:"articles",className:"gap-2",children:[e.jsx(Ve,{className:"h-4 w-4"}),"Articles"]}),e.jsxs(K,{value:"keywords",className:"gap-2",children:[e.jsx(Oe,{className:"h-4 w-4"}),"Keywords"]}),e.jsxs(K,{value:"seo",className:"gap-2",children:[e.jsx(De,{className:"h-4 w-4"}),"SEO"]}),e.jsxs(K,{value:"users",className:"gap-2",children:[e.jsx(Le,{className:"h-4 w-4"}),"User Roles"]}),e.jsxs(K,{value:"settings",className:"gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Platform"]})]}),e.jsx(E,{value:"ai",className:"space-y-6",children:e.jsx(Je,{})}),e.jsx(E,{value:"social",className:"space-y-6",children:e.jsx(es,{})}),e.jsx(E,{value:"articles",className:"space-y-6",children:e.jsx(as,{})}),e.jsx(E,{value:"keywords",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Keyword Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Import and manage keywords from CSV files"})]}),e.jsx(Fe,{})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Use the import button to bulk upload keywords from a CSV file. Keywords help improve content generation and SEO optimization."})]})}),e.jsx(E,{value:"seo",className:"space-y-6",children:e.jsx(Qe,{})}),e.jsx(E,{value:"users",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"User Role Management"}),e.jsx("p",{className:"text-muted-foreground",children:"User role management interface coming soon..."})]})}),e.jsx(E,{value:"settings",className:"space-y-6",children:e.jsxs("div",{className:"rounded-lg border p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Platform Settings"}),e.jsx("p",{className:"text-muted-foreground",children:"Additional platform configuration coming soon..."})]})})]})})]})}export{Ns as AdminDashboard};
