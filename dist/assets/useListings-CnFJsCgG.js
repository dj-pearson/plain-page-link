import{q,b3 as w,G as h,s}from"./index-CbXwE5cx.js";import{u as a}from"./useMutation-BeLtmIn6.js";function Q(){const{user:e}=q(),n=w(),{data:u=[],isLoading:d,isError:c,error:l,refetch:g}=h({queryKey:["listings",e?.id],queryFn:async()=>{if(!e?.id)return[];const{data:i,error:r}=await s.from("listings").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(r)throw r;return i},enabled:!!e?.id}),y=a({mutationFn:async i=>{if(!e?.id)throw new Error("User not authenticated");const{data:r,error:t}=await s.from("listings").insert({user_id:e.id,...i}).select().single();if(t)throw t;return r},onSuccess:()=>{n.invalidateQueries({queryKey:["listings",e?.id]})}}),f=a({mutationFn:async({id:i,...r})=>{const{data:t,error:o}=await s.from("listings").update(r).eq("id",i).select().single();if(o)throw o;return t},onSuccess:()=>{n.invalidateQueries({queryKey:["listings",e?.id]})}}),m=a({mutationFn:async i=>{const{error:r}=await s.from("listings").delete().eq("id",i);if(r)throw r},onSuccess:()=>{n.invalidateQueries({queryKey:["listings",e?.id]})}});return{listings:u,isLoading:d,isError:c,error:l,refetch:g,addListing:y,updateListing:f,deleteListing:m}}export{Q as u};
