import{j as e}from"./ui-vendor-CfJXqRNY.js";import{b as l}from"./react-vendor-J1CWpfuS.js";import{u as ne,a8 as oe,a9 as ce,aj as de,aa as me,Z as V,ab as xe,I as ge,e as je,B as w,h as ee,a5 as he,ak as Ne,s as S,J as $,f as se,y as G,z as K,D as J,F as Y,G as U,M as X,a0 as B,a3 as q,$ as ve,_ as te,T as ye,H as be,U as ue,a7 as E,l as we,ae as Se,C as f,d as g,x as ke,aq as Ce,K as _e}from"./index-D2pWWD8v.js";import{u as Le}from"./state-vendor-CLv4ylJ5.js";import{u as Te,U as Ue}from"./UpgradeModal-Gjek364d.js";import{u as Ae}from"./useProfile-D87lXAz1.js";import{C as De}from"./circle-x-D01msjEE.js";import{b as ae}from"./date-vendor-Xm6TBh54.js";import{S as Q}from"./send-DozEymmo.js";import{F as Re}from"./file-text-DCmjezaa.js";import{T as Me}from"./trash-2-BEXpIPuO.js";import{S as re}from"./square-check-big-LyvnfmI1.js";import{S as le}from"./square-Dz_Nr7vJ.js";import{R as Ie}from"./refresh-cw-D_EOxaGn.js";import"./supabase-Cz6j5Lvp.js";import"./three-vendor-D7cCqkiR.js";import"./charts-vendor-CEquIWeD.js";import"./form-vendor-DMOe4tsc.js";import"./animation-vendor-BZ61rGB5.js";function Ze({open:t,onOpenChange:k}){const{toast:h}=ne(),{profile:A,refetch:I}=Ae(),[m,j]=l.useState(A?.zapier_webhook_url||""),[N,C]=l.useState(!1),[v,i]=l.useState(!1),[c,u]=l.useState(null),p=async()=>{C(!0);try{const{data:{user:n}}=await S.auth.getUser();if(!n)throw new Error("Not authenticated");const{error:x}=await S.from("profiles").update({zapier_webhook_url:m||null}).eq("id",n.id);if(x)throw x;await I(),h({title:"Saved!",description:m?"Zapier webhook configured successfully":"Zapier webhook removed"})}catch{h({title:"Error",description:"Failed to save webhook URL",variant:"destructive"})}finally{C(!1)}},y=async()=>{if(!m){h({title:"Error",description:"Please enter a webhook URL first",variant:"destructive"});return}i(!0),u(null);try{const n={test:!0,lead_id:"test-lead-id",name:"Test Lead",email:"test@example.com",phone:"+1 555-123-4567",message:"This is a test lead from AgentBio.net",lead_type:"contact",created_at:new Date().toISOString()},x=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(x.ok)u("success"),h({title:"Test successful!",description:"Your Zapier webhook is working correctly"});else throw new Error(`HTTP ${x.status}`)}catch{u("error"),h({title:"Test failed",description:"Could not reach your webhook. Check the URL and try again.",variant:"destructive"})}finally{i(!1)}};return e.jsx(oe,{open:t,onOpenChange:k,children:e.jsxs(ce,{className:"sm:max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(de,{children:[e.jsxs(me,{className:"text-2xl flex items-center gap-2",children:[e.jsx(V,{className:"h-6 w-6 text-orange-500"}),"Zapier Integration"]}),e.jsx(xe,{children:"Automatically send new leads to your CRM via Zapier"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold mb-2",children:"Zapier Webhook URL"}),e.jsx(ge,{type:"url",placeholder:"https://hooks.zapier.com/hooks/catch/...",value:m,onChange:n=>j(n.target.value),className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Paste your Zapier webhook URL here"})]}),c&&e.jsxs("div",{className:`p-3 rounded-lg flex items-center gap-2 ${c==="success"?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"}`,children:[c==="success"?e.jsx(je,{className:"h-5 w-5"}):e.jsx(De,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:c==="success"?"Webhook test successful!":"Webhook test failed. Check your URL."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{onClick:y,variant:"outline",disabled:v||!m,className:"flex-1",children:v?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-4 w-4 mr-2 animate-spin"}),"Testing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-4 w-4 mr-2"}),"Test Webhook"]})}),e.jsx(w,{onClick:p,disabled:N,className:"flex-1",children:N?e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):"Save Configuration"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(he,{className:"h-5 w-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold text-blue-900 mb-2",children:"How to set up Zapier integration:"}),e.jsxs("ol",{className:"text-blue-800 space-y-2 list-decimal list-inside",children:[e.jsxs("li",{children:["Go to"," ",e.jsxs("a",{href:"https://zapier.com",target:"_blank",rel:"noopener noreferrer",className:"underline inline-flex items-center gap-1",children:["Zapier.com",e.jsx(Ne,{className:"h-3 w-3"})]})," ","and create a new Zap"]}),e.jsx("li",{children:'Choose "Webhooks by Zapier" as the trigger'}),e.jsx("li",{children:'Select "Catch Hook" as the event'}),e.jsx("li",{children:"Copy the webhook URL Zapier provides"}),e.jsx("li",{children:"Paste it in the field above and save"}),e.jsx("li",{children:"Connect your CRM (Salesforce, HubSpot, etc.) as the action"}),e.jsx("li",{children:"Map the lead fields to your CRM fields"}),e.jsx("li",{children:"Turn on your Zap!"})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Available Fields in Webhook Payload:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs font-mono",children:[e.jsx("div",{className:"text-gray-600",children:"lead_id"}),e.jsx("div",{className:"text-gray-600",children:"name"}),e.jsx("div",{className:"text-gray-600",children:"email"}),e.jsx("div",{className:"text-gray-600",children:"phone"}),e.jsx("div",{className:"text-gray-600",children:"message"}),e.jsx("div",{className:"text-gray-600",children:"lead_type"}),e.jsx("div",{className:"text-gray-600",children:"price_range"}),e.jsx("div",{className:"text-gray-600",children:"timeline"}),e.jsx("div",{className:"text-gray-600",children:"property_address"}),e.jsx("div",{className:"text-gray-600",children:"preapproved"}),e.jsx("div",{className:"text-gray-600",children:"referrer_url"}),e.jsx("div",{className:"text-gray-600",children:"utm_source"}),e.jsx("div",{className:"text-gray-600",children:"utm_medium"}),e.jsx("div",{className:"text-gray-600",children:"utm_campaign"}),e.jsx("div",{className:"text-gray-600",children:"device"}),e.jsx("div",{className:"text-gray-600",children:"created_at"})]})]}),e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2 text-purple-900",children:"⚡ Benefits of Zapier Integration:"}),e.jsxs("ul",{className:"text-sm text-purple-800 space-y-1",children:[e.jsx("li",{children:"• Automatically sync leads to 5,000+ apps"}),e.jsx("li",{children:"• Connect to popular CRMs (Salesforce, HubSpot, Zoho)"}),e.jsx("li",{children:"• Send leads to Google Sheets for easy tracking"}),e.jsx("li",{children:"• Get instant Slack/Teams notifications for new leads"}),e.jsx("li",{children:"• Create tasks in your project management tools"})]})]})]})]})})}const ze=[{value:"new",label:"New",color:"bg-green-100 text-green-800"},{value:"contacted",label:"Contacted",color:"bg-blue-100 text-blue-800"},{value:"qualified",label:"Qualified",color:"bg-purple-100 text-purple-800"},{value:"converted",label:"Converted",color:"bg-emerald-100 text-emerald-800"},{value:"lost",label:"Lost",color:"bg-gray-100 text-gray-800"}],ie=[{id:"intro",title:"Introduction",template:"Hi {name}, thank you for reaching out! I'd love to help you {lead_type}. When would be a good time to chat?"},{id:"buyer_followup",title:"Buyer Follow-up",template:"Hi {name}, I have some great properties that match what you're looking for. Are you available for a showing this week?"},{id:"seller_followup",title:"Seller Follow-up",template:"Hi {name}, I'd like to schedule a time to visit your property and discuss your goals. What days work best for you?"},{id:"valuation",title:"Home Valuation",template:"Hi {name}, I've prepared a comparative market analysis for your property. Can we schedule a call to discuss the current market value?"}];function Fe({lead:t,open:k,onOpenChange:h,onLeadUpdated:A}){const[I,m]=l.useState(t?.status||"new"),[j,N]=l.useState(""),[C,v]=l.useState([]),[i,c]=l.useState(!1),[u,p]=l.useState(!1),[y,n]=l.useState("");l.useEffect(()=>{t&&k&&x()},[t,k]);const x=async()=>{if(t){p(!0);try{const{data:a,error:o}=await S.from("lead_notes").select("*").eq("lead_id",t.id).order("created_at",{ascending:!1});if(o)throw o;v(a||[])}catch(a){console.error("Failed to load notes:",a)}finally{p(!1)}}},d=async a=>{if(t){c(!0);try{const{error:o}=await S.from("leads").update({status:a}).eq("id",t.id);if(o)throw o;m(a),E.success("Lead status updated"),A?.(),await z(`Status changed to: ${a}`,!0)}catch(o){console.error("Failed to update status:",o),E.error("Failed to update status")}finally{c(!1)}}},z=async(a,o=!1)=>{if(!(!t||!a.trim()))try{const{data:_,error:P}=await S.from("lead_notes").insert({lead_id:t.id,note:a.trim(),is_system:o}).select().single();if(P)throw P;v(W=>[_,...W]),o||(N(""),E.success("Note added"))}catch(_){console.error("Failed to add note:",_),o||E.error("Failed to add note")}},H=()=>{z(j,!1)},F=()=>{switch(t?.lead_type){case"buyer":return e.jsx(ue,{className:"h-5 w-5"});case"seller":return e.jsx(be,{className:"h-5 w-5"});case"valuation":return e.jsx(te,{className:"h-5 w-5"});default:return e.jsx(q,{className:"h-5 w-5"})}},D=a=>a.replace("{name}",t?.name||"there").replace("{lead_type}",t?.lead_type==="buyer"?"find your dream home":"sell your property"),R=a=>{const o=ie.find(_=>_.id===a);o&&(N(D(o.template)),n(""))};if(!t)return null;const O=t.created_at?ae(new Date(t.created_at),{addSuffix:!0}):"";return e.jsx(oe,{open:k,onOpenChange:h,children:e.jsxs(ce,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:F()}),e.jsxs("div",{children:[e.jsx(me,{className:"text-xl",children:t.name}),e.jsxs(xe,{className:"flex items-center gap-2 mt-1",children:[e.jsx($,{variant:"outline",className:"capitalize",children:t.lead_type}),e.jsx("span",{className:"text-xs text-muted-foreground",children:O})]})]})]})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{children:"Lead Status"}),e.jsxs(G,{value:I,onValueChange:d,disabled:i,children:[e.jsx(K,{children:e.jsx(J,{})}),e.jsx(Y,{children:ze.map(a=>e.jsx(U,{value:a.value,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${a.color}`}),a.label]})},a.value))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Contact Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("a",{href:`mailto:${t.email}`,className:"flex items-center gap-3 p-3 rounded-lg border hover:border-primary hover:bg-primary/5 transition-colors group",children:[e.jsx(X,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary"}),e.jsx("span",{className:"flex-1 text-sm",children:t.email}),e.jsx(Q,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary opacity-0 group-hover:opacity-100 transition-opacity"})]}),t.phone&&e.jsxs("a",{href:`tel:${t.phone}`,className:"flex items-center gap-3 p-3 rounded-lg border hover:border-primary hover:bg-primary/5 transition-colors group",children:[e.jsx(B,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary"}),e.jsx("span",{className:"flex-1 text-sm",children:t.phone}),e.jsx(B,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary opacity-0 group-hover:opacity-100 transition-opacity"})]}),t.phone&&e.jsxs("a",{href:`sms:${t.phone}`,className:"flex items-center gap-3 p-3 rounded-lg border hover:border-primary hover:bg-primary/5 transition-colors group",children:[e.jsx(q,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary"}),e.jsx("span",{className:"flex-1 text-sm",children:"Send SMS"}),e.jsx(Q,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary opacity-0 group-hover:opacity-100 transition-opacity"})]})]})]}),t.message&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Message"}),e.jsx("div",{className:"p-4 bg-muted/50 rounded-lg",children:e.jsx("p",{className:"text-sm whitespace-pre-wrap",children:t.message})})]}),(t.source||t.property_address||t.budget)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Additional Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.source&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Re,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Source:"}),e.jsx("span",{className:"font-medium",children:t.source})]}),t.property_address&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Property:"}),e.jsx("span",{className:"font-medium",children:t.property_address})]}),t.budget&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-muted-foreground",children:"Budget:"}),e.jsx("span",{className:"font-medium",children:t.budget})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{children:"Quick Response Templates"}),e.jsxs(G,{value:y,onValueChange:R,children:[e.jsx(K,{children:e.jsx(J,{placeholder:"Select a template..."})}),e.jsx(Y,{children:ie.map(a=>e.jsx(U,{value:a.id,children:a.title},a.id))})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"font-semibold text-sm text-muted-foreground uppercase tracking-wide",children:"Notes & Activity"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ye,{value:j,onChange:a=>N(a.target.value),placeholder:"Add a note about this lead...",rows:3}),e.jsxs(w,{onClick:H,disabled:!j.trim(),size:"sm",className:"gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Add Note"]})]}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:u?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"Loading notes..."}):C.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No notes yet. Add your first note above."}):C.map(a=>e.jsxs("div",{className:`p-3 rounded-lg border ${a.is_system?"bg-muted/30 border-muted":"bg-background"}`,children:[e.jsx("p",{className:"text-sm",children:a.note}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:ae(new Date(a.created_at),{addSuffix:!0})})]},a.id))})]})]})]})})}function rs(){const[t,k]=l.useState(""),[h,A]=l.useState(!1),[I,m]=l.useState(!1),[j,N]=l.useState(null),[C,v]=l.useState(!1),[i,c]=l.useState(new Set),[u,p]=l.useState(!1),{user:y}=we(),{toast:n}=ne(),{subscription:x}=Te(),{data:d,isLoading:z,isError:H,error:F,refetch:D}=Le({queryKey:["leads",y?.id],queryFn:async()=>{if(!y?.id)return[];const{data:s,error:r}=await S.from("leads").select("*").eq("user_id",y.id).order("created_at",{ascending:!1});if(r)throw r;return s},enabled:!!y?.id}),R=l.useMemo(()=>d?d.reduce((s,r)=>(s.total++,r.status==="new"?s.new++:r.status==="contacted"?s.contacted++:r.status==="converted"&&s.converted++,s),{total:0,new:0,contacted:0,converted:0}):{total:0,new:0,contacted:0,converted:0},[d]),O=s=>{N(s),v(!0)},a=(s,r)=>{r.stopPropagation(),c(M=>{const L=new Set(M);return L.has(s)?L.delete(s):L.add(s),L})},o=()=>{i.size===b?.length?c(new Set):c(new Set(b?.map(s=>s.id)||[]))},_=async s=>{if(i.size!==0){p(!0);try{const{error:r}=await S.from("leads").update({status:s}).in("id",Array.from(i));if(r)throw r;n({title:"Status updated",description:`Updated ${i.size} lead(s) to ${s}`}),c(new Set),D()}catch(r){console.error("Bulk status update failed:",r),n({title:"Error",description:"Failed to update lead status",variant:"destructive"})}finally{p(!1)}}},P=async()=>{if(i.size!==0&&confirm(`Are you sure you want to delete ${i.size} lead(s)? This action cannot be undone.`)){p(!0);try{const{error:s}=await S.from("leads").delete().in("id",Array.from(i));if(s)throw s;n({title:"Leads deleted",description:`Deleted ${i.size} lead(s)`}),c(new Set),D()}catch(s){console.error("Bulk delete failed:",s),n({title:"Error",description:"Failed to delete leads",variant:"destructive"})}finally{p(!1)}}},W=()=>{if(x?.plan_name==="free"){A(!0);return}if(!d||d.length===0){n({title:"No leads to export",description:"You don't have any leads yet.",variant:"destructive"});return}const r=[["Name","Email","Phone","Type","Message","Status","Created At"].join(","),...d.map(T=>[T.name,T.email,T.phone||"",T.lead_type,`"${(T.message||"").replace(/"/g,'""')}"`,T.status,new Date(T.created_at).toLocaleDateString()].join(","))].join(`
`),M=new Blob([r],{type:"text/csv"}),L=URL.createObjectURL(M),Z=document.createElement("a");Z.href=L,Z.download=`leads-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(Z),Z.click(),document.body.removeChild(Z),URL.revokeObjectURL(L),n({title:"Leads exported",description:`Successfully exported ${d.length} leads to CSV`})},pe=s=>{const M={new:{variant:"default",label:"New"},contacted:{variant:"secondary",label:"Contacted"},qualified:{variant:"outline",label:"Qualified"},converted:{variant:"default",label:"Converted"}}[s]||{variant:"outline",label:s};return e.jsx($,{variant:M.variant,children:M.label})},fe=s=>{switch(s){case"buyer":return e.jsx(ue,{className:"h-4 w-4"});case"seller":return e.jsx(B,{className:"h-4 w-4"});case"valuation":return e.jsx(X,{className:"h-4 w-4"});default:return e.jsx(q,{className:"h-4 w-4"})}},b=d?.filter(s=>t?s.name.toLowerCase().includes(t.toLowerCase())||s.email.toLowerCase().includes(t.toLowerCase()):!0);return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Lead Management"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mt-0.5 sm:mt-1",children:"Track and follow up with your inquiries"})]}),e.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[e.jsxs(w,{onClick:()=>m(!0),variant:"outline",className:"flex-1 sm:flex-none min-h-[44px] active:scale-95 transition-all",children:[e.jsx(V,{className:"h-4 w-4 mr-2 text-orange-500"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Zapier"})]}),e.jsxs(w,{onClick:W,variant:"outline",disabled:!d||d.length===0,className:"flex-1 sm:flex-none min-h-[44px] active:scale-95 transition-all",children:[e.jsx(Se,{className:"h-4 w-4 mr-2"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Export CSV"}),x?.plan_name==="free"&&e.jsx($,{variant:"secondary",className:"ml-2",children:"Pro"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx(f,{className:"hover:shadow-md transition-shadow",children:e.jsxs(g,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-foreground",children:R.total}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Total Leads"})]})}),e.jsx(f,{className:"hover:shadow-md transition-shadow",children:e.jsxs(g,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:R.new}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"New"})]})}),e.jsx(f,{className:"hover:shadow-md transition-shadow",children:e.jsxs(g,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:R.contacted}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Contacted"})]})}),e.jsx(f,{className:"hover:shadow-md transition-shadow",children:e.jsxs(g,{className:"pt-4 sm:pt-6 pb-4 sm:pb-6",children:[e.jsx("div",{className:"text-xl sm:text-2xl font-bold text-primary",children:R.converted}),e.jsx("div",{className:"text-xs sm:text-sm text-muted-foreground mt-0.5",children:"Converted"})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground pointer-events-none"}),e.jsx("input",{type:"text",placeholder:"Search leads by name or email...",value:t,onChange:s=>k(s.target.value),className:"w-full pl-10 pr-4 py-2.5 sm:py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary text-sm sm:text-base min-h-[44px]"})]}),i.size>0&&e.jsx(f,{className:"bg-blue-50 border-blue-200",children:e.jsx(g,{className:"p-3 sm:p-4",children:e.jsxs("div",{className:"flex items-center justify-between gap-3 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"h-5 w-5 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[i.size," lead",i.size!==1?"s":""," selected"]})]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(G,{onValueChange:_,disabled:u,children:[e.jsx(K,{className:"w-[140px] sm:w-[160px] h-9 bg-white",children:e.jsx(J,{placeholder:"Update status"})}),e.jsxs(Y,{children:[e.jsx(U,{value:"new",children:"New"}),e.jsx(U,{value:"contacted",children:"Contacted"}),e.jsx(U,{value:"qualified",children:"Qualified"}),e.jsx(U,{value:"converted",children:"Converted"}),e.jsx(U,{value:"lost",children:"Lost"})]})]}),e.jsxs(w,{variant:"destructive",size:"sm",onClick:P,disabled:u,className:"gap-2",children:[e.jsx(Me,{className:"h-4 w-4"}),"Delete"]}),e.jsx(w,{variant:"outline",size:"sm",onClick:()=>c(new Set),disabled:u,children:"Clear"})]})]})})})]}),b&&b.length>0&&e.jsx("div",{className:"flex items-center gap-2 px-2",children:e.jsxs("button",{onClick:o,className:"flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors min-h-[44px] px-2",children:[i.size===b.length?e.jsx(re,{className:"h-5 w-5 text-primary"}):e.jsx(le,{className:"h-5 w-5"}),e.jsx("span",{children:"Select all"})]})}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:H?e.jsx(f,{children:e.jsxs(g,{className:"p-6 sm:p-8 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 bg-red-100 rounded-full mb-3 sm:mb-4",children:e.jsx(he,{className:"h-7 w-7 sm:h-8 sm:w-8 text-red-600"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1 sm:mb-2",children:"Failed to load leads"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground mb-4 max-w-sm mx-auto",children:F instanceof Error?F.message:"An unexpected error occurred. Please try again."}),e.jsxs(w,{onClick:()=>D(),variant:"outline",className:"gap-2",children:[e.jsx(Ie,{className:"h-4 w-4"}),"Try Again"]})]})}):z?e.jsxs("div",{className:"space-y-2 sm:space-y-3",role:"status","aria-label":"Loading leads",children:[Array.from({length:4}).map((s,r)=>e.jsx(f,{children:e.jsx(g,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-start gap-4 animate-pulse",children:[e.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-5 w-32 bg-gray-200 rounded"}),e.jsx("div",{className:"h-5 w-16 bg-gray-200 rounded-full"})]}),e.jsx("div",{className:"h-4 w-48 bg-gray-200 rounded"}),e.jsx("div",{className:"h-4 w-36 bg-gray-200 rounded"})]}),e.jsx("div",{className:"h-4 w-20 bg-gray-200 rounded"})]})})},r)),e.jsx("span",{className:"sr-only",children:"Loading leads..."})]}):b&&b.length>0?b.map(s=>e.jsx(f,{className:"hover:shadow-md active:shadow-lg transition-all cursor-pointer",onClick:()=>O(s),children:e.jsx(g,{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 sm:gap-4 flex-1 min-w-0",children:[e.jsx("button",{onClick:r=>a(s.id,r),className:"flex-shrink-0 mt-1 hover:bg-gray-100 rounded p-1 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center",children:i.has(s.id)?e.jsx(re,{className:"h-5 w-5 text-primary"}):e.jsx(le,{className:"h-5 w-5 text-gray-400"})}),e.jsx("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0",children:fe(s.lead_type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx("h3",{className:"font-semibold text-sm sm:text-base text-foreground truncate",children:s.name}),pe(s.status),e.jsx($,{variant:"outline",className:"capitalize text-xs",children:s.lead_type})]}),e.jsxs("div",{className:"space-y-1.5 text-xs sm:text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-2 min-h-[32px]",children:[e.jsx(X,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("a",{href:`mailto:${s.email}`,className:"hover:text-primary active:text-primary-dark break-all",children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-2 min-h-[32px]",children:[e.jsx(B,{className:"h-3 w-3 flex-shrink-0"}),e.jsx("a",{href:`tel:${s.phone}`,className:"hover:text-primary active:text-primary-dark",children:s.phone})]}),s.message&&e.jsx("p",{className:"mt-2 text-foreground line-clamp-2 text-xs sm:text-sm leading-relaxed",children:s.message})]})]})]}),e.jsx("div",{className:"text-left sm:text-right flex-shrink-0 pl-12 sm:pl-0",children:e.jsxs("div",{className:"flex sm:justify-end items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(_e,{className:"h-3 w-3"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]})})]})})},s.id)):e.jsx(f,{children:e.jsxs(g,{className:"p-8 sm:p-12 text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-16 sm:h-16 bg-accent rounded-full mb-3 sm:mb-4",children:e.jsx(q,{className:"h-7 w-7 sm:h-8 sm:w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-foreground mb-1 sm:mb-2",children:"No leads yet"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground max-w-sm mx-auto",children:"Leads will appear here when visitors contact you through your profile"})]})})}),e.jsx(Ue,{open:h,onOpenChange:A,feature:"lead_export",currentPlan:x?.plan_name||"Free",requiredPlan:"Starter"}),e.jsx(Ze,{open:I,onOpenChange:m}),j&&e.jsx(Fe,{lead:j,open:C,onOpenChange:v,onLeadUpdated:()=>D()})]})}export{rs as default};
