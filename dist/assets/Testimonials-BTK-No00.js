import{r as g,j as e}from"./vendor-react-Vgz0BWSF.js";import{a4 as E,a5 as D,ae as I,a6 as U,a7 as $,L as c,I as w,S as k,T,X as L,ap as Y,B as p,u as O,f as P,ab as z,af as J,M as G,_ as Q,aB as V,s as q}from"./index-CEZzrIvr.js";import{U as W}from"./upload-D7IwIPsJ.js";import{u as X}from"./useTestimonials-DNzvXxiW.js";import{u as K,U as Z}from"./UpgradeModal-9VN0GeEm.js";import{L as ee}from"./LimitBanner-CFYnHyOI.js";import{C as M}from"./copy-C-kJPV1T.js";import{u as te}from"./useProfile-BBVz4PDl.js";import{P as A}from"./plus-DmBc-AQq.js";import{S as se}from"./square-pen-BiApeuTi.js";import{T as re}from"./trash-2-ChghqxQQ.js";import"./vendor-charts-DwHIVLWv.js";import"./vendor-data-D8Q-8Ib3.js";import"./vendor-three-4sb3k4hC.js";import"./vendor-ui-B_M8o0qd.js";import"./vendor-animation-DTV5ZUuA.js";import"./alert-BzRboVzW.js";import"./progress-B1rAMDwO.js";import"./triangle-alert-C7KzbMoS.js";function ie({open:b,onOpenChange:m,onSave:n}){const[i,t]=g.useState({clientName:"",rating:5,review:"",propertyType:"",featured:!1}),[o,j]=g.useState(null),s=a=>{const{name:d,value:f}=a.target;t(v=>({...v,[d]:f}))},u=a=>{const d=a.target.files?.[0];if(d){t(v=>({...v,clientPhoto:d}));const f=new FileReader;f.onloadend=()=>{j(f.result)},f.readAsDataURL(d)}},l=()=>{t(a=>({...a,clientPhoto:void 0})),j(null)},y=a=>{a.preventDefault(),n?.(i),m(!1),t({clientName:"",rating:5,review:"",propertyType:"",featured:!1}),j(null)};return e.jsx(E,{open:b,onOpenChange:m,children:e.jsxs(D,{className:"max-w-2xl",children:[e.jsxs(I,{children:[e.jsx(U,{children:"Add Client Testimonial"}),e.jsx($,{children:"Share feedback from satisfied clients to build credibility"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"clientName",children:"Client Name *"}),e.jsx(w,{id:"clientName",name:"clientName",value:i.clientName,onChange:s,placeholder:"John Smith",required:!0}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:'You can use initials for privacy (e.g., "John S.")'})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"propertyType",children:"Property Type *"}),e.jsx(w,{id:"propertyType",name:"propertyType",value:i.propertyType,onChange:s,placeholder:"Single Family Home, Condo, etc.",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(c,{children:"Rating *"}),e.jsx("div",{className:"flex gap-2 mt-2",children:[1,2,3,4,5].map(a=>e.jsx("button",{type:"button",onClick:()=>t(d=>({...d,rating:a})),className:"focus:outline-none",children:e.jsx(k,{className:`h-8 w-8 transition-colors ${a<=i.rating?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},a))})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"review",children:"Testimonial Text *"}),e.jsx(T,{id:"review",name:"review",value:i.review,onChange:s,rows:6,maxLength:500,placeholder:"Share what the client said about working with you...",required:!0}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[i.review.length,"/500 characters"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(c,{children:"Client Photo (Optional)"}),o?e.jsxs("div",{className:"relative inline-block",children:[e.jsx("img",{src:o,alt:"Client preview",className:"w-24 h-24 rounded-full object-cover"}),e.jsx("button",{type:"button",onClick:l,className:"absolute top-0 right-0 p-1 bg-red-500 text-white rounded-full",children:e.jsx(L,{className:"h-3 w-3"})})]}):e.jsxs("div",{className:"border-2 border-dashed border-border rounded-lg p-6 text-center hover:bg-accent/50 transition-colors cursor-pointer",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:u,className:"hidden",id:"photo-upload"}),e.jsxs("label",{htmlFor:"photo-upload",className:"cursor-pointer",children:[e.jsx(W,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload client photo"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG up to 2MB"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"featured",checked:i.featured,onChange:a=>t(d=>({...d,featured:a.target.checked})),className:"rounded border-border"}),e.jsx(c,{htmlFor:"featured",className:"cursor-pointer",children:"Feature this testimonial on my profile"})]}),e.jsxs(Y,{children:[e.jsx(p,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(p,{type:"submit",children:"Add Testimonial"})]})]})]})})}function ae({isOpen:b,onClose:m,onSubmit:n,initialData:i}){const[t,o]=g.useState(i);if(g.useEffect(()=>{o(i)},[i]),!b)return null;const j=s=>{s.preventDefault(),n(t)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-card border border-border rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-card border-b border-border p-4 flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Edit Testimonial"}),e.jsx("button",{onClick:m,className:"p-2 hover:bg-accent rounded-lg transition-colors",children:e.jsx(L,{className:"w-5 h-5"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx(c,{htmlFor:"client_name",children:"Client Name *"}),e.jsx(w,{id:"client_name",value:t.client_name,onChange:s=>o({...t,client_name:s.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"client_title",children:"Client Title"}),e.jsx(w,{id:"client_title",value:t.client_title||"",onChange:s=>o({...t,client_title:s.target.value}),placeholder:"e.g., First-Time Homebuyer"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"rating",children:"Rating *"}),e.jsx(w,{id:"rating",type:"number",min:"1",max:"5",value:t.rating,onChange:s=>o({...t,rating:parseInt(s.target.value)}),required:!0})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"review",children:"Review *"}),e.jsx(T,{id:"review",value:t.review,onChange:s=>o({...t,review:s.target.value}),rows:6,required:!0})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"property_type",children:"Property Type"}),e.jsx(w,{id:"property_type",value:t.property_type||"",onChange:s=>o({...t,property_type:s.target.value}),placeholder:"e.g., Single Family Home"})]}),e.jsxs("div",{children:[e.jsx(c,{htmlFor:"transaction_type",children:"Transaction Type"}),e.jsxs("select",{id:"transaction_type",value:t.transaction_type||"",onChange:s=>o({...t,transaction_type:s.target.value}),className:"w-full px-3 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"",children:"Select type"}),e.jsx("option",{value:"buyer",children:"Buyer"}),e.jsx("option",{value:"seller",children:"Seller"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(p,{type:"button",variant:"outline",onClick:m,className:"flex-1",children:"Cancel"}),e.jsx(p,{type:"submit",className:"flex-1",children:"Save Changes"})]})]})]})})}function le({open:b,onOpenChange:m,username:n,agentName:i}){const[t,o]=g.useState(!1),[j,s]=g.useState(!1),{toast:u}=O(),l=`${window.location.origin}/${n}/review`,y=`Hi there!

I hope you've been enjoying your new home! I wanted to reach out and ask if you'd be willing to share a brief review of your experience working with me.

Your feedback helps me improve my services and helps other clients find the right agent for their needs.

You can leave a review here:
${l}

It only takes a couple of minutes, and I really appreciate your time!

Best regards,
${i}`,a=`Hi! Would you mind leaving a quick review of your experience? It helps me serve clients better: ${l} Thanks! - ${i}`,d=async(h,N="url")=>{try{await navigator.clipboard.writeText(h),N==="url"?(o(!0),setTimeout(()=>o(!1),2e3)):(s(!0),setTimeout(()=>s(!1),2e3)),u({title:"Copied!",description:`${N==="url"?"Review link":"Email template"} copied to clipboard`})}catch{u({title:"Failed to copy",description:"Please copy manually",variant:"destructive"})}},f=()=>{const h=encodeURIComponent(`Request for Testimonial - ${i}`),N=encodeURIComponent(y);window.open(`mailto:?subject=${h}&body=${N}`)},v=()=>{const h=encodeURIComponent(a);window.open(`sms:?&body=${h}`)},S=async()=>{if(navigator.share)try{await navigator.share({title:"Leave a Review",text:"I'd appreciate if you could leave a review of your experience!",url:l})}catch{console.log("Share cancelled")}else d(l)};return e.jsx(E,{open:b,onOpenChange:m,children:e.jsxs(D,{className:"sm:max-w-2xl",children:[e.jsxs(I,{children:[e.jsx(U,{className:"text-2xl",children:"Request Client Testimonial"}),e.jsx($,{children:"Share this link with clients to collect reviews and testimonials"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(c,{className:"text-base font-semibold",children:"Your Review Link"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Send this link to clients so they can leave a review"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(w,{value:l,readOnly:!0,className:"font-mono text-sm"}),e.jsx(p,{onClick:()=>d(l),variant:"outline",size:"icon",children:t?e.jsx(P,{className:"h-4 w-4 text-green-600"}):e.jsx(M,{className:"h-4 w-4"})}),e.jsx(p,{onClick:S,variant:"outline",size:"icon",title:"Share via...",children:e.jsx(z,{className:"h-4 w-4"})}),e.jsx(p,{asChild:!0,variant:"outline",size:"icon",title:"Preview review page",children:e.jsx("a",{href:l,target:"_blank",rel:"noopener noreferrer",children:e.jsx(J,{className:"h-4 w-4"})})})]})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-base font-semibold mb-3 block",children:"Quick Send Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs(p,{onClick:f,variant:"outline",className:"justify-start",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Send via Email"]}),e.jsxs(p,{onClick:v,variant:"outline",className:"justify-start",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Send via SMS"]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(c,{className:"text-base font-semibold",children:"Email Template"}),e.jsx(p,{onClick:()=>d(y,"email"),variant:"ghost",size:"sm",children:j?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 mr-2 text-green-600"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-4 w-4 mr-2"}),"Copy"]})})]}),e.jsx(T,{value:y,readOnly:!0,rows:12,className:"font-mono text-sm resize-none"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"ðŸ’¡ Tip: Customize this template to match your personal style"})]}),e.jsxs("div",{children:[e.jsx(c,{className:"text-base font-semibold mb-2 block",children:"SMS Template"}),e.jsx(T,{value:a,readOnly:!0,rows:3,className:"font-mono text-sm resize-none"})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2 text-blue-900",children:"ðŸ“‹ Best Practices for Requesting Reviews"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"â€¢ Wait 1-2 weeks after closing for best results"}),e.jsx("li",{children:"â€¢ Send a personalized message, not just the link"}),e.jsx("li",{children:"â€¢ Follow up once if no response after 1 week"}),e.jsx("li",{children:"â€¢ Thank clients regardless of whether they leave a review"}),e.jsx("li",{children:"â€¢ Make it easy - include the direct link"})]})]})]})]})})}function Se(){const[b,m]=g.useState(!1),[n,i]=g.useState(null),[t,o]=g.useState(!1),[j,s]=g.useState(!1),{toast:u}=O(),{testimonials:l,addTestimonial:y,deleteTestimonial:a}=X(),{subscription:d,canAdd:f,getLimit:v,getUsage:S}=K(),{profile:h}=te(),N=()=>{if(!f("testimonials")){o(!0);return}m(!0)},_=async r=>{try{await y.mutateAsync(r),u({title:"Testimonial added!",description:"Client review has been added successfully."}),m(!1)}catch{u({title:"Error",description:"Failed to add testimonial. Please try again.",variant:"destructive"})}},B=async r=>{if(confirm("Are you sure you want to delete this testimonial?"))try{await a.mutateAsync(r),u({title:"Testimonial deleted",description:"Client review has been removed."})}catch{u({title:"Error",description:"Failed to delete testimonial.",variant:"destructive"})}},H=async r=>{if(n)try{const{data:{user:x}}=await q.auth.getUser();if(!x)throw new Error("Not authenticated");const{error:C}=await q.from("testimonials").update({client_name:r.client_name,client_title:r.client_title,rating:r.rating,review:r.review,property_type:r.property_type,transaction_type:r.transaction_type,updated_at:new Date().toISOString()}).eq("id",n.id).eq("user_id",x.id);if(C)throw C;u({title:"Testimonial updated!",description:"Client review has been updated successfully."}),i(null),window.location.reload()}catch{u({title:"Error",description:"Failed to update testimonial. Please try again.",variant:"destructive"})}},F=l.length>0?(l.reduce((r,x)=>r+x.rating,0)/l.length).toFixed(1):"0.0",R=r=>e.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((x,C)=>e.jsx(k,{className:`h-4 w-4 ${C<r?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},C))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Testimonials"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Showcase client reviews and success stories"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>s(!0),className:"inline-flex items-center gap-2 px-4 py-2 bg-secondary text-secondary-foreground rounded-lg hover:bg-secondary/80 transition-colors font-medium border border-border",children:[e.jsx(z,{className:"h-4 w-4"}),"Request Testimonial"]}),e.jsxs("button",{onClick:N,className:"inline-flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium",children:[e.jsx(A,{className:"h-4 w-4"}),"Add Testimonial"]})]})]}),d&&v("testimonials")!==1/0&&e.jsx(ee,{feature:"testimonials",current:S("testimonials"),limit:v("testimonials")}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:l.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Reviews"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:F}),e.jsx("div",{className:"flex",children:R(Math.round(parseFloat(F)))})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Average Rating"})]}),e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:l.length}),e.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Reviews"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l.map(r=>e.jsxs("div",{className:"bg-card border border-border rounded-lg p-6 hover:shadow-lg transition-shadow relative",children:[e.jsx("div",{className:"mb-4",children:e.jsx(V,{className:"h-8 w-8 text-primary opacity-20"})}),e.jsxs("p",{className:"text-foreground mb-6 leading-relaxed",children:['"',r.review,'"']}),e.jsx("div",{className:"mb-4",children:R(r.rating)}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-border",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center text-primary font-semibold",children:r.client_name.split(" ").map(x=>x[0]).join("")}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:r.client_name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:r.property_type||"Client"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>i(r),className:"p-2 hover:bg-accent rounded-lg transition-colors",children:e.jsx(se,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx("button",{onClick:()=>B(r.id),className:"p-2 hover:bg-red-50 rounded-lg transition-colors",children:e.jsx(re,{className:"h-4 w-4 text-red-500"})})]})]})]},r.id))}),l.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-accent rounded-full mb-4",children:e.jsx(k,{className:"h-8 w-8 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No testimonials yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Start building social proof by adding client reviews"}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors font-medium",children:[e.jsx(A,{className:"h-5 w-5"}),"Add Your First Testimonial"]})]}),e.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-900 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:["ðŸ’¡ ",e.jsx("strong",{children:"Tip:"})," Featured testimonials will be prominently displayed on your public profile. Ask satisfied clients for reviews after successful transactions!"]})}),e.jsx(ie,{open:b,onOpenChange:m,onSave:_}),n&&e.jsx(ae,{isOpen:!!n,onClose:()=>i(null),onSubmit:H,initialData:{client_name:n.client_name,review:n.review,rating:n.rating,client_title:n.client_title,property_type:n.property_type,transaction_type:n.transaction_type}}),e.jsx(Z,{open:t,onOpenChange:o,feature:"testimonials",currentPlan:d?.plan_name||"Free",requiredPlan:"Starter"}),h&&e.jsx(le,{open:j,onOpenChange:s,username:h.username||"",agentName:h.full_name||""})]})}export{Se as default};
