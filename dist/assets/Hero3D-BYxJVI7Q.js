import{r as T,bx as ln,j as v}from"./index-C8-3SfN2.js";import{a as Ne,u as Ct,b as Ur,V as ue,c as Ze,d as Bt,O as At,R as cn,B as un,e as mr,I as dn,S as vr,f as Mt,T as St,g as Ar,Q as Rr,h as hn,i as fn,j as jr,H as We,F as nt,k as It,L as Je,l as Ht,m as pn,n as mn,o as vn,p as lt,q as kr,r as Br,W as zr,U as rr,s as gn,t as yn,v as ur,w as Tt,x as wn,y as bn,z as En,A as xn,E as _n,G as dr,J as tr,K as Mn,N as Sn,X as Cr,Y as In,Z as Tn,_ as nr,$ as An,a0 as Rn,a1 as Cn,a2 as Pn,a3 as On,a4 as Fn,a5 as Pr,C as Nn}from"./react-three-fiber.esm-Xa50yuxT.js";import{_ as Wt}from"./extends-CF3RwP-h.js";const Yt=new ue,gr=new ue,Dn=new ue,Or=new Ze;function Ln(a,r,i){const t=Yt.setFromMatrixPosition(a.matrixWorld);t.project(r);const s=i.width/2,c=i.height/2;return[t.x*s+s,-(t.y*c)+c]}function Un(a,r){const i=Yt.setFromMatrixPosition(a.matrixWorld),t=gr.setFromMatrixPosition(r.matrixWorld),s=i.sub(t),c=r.getWorldDirection(Dn);return s.angleTo(c)>Math.PI/2}function jn(a,r,i,t){const s=Yt.setFromMatrixPosition(a.matrixWorld),c=s.clone();c.project(r),Or.set(c.x,c.y),i.setFromCamera(Or,r);const h=i.intersectObjects(t,!0);if(h.length){const d=h[0].distance;return s.distanceTo(i.ray.origin)<d}return!0}function kn(a,r){if(r instanceof At)return r.zoom;if(r instanceof Bt){const i=Yt.setFromMatrixPosition(a.matrixWorld),t=gr.setFromMatrixPosition(r.matrixWorld),s=r.fov*Math.PI/180,c=i.distanceTo(t);return 1/(2*Math.tan(s/2)*c)}else return 1}function Bn(a,r,i){if(r instanceof Bt||r instanceof At){const t=Yt.setFromMatrixPosition(a.matrixWorld),s=gr.setFromMatrixPosition(r.matrixWorld),c=t.distanceTo(s),h=(i[1]-i[0])/(r.far-r.near),d=i[1]-h*r.far;return Math.round(h*c+d)}}const hr=a=>Math.abs(a)<1e-10?0:a;function Hr(a,r,i=""){let t="matrix3d(";for(let s=0;s!==16;s++)t+=hr(r[s]*a.elements[s])+(s!==15?",":")");return i+t}const zn=(a=>r=>Hr(r,a))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),Hn=(a=>(r,i)=>Hr(r,a(i),"translate(-50%,-50%)"))(a=>[1/a,1/a,1/a,1,-1/a,-1/a,-1/a,-1,1/a,1/a,1/a,1,1,1,1,1]);function Zn(a){return a&&typeof a=="object"&&"current"in a}const yr=T.forwardRef(({children:a,eps:r=.001,style:i,className:t,prepend:s,center:c,fullscreen:h,portal:d,distanceFactor:f,sprite:g=!1,transform:E=!1,occlude:y,onOcclude:S,castShadow:j,receiveShadow:L,material:W,geometry:Z,zIndexRange:z=[16777271,0],calculatePosition:$=Ln,as:K="div",wrapperClass:Q,pointerEvents:N="auto",...P},ee)=>{const{gl:w,camera:x,scene:F,size:G,raycaster:te,events:q,viewport:H}=Ne(),[X]=T.useState(()=>document.createElement(K)),Y=T.useRef(),de=T.useRef(null),Se=T.useRef(0),be=T.useRef([0,0]),re=T.useRef(null),Ae=T.useRef(null),ae=d?.current||q.connected||w.domElement.parentNode,se=T.useRef(null),xe=T.useRef(!1),Ue=T.useMemo(()=>y&&y!=="blending"||Array.isArray(y)&&y.length&&Zn(y[0]),[y]);T.useLayoutEffect(()=>{const Ie=w.domElement;y&&y==="blending"?(Ie.style.zIndex=`${Math.floor(z[0]/2)}`,Ie.style.position="absolute",Ie.style.pointerEvents="none"):(Ie.style.zIndex=null,Ie.style.position=null,Ie.style.pointerEvents=null)},[y]),T.useLayoutEffect(()=>{if(de.current){const Ie=Y.current=ln.createRoot(X);if(F.updateMatrixWorld(),E)X.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const le=$(de.current,x,G);X.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${le[0]}px,${le[1]}px,0);transform-origin:0 0;`}return ae&&(s?ae.prepend(X):ae.appendChild(X)),()=>{ae&&ae.removeChild(X),Ie.unmount()}}},[ae,E]),T.useLayoutEffect(()=>{Q&&(X.className=Q)},[Q]);const ie=T.useMemo(()=>E?{position:"absolute",top:0,left:0,width:G.width,height:G.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:c?"translate3d(-50%,-50%,0)":"none",...h&&{top:-G.height/2,left:-G.width/2,width:G.width,height:G.height},...i},[i,c,h,G,E]),De=T.useMemo(()=>({position:"absolute",pointerEvents:N}),[N]);T.useLayoutEffect(()=>{if(xe.current=!1,E){var Ie;(Ie=Y.current)==null||Ie.render(T.createElement("div",{ref:re,style:ie},T.createElement("div",{ref:Ae,style:De},T.createElement("div",{ref:ee,className:t,style:i,children:a}))))}else{var le;(le=Y.current)==null||le.render(T.createElement("div",{ref:ee,style:ie,className:t,children:a}))}});const _e=T.useRef(!0);Ct(Ie=>{if(de.current){x.updateMatrixWorld(),de.current.updateWorldMatrix(!0,!1);const le=E?be.current:$(de.current,x,G);if(E||Math.abs(Se.current-x.zoom)>r||Math.abs(be.current[0]-le[0])>r||Math.abs(be.current[1]-le[1])>r){const je=Un(de.current,x);let Pe=!1;Ue&&(Array.isArray(y)?Pe=y.map(ke=>ke.current):y!=="blending"&&(Pe=[F]));const Ye=_e.current;if(Pe){const ke=jn(de.current,x,te,Pe);_e.current=ke&&!je}else _e.current=!je;Ye!==_e.current&&(S?S(!_e.current):X.style.display=_e.current?"block":"none");const et=Math.floor(z[0]/2),Pt=y?Ue?[z[0],et]:[et-1,0]:z;if(X.style.zIndex=`${Bn(de.current,x,Pt)}`,E){const[ke,ut]=[G.width/2,G.height/2],at=x.projectionMatrix.elements[5]*ut,{isOrthographicCamera:yt,top:Ot,left:wt,bottom:it,right:tt}=x,dt=zn(x.matrixWorldInverse),Ft=yt?`scale(${at})translate(${hr(-(tt+wt)/2)}px,${hr((Ot+it)/2)}px)`:`translateZ(${at}px)`;let Be=de.current.matrixWorld;g&&(Be=x.matrixWorldInverse.clone().transpose().copyPosition(Be).scale(de.current.scale),Be.elements[3]=Be.elements[7]=Be.elements[11]=0,Be.elements[15]=1),X.style.width=G.width+"px",X.style.height=G.height+"px",X.style.perspective=yt?"":`${at}px`,re.current&&Ae.current&&(re.current.style.transform=`${Ft}${dt}translate(${ke}px,${ut}px)`,Ae.current.style.transform=Hn(Be,1/((f||10)/400)))}else{const ke=f===void 0?1:kn(de.current,x)*f;X.style.transform=`translate3d(${le[0]}px,${le[1]}px,0) scale(${ke})`}be.current=le,Se.current=x.zoom}}if(!Ue&&se.current&&!xe.current)if(E){if(re.current){const le=re.current.children[0];if(le!=null&&le.clientWidth&&le!=null&&le.clientHeight){const{isOrthographicCamera:je}=x;if(je||Z)P.scale&&(Array.isArray(P.scale)?P.scale instanceof ue?se.current.scale.copy(P.scale.clone().divideScalar(1)):se.current.scale.set(1/P.scale[0],1/P.scale[1],1/P.scale[2]):se.current.scale.setScalar(1/P.scale));else{const Pe=(f||10)/400,Ye=le.clientWidth*Pe,et=le.clientHeight*Pe;se.current.scale.set(Ye,et,1)}xe.current=!0}}}else{const le=X.children[0];if(le!=null&&le.clientWidth&&le!=null&&le.clientHeight){const je=1/H.factor,Pe=le.clientWidth*je,Ye=le.clientHeight*je;se.current.scale.set(Pe,Ye,1),xe.current=!0}se.current.lookAt(Ie.camera.position)}});const gt=T.useMemo(()=>({vertexShader:E?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[E]);return T.createElement("group",Wt({},P,{ref:de}),y&&!Ue&&T.createElement("mesh",{castShadow:j,receiveShadow:L,ref:se},Z||T.createElement("planeGeometry",null),W||T.createElement("shaderMaterial",{side:Ur,vertexShader:gt.vertexShader,fragmentShader:gt.fragmentShader})))}),Zr=parseInt(cn.replace(/\D+/g,""));function Gn(a,r=Math.PI/3){const i=Math.cos(r),t=(1+1e-10)*100,s=[new ue,new ue,new ue],c=new ue,h=new ue,d=new ue,f=new ue;function g(W){const Z=~~(W.x*t),z=~~(W.y*t),$=~~(W.z*t);return`${Z},${z},${$}`}const E=a.index?a.toNonIndexed():a,y=E.attributes.position,S={};for(let W=0,Z=y.count/3;W<Z;W++){const z=3*W,$=s[0].fromBufferAttribute(y,z+0),K=s[1].fromBufferAttribute(y,z+1),Q=s[2].fromBufferAttribute(y,z+2);c.subVectors(Q,K),h.subVectors($,K);const N=new ue().crossVectors(c,h).normalize();for(let P=0;P<3;P++){const ee=s[P],w=g(ee);w in S||(S[w]=[]),S[w].push(N)}}const j=new Float32Array(y.count*3),L=new un(j,3,!1);for(let W=0,Z=y.count/3;W<Z;W++){const z=3*W,$=s[0].fromBufferAttribute(y,z+0),K=s[1].fromBufferAttribute(y,z+1),Q=s[2].fromBufferAttribute(y,z+2);c.subVectors(Q,K),h.subVectors($,K),d.crossVectors(c,h).normalize();for(let N=0;N<3;N++){const P=s[N],ee=g(P),w=S[ee];f.set(0,0,0);for(let x=0,F=w.length;x<F;x++){const G=w[x];d.dot(G)>i&&f.add(G)}f.normalize(),L.setXYZ(z+N,f.x,f.y,f.z)}}return E.setAttribute("normal",L),E}var Ge=Uint8Array,ct=Uint16Array,fr=Uint32Array,Gr=new Ge([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Wr=new Ge([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Wn=new Ge([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Yr=function(a,r){for(var i=new ct(31),t=0;t<31;++t)i[t]=r+=1<<a[t-1];for(var s=new fr(i[30]),t=1;t<30;++t)for(var c=i[t];c<i[t+1];++c)s[c]=c-i[t]<<5|t;return[i,s]},$r=Yr(Gr,2),Xr=$r[0],Yn=$r[1];Xr[28]=258,Yn[258]=28;var $n=Yr(Wr,0),Xn=$n[0],pr=new ct(32768);for(var ge=0;ge<32768;++ge){var st=(ge&43690)>>>1|(ge&21845)<<1;st=(st&52428)>>>2|(st&13107)<<2,st=(st&61680)>>>4|(st&3855)<<4,pr[ge]=((st&65280)>>>8|(st&255)<<8)>>>1}var zt=(function(a,r,i){for(var t=a.length,s=0,c=new ct(r);s<t;++s)++c[a[s]-1];var h=new ct(r);for(s=0;s<r;++s)h[s]=h[s-1]+c[s-1]<<1;var d;if(i){d=new ct(1<<r);var f=15-r;for(s=0;s<t;++s)if(a[s])for(var g=s<<4|a[s],E=r-a[s],y=h[a[s]-1]++<<E,S=y|(1<<E)-1;y<=S;++y)d[pr[y]>>>f]=g}else for(d=new ct(t),s=0;s<t;++s)a[s]&&(d[s]=pr[h[a[s]-1]++]>>>15-a[s]);return d}),$t=new Ge(288);for(var ge=0;ge<144;++ge)$t[ge]=8;for(var ge=144;ge<256;++ge)$t[ge]=9;for(var ge=256;ge<280;++ge)$t[ge]=7;for(var ge=280;ge<288;++ge)$t[ge]=8;var Vr=new Ge(32);for(var ge=0;ge<32;++ge)Vr[ge]=5;var Vn=zt($t,9,1),Kn=zt(Vr,5,1),lr=function(a){for(var r=a[0],i=1;i<a.length;++i)a[i]>r&&(r=a[i]);return r},Ve=function(a,r,i){var t=r/8|0;return(a[t]|a[t+1]<<8)>>(r&7)&i},cr=function(a,r){var i=r/8|0;return(a[i]|a[i+1]<<8|a[i+2]<<16)>>(r&7)},qn=function(a){return(a/8|0)+(a&7&&1)},Qn=function(a,r,i){(i==null||i>a.length)&&(i=a.length);var t=new(a instanceof ct?ct:a instanceof fr?fr:Ge)(i-r);return t.set(a.subarray(r,i)),t},Jn=function(a,r,i){var t=a.length;if(!t||i&&!i.l&&t<5)return r||new Ge(0);var s=!r||i,c=!i||i.i;i||(i={}),r||(r=new Ge(t*3));var h=function(ie){var De=r.length;if(ie>De){var _e=new Ge(Math.max(De*2,ie));_e.set(r),r=_e}},d=i.f||0,f=i.p||0,g=i.b||0,E=i.l,y=i.d,S=i.m,j=i.n,L=t*8;do{if(!E){i.f=d=Ve(a,f,1);var W=Ve(a,f+1,3);if(f+=3,W)if(W==1)E=Vn,y=Kn,S=9,j=5;else if(W==2){var K=Ve(a,f,31)+257,Q=Ve(a,f+10,15)+4,N=K+Ve(a,f+5,31)+1;f+=14;for(var P=new Ge(N),ee=new Ge(19),w=0;w<Q;++w)ee[Wn[w]]=Ve(a,f+w*3,7);f+=Q*3;for(var x=lr(ee),F=(1<<x)-1,G=zt(ee,x,1),w=0;w<N;){var te=G[Ve(a,f,F)];f+=te&15;var Z=te>>>4;if(Z<16)P[w++]=Z;else{var q=0,H=0;for(Z==16?(H=3+Ve(a,f,3),f+=2,q=P[w-1]):Z==17?(H=3+Ve(a,f,7),f+=3):Z==18&&(H=11+Ve(a,f,127),f+=7);H--;)P[w++]=q}}var X=P.subarray(0,K),Y=P.subarray(K);S=lr(X),j=lr(Y),E=zt(X,S,1),y=zt(Y,j,1)}else throw"invalid block type";else{var Z=qn(f)+4,z=a[Z-4]|a[Z-3]<<8,$=Z+z;if($>t){if(c)throw"unexpected EOF";break}s&&h(g+z),r.set(a.subarray(Z,$),g),i.b=g+=z,i.p=f=$*8;continue}if(f>L){if(c)throw"unexpected EOF";break}}s&&h(g+131072);for(var de=(1<<S)-1,Se=(1<<j)-1,be=f;;be=f){var q=E[cr(a,f)&de],re=q>>>4;if(f+=q&15,f>L){if(c)throw"unexpected EOF";break}if(!q)throw"invalid length/literal";if(re<256)r[g++]=re;else if(re==256){be=f,E=null;break}else{var Ae=re-254;if(re>264){var w=re-257,ae=Gr[w];Ae=Ve(a,f,(1<<ae)-1)+Xr[w],f+=ae}var se=y[cr(a,f)&Se],xe=se>>>4;if(!se)throw"invalid distance";f+=se&15;var Y=Xn[xe];if(xe>3){var ae=Wr[xe];Y+=cr(a,f)&(1<<ae)-1,f+=ae}if(f>L){if(c)throw"unexpected EOF";break}s&&h(g+131072);for(var Ue=g+Ae;g<Ue;g+=4)r[g]=r[g-Y],r[g+1]=r[g+1-Y],r[g+2]=r[g+2-Y],r[g+3]=r[g+3-Y];g=Ue}}i.l=E,i.p=be,i.b=g,E&&(d=1,i.m=S,i.d=y,i.n=j)}while(!d);return g==r.length?r:Qn(r,0,g)},ea=new Ge(0),ta=function(a){if((a[0]&15)!=8||a[0]>>>4>7||(a[0]<<8|a[1])%31)throw"invalid zlib data";if(a[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function qt(a,r){return Jn((ta(a),a.subarray(2,-4)),r)}var ra=typeof TextDecoder<"u"&&new TextDecoder,na=0;try{ra.decode(ea,{stream:!0}),na=1}catch{}const aa=a=>a&&a.isCubeTexture;class ia extends mr{constructor(r,i){var t,s;const c=aa(r),d=((s=c?(t=r.image[0])==null?void 0:t.width:r.image.width)!=null?s:1024)/4,f=Math.floor(Math.log2(d)),g=Math.pow(2,f),E=3*Math.max(g,112),y=4*g,S=[c?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/E}`,`#define CUBEUV_TEXEL_HEIGHT ${1/y}`,`#define CUBEUV_MAX_MIP ${f}.0`],j=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,L=S.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${Zr>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,W={map:{value:r},height:{value:i?.height||15},radius:{value:i?.radius||100}},Z=new dn(1,16),z=new vr({uniforms:W,fragmentShader:L,vertexShader:j,side:Ur});super(Z,z)}set radius(r){this.material.uniforms.radius.value=r}get radius(){return this.material.uniforms.radius.value}set height(r){this.material.uniforms.height.value=r}get height(){return this.material.uniforms.height.value}}var oa=Object.defineProperty,sa=(a,r,i)=>r in a?oa(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,la=(a,r,i)=>(sa(a,r+"",i),i);class ca{constructor(){la(this,"_listeners")}addEventListener(r,i){this._listeners===void 0&&(this._listeners={});const t=this._listeners;t[r]===void 0&&(t[r]=[]),t[r].indexOf(i)===-1&&t[r].push(i)}hasEventListener(r,i){if(this._listeners===void 0)return!1;const t=this._listeners;return t[r]!==void 0&&t[r].indexOf(i)!==-1}removeEventListener(r,i){if(this._listeners===void 0)return;const s=this._listeners[r];if(s!==void 0){const c=s.indexOf(i);c!==-1&&s.splice(c,1)}}dispatchEvent(r){if(this._listeners===void 0)return;const t=this._listeners[r.type];if(t!==void 0){r.target=this;const s=t.slice(0);for(let c=0,h=s.length;c<h;c++)s[c].call(this,r);r.target=null}}}var ua=Object.defineProperty,da=(a,r,i)=>r in a?ua(a,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[r]=i,B=(a,r,i)=>(da(a,typeof r!="symbol"?r+"":r,i),i);const Qt=new hn,Fr=new fn,ha=Math.cos(70*(Math.PI/180)),Nr=(a,r)=>(a%r+r)%r;let fa=class extends ca{constructor(r,i){super(),B(this,"object"),B(this,"domElement"),B(this,"enabled",!0),B(this,"target",new ue),B(this,"minDistance",0),B(this,"maxDistance",1/0),B(this,"minZoom",0),B(this,"maxZoom",1/0),B(this,"minPolarAngle",0),B(this,"maxPolarAngle",Math.PI),B(this,"minAzimuthAngle",-1/0),B(this,"maxAzimuthAngle",1/0),B(this,"enableDamping",!1),B(this,"dampingFactor",.05),B(this,"enableZoom",!0),B(this,"zoomSpeed",1),B(this,"enableRotate",!0),B(this,"rotateSpeed",1),B(this,"enablePan",!0),B(this,"panSpeed",1),B(this,"screenSpacePanning",!0),B(this,"keyPanSpeed",7),B(this,"zoomToCursor",!1),B(this,"autoRotate",!1),B(this,"autoRotateSpeed",2),B(this,"reverseOrbit",!1),B(this,"reverseHorizontalOrbit",!1),B(this,"reverseVerticalOrbit",!1),B(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),B(this,"mouseButtons",{LEFT:Mt.ROTATE,MIDDLE:Mt.DOLLY,RIGHT:Mt.PAN}),B(this,"touches",{ONE:St.ROTATE,TWO:St.DOLLY_PAN}),B(this,"target0"),B(this,"position0"),B(this,"zoom0"),B(this,"_domElementKeyEvents",null),B(this,"getPolarAngle"),B(this,"getAzimuthalAngle"),B(this,"setPolarAngle"),B(this,"setAzimuthalAngle"),B(this,"getDistance"),B(this,"getZoomScale"),B(this,"listenToKeyEvents"),B(this,"stopListenToKeyEvents"),B(this,"saveState"),B(this,"reset"),B(this,"update"),B(this,"connect"),B(this,"dispose"),B(this,"dollyIn"),B(this,"dollyOut"),B(this,"getScale"),B(this,"setScale"),this.object=r,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>E.phi,this.getAzimuthalAngle=()=>E.theta,this.setPolarAngle=l=>{let _=Nr(l,2*Math.PI),D=E.phi;D<0&&(D+=2*Math.PI),_<0&&(_+=2*Math.PI);let oe=Math.abs(_-D);2*Math.PI-oe<oe&&(_<D?_+=2*Math.PI:D+=2*Math.PI),y.phi=_-D,t.update()},this.setAzimuthalAngle=l=>{let _=Nr(l,2*Math.PI),D=E.theta;D<0&&(D+=2*Math.PI),_<0&&(_+=2*Math.PI);let oe=Math.abs(_-D);2*Math.PI-oe<oe&&(_<D?_+=2*Math.PI:D+=2*Math.PI),y.theta=_-D,t.update()},this.getDistance=()=>t.object.position.distanceTo(t.target),this.listenToKeyEvents=l=>{l.addEventListener("keydown",bt),this._domElementKeyEvents=l},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",bt),this._domElementKeyEvents=null},this.saveState=()=>{t.target0.copy(t.target),t.position0.copy(t.object.position),t.zoom0=t.object.zoom},this.reset=()=>{t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),t.dispatchEvent(s),t.update(),f=d.NONE},this.update=(()=>{const l=new ue,_=new ue(0,1,0),D=new Rr().setFromUnitVectors(r.up,_),oe=D.clone().invert(),I=new ue,Oe=new Rr,Ke=2*Math.PI;return function(){const Vt=t.object.position;D.setFromUnitVectors(r.up,_),oe.copy(D).invert(),l.copy(Vt).sub(t.target),l.applyQuaternion(D),E.setFromVector3(l),t.autoRotate&&f===d.NONE&&H(te()),t.enableDamping?(E.theta+=y.theta*t.dampingFactor,E.phi+=y.phi*t.dampingFactor):(E.theta+=y.theta,E.phi+=y.phi);let $e=t.minAzimuthAngle,Xe=t.maxAzimuthAngle;isFinite($e)&&isFinite(Xe)&&($e<-Math.PI?$e+=Ke:$e>Math.PI&&($e-=Ke),Xe<-Math.PI?Xe+=Ke:Xe>Math.PI&&(Xe-=Ke),$e<=Xe?E.theta=Math.max($e,Math.min(Xe,E.theta)):E.theta=E.theta>($e+Xe)/2?Math.max($e,E.theta):Math.min(Xe,E.theta)),E.phi=Math.max(t.minPolarAngle,Math.min(t.maxPolarAngle,E.phi)),E.makeSafe(),t.enableDamping===!0?t.target.addScaledVector(j,t.dampingFactor):t.target.add(j),t.zoomToCursor&&x||t.object.isOrthographicCamera?E.radius=se(E.radius):E.radius=se(E.radius*S),l.setFromSpherical(E),l.applyQuaternion(oe),Vt.copy(t.target).add(l),t.object.matrixAutoUpdate||t.object.updateMatrix(),t.object.lookAt(t.target),t.enableDamping===!0?(y.theta*=1-t.dampingFactor,y.phi*=1-t.dampingFactor,j.multiplyScalar(1-t.dampingFactor)):(y.set(0,0,0),j.set(0,0,0));let ft=!1;if(t.zoomToCursor&&x){let pt=null;if(t.object instanceof Bt&&t.object.isPerspectiveCamera){const mt=l.length();pt=se(mt*S);const _t=mt-pt;t.object.position.addScaledVector(ee,_t),t.object.updateMatrixWorld()}else if(t.object.isOrthographicCamera){const mt=new ue(w.x,w.y,0);mt.unproject(t.object),t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/S)),t.object.updateProjectionMatrix(),ft=!0;const _t=new ue(w.x,w.y,0);_t.unproject(t.object),t.object.position.sub(_t).add(mt),t.object.updateMatrixWorld(),pt=l.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),t.zoomToCursor=!1;pt!==null&&(t.screenSpacePanning?t.target.set(0,0,-1).transformDirection(t.object.matrix).multiplyScalar(pt).add(t.object.position):(Qt.origin.copy(t.object.position),Qt.direction.set(0,0,-1).transformDirection(t.object.matrix),Math.abs(t.object.up.dot(Qt.direction))<ha?r.lookAt(t.target):(Fr.setFromNormalAndCoplanarPoint(t.object.up,t.target),Qt.intersectPlane(Fr,t.target))))}else t.object instanceof At&&t.object.isOrthographicCamera&&(ft=S!==1,ft&&(t.object.zoom=Math.max(t.minZoom,Math.min(t.maxZoom,t.object.zoom/S)),t.object.updateProjectionMatrix()));return S=1,x=!1,ft||I.distanceToSquared(t.object.position)>g||8*(1-Oe.dot(t.object.quaternion))>g?(t.dispatchEvent(s),I.copy(t.object.position),Oe.copy(t.object.quaternion),ft=!1,!0):!1}})(),this.connect=l=>{t.domElement=l,t.domElement.style.touchAction="none",t.domElement.addEventListener("contextmenu",Xt),t.domElement.addEventListener("pointerdown",wt),t.domElement.addEventListener("pointercancel",tt),t.domElement.addEventListener("wheel",Be)},this.dispose=()=>{var l,_,D,oe,I,Oe;t.domElement&&(t.domElement.style.touchAction="auto"),(l=t.domElement)==null||l.removeEventListener("contextmenu",Xt),(_=t.domElement)==null||_.removeEventListener("pointerdown",wt),(D=t.domElement)==null||D.removeEventListener("pointercancel",tt),(oe=t.domElement)==null||oe.removeEventListener("wheel",Be),(I=t.domElement)==null||I.ownerDocument.removeEventListener("pointermove",it),(Oe=t.domElement)==null||Oe.ownerDocument.removeEventListener("pointerup",tt),t._domElementKeyEvents!==null&&t._domElementKeyEvents.removeEventListener("keydown",bt)};const t=this,s={type:"change"},c={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let f=d.NONE;const g=1e-6,E=new Ar,y=new Ar;let S=1;const j=new ue,L=new Ze,W=new Ze,Z=new Ze,z=new Ze,$=new Ze,K=new Ze,Q=new Ze,N=new Ze,P=new Ze,ee=new ue,w=new Ze;let x=!1;const F=[],G={};function te(){return 2*Math.PI/60/60*t.autoRotateSpeed}function q(){return Math.pow(.95,t.zoomSpeed)}function H(l){t.reverseOrbit||t.reverseHorizontalOrbit?y.theta+=l:y.theta-=l}function X(l){t.reverseOrbit||t.reverseVerticalOrbit?y.phi+=l:y.phi-=l}const Y=(()=>{const l=new ue;return function(D,oe){l.setFromMatrixColumn(oe,0),l.multiplyScalar(-D),j.add(l)}})(),de=(()=>{const l=new ue;return function(D,oe){t.screenSpacePanning===!0?l.setFromMatrixColumn(oe,1):(l.setFromMatrixColumn(oe,0),l.crossVectors(t.object.up,l)),l.multiplyScalar(D),j.add(l)}})(),Se=(()=>{const l=new ue;return function(D,oe){const I=t.domElement;if(I&&t.object instanceof Bt&&t.object.isPerspectiveCamera){const Oe=t.object.position;l.copy(Oe).sub(t.target);let Ke=l.length();Ke*=Math.tan(t.object.fov/2*Math.PI/180),Y(2*D*Ke/I.clientHeight,t.object.matrix),de(2*oe*Ke/I.clientHeight,t.object.matrix)}else I&&t.object instanceof At&&t.object.isOrthographicCamera?(Y(D*(t.object.right-t.object.left)/t.object.zoom/I.clientWidth,t.object.matrix),de(oe*(t.object.top-t.object.bottom)/t.object.zoom/I.clientHeight,t.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),t.enablePan=!1)}})();function be(l){t.object instanceof Bt&&t.object.isPerspectiveCamera||t.object instanceof At&&t.object.isOrthographicCamera?S=l:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),t.enableZoom=!1)}function re(l){be(S/l)}function Ae(l){be(S*l)}function ae(l){if(!t.zoomToCursor||!t.domElement)return;x=!0;const _=t.domElement.getBoundingClientRect(),D=l.clientX-_.left,oe=l.clientY-_.top,I=_.width,Oe=_.height;w.x=D/I*2-1,w.y=-(oe/Oe)*2+1,ee.set(w.x,w.y,1).unproject(t.object).sub(t.object.position).normalize()}function se(l){return Math.max(t.minDistance,Math.min(t.maxDistance,l))}function xe(l){L.set(l.clientX,l.clientY)}function Ue(l){ae(l),Q.set(l.clientX,l.clientY)}function ie(l){z.set(l.clientX,l.clientY)}function De(l){W.set(l.clientX,l.clientY),Z.subVectors(W,L).multiplyScalar(t.rotateSpeed);const _=t.domElement;_&&(H(2*Math.PI*Z.x/_.clientHeight),X(2*Math.PI*Z.y/_.clientHeight)),L.copy(W),t.update()}function _e(l){N.set(l.clientX,l.clientY),P.subVectors(N,Q),P.y>0?re(q()):P.y<0&&Ae(q()),Q.copy(N),t.update()}function gt(l){$.set(l.clientX,l.clientY),K.subVectors($,z).multiplyScalar(t.panSpeed),Se(K.x,K.y),z.copy($),t.update()}function Ie(l){ae(l),l.deltaY<0?Ae(q()):l.deltaY>0&&re(q()),t.update()}function le(l){let _=!1;switch(l.code){case t.keys.UP:Se(0,t.keyPanSpeed),_=!0;break;case t.keys.BOTTOM:Se(0,-t.keyPanSpeed),_=!0;break;case t.keys.LEFT:Se(t.keyPanSpeed,0),_=!0;break;case t.keys.RIGHT:Se(-t.keyPanSpeed,0),_=!0;break}_&&(l.preventDefault(),t.update())}function je(){if(F.length==1)L.set(F[0].pageX,F[0].pageY);else{const l=.5*(F[0].pageX+F[1].pageX),_=.5*(F[0].pageY+F[1].pageY);L.set(l,_)}}function Pe(){if(F.length==1)z.set(F[0].pageX,F[0].pageY);else{const l=.5*(F[0].pageX+F[1].pageX),_=.5*(F[0].pageY+F[1].pageY);z.set(l,_)}}function Ye(){const l=F[0].pageX-F[1].pageX,_=F[0].pageY-F[1].pageY,D=Math.sqrt(l*l+_*_);Q.set(0,D)}function et(){t.enableZoom&&Ye(),t.enablePan&&Pe()}function Pt(){t.enableZoom&&Ye(),t.enableRotate&&je()}function ke(l){if(F.length==1)W.set(l.pageX,l.pageY);else{const D=xt(l),oe=.5*(l.pageX+D.x),I=.5*(l.pageY+D.y);W.set(oe,I)}Z.subVectors(W,L).multiplyScalar(t.rotateSpeed);const _=t.domElement;_&&(H(2*Math.PI*Z.x/_.clientHeight),X(2*Math.PI*Z.y/_.clientHeight)),L.copy(W)}function ut(l){if(F.length==1)$.set(l.pageX,l.pageY);else{const _=xt(l),D=.5*(l.pageX+_.x),oe=.5*(l.pageY+_.y);$.set(D,oe)}K.subVectors($,z).multiplyScalar(t.panSpeed),Se(K.x,K.y),z.copy($)}function at(l){const _=xt(l),D=l.pageX-_.x,oe=l.pageY-_.y,I=Math.sqrt(D*D+oe*oe);N.set(0,I),P.set(0,Math.pow(N.y/Q.y,t.zoomSpeed)),re(P.y),Q.copy(N)}function yt(l){t.enableZoom&&at(l),t.enablePan&&ut(l)}function Ot(l){t.enableZoom&&at(l),t.enableRotate&&ke(l)}function wt(l){var _,D;t.enabled!==!1&&(F.length===0&&((_=t.domElement)==null||_.ownerDocument.addEventListener("pointermove",it),(D=t.domElement)==null||D.ownerDocument.addEventListener("pointerup",tt)),sr(l),l.pointerType==="touch"?Et(l):dt(l))}function it(l){t.enabled!==!1&&(l.pointerType==="touch"?or(l):Ft(l))}function tt(l){var _,D,oe;ht(l),F.length===0&&((_=t.domElement)==null||_.releasePointerCapture(l.pointerId),(D=t.domElement)==null||D.ownerDocument.removeEventListener("pointermove",it),(oe=t.domElement)==null||oe.ownerDocument.removeEventListener("pointerup",tt)),t.dispatchEvent(h),f=d.NONE}function dt(l){let _;switch(l.button){case 0:_=t.mouseButtons.LEFT;break;case 1:_=t.mouseButtons.MIDDLE;break;case 2:_=t.mouseButtons.RIGHT;break;default:_=-1}switch(_){case Mt.DOLLY:if(t.enableZoom===!1)return;Ue(l),f=d.DOLLY;break;case Mt.ROTATE:if(l.ctrlKey||l.metaKey||l.shiftKey){if(t.enablePan===!1)return;ie(l),f=d.PAN}else{if(t.enableRotate===!1)return;xe(l),f=d.ROTATE}break;case Mt.PAN:if(l.ctrlKey||l.metaKey||l.shiftKey){if(t.enableRotate===!1)return;xe(l),f=d.ROTATE}else{if(t.enablePan===!1)return;ie(l),f=d.PAN}break;default:f=d.NONE}f!==d.NONE&&t.dispatchEvent(c)}function Ft(l){if(t.enabled!==!1)switch(f){case d.ROTATE:if(t.enableRotate===!1)return;De(l);break;case d.DOLLY:if(t.enableZoom===!1)return;_e(l);break;case d.PAN:if(t.enablePan===!1)return;gt(l);break}}function Be(l){t.enabled===!1||t.enableZoom===!1||f!==d.NONE&&f!==d.ROTATE||(l.preventDefault(),t.dispatchEvent(c),Ie(l),t.dispatchEvent(h))}function bt(l){t.enabled===!1||t.enablePan===!1||le(l)}function Et(l){switch(Te(l),F.length){case 1:switch(t.touches.ONE){case St.ROTATE:if(t.enableRotate===!1)return;je(),f=d.TOUCH_ROTATE;break;case St.PAN:if(t.enablePan===!1)return;Pe(),f=d.TOUCH_PAN;break;default:f=d.NONE}break;case 2:switch(t.touches.TWO){case St.DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;et(),f=d.TOUCH_DOLLY_PAN;break;case St.DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Pt(),f=d.TOUCH_DOLLY_ROTATE;break;default:f=d.NONE}break;default:f=d.NONE}f!==d.NONE&&t.dispatchEvent(c)}function or(l){switch(Te(l),f){case d.TOUCH_ROTATE:if(t.enableRotate===!1)return;ke(l),t.update();break;case d.TOUCH_PAN:if(t.enablePan===!1)return;ut(l),t.update();break;case d.TOUCH_DOLLY_PAN:if(t.enableZoom===!1&&t.enablePan===!1)return;yt(l),t.update();break;case d.TOUCH_DOLLY_ROTATE:if(t.enableZoom===!1&&t.enableRotate===!1)return;Ot(l),t.update();break;default:f=d.NONE}}function Xt(l){t.enabled!==!1&&l.preventDefault()}function sr(l){F.push(l)}function ht(l){delete G[l.pointerId];for(let _=0;_<F.length;_++)if(F[_].pointerId==l.pointerId){F.splice(_,1);return}}function Te(l){let _=G[l.pointerId];_===void 0&&(_=new Ze,G[l.pointerId]=_),_.set(l.pageX,l.pageY)}function xt(l){const _=l.pointerId===F[0].pointerId?F[1]:F[0];return G[_.pointerId]}this.dollyIn=(l=q())=>{Ae(l),t.update()},this.dollyOut=(l=q())=>{re(l),t.update()},this.getScale=()=>S,this.setScale=l=>{be(l),t.update()},this.getZoomScale=()=>q(),i!==void 0&&this.connect(i),this.update()}};class pa extends jr{constructor(r){super(r),this.type=We}parse(r){const h=function(w,x){switch(w){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(x||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(x||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(x||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(x||""))}},y=function(w,x,F){x=x||1024;let te=w.pos,q=-1,H=0,X="",Y=String.fromCharCode.apply(null,new Uint16Array(w.subarray(te,te+128)));for(;0>(q=Y.indexOf(`
`))&&H<x&&te<w.byteLength;)X+=Y,H+=Y.length,te+=128,Y+=String.fromCharCode.apply(null,new Uint16Array(w.subarray(te,te+128)));return-1<q?(w.pos+=H+q+1,X+Y.slice(0,q)):!1},S=function(w){const x=/^#\?(\S+)/,F=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,G=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,te=/^\s*FORMAT=(\S+)\s*$/,q=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,H={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let X,Y;for((w.pos>=w.byteLength||!(X=y(w)))&&h(1,"no header found"),(Y=X.match(x))||h(3,"bad initial token"),H.valid|=1,H.programtype=Y[1],H.string+=X+`
`;X=y(w),X!==!1;){if(H.string+=X+`
`,X.charAt(0)==="#"){H.comments+=X+`
`;continue}if((Y=X.match(F))&&(H.gamma=parseFloat(Y[1])),(Y=X.match(G))&&(H.exposure=parseFloat(Y[1])),(Y=X.match(te))&&(H.valid|=2,H.format=Y[1]),(Y=X.match(q))&&(H.valid|=4,H.height=parseInt(Y[1],10),H.width=parseInt(Y[2],10)),H.valid&2&&H.valid&4)break}return H.valid&2||h(3,"missing format specifier"),H.valid&4||h(3,"missing image size specifier"),H},j=function(w,x,F){const G=x;if(G<8||G>32767||w[0]!==2||w[1]!==2||w[2]&128)return new Uint8Array(w);G!==(w[2]<<8|w[3])&&h(3,"wrong scanline width");const te=new Uint8Array(4*x*F);te.length||h(4,"unable to allocate buffer space");let q=0,H=0;const X=4*G,Y=new Uint8Array(4),de=new Uint8Array(X);let Se=F;for(;Se>0&&H<w.byteLength;){H+4>w.byteLength&&h(1),Y[0]=w[H++],Y[1]=w[H++],Y[2]=w[H++],Y[3]=w[H++],(Y[0]!=2||Y[1]!=2||(Y[2]<<8|Y[3])!=G)&&h(3,"bad rgbe scanline format");let be=0,re;for(;be<X&&H<w.byteLength;){re=w[H++];const ae=re>128;if(ae&&(re-=128),(re===0||be+re>X)&&h(3,"bad scanline data"),ae){const se=w[H++];for(let xe=0;xe<re;xe++)de[be++]=se}else de.set(w.subarray(H,H+re),be),be+=re,H+=re}const Ae=G;for(let ae=0;ae<Ae;ae++){let se=0;te[q]=de[ae+se],se+=G,te[q+1]=de[ae+se],se+=G,te[q+2]=de[ae+se],se+=G,te[q+3]=de[ae+se],q+=4}Se--}return te},L=function(w,x,F,G){const te=w[x+3],q=Math.pow(2,te-128)/255;F[G+0]=w[x+0]*q,F[G+1]=w[x+1]*q,F[G+2]=w[x+2]*q,F[G+3]=1},W=function(w,x,F,G){const te=w[x+3],q=Math.pow(2,te-128)/255;F[G+0]=It.toHalfFloat(Math.min(w[x+0]*q,65504)),F[G+1]=It.toHalfFloat(Math.min(w[x+1]*q,65504)),F[G+2]=It.toHalfFloat(Math.min(w[x+2]*q,65504)),F[G+3]=It.toHalfFloat(1)},Z=new Uint8Array(r);Z.pos=0;const z=S(Z),$=z.width,K=z.height,Q=j(Z.subarray(Z.pos),$,K);let N,P,ee;switch(this.type){case nt:ee=Q.length/4;const w=new Float32Array(ee*4);for(let F=0;F<ee;F++)L(Q,F*4,w,F*4);N=w,P=nt;break;case We:ee=Q.length/4;const x=new Uint16Array(ee*4);for(let F=0;F<ee;F++)W(Q,F*4,x,F*4);N=x,P=We;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:$,height:K,data:N,header:z.string,gamma:z.gamma,exposure:z.exposure,type:P}}setDataType(r){return this.type=r,this}load(r,i,t,s){function c(h,d){switch(h.type){case nt:case We:"colorSpace"in h?h.colorSpace="srgb-linear":h.encoding=3e3,h.minFilter=Je,h.magFilter=Je,h.generateMipmaps=!1,h.flipY=!0;break}i&&i(h,d)}return super.load(r,c,t,s)}}const Ut=Zr>=152;class ma extends jr{constructor(r){super(r),this.type=We}parse(r){const x=Math.pow(2.7182818,2.2);function F(e,n){for(var o=0,u=0;u<65536;++u)(u==0||e[u>>3]&1<<(u&7))&&(n[o++]=u);for(var p=o-1;o<65536;)n[o++]=0;return p}function G(e){for(var n=0;n<16384;n++)e[n]={},e[n].len=0,e[n].lit=0,e[n].p=null}const te={l:0,c:0,lc:0};function q(e,n,o,u,p){for(;o<e;)n=n<<8|xt(u,p),o+=8;o-=e,te.l=n>>o&(1<<e)-1,te.c=n,te.lc=o}const H=new Array(59);function X(e){for(var n=0;n<=58;++n)H[n]=0;for(var n=0;n<65537;++n)H[e[n]]+=1;for(var o=0,n=58;n>0;--n){var u=o+H[n]>>1;H[n]=o,o=u}for(var n=0;n<65537;++n){var p=e[n];p>0&&(e[n]=p|H[p]++<<6)}}function Y(e,n,o,u,p,m,M){for(var b=o,C=0,R=0;p<=m;p++){if(b.value-o.value>u)return!1;q(6,C,R,e,b);var O=te.l;if(C=te.c,R=te.lc,M[p]=O,O==63){if(b.value-o.value>u)throw"Something wrong with hufUnpackEncTable";q(8,C,R,e,b);var A=te.l+6;if(C=te.c,R=te.lc,p+A>m+1)throw"Something wrong with hufUnpackEncTable";for(;A--;)M[p++]=0;p--}else if(O>=59){var A=O-59+2;if(p+A>m+1)throw"Something wrong with hufUnpackEncTable";for(;A--;)M[p++]=0;p--}}X(M)}function de(e){return e&63}function Se(e){return e>>6}function be(e,n,o,u){for(;n<=o;n++){var p=Se(e[n]),m=de(e[n]);if(p>>m)throw"Invalid table entry";if(m>14){var M=u[p>>m-14];if(M.len)throw"Invalid table entry";if(M.lit++,M.p){var b=M.p;M.p=new Array(M.lit);for(var C=0;C<M.lit-1;++C)M.p[C]=b[C]}else M.p=new Array(1);M.p[M.lit-1]=n}else if(m)for(var R=0,C=1<<14-m;C>0;C--){var M=u[(p<<14-m)+R];if(M.len||M.p)throw"Invalid table entry";M.len=m,M.lit=n,R++}}return!0}const re={c:0,lc:0};function Ae(e,n,o,u){e=e<<8|xt(o,u),n+=8,re.c=e,re.lc=n}const ae={c:0,lc:0};function se(e,n,o,u,p,m,M,b,C,R){if(e==n){u<8&&(Ae(o,u,p,M),o=re.c,u=re.lc),u-=8;var O=o>>u,O=new Uint8Array([O])[0];if(C.value+O>R)return!1;for(var A=b[C.value-1];O-- >0;)b[C.value++]=A}else if(C.value<R)b[C.value++]=e;else return!1;ae.c=o,ae.lc=u}function xe(e){return e&65535}function Ue(e){var n=xe(e);return n>32767?n-65536:n}const ie={a:0,b:0};function De(e,n){var o=Ue(e),u=Ue(n),p=u,m=o+(p&1)+(p>>1),M=m,b=m-p;ie.a=M,ie.b=b}function _e(e,n){var o=xe(e),u=xe(n),p=o-(u>>1)&65535,m=u+p-32768&65535;ie.a=m,ie.b=p}function gt(e,n,o,u,p,m,M){for(var b=M<16384,C=o>p?p:o,R=1,O;R<=C;)R<<=1;for(R>>=1,O=R,R>>=1;R>=1;){for(var A=0,we=A+m*(p-O),U=m*R,k=m*O,V=u*R,J=u*O,he,pe,Ee,Fe;A<=we;A+=k){for(var me=A,qe=A+u*(o-O);me<=qe;me+=J){var ve=me+V,Me=me+U,rt=Me+V;b?(De(e[me+n],e[Me+n]),he=ie.a,Ee=ie.b,De(e[ve+n],e[rt+n]),pe=ie.a,Fe=ie.b,De(he,pe),e[me+n]=ie.a,e[ve+n]=ie.b,De(Ee,Fe),e[Me+n]=ie.a,e[rt+n]=ie.b):(_e(e[me+n],e[Me+n]),he=ie.a,Ee=ie.b,_e(e[ve+n],e[rt+n]),pe=ie.a,Fe=ie.b,_e(he,pe),e[me+n]=ie.a,e[ve+n]=ie.b,_e(Ee,Fe),e[Me+n]=ie.a,e[rt+n]=ie.b)}if(o&R){var Me=me+U;b?De(e[me+n],e[Me+n]):_e(e[me+n],e[Me+n]),he=ie.a,e[Me+n]=ie.b,e[me+n]=he}}if(p&R)for(var me=A,qe=A+u*(o-O);me<=qe;me+=J){var ve=me+V;b?De(e[me+n],e[ve+n]):_e(e[me+n],e[ve+n]),he=ie.a,e[ve+n]=ie.b,e[me+n]=he}O=R,R>>=1}return A}function Ie(e,n,o,u,p,m,M,b,C,R){for(var O=0,A=0,we=b,U=Math.trunc(p.value+(m+7)/8);p.value<U;)for(Ae(O,A,o,p),O=re.c,A=re.lc;A>=14;){var k=O>>A-14&16383,V=n[k];if(V.len)A-=V.len,se(V.lit,M,O,A,o,u,p,C,R,we),O=ae.c,A=ae.lc;else{if(!V.p)throw"hufDecode issues";var J;for(J=0;J<V.lit;J++){for(var he=de(e[V.p[J]]);A<he&&p.value<U;)Ae(O,A,o,p),O=re.c,A=re.lc;if(A>=he&&Se(e[V.p[J]])==(O>>A-he&(1<<he)-1)){A-=he,se(V.p[J],M,O,A,o,u,p,C,R,we),O=ae.c,A=ae.lc;break}}if(J==V.lit)throw"hufDecode issues"}}var pe=8-m&7;for(O>>=pe,A-=pe;A>0;){var V=n[O<<14-A&16383];if(V.len)A-=V.len,se(V.lit,M,O,A,o,u,p,C,R,we),O=ae.c,A=ae.lc;else throw"hufDecode issues"}return!0}function le(e,n,o,u,p,m){var M={value:0},b=o.value,C=Te(n,o),R=Te(n,o);o.value+=4;var O=Te(n,o);if(o.value+=4,C<0||C>=65537||R<0||R>=65537)throw"Something wrong with HUF_ENCSIZE";var A=new Array(65537),we=new Array(16384);G(we);var U=u-(o.value-b);if(Y(e,n,o,U,C,R,A),O>8*(u-(o.value-b)))throw"Something wrong with hufUncompress";be(A,C,R,we),Ie(A,we,e,n,o,O,R,m,p,M)}function je(e,n,o){for(var u=0;u<o;++u)n[u]=e[n[u]]}function Pe(e){for(var n=1;n<e.length;n++){var o=e[n-1]+e[n]-128;e[n]=o}}function Ye(e,n){for(var o=0,u=Math.floor((e.length+1)/2),p=0,m=e.length-1;!(p>m||(n[p++]=e[o++],p>m));)n[p++]=e[u++]}function et(e){for(var n=e.byteLength,o=new Array,u=0,p=new DataView(e);n>0;){var m=p.getInt8(u++);if(m<0){var M=-m;n-=M+1;for(var b=0;b<M;b++)o.push(p.getUint8(u++))}else{var M=m;n-=2;for(var C=p.getUint8(u++),b=0;b<M+1;b++)o.push(C)}}return o}function Pt(e,n,o,u,p,m){var ve=new DataView(m.buffer),M=o[e.idx[0]].width,b=o[e.idx[0]].height,C=3,R=Math.floor(M/8),O=Math.ceil(M/8),A=Math.ceil(b/8),we=M-(O-1)*8,U=b-(A-1)*8,k={value:0},V=new Array(C),J=new Array(C),he=new Array(C),pe=new Array(C),Ee=new Array(C);for(let fe=0;fe<C;++fe)Ee[fe]=n[e.idx[fe]],V[fe]=fe<1?0:V[fe-1]+O*A,J[fe]=new Float32Array(64),he[fe]=new Uint16Array(64),pe[fe]=new Uint16Array(O*64);for(let fe=0;fe<A;++fe){var Fe=8;fe==A-1&&(Fe=U);var me=8;for(let ye=0;ye<O;++ye){ye==O-1&&(me=we);for(let ce=0;ce<C;++ce)he[ce].fill(0),he[ce][0]=p[V[ce]++],ke(k,u,he[ce]),ut(he[ce],J[ce]),at(J[ce]);yt(J);for(let ce=0;ce<C;++ce)Ot(J[ce],pe[ce],ye*64)}let Re=0;for(let ye=0;ye<C;++ye){const ce=o[e.idx[ye]].type;for(let He=8*fe;He<8*fe+Fe;++He){Re=Ee[ye][He];for(let vt=0;vt<R;++vt){const Le=vt*64+(He&7)*8;ve.setUint16(Re+0*ce,pe[ye][Le+0],!0),ve.setUint16(Re+2*ce,pe[ye][Le+1],!0),ve.setUint16(Re+4*ce,pe[ye][Le+2],!0),ve.setUint16(Re+6*ce,pe[ye][Le+3],!0),ve.setUint16(Re+8*ce,pe[ye][Le+4],!0),ve.setUint16(Re+10*ce,pe[ye][Le+5],!0),ve.setUint16(Re+12*ce,pe[ye][Le+6],!0),ve.setUint16(Re+14*ce,pe[ye][Le+7],!0),Re+=16*ce}}if(R!=O)for(let He=8*fe;He<8*fe+Fe;++He){const vt=Ee[ye][He]+8*R*2*ce,Le=R*64+(He&7)*8;for(let ot=0;ot<me;++ot)ve.setUint16(vt+ot*2*ce,pe[ye][Le+ot],!0)}}}for(var qe=new Uint16Array(M),ve=new DataView(m.buffer),Me=0;Me<C;++Me){o[e.idx[Me]].decoded=!0;var rt=o[e.idx[Me]].type;if(o[Me].type==2)for(var Lt=0;Lt<b;++Lt){const fe=Ee[Me][Lt];for(var ze=0;ze<M;++ze)qe[ze]=ve.getUint16(fe+ze*2*rt,!0);for(var ze=0;ze<M;++ze)ve.setFloat32(fe+ze*2*rt,I(qe[ze]),!0)}}}function ke(e,n,o){for(var u,p=1;p<64;)u=n[e.value],u==65280?p=64:u>>8==255?p+=u&255:(o[p]=u,p++),e.value++}function ut(e,n){n[0]=I(e[0]),n[1]=I(e[1]),n[2]=I(e[5]),n[3]=I(e[6]),n[4]=I(e[14]),n[5]=I(e[15]),n[6]=I(e[27]),n[7]=I(e[28]),n[8]=I(e[2]),n[9]=I(e[4]),n[10]=I(e[7]),n[11]=I(e[13]),n[12]=I(e[16]),n[13]=I(e[26]),n[14]=I(e[29]),n[15]=I(e[42]),n[16]=I(e[3]),n[17]=I(e[8]),n[18]=I(e[12]),n[19]=I(e[17]),n[20]=I(e[25]),n[21]=I(e[30]),n[22]=I(e[41]),n[23]=I(e[43]),n[24]=I(e[9]),n[25]=I(e[11]),n[26]=I(e[18]),n[27]=I(e[24]),n[28]=I(e[31]),n[29]=I(e[40]),n[30]=I(e[44]),n[31]=I(e[53]),n[32]=I(e[10]),n[33]=I(e[19]),n[34]=I(e[23]),n[35]=I(e[32]),n[36]=I(e[39]),n[37]=I(e[45]),n[38]=I(e[52]),n[39]=I(e[54]),n[40]=I(e[20]),n[41]=I(e[22]),n[42]=I(e[33]),n[43]=I(e[38]),n[44]=I(e[46]),n[45]=I(e[51]),n[46]=I(e[55]),n[47]=I(e[60]),n[48]=I(e[21]),n[49]=I(e[34]),n[50]=I(e[37]),n[51]=I(e[47]),n[52]=I(e[50]),n[53]=I(e[56]),n[54]=I(e[59]),n[55]=I(e[61]),n[56]=I(e[35]),n[57]=I(e[36]),n[58]=I(e[48]),n[59]=I(e[49]),n[60]=I(e[57]),n[61]=I(e[58]),n[62]=I(e[62]),n[63]=I(e[63])}function at(e){const n=.5*Math.cos(.7853975),o=.5*Math.cos(3.14159/16),u=.5*Math.cos(3.14159/8),p=.5*Math.cos(3*3.14159/16),m=.5*Math.cos(5*3.14159/16),M=.5*Math.cos(3*3.14159/8),b=.5*Math.cos(7*3.14159/16);for(var C=new Array(4),R=new Array(4),O=new Array(4),A=new Array(4),we=0;we<8;++we){var U=we*8;C[0]=u*e[U+2],C[1]=M*e[U+2],C[2]=u*e[U+6],C[3]=M*e[U+6],R[0]=o*e[U+1]+p*e[U+3]+m*e[U+5]+b*e[U+7],R[1]=p*e[U+1]-b*e[U+3]-o*e[U+5]-m*e[U+7],R[2]=m*e[U+1]-o*e[U+3]+b*e[U+5]+p*e[U+7],R[3]=b*e[U+1]-m*e[U+3]+p*e[U+5]-o*e[U+7],O[0]=n*(e[U+0]+e[U+4]),O[3]=n*(e[U+0]-e[U+4]),O[1]=C[0]+C[3],O[2]=C[1]-C[2],A[0]=O[0]+O[1],A[1]=O[3]+O[2],A[2]=O[3]-O[2],A[3]=O[0]-O[1],e[U+0]=A[0]+R[0],e[U+1]=A[1]+R[1],e[U+2]=A[2]+R[2],e[U+3]=A[3]+R[3],e[U+4]=A[3]-R[3],e[U+5]=A[2]-R[2],e[U+6]=A[1]-R[1],e[U+7]=A[0]-R[0]}for(var k=0;k<8;++k)C[0]=u*e[16+k],C[1]=M*e[16+k],C[2]=u*e[48+k],C[3]=M*e[48+k],R[0]=o*e[8+k]+p*e[24+k]+m*e[40+k]+b*e[56+k],R[1]=p*e[8+k]-b*e[24+k]-o*e[40+k]-m*e[56+k],R[2]=m*e[8+k]-o*e[24+k]+b*e[40+k]+p*e[56+k],R[3]=b*e[8+k]-m*e[24+k]+p*e[40+k]-o*e[56+k],O[0]=n*(e[k]+e[32+k]),O[3]=n*(e[k]-e[32+k]),O[1]=C[0]+C[3],O[2]=C[1]-C[2],A[0]=O[0]+O[1],A[1]=O[3]+O[2],A[2]=O[3]-O[2],A[3]=O[0]-O[1],e[0+k]=A[0]+R[0],e[8+k]=A[1]+R[1],e[16+k]=A[2]+R[2],e[24+k]=A[3]+R[3],e[32+k]=A[3]-R[3],e[40+k]=A[2]-R[2],e[48+k]=A[1]-R[1],e[56+k]=A[0]-R[0]}function yt(e){for(var n=0;n<64;++n){var o=e[0][n],u=e[1][n],p=e[2][n];e[0][n]=o+1.5747*p,e[1][n]=o-.1873*u-.4682*p,e[2][n]=o+1.8556*u}}function Ot(e,n,o){for(var u=0;u<64;++u)n[o+u]=It.toHalfFloat(wt(e[u]))}function wt(e){return e<=1?Math.sign(e)*Math.pow(Math.abs(e),2.2):Math.sign(e)*Math.pow(x,Math.abs(e)-1)}function it(e){return new DataView(e.array.buffer,e.offset.value,e.size)}function tt(e){var n=e.viewer.buffer.slice(e.offset.value,e.offset.value+e.size),o=new Uint8Array(et(n)),u=new Uint8Array(o.length);return Pe(o),Ye(o,u),new DataView(u.buffer)}function dt(e){var n=e.array.slice(e.offset.value,e.offset.value+e.size),o=qt(n),u=new Uint8Array(o.length);return Pe(o),Ye(o,u),new DataView(u.buffer)}function Ft(e){for(var n=e.viewer,o={value:e.offset.value},u=new Uint16Array(e.width*e.scanlineBlockSize*(e.channels*e.type)),p=new Uint8Array(8192),m=0,M=new Array(e.channels),b=0;b<e.channels;b++)M[b]={},M[b].start=m,M[b].end=M[b].start,M[b].nx=e.width,M[b].ny=e.lines,M[b].size=e.type,m+=M[b].nx*M[b].ny*M[b].size;var C=Oe(n,o),R=Oe(n,o);if(R>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(C<=R)for(var b=0;b<R-C+1;b++)p[b+C]=l(n,o);var O=new Uint16Array(65536),A=F(p,O),we=Te(n,o);le(e.array,n,o,we,u,m);for(var b=0;b<e.channels;++b)for(var U=M[b],k=0;k<M[b].size;++k)gt(u,U.start+k,U.nx,U.size,U.ny,U.nx*U.size,A);je(O,u,m);for(var V=0,J=new Uint8Array(u.buffer.byteLength),he=0;he<e.lines;he++)for(var pe=0;pe<e.channels;pe++){var U=M[pe],Ee=U.nx*U.size,Fe=new Uint8Array(u.buffer,U.end*2,Ee*2);J.set(Fe,V),V+=Ee*2,U.end+=Ee}return new DataView(J.buffer)}function Be(e){var n=e.array.slice(e.offset.value,e.offset.value+e.size),o=qt(n);const u=e.lines*e.channels*e.width,p=e.type==1?new Uint16Array(u):new Uint32Array(u);let m=0,M=0;const b=new Array(4);for(let C=0;C<e.lines;C++)for(let R=0;R<e.channels;R++){let O=0;switch(e.type){case 1:b[0]=m,b[1]=b[0]+e.width,m=b[1]+e.width;for(let A=0;A<e.width;++A){const we=o[b[0]++]<<8|o[b[1]++];O+=we,p[M]=O,M++}break;case 2:b[0]=m,b[1]=b[0]+e.width,b[2]=b[1]+e.width,m=b[2]+e.width;for(let A=0;A<e.width;++A){const we=o[b[0]++]<<24|o[b[1]++]<<16|o[b[2]++]<<8;O+=we,p[M]=O,M++}break}}return new DataView(p.buffer)}function bt(e){var n=e.viewer,o={value:e.offset.value},u=new Uint8Array(e.width*e.lines*(e.channels*e.type*2)),p={version:_(n,o),unknownUncompressedSize:_(n,o),unknownCompressedSize:_(n,o),acCompressedSize:_(n,o),dcCompressedSize:_(n,o),rleCompressedSize:_(n,o),rleUncompressedSize:_(n,o),rleRawSize:_(n,o),totalAcUncompressedCount:_(n,o),totalDcUncompressedCount:_(n,o),acCompression:_(n,o)};if(p.version<2)throw"EXRLoader.parse: "+Dt.compression+" version "+p.version+" is unsupported";for(var m=new Array,M=Oe(n,o)-2;M>0;){var b=Et(n.buffer,o),C=l(n,o),R=C>>2&3,O=(C>>4)-1,A=new Int8Array([O])[0],we=l(n,o);m.push({name:b,index:A,type:we,compression:R}),M-=b.length+3}for(var U=Dt.channels,k=new Array(e.channels),V=0;V<e.channels;++V){var J=k[V]={},he=U[V];J.name=he.name,J.compression=0,J.decoded=!1,J.type=he.pixelType,J.pLinear=he.pLinear,J.width=e.width,J.height=e.lines}for(var pe={idx:new Array(3)},Ee=0;Ee<e.channels;++Ee)for(var J=k[Ee],V=0;V<m.length;++V){var Fe=m[V];J.name==Fe.name&&(J.compression=Fe.compression,Fe.index>=0&&(pe.idx[Fe.index]=Ee),J.offset=Ee)}if(p.acCompressedSize>0)switch(p.acCompression){case 0:var ve=new Uint16Array(p.totalAcUncompressedCount);le(e.array,n,o,p.acCompressedSize,ve,p.totalAcUncompressedCount);break;case 1:var me=e.array.slice(o.value,o.value+p.totalAcUncompressedCount),qe=qt(me),ve=new Uint16Array(qe.buffer);o.value+=p.totalAcUncompressedCount;break}if(p.dcCompressedSize>0){var Me={array:e.array,offset:o,size:p.dcCompressedSize},rt=new Uint16Array(dt(Me).buffer);o.value+=p.dcCompressedSize}if(p.rleRawSize>0){var me=e.array.slice(o.value,o.value+p.rleCompressedSize),qe=qt(me),Lt=et(qe.buffer);o.value+=p.rleCompressedSize}for(var ze=0,fe=new Array(k.length),V=0;V<fe.length;++V)fe[V]=new Array;for(var Re=0;Re<e.lines;++Re)for(var ye=0;ye<k.length;++ye)fe[ye].push(ze),ze+=k[ye].width*e.type*2;Pt(pe,fe,k,ve,rt,u);for(var V=0;V<k.length;++V){var J=k[V];if(!J.decoded)switch(J.compression){case 2:for(var ce=0,He=0,Re=0;Re<e.lines;++Re){for(var vt=fe[V][ce],Le=0;Le<J.width;++Le){for(var ot=0;ot<2*J.type;++ot)u[vt++]=Lt[He+ot*J.width*J.height];He++}ce++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(u.buffer)}function Et(e,n){for(var o=new Uint8Array(e),u=0;o[n.value+u]!=0;)u+=1;var p=new TextDecoder().decode(o.slice(n.value,n.value+u));return n.value=n.value+u+1,p}function or(e,n,o){var u=new TextDecoder().decode(new Uint8Array(e).slice(n.value,n.value+o));return n.value=n.value+o,u}function Xt(e,n){var o=ht(e,n),u=Te(e,n);return[o,u]}function sr(e,n){var o=Te(e,n),u=Te(e,n);return[o,u]}function ht(e,n){var o=e.getInt32(n.value,!0);return n.value=n.value+4,o}function Te(e,n){var o=e.getUint32(n.value,!0);return n.value=n.value+4,o}function xt(e,n){var o=e[n.value];return n.value=n.value+1,o}function l(e,n){var o=e.getUint8(n.value);return n.value=n.value+1,o}const _=function(e,n){let o;return"getBigInt64"in DataView.prototype?o=Number(e.getBigInt64(n.value,!0)):o=e.getUint32(n.value+4,!0)+Number(e.getUint32(n.value,!0)<<32),n.value+=8,o};function D(e,n){var o=e.getFloat32(n.value,!0);return n.value+=4,o}function oe(e,n){return It.toHalfFloat(D(e,n))}function I(e){var n=(e&31744)>>10,o=e&1023;return(e>>15?-1:1)*(n?n===31?o?NaN:1/0:Math.pow(2,n-15)*(1+o/1024):6103515625e-14*(o/1024))}function Oe(e,n){var o=e.getUint16(n.value,!0);return n.value+=2,o}function Ke(e,n){return I(Oe(e,n))}function Ir(e,n,o,u){for(var p=o.value,m=[];o.value<p+u-1;){var M=Et(n,o),b=ht(e,o),C=l(e,o);o.value+=3;var R=ht(e,o),O=ht(e,o);m.push({name:M,pixelType:b,pLinear:C,xSampling:R,ySampling:O})}return o.value+=1,m}function Vt(e,n){var o=D(e,n),u=D(e,n),p=D(e,n),m=D(e,n),M=D(e,n),b=D(e,n),C=D(e,n),R=D(e,n);return{redX:o,redY:u,greenX:p,greenY:m,blueX:M,blueY:b,whiteX:C,whiteY:R}}function $e(e,n){var o=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],u=l(e,n);return o[u]}function Xe(e,n){var o=Te(e,n),u=Te(e,n),p=Te(e,n),m=Te(e,n);return{xMin:o,yMin:u,xMax:p,yMax:m}}function ft(e,n){var o=["INCREASING_Y"],u=l(e,n);return o[u]}function pt(e,n){var o=D(e,n),u=D(e,n);return[o,u]}function mt(e,n){var o=D(e,n),u=D(e,n),p=D(e,n);return[o,u,p]}function _t(e,n,o,u,p){if(u==="string"||u==="stringvector"||u==="iccProfile")return or(n,o,p);if(u==="chlist")return Ir(e,n,o,p);if(u==="chromaticities")return Vt(e,o);if(u==="compression")return $e(e,o);if(u==="box2i")return Xe(e,o);if(u==="lineOrder")return ft(e,o);if(u==="float")return D(e,o);if(u==="v2f")return pt(e,o);if(u==="v3f")return mt(e,o);if(u==="int")return ht(e,o);if(u==="rational")return Xt(e,o);if(u==="timecode")return sr(e,o);if(u==="preview")return o.value+=p,"skipped";o.value+=p}function nn(e,n,o){const u={};if(e.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";u.version=e.getUint8(4);const p=e.getUint8(5);u.spec={singleTile:!!(p&2),longName:!!(p&4),deepFormat:!!(p&8),multiPart:!!(p&16)},o.value=8;for(var m=!0;m;){var M=Et(n,o);if(M==0)m=!1;else{var b=Et(n,o),C=Te(e,o),R=_t(e,n,o,b,C);R===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${b}'.`):u[M]=R}}if((p&-5)!=0)throw console.error("EXRHeader:",u),"THREE.EXRLoader: provided file is currently unsupported.";return u}function an(e,n,o,u,p){const m={size:0,viewer:n,array:o,offset:u,width:e.dataWindow.xMax-e.dataWindow.xMin+1,height:e.dataWindow.yMax-e.dataWindow.yMin+1,channels:e.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:e.channels[0].pixelType,uncompress:null,getter:null,format:null,[Ut?"colorSpace":"encoding"]:null};switch(e.compression){case"NO_COMPRESSION":m.lines=1,m.uncompress=it;break;case"RLE_COMPRESSION":m.lines=1,m.uncompress=tt;break;case"ZIPS_COMPRESSION":m.lines=1,m.uncompress=dt;break;case"ZIP_COMPRESSION":m.lines=16,m.uncompress=dt;break;case"PIZ_COMPRESSION":m.lines=32,m.uncompress=Ft;break;case"PXR24_COMPRESSION":m.lines=16,m.uncompress=Be;break;case"DWAA_COMPRESSION":m.lines=32,m.uncompress=bt;break;case"DWAB_COMPRESSION":m.lines=256,m.uncompress=bt;break;default:throw"EXRLoader.parse: "+e.compression+" is unsupported"}if(m.scanlineBlockSize=m.lines,m.type==1)switch(p){case nt:m.getter=Ke,m.inputSize=2;break;case We:m.getter=Oe,m.inputSize=2;break}else if(m.type==2)switch(p){case nt:m.getter=D,m.inputSize=4;break;case We:m.getter=oe,m.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+m.type+" for "+e.compression+".";m.blockCount=(e.dataWindow.yMax+1)/m.scanlineBlockSize;for(var M=0;M<m.blockCount;M++)_(n,u);m.outputChannels=m.channels==3?4:m.channels;const b=m.width*m.height*m.outputChannels;switch(p){case nt:m.byteArray=new Float32Array(b),m.channels<m.outputChannels&&m.byteArray.fill(1,0,b);break;case We:m.byteArray=new Uint16Array(b),m.channels<m.outputChannels&&m.byteArray.fill(15360,0,b);break;default:console.error("THREE.EXRLoader: unsupported type: ",p);break}return m.bytesPerLine=m.width*m.inputSize*m.channels,m.outputChannels==4?m.format=Ht:m.format=pn,Ut?m.colorSpace="srgb-linear":m.encoding=3e3,m}const Kt=new DataView(r),on=new Uint8Array(r),Nt={value:0},Dt=nn(Kt,r,Nt),ne=an(Dt,Kt,on,Nt,this.type),Tr={value:0},sn={R:0,G:1,B:2,A:3,Y:0};for(let e=0;e<ne.height/ne.scanlineBlockSize;e++){const n=Te(Kt,Nt);ne.size=Te(Kt,Nt),ne.lines=n+ne.scanlineBlockSize>ne.height?ne.height-n:ne.scanlineBlockSize;const u=ne.size<ne.lines*ne.bytesPerLine?ne.uncompress(ne):it(ne);Nt.value+=ne.size;for(let p=0;p<ne.scanlineBlockSize;p++){const m=p+e*ne.scanlineBlockSize;if(m>=ne.height)break;for(let M=0;M<ne.channels;M++){const b=sn[Dt.channels[M].name];for(let C=0;C<ne.width;C++){Tr.value=(p*(ne.channels*ne.width)+M*ne.width+C)*ne.inputSize;const R=(ne.height-1-m)*(ne.width*ne.outputChannels)+C*ne.outputChannels+b;ne.byteArray[R]=ne.getter(u,Tr)}}}}return{header:Dt,width:ne.width,height:ne.height,data:ne.byteArray,format:ne.format,[Ut?"colorSpace":"encoding"]:ne[Ut?"colorSpace":"encoding"],type:this.type}}setDataType(r){return this.type=r,this}load(r,i,t,s){function c(h,d){Ut?h.colorSpace=d.colorSpace:h.encoding=d.encoding,h.minFilter=Je,h.magFilter=Je,h.generateMipmaps=!1,h.flipY=!1,i&&i(h,d)}return super.load(r,c,t,s)}}const va=T.forwardRef(({makeDefault:a,camera:r,regress:i,domElement:t,enableDamping:s=!0,keyEvents:c=!1,onChange:h,onStart:d,onEnd:f,...g},E)=>{const y=Ne(P=>P.invalidate),S=Ne(P=>P.camera),j=Ne(P=>P.gl),L=Ne(P=>P.events),W=Ne(P=>P.setEvents),Z=Ne(P=>P.set),z=Ne(P=>P.get),$=Ne(P=>P.performance),K=r||S,Q=t||L.connected||j.domElement,N=T.useMemo(()=>new fa(K),[K]);return Ct(()=>{N.enabled&&N.update()},-1),T.useEffect(()=>(c&&N.connect(c===!0?Q:c),N.connect(Q),()=>void N.dispose()),[c,Q,i,N,y]),T.useEffect(()=>{const P=x=>{y(),i&&$.regress(),h&&h(x)},ee=x=>{d&&d(x)},w=x=>{f&&f(x)};return N.addEventListener("change",P),N.addEventListener("start",ee),N.addEventListener("end",w),()=>{N.removeEventListener("start",ee),N.removeEventListener("end",w),N.removeEventListener("change",P)}},[h,d,f,N,y,W]),T.useEffect(()=>{if(a){const P=z().controls;return Z({controls:N}),()=>Z({controls:P})}},[a,N]),T.createElement("primitive",Wt({ref:E,object:N,enableDamping:s},g))}),ga=3e3,ya=3001;function Kr(a,r){const i=a+"Geometry";return T.forwardRef(({args:t,children:s,...c},h)=>{const d=T.useRef(null);return T.useImperativeHandle(h,()=>d.current),T.useLayoutEffect(()=>void r?.(d.current)),T.createElement("mesh",Wt({ref:d},c),T.createElement(i,{attach:"geometry",args:t}),s)})}const Zt=Kr("cylinder"),Jt=Kr("sphere"),Qe=1e-5;function wa(a,r,i){const t=new mn,s=i-Qe;return t.absarc(Qe,Qe,Qe,-Math.PI/2,-Math.PI,!0),t.absarc(Qe,r-s*2,Qe,Math.PI,Math.PI/2,!0),t.absarc(a-s*2,r-s*2,Qe,Math.PI/2,0,!0),t.absarc(a-s*2,Qe,Qe,0,-Math.PI/2,!0),t}const Ce=T.forwardRef(function({args:[r=1,i=1,t=1]=[],radius:s=.05,steps:c=1,smoothness:h=4,bevelSegments:d=4,creaseAngle:f=.4,children:g,...E},y){const S=T.useMemo(()=>wa(r,i,s),[r,i,s]),j=T.useMemo(()=>({depth:t-s*2,bevelEnabled:!0,bevelSegments:d*2,steps:c,bevelSize:s-Qe,bevelThickness:s,curveSegments:h}),[t,s,h]),L=T.useRef(null);return T.useLayoutEffect(()=>{L.current&&(L.current.center(),Gn(L.current,f))},[S,j]),T.createElement("mesh",Wt({ref:y},E),T.createElement("extrudeGeometry",{ref:L,args:[S,j]}),g)}),ar=T.forwardRef(({children:a,enabled:r=!0,speed:i=1,rotationIntensity:t=1,floatIntensity:s=1,floatingRange:c=[-.1,.1],autoInvalidate:h=!1,...d},f)=>{const g=T.useRef(null);T.useImperativeHandle(f,()=>g.current,[]);const E=T.useRef(Math.random()*1e4);return Ct(y=>{var S,j;if(!r||i===0)return;h&&y.invalidate();const L=E.current+y.clock.elapsedTime;g.current.rotation.x=Math.cos(L/4*i)/8*t,g.current.rotation.y=Math.sin(L/4*i)/8*t,g.current.rotation.z=Math.sin(L/4*i)/20*t;let W=Math.sin(L/4*i)/10;W=vn.mapLinear(W,-.1,.1,(S=c?.[0])!==null&&S!==void 0?S:-.1,(j=c?.[1])!==null&&j!==void 0?j:.1),g.current.position.y=W*s,g.current.updateMatrix()}),T.createElement("group",d,T.createElement("group",{ref:g,matrixAutoUpdate:!1},a))}),qr=(a,r,i)=>{let t;switch(a){case dr:t=new Uint8ClampedArray(r*i*4);break;case We:t=new Uint16Array(r*i*4);break;case _n:t=new Uint32Array(r*i*4);break;case xn:t=new Int8Array(r*i*4);break;case En:t=new Int16Array(r*i*4);break;case bn:t=new Int32Array(r*i*4);break;case nt:t=new Float32Array(r*i*4);break;default:throw new Error("Unsupported data type")}return t};let er;const ba=(a,r,i,t)=>{if(er!==void 0)return er;const s=new zr(1,1,t);r.setRenderTarget(s);const c=new mr(new Br,new wn({color:16777215}));r.render(c,i),r.setRenderTarget(null);const h=qr(a,s.width,s.height);return r.readRenderTargetPixels(s,0,0,s.width,s.height,h),s.dispose(),c.geometry.dispose(),c.material.dispose(),er=h[0]!==0,er};class wr{constructor(r){var i,t,s,c,h,d,f,g,E,y,S,j,L,W,Z,z;this._rendererIsDisposable=!1,this._supportsReadPixels=!0,this.render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(K){throw this._renderer.setRenderTarget(null),K}this._renderer.setRenderTarget(null)},this._width=r.width,this._height=r.height,this._type=r.type,this._colorSpace=r.colorSpace;const $={format:Ht,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:((i=r.renderTargetOptions)===null||i===void 0?void 0:i.anisotropy)!==void 0?(t=r.renderTargetOptions)===null||t===void 0?void 0:t.anisotropy:1,generateMipmaps:((s=r.renderTargetOptions)===null||s===void 0?void 0:s.generateMipmaps)!==void 0?(c=r.renderTargetOptions)===null||c===void 0?void 0:c.generateMipmaps:!1,magFilter:((h=r.renderTargetOptions)===null||h===void 0?void 0:h.magFilter)!==void 0?(d=r.renderTargetOptions)===null||d===void 0?void 0:d.magFilter:Je,minFilter:((f=r.renderTargetOptions)===null||f===void 0?void 0:f.minFilter)!==void 0?(g=r.renderTargetOptions)===null||g===void 0?void 0:g.minFilter:Je,samples:((E=r.renderTargetOptions)===null||E===void 0?void 0:E.samples)!==void 0?(y=r.renderTargetOptions)===null||y===void 0?void 0:y.samples:void 0,wrapS:((S=r.renderTargetOptions)===null||S===void 0?void 0:S.wrapS)!==void 0?(j=r.renderTargetOptions)===null||j===void 0?void 0:j.wrapS:lt,wrapT:((L=r.renderTargetOptions)===null||L===void 0?void 0:L.wrapT)!==void 0?(W=r.renderTargetOptions)===null||W===void 0?void 0:W.wrapT:lt};if(this._material=r.material,r.renderer?this._renderer=r.renderer:(this._renderer=wr.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new kr,this._camera=new At,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!ba(this._type,this._renderer,this._camera,$)){let K;switch(this._type){case We:K=this._renderer.extensions.has("EXT_color_buffer_float")?nt:void 0;break}K!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${nt}`),this._type=K):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new mr(new Br,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new zr(this.width,this.height,$),this._renderTarget.texture.mapping=((Z=r.renderTargetOptions)===null||Z===void 0?void 0:Z.mapping)!==void 0?(z=r.renderTargetOptions)===null||z===void 0?void 0:z.mapping:rr}static instantiateRenderer(){const r=new gn;return r.setSize(128,128),r}toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const r=qr(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,r),r}toDataTexture(r){const i=new yn(this.toArray(),this.width,this.height,Ht,this._type,r?.mapping||rr,r?.wrapS||lt,r?.wrapT||lt,r?.magFilter||Je,r?.minFilter||Je,r?.anisotropy||1,ur);return i.generateMipmaps=r?.generateMipmaps!==void 0?r?.generateMipmaps:!1,i}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(r){this.disposeOnDemandRenderer(),r&&this.renderTarget.dispose(),this.material instanceof vr&&Object.values(this.material.uniforms).forEach(i=>{i.value instanceof Tt&&i.value.dispose()}),Object.values(this.material).forEach(i=>{i instanceof Tt&&i.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(r){this._width=r,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(r){this._height=r,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(r){this._renderTarget=r,this._width=r.width,this._height=r.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}const Ea=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,xa=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class _a extends vr{constructor({gamma:r,offsetHdr:i,offsetSdr:t,gainMapMin:s,gainMapMax:c,maxDisplayBoost:h,hdrCapacityMin:d,hdrCapacityMax:f,sdr:g,gainMap:E}){super({name:"GainMapDecoderMaterial",vertexShader:Ea,fragmentShader:xa,uniforms:{sdr:{value:g},gainMap:{value:E},gamma:{value:new ue(1/r[0],1/r[1],1/r[2])},offsetHdr:{value:new ue().fromArray(i)},offsetSdr:{value:new ue().fromArray(t)},gainMapMin:{value:new ue().fromArray(s)},gainMapMax:{value:new ue().fromArray(c)},weightFactor:{value:(Math.log2(h)-d)/(f-d)}},blending:Tn,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=h,this._hdrCapacityMin=d,this._hdrCapacityMax=f,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(r){this.uniforms.sdr.value=r}get gainMap(){return this.uniforms.gainMap.value}set gainMap(r){this.uniforms.gainMap.value=r}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(r){this.uniforms.offsetHdr.value.fromArray(r)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(r){this.uniforms.offsetSdr.value.fromArray(r)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(r){this.uniforms.gainMapMin.value.fromArray(r)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(r){this.uniforms.gainMapMax.value.fromArray(r)}get gamma(){const r=this.uniforms.gamma.value;return[1/r.x,1/r.y,1/r.z]}set gamma(r){const i=this.uniforms.gamma.value;i.x=1/r[0],i.y=1/r[1],i.z=1/r[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(r){this._hdrCapacityMin=r,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(r){this._hdrCapacityMax=r,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(r){this._maxDisplayBoost=Math.max(1,Math.min(65504,r)),this.calculateWeight()}calculateWeight(){const r=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,r))}}class Qr extends Error{}class Jr extends Error{}const jt=(a,r,i)=>{const t=new RegExp(`${r}="([^"]*)"`,"i").exec(a);if(t)return t[1];const s=new RegExp(`<${r}[^>]*>([\\s\\S]*?)</${r}>`,"i").exec(a);if(s){const c=s[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return c&&c.length===3?c.map(h=>h.replace(/<\/?rdf:li>/g,"")):s[1].trim()}if(i!==void 0)return i;throw new Error(`Can't find ${r} in gainmap metadata`)},Ma=a=>{let r;typeof TextDecoder<"u"?r=new TextDecoder().decode(a):r=a.toString();let i=r.indexOf("<x:xmpmeta");for(;i!==-1;){const t=r.indexOf("x:xmpmeta>",i),s=r.slice(i,t+10);try{const c=jt(s,"hdrgm:GainMapMin","0"),h=jt(s,"hdrgm:GainMapMax"),d=jt(s,"hdrgm:Gamma","1"),f=jt(s,"hdrgm:OffsetSDR","0.015625"),g=jt(s,"hdrgm:OffsetHDR","0.015625"),E=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(s),y=E?E[1]:"0",S=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(s);if(!S)throw new Error("Incomplete gainmap metadata");const j=S[1];return{gainMapMin:Array.isArray(c)?c.map(L=>parseFloat(L)):[parseFloat(c),parseFloat(c),parseFloat(c)],gainMapMax:Array.isArray(h)?h.map(L=>parseFloat(L)):[parseFloat(h),parseFloat(h),parseFloat(h)],gamma:Array.isArray(d)?d.map(L=>parseFloat(L)):[parseFloat(d),parseFloat(d),parseFloat(d)],offsetSdr:Array.isArray(f)?f.map(L=>parseFloat(L)):[parseFloat(f),parseFloat(f),parseFloat(f)],offsetHdr:Array.isArray(g)?g.map(L=>parseFloat(L)):[parseFloat(g),parseFloat(g),parseFloat(g)],hdrCapacityMin:parseFloat(y),hdrCapacityMax:parseFloat(j)}}catch{}i=r.indexOf("<x:xmpmeta",t)}};class Sa{constructor(r){this.options={debug:r&&r.debug!==void 0?r.debug:!1,extractFII:r&&r.extractFII!==void 0?r.extractFII:!0,extractNonFII:r&&r.extractNonFII!==void 0?r.extractNonFII:!0}}extract(r){return new Promise((i,t)=>{const s=this.options.debug,c=new DataView(r.buffer);if(c.getUint16(0)!==65496){t(new Error("Not a valid jpeg"));return}const h=c.byteLength;let d=2,f=0,g;for(;d<h;){if(++f>250){t(new Error(`Found no marker after ${f} loops `));return}if(c.getUint8(d)!==255){t(new Error(`Not a valid marker at offset 0x${d.toString(16)}, found: 0x${c.getUint8(d).toString(16)}`));return}if(g=c.getUint8(d+1),s&&console.log(`Marker: ${g.toString(16)}`),g===226){s&&console.log("Found APP2 marker (0xffe2)");const E=d+4;if(c.getUint32(E)===1297106432){const y=E+4;let S;if(c.getUint16(y)===18761)S=!1;else if(c.getUint16(y)===19789)S=!0;else{t(new Error("No valid endianness marker found in TIFF header"));return}if(c.getUint16(y+2,!S)!==42){t(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const j=c.getUint32(y+4,!S);if(j<8){t(new Error("Not valid TIFF data! (First offset less than 8)"));return}const L=y+j,W=c.getUint16(L,!S),Z=L+2;let z=0;for(let N=Z;N<Z+12*W;N+=12)c.getUint16(N,!S)===45057&&(z=c.getUint32(N+8,!S));const K=L+2+W*12+4,Q=[];for(let N=K;N<K+z*16;N+=16){const P={MPType:c.getUint32(N,!S),size:c.getUint32(N+4,!S),dataOffset:c.getUint32(N+8,!S),dependantImages:c.getUint32(N+12,!S),start:-1,end:-1,isFII:!1};P.dataOffset?(P.start=y+P.dataOffset,P.isFII=!1):(P.start=0,P.isFII=!0),P.end=P.start+P.size,Q.push(P)}if(this.options.extractNonFII&&Q.length){const N=new Blob([c]),P=[];for(const ee of Q){if(ee.isFII&&!this.options.extractFII)continue;const w=N.slice(ee.start,ee.end+1,"image/jpeg");P.push(w)}i(P)}}}d+=2+c.getUint16(d+2)}})}}const Ia=async a=>{const r=Ma(a);if(!r)throw new Jr("Gain map XMP metadata not found");const t=await new Sa({extractFII:!0,extractNonFII:!0}).extract(a);if(t.length!==2)throw new Qr("Gain map recovery image not found");return{sdr:new Uint8Array(await t[0].arrayBuffer()),gainMap:new Uint8Array(await t[1].arrayBuffer()),metadata:r}},Dr=a=>new Promise((r,i)=>{const t=document.createElement("img");t.onload=()=>{r(t)},t.onerror=s=>{i(s)},t.src=URL.createObjectURL(a)});class en extends Mn{constructor(r,i){super(i),r&&(this._renderer=r),this._internalLoadingManager=new Sn}setRenderer(r){return this._renderer=r,this}setRenderTargetOptions(r){return this._renderTargetOptions=r,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: An existing WebGL Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const r=new _a({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new Tt,sdr:new Tt});return new wr({width:16,height:16,type:We,colorSpace:ur,material:r,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async render(r,i,t,s){const c=s?new Blob([s],{type:"image/jpeg"}):void 0,h=new Blob([t],{type:"image/jpeg"});let d,f,g=!1;if(typeof createImageBitmap>"u"){const S=await Promise.all([c?Dr(c):Promise.resolve(void 0),Dr(h)]);f=S[0],d=S[1],g=!0}else{const S=await Promise.all([c?createImageBitmap(c,{imageOrientation:"flipY"}):Promise.resolve(void 0),createImageBitmap(h,{imageOrientation:"flipY"})]);f=S[0],d=S[1]}const E=new Tt(f||new ImageData(2,2),rr,lt,lt,Je,Cr,Ht,dr,1,ur);E.flipY=g,E.needsUpdate=!0;const y=new Tt(d,rr,lt,lt,Je,Cr,Ht,dr,1,In);y.flipY=g,y.needsUpdate=!0,r.width=d.width,r.height=d.height,r.material.gainMap=E,r.material.sdr=y,r.material.gainMapMin=i.gainMapMin,r.material.gainMapMax=i.gainMapMax,r.material.offsetHdr=i.offsetHdr,r.material.offsetSdr=i.offsetSdr,r.material.gamma=i.gamma,r.material.hdrCapacityMin=i.hdrCapacityMin,r.material.hdrCapacityMax=i.hdrCapacityMax,r.material.maxDisplayBoost=Math.pow(2,i.hdrCapacityMax),r.material.needsUpdate=!0,r.render()}}class Ta extends en{load([r,i,t],s,c,h){const d=this.prepareQuadRenderer();let f,g,E;const y=async()=>{if(f&&g&&E){try{await this.render(d,E,f,g)}catch(x){this.manager.itemError(r),this.manager.itemError(i),this.manager.itemError(t),typeof h=="function"&&h(x),d.disposeOnDemandRenderer();return}typeof s=="function"&&s(d),this.manager.itemEnd(r),this.manager.itemEnd(i),this.manager.itemEnd(t),d.disposeOnDemandRenderer()}};let S=!0,j=0,L=0,W=!0,Z=0,z=0,$=!0,K=0,Q=0;const N=()=>{if(typeof c=="function"){const x=j+Z+K,F=L+z+Q,G=S&&W&&$;c(new ProgressEvent("progress",{lengthComputable:G,loaded:F,total:x}))}};this.manager.itemStart(r),this.manager.itemStart(i),this.manager.itemStart(t);const P=new tr(this._internalLoadingManager);P.setResponseType("arraybuffer"),P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(this.withCredentials),P.load(r,async x=>{if(typeof x=="string")throw new Error("Invalid sdr buffer");f=x,await y()},x=>{S=x.lengthComputable,L=x.loaded,j=x.total,N()},x=>{this.manager.itemError(r),typeof h=="function"&&h(x)});const ee=new tr(this._internalLoadingManager);ee.setResponseType("arraybuffer"),ee.setRequestHeader(this.requestHeader),ee.setPath(this.path),ee.setWithCredentials(this.withCredentials),ee.load(i,async x=>{if(typeof x=="string")throw new Error("Invalid gainmap buffer");g=x,await y()},x=>{W=x.lengthComputable,z=x.loaded,Z=x.total,N()},x=>{this.manager.itemError(i),typeof h=="function"&&h(x)});const w=new tr(this._internalLoadingManager);return w.setRequestHeader(this.requestHeader),w.setPath(this.path),w.setWithCredentials(this.withCredentials),w.load(t,async x=>{if(typeof x!="string")throw new Error("Invalid metadata string");E=JSON.parse(x),await y()},x=>{$=x.lengthComputable,Q=x.loaded,K=x.total,N()},x=>{this.manager.itemError(t),typeof h=="function"&&h(x)}),d}}class Aa extends en{load(r,i,t,s){const c=this.prepareQuadRenderer(),h=new tr(this._internalLoadingManager);return h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setPath(this.path),h.setWithCredentials(this.withCredentials),this.manager.itemStart(r),h.load(r,async d=>{if(typeof d=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const f=new Uint8Array(d);let g,E,y;try{const S=await Ia(f);g=S.sdr,E=S.gainMap,y=S.metadata}catch(S){if(S instanceof Jr||S instanceof Qr)console.warn(`Failure to reconstruct an HDR image from ${r}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),y={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},g=f;else throw S}try{await this.render(c,y,g,E)}catch(S){this.manager.itemError(r),typeof s=="function"&&s(S),c.disposeOnDemandRenderer();return}typeof i=="function"&&i(c),this.manager.itemEnd(r),c.disposeOnDemandRenderer()},t,d=>{this.manager.itemError(r),typeof s=="function"&&s(d)}),c}}const Gt={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},tn="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",Rt=a=>Array.isArray(a),br=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function ir({files:a=br,path:r="",preset:i=void 0,encoding:t=void 0,extensions:s}={}){let c=null,h=!1;i&&(Er(i),a=Gt[i],r=tn),h=Rt(a);const{extension:d,isCubemap:f}=xr(a);if(c=_r(d),!c)throw new Error("useEnvironment: Unrecognized file extension: "+a);const g=Ne(j=>j.gl);T.useLayoutEffect(()=>{if(d!=="webp"&&d!=="jpg"&&d!=="jpeg")return;function j(){nr.clear(c,h?[a]:a)}g.domElement.addEventListener("webglcontextlost",j,{once:!0})},[a,g.domElement]);const E=nr(c,h?[a]:a,j=>{(d==="webp"||d==="jpg"||d==="jpeg")&&j.setRenderer(g),j.setPath==null||j.setPath(r),s&&s(j)});let y=h?E[0]:E;if(d==="jpg"||d==="jpeg"||d==="webp"){var S;y=(S=y.renderTarget)==null?void 0:S.texture}return y.mapping=f?An:Rn,"colorSpace"in y?y.colorSpace=t??f?"srgb":"srgb-linear":y.encoding=t??f?ya:ga,y}const Ra={files:br,path:"",preset:void 0,extensions:void 0};ir.preload=a=>{const r={...Ra,...a};let{files:i,path:t=""}=r;const{preset:s,extensions:c}=r;s&&(Er(s),i=Gt[s],t=tn);const{extension:h}=xr(i);if(h==="webp"||h==="jpg"||h==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const d=_r(h);if(!d)throw new Error("useEnvironment: Unrecognized file extension: "+i);nr.preload(d,Rt(i)?[i]:i,f=>{f.setPath==null||f.setPath(t),c&&c(f)})};const Ca={files:br,preset:void 0};ir.clear=a=>{const r={...Ca,...a};let{files:i}=r;const{preset:t}=r;t&&(Er(t),i=Gt[t]);const{extension:s}=xr(i),c=_r(s);if(!c)throw new Error("useEnvironment: Unrecognized file extension: "+i);nr.clear(c,Rt(i)?[i]:i)};function Er(a){if(!(a in Gt))throw new Error("Preset must be one of: "+Object.keys(Gt).join(", "))}function xr(a){var r;const i=Rt(a)&&a.length===6,t=Rt(a)&&a.length===3&&a.some(h=>h.endsWith("json")),s=Rt(a)?a[0]:a;return{extension:i?"cube":t?"webp":s.startsWith("data:application/exr")?"exr":s.startsWith("data:application/hdr")?"hdr":s.startsWith("data:image/jpeg")?"jpg":(r=s.split(".").pop())==null||(r=r.split("?"))==null||(r=r.shift())==null?void 0:r.toLowerCase(),isCubemap:i,isGainmap:t}}function _r(a){return a==="cube"?Cn:a==="hdr"?pa:a==="exr"?ma:a==="jpg"||a==="jpeg"?Aa:a==="webp"?Ta:null}const Pa=a=>a.current&&a.current.isScene,Oa=a=>Pa(a)?a.current:a;function Mr(a,r,i,t,s={}){var c,h,d,f;s={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...s};const g=Oa(r||i),E=g.background,y=g.environment,S={backgroundBlurriness:g.backgroundBlurriness,backgroundIntensity:g.backgroundIntensity,backgroundRotation:(c=(h=g.backgroundRotation)==null||h.clone==null?void 0:h.clone())!==null&&c!==void 0?c:[0,0,0],environmentIntensity:g.environmentIntensity,environmentRotation:(d=(f=g.environmentRotation)==null||f.clone==null?void 0:f.clone())!==null&&d!==void 0?d:[0,0,0]};return a!=="only"&&(g.environment=t),a&&(g.background=t),Pr(g,s),()=>{a!=="only"&&(g.environment=y),a&&(g.background=E),Pr(g,S)}}function Sr({scene:a,background:r=!1,map:i,...t}){const s=Ne(c=>c.scene);return T.useLayoutEffect(()=>{if(i)return Mr(r,a,s,i,t)}),null}function rn({background:a=!1,scene:r,blur:i,backgroundBlurriness:t,backgroundIntensity:s,backgroundRotation:c,environmentIntensity:h,environmentRotation:d,...f}){const g=ir(f),E=Ne(y=>y.scene);return T.useLayoutEffect(()=>Mr(a,r,E,g,{backgroundBlurriness:i??t,backgroundIntensity:s,backgroundRotation:c,environmentIntensity:h,environmentRotation:d})),T.useEffect(()=>()=>{g.dispose()},[g]),null}function Fa({children:a,near:r=.1,far:i=1e3,resolution:t=256,frames:s=1,map:c,background:h=!1,blur:d,backgroundBlurriness:f,backgroundIntensity:g,backgroundRotation:E,environmentIntensity:y,environmentRotation:S,scene:j,files:L,path:W,preset:Z=void 0,extensions:z}){const $=Ne(w=>w.gl),K=Ne(w=>w.scene),Q=T.useRef(null),[N]=T.useState(()=>new kr),P=T.useMemo(()=>{const w=new On(t);return w.texture.type=We,w},[t]);T.useEffect(()=>()=>{P.dispose()},[P]),T.useLayoutEffect(()=>{if(s===1){const w=$.autoClear;$.autoClear=!0,Q.current.update($,N),$.autoClear=w}return Mr(h,j,K,P.texture,{backgroundBlurriness:d??f,backgroundIntensity:g,backgroundRotation:E,environmentIntensity:y,environmentRotation:S})},[a,N,P.texture,j,K,h,s,$]);let ee=1;return Ct(()=>{if(s===1/0||ee<s){const w=$.autoClear;$.autoClear=!0,Q.current.update($,N),$.autoClear=w,ee++}}),T.createElement(T.Fragment,null,Fn(T.createElement(T.Fragment,null,a,T.createElement("cubeCamera",{ref:Q,args:[r,i,P]}),L||Z?T.createElement(rn,{background:!0,files:L,preset:Z,path:W,extensions:z}):c?T.createElement(Sr,{background:!0,map:c,extensions:z}):null),N))}function Na(a){var r,i,t,s;const c=ir(a),h=a.map||c;T.useMemo(()=>Pn({GroundProjectedEnvImpl:ia}),[]),T.useEffect(()=>()=>{c.dispose()},[c]);const d=T.useMemo(()=>[h],[h]),f=(r=a.ground)==null?void 0:r.height,g=(i=a.ground)==null?void 0:i.radius,E=(t=(s=a.ground)==null?void 0:s.scale)!==null&&t!==void 0?t:1e3;return T.createElement(T.Fragment,null,T.createElement(Sr,Wt({},a,{map:h})),T.createElement("groundProjectedEnvImpl",{args:d,scale:E,height:f,radius:g}))}function Da(a){return a.ground?T.createElement(Na,a):a.map?T.createElement(Sr,a):a.children?T.createElement(Fa,a):T.createElement(rn,a)}function La(){const a=T.useRef(null);return v.jsxs("group",{ref:a,position:[0,-.8,-.5],children:[v.jsx(Ce,{args:[5,.1,4],radius:.02,position:[0,-.05,0],receiveShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#2c2c2c",roughness:.8,metalness:.2})}),v.jsx(Ce,{args:[4,1.2,3.5],radius:.05,position:[0,.6,0],castShadow:!0,receiveShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#f5f5f5",roughness:.2,metalness:.8})}),v.jsx(Ce,{args:[3,1,3],radius:.05,position:[-.3,1.5,.2],castShadow:!0,receiveShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.1,metalness:.3})}),v.jsx(Ce,{args:[1,2,3.2],radius:.03,position:[1.3,1.2,0],castShadow:!0,receiveShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#e8f4f8",roughness:.15,metalness:.4})}),v.jsx(Ce,{args:[3.1,.1,3.1],radius:.02,position:[-.3,2.05,.2],castShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#a1c4fd",roughness:.2,metalness:.8})}),v.jsx(Ce,{args:[1.5,.08,1.5],radius:.02,position:[-.3,2.15,.2],children:v.jsx("meshStandardMaterial",{color:"#80d0c7",roughness:.3,metalness:.7})}),v.jsx(Ce,{args:[2.5,1,.05],radius:.01,position:[0,.6,1.76],castShadow:!0,children:v.jsx("meshPhysicalMaterial",{color:"#b8e6f5",roughness:.05,metalness:.95,emissive:"#a1c4fd",emissiveIntensity:.4,transparent:!0,opacity:.9})}),v.jsx(Ce,{args:[2.2,.8,.05],radius:.01,position:[-.3,1.5,1.63],castShadow:!0,children:v.jsx("meshPhysicalMaterial",{color:"#b8e6f5",roughness:.05,metalness:.95,emissive:"#a1c4fd",emissiveIntensity:.3,transparent:!0,opacity:.9})}),v.jsx(Ce,{args:[2.4,.05,.05],radius:.01,position:[-.3,1,1.65],children:v.jsx("meshStandardMaterial",{color:"#c2e9fb",roughness:.05,metalness:.95,emissive:"#a1c4fd",emissiveIntensity:.3,transparent:!0,opacity:.9})}),v.jsx(Ce,{args:[.5,1.1,.05],radius:.02,position:[1.2,.5,1.76],children:v.jsx("meshStandardMaterial",{color:"#5a9fb8",roughness:.3,metalness:.6})}),v.jsx(Zt,{args:[.03,.03,.15,8],rotation:[0,0,Math.PI/2],position:[1,.5,1.8],children:v.jsx("meshStandardMaterial",{color:"#c9b037",roughness:.2,metalness:1})}),v.jsx(Ce,{args:[.05,2,2.8],radius:.01,position:[2.02,1.2,0],castShadow:!0,children:v.jsx("meshPhysicalMaterial",{color:"#b8e6f5",roughness:.05,metalness:.95,emissive:"#a1c4fd",emissiveIntensity:.3,transparent:!0,opacity:.85})}),v.jsx(Ce,{args:[5,.05,2],radius:.01,position:[0,-.04,2.8],receiveShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#80d0c7",roughness:.2,metalness:.7})}),v.jsx(Ce,{args:[.8,.03,2],radius:.01,position:[1.2,-.02,2.8],receiveShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#7ab8c7",roughness:.4,metalness:.5})}),v.jsx(Jt,{args:[.3,16,16],position:[-1.5,.2,2.2],children:v.jsx("meshStandardMaterial",{color:"#2d5016",roughness:.9})}),v.jsx(Jt,{args:[.25,16,16],position:[.5,.15,2.5],children:v.jsx("meshStandardMaterial",{color:"#2d5016",roughness:.9})}),v.jsx(Jt,{args:[.35,16,16],position:[-2,.25,2],children:v.jsx("meshStandardMaterial",{color:"#2d5016",roughness:.9})}),v.jsxs("group",{position:[-2.5,0,2.5],children:[v.jsx(Zt,{args:[.1,.12,1,8],position:[0,.5,0],children:v.jsx("meshStandardMaterial",{color:"#4a3c28",roughness:.9})}),v.jsx(Jt,{args:[.5,16,16],position:[0,1.3,0],children:v.jsx("meshStandardMaterial",{color:"#2d5016",roughness:.9})})]})]})}function kt({position:a,scale:r,color:i,speed:t}){const s=T.useRef(null);return Ct(c=>{s.current&&(s.current.rotation.x=c.clock.getElapsedTime()*t*.3,s.current.rotation.y=c.clock.getElapsedTime()*t*.5,s.current.position.y=a[1]+Math.sin(c.clock.getElapsedTime()*t)*.2)}),v.jsx(ar,{speed:t,rotationIntensity:.5,floatIntensity:.5,children:v.jsxs("mesh",{ref:s,position:a,scale:r,children:[v.jsx("boxGeometry",{args:[1,1,1]}),v.jsx("meshStandardMaterial",{color:i,roughness:.2,metalness:.8})]})})}function Lr({position:a,rotation:r=0}){return v.jsx(ar,{speed:2,rotationIntensity:.3,floatIntensity:.5,children:v.jsxs("group",{position:a,rotation:[0,r,0],children:[v.jsx(Ce,{args:[1.2,.8,.05],radius:.02,children:v.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.1,metalness:.2})}),v.jsx(Ce,{args:[1.1,.4,.01],radius:.01,position:[0,.2,.026],children:v.jsx("meshStandardMaterial",{color:"#80d0c7"})}),v.jsxs(yr,{position:[0,-.15,.03],transform:!0,occlude:!0,style:{width:"110px",fontSize:"8px",color:"#333",textAlign:"center",pointerEvents:"none",userSelect:"none"},children:[v.jsx("div",{style:{fontWeight:"bold",marginBottom:"2px"},children:"$850,000"}),v.jsx("div",{style:{fontSize:"7px",color:"#666"},children:"4 bd  3 ba  2,400 sqft"})]})]})})}function Ua(){const a=T.useRef(null);return v.jsx(ar,{speed:1.5,rotationIntensity:.2,floatIntensity:.3,children:v.jsxs("group",{ref:a,position:[-3,.5,1],children:[v.jsx(Zt,{args:[.05,.05,1.5,16],position:[0,-.3,0],children:v.jsx("meshStandardMaterial",{color:"#4a4a4a",metalness:.6,roughness:.4})}),v.jsx(Ce,{args:[.8,.5,.05],radius:.02,castShadow:!0,children:v.jsx("meshStandardMaterial",{color:"#dc2626",roughness:.3,metalness:.2})}),v.jsx(yr,{position:[0,0,.03],transform:!0,occlude:!0,style:{width:"80px",textAlign:"center",pointerEvents:"none",userSelect:"none"},children:v.jsx("div",{style:{color:"white",fontSize:"24px",fontWeight:"bold",textShadow:"0 2px 4px rgba(0,0,0,0.3)",letterSpacing:"2px"},children:"SOLD"})})]})})}function ja(){const a=T.useRef(null),r=T.useMemo(()=>{const i=new Float32Array(6e3);for(let t=0;t<2e3;t++){const s=(Math.random()-.5)*15,c=(Math.random()-.5)*15,h=(Math.random()-.5)*15;i.set([s,c,h],t*3)}return i},[]);return Ct(i=>{a.current&&(a.current.rotation.y=i.clock.getElapsedTime()*.05)}),v.jsxs("points",{ref:a,children:[v.jsx("bufferGeometry",{children:v.jsx("bufferAttribute",{attach:"attributes-position",count:r.length/3,array:r,itemSize:3})}),v.jsx("pointsMaterial",{size:.02,color:"#80d0c7",transparent:!0,opacity:.6,sizeAttenuation:!0})]})}function ka({position:a,value:r,label:i,color:t}){return v.jsx(ar,{speed:2.5,rotationIntensity:.4,floatIntensity:.6,children:v.jsxs("group",{position:a,children:[v.jsx(Zt,{args:[.4,.4,.1,32],rotation:[Math.PI/2,0,0],children:v.jsx("meshStandardMaterial",{color:t,roughness:.2,metalness:.8,emissive:t,emissiveIntensity:.3})}),v.jsx(Zt,{args:[.32,.32,.02,32],rotation:[Math.PI/2,0,0],position:[0,0,.06],children:v.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.1,metalness:.3})}),v.jsxs(yr,{position:[0,0,.08],transform:!0,occlude:!0,style:{width:"70px",textAlign:"center",pointerEvents:"none",userSelect:"none"},children:[v.jsx("div",{style:{fontSize:"16px",fontWeight:"bold",color:"#333",marginBottom:"2px"},children:r}),v.jsx("div",{style:{fontSize:"10px",color:"#666"},children:i})]})]})})}function Ba(){const a={teal:"#80d0c7",blue:"#a1c4fd",lightBlue:"#c2e9fb"};return v.jsxs(v.Fragment,{children:[v.jsx("ambientLight",{intensity:.5}),v.jsx("pointLight",{position:[10,10,10],intensity:1,color:"#ffffff"}),v.jsx("pointLight",{position:[-10,-10,-10],intensity:.5,color:"#80d0c7"}),v.jsx("spotLight",{position:[0,5,0],intensity:.5,angle:.6,penumbra:1,color:"#a1c4fd"}),v.jsx(Da,{preset:"city"}),v.jsx(La,{}),v.jsx(Lr,{position:[-3.5,2,-1],rotation:.3}),v.jsx(Lr,{position:[3.5,1.5,0],rotation:-.4}),v.jsx(Ua,{}),v.jsx(ka,{position:[3,2.5,2],value:"$2M+",label:"Sold",color:"#80d0c7"}),v.jsx(kt,{position:[-3,.5,-1],scale:.4,color:a.teal,speed:.8}),v.jsx(kt,{position:[3,-.5,-2],scale:.35,color:a.blue,speed:1.2}),v.jsx(kt,{position:[-2.5,-1.5,1],scale:.3,color:a.lightBlue,speed:1.5}),v.jsx(kt,{position:[2.8,1.5,.5],scale:.45,color:a.teal,speed:.6}),v.jsx(kt,{position:[0,-2,-1.5],scale:.35,color:a.blue,speed:1}),v.jsx(ja,{}),v.jsx(va,{enableZoom:!1,enablePan:!1,autoRotate:!0,autoRotateSpeed:.5,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/2})]})}function za(){return v.jsx("div",{className:"flex items-center justify-center w-full h-full",children:v.jsxs("div",{className:"relative",children:[v.jsx("div",{className:"w-16 h-16 border-4 border-glass-border rounded-full animate-pulse"}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-[#80d0c7] to-[#a1c4fd] rounded-full animate-ping"})})]})})}function Ya({className:a="",height:r="600px"}){return v.jsxs("div",{className:`relative overflow-hidden rounded-2xl ${a}`,style:{height:r},children:[v.jsx("div",{className:"absolute inset-0 bg-glass-background backdrop-blur-sm border border-glass-border rounded-2xl"}),v.jsx("div",{className:"absolute inset-0",children:v.jsx(T.Suspense,{fallback:v.jsx(za,{}),children:v.jsx(Nn,{camera:{position:[0,0,5],fov:75},gl:{antialias:!0,alpha:!0,powerPreference:"high-performance"},dpr:[1,2],children:v.jsx(Ba,{})})})}),v.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-black/10 rounded-2xl pointer-events-none"}),v.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t from-black/20 to-transparent rounded-b-2xl pointer-events-none"})]})}export{Ya as Hero3D};
