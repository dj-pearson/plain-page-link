import{a7 as U,b as $,r as p,s as b,j as e,B as N,C as l,c as o,d as x,ac as J,f as n,a2 as V,b6 as G,e as M,O as y,a0 as Ee,af as Ne,b9 as ve,ag as ye,ar as _e,ah as we,ai as be,L as T,I as B,T as Le,F as ce,G as de,J as oe,K as xe,N as he,a_ as ke,Y as Z,D as Ce,x as Se,a1 as re,as as Ae,aa as qe,Z as Pe,br as Ie,at as Oe,be as Ke}from"./index-CIfNOF3i.js";import{T as le,a as W,b as u,c as F}from"./tabs-CnKvQSsD.js";import{R as ne}from"./refresh-cw-BdXLoj7q.js";import{T as me}from"./triangle-alert-Lz-W7BNH.js";import{B as Q}from"./bell-CFbdzeVM.js";import{f as ee}from"./formatDistanceToNow-COQE-Ol7.js";import{S as se}from"./switch-BURCIz3A.js";import{P as te}from"./plus-BBQjrNBP.js";import{P as ue}from"./play-BeVW-2E0.js";import{T as Re}from"./trash-2-C6tp_CcE.js";import{C as pe}from"./circle-x-D4sUoTPV.js";import{c as Te,d as De,e as Y,h as R,i as Fe,j as A,R as He,L as Be,X as ze,Y as Ue,T as Ve,a as Ge}from"./table-Cmq5jxJU.js";import{T as Me}from"./trending-down-DaNup3fZ.js";import{M as We}from"./minus-Dxbu1Et1.js";import{F as je}from"./file-text-DQ9v_9F9.js";import{L as Ye}from"./link-_lEtg27e.js";import{I as $e}from"./image-DgZgJZ2-.js";import{R as Xe}from"./repeat-DgVe1oBq.js";import{C as Ze}from"./copy-BZRV6ov6.js";const Je=U("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);const Qe=U("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);const es=U("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);const ss=U("FileCode",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);const ts=U("Map",[["polygon",{points:"3 6 9 3 15 6 21 3 21 18 15 21 9 18 3 21",key:"ok2ie8"}],["line",{x1:"9",x2:"9",y1:"3",y2:"18",key:"w34qz5"}],["line",{x1:"15",x2:"15",y1:"6",y2:"21",key:"volv9a"}]]);const ge=U("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);const ie=U("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),as=()=>{const{toast:i}=$(),[j,D]=p.useState(!1),[g,_]=p.useState([]),[d,E]=p.useState([]),[q,m]=p.useState(0),[c,k]=p.useState(0),[h,S]=p.useState(0);p.useEffect(()=>{P(),O();const a=b.channel("seo_notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"seo_notification_queue"},w=>{_(z=>[w.new,...z]),I([w.new,...g])}).subscribe();return()=>{a.unsubscribe()}},[]);const P=async()=>{try{const{data:a,error:w}=await b.from("seo_notification_queue").select("*").order("created_at",{ascending:!1}).limit(50);if(w)throw w;_(a||[]),I(a||[])}catch(a){console.error("Error loading alerts:",a)}},O=async()=>{try{const{data:a,error:w}=await b.from("seo_audit_schedules").select("*").not("last_run_at","is",null).order("last_run_at",{ascending:!1}).limit(5);if(w)throw w;E(a||[])}catch(a){console.error("Error loading recent audits:",a)}},I=a=>{const w=a.filter(H=>H.severity==="critical"&&H.status==="pending").length,z=a.filter(H=>H.severity==="medium"&&H.status==="pending").length,ae=a.filter(H=>H.notification_type==="opportunity"&&H.status==="pending").length;m(w),k(z),S(ae)},L=async a=>{try{const{error:w}=await b.from("seo_notification_queue").update({status:"sent"}).eq("id",a);if(w)throw w;_(z=>z.filter(ae=>ae.id!==a)),I(g.filter(z=>z.id!==a)),i({title:"Notification dismissed",description:"The notification has been marked as read"})}catch(w){i({title:"Error",description:w.message,variant:"destructive"})}},K=async()=>{D(!0),await P(),await O(),D(!1),i({title:"Alerts refreshed",description:"Latest alerts and audit results loaded"})},v=a=>{switch(a){case"critical":return e.jsx(J,{className:"h-5 w-5 text-red-500"});case"high":case"medium":return e.jsx(me,{className:"h-5 w-5 text-yellow-500"});case"low":return e.jsx(V,{className:"h-5 w-5 text-blue-500"});default:return e.jsx(Q,{className:"h-5 w-5 text-gray-500"})}},t=a=>{const w={critical:"destructive",high:"destructive",medium:"default",low:"secondary"};return e.jsx(y,{variant:w[a]||"default",children:a})},f=g.filter(a=>(a.severity==="critical"||a.severity==="high")&&a.notification_type==="critical_issue"&&a.status==="pending"),s=g.filter(a=>a.severity==="medium"&&a.notification_type==="warning"&&a.status==="pending"),r=g.filter(a=>a.notification_type==="opportunity"&&a.status==="pending"),C=g.filter(a=>a.notification_type==="competitor_alert"&&a.status==="pending");return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",children:"SEO Alerts Dashboard"}),e.jsx("p",{className:"text-muted-foreground",children:"Real-time monitoring of SEO issues, warnings, and opportunities"})]}),e.jsxs(N,{onClick:K,disabled:j,variant:"outline",children:[e.jsx(ne,{className:`h-4 w-4 mr-2 ${j?"animate-spin":""}`}),"Refresh"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(l,{className:"border-red-500",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(x,{className:"text-sm flex items-center gap-2",children:[e.jsx(J,{className:"h-4 w-4 text-red-500"}),"Critical Issues"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-red-600",children:q}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Require immediate attention"})]})]}),e.jsxs(l,{className:"border-yellow-500",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(x,{className:"text-sm flex items-center gap-2",children:[e.jsx(me,{className:"h-4 w-4 text-yellow-500"}),"Warnings"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:c}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Should be addressed soon"})]})]}),e.jsxs(l,{className:"border-blue-500",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(x,{className:"text-sm flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-blue-500"}),"Opportunities"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:h}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Potential improvements"})]})]}),e.jsxs(l,{className:"border-green-500",children:[e.jsx(o,{className:"pb-2",children:e.jsxs(x,{className:"text-sm flex items-center gap-2",children:[e.jsx(G,{className:"h-4 w-4 text-green-500"}),"Health Score"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:d[0]?.last_run_results?.overall_score||"N/A"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Latest audit score"})]})]})]}),e.jsxs(le,{defaultValue:"critical",className:"w-full",children:[e.jsxs(W,{className:"grid w-full grid-cols-4",children:[e.jsxs(u,{value:"critical",children:["Critical (",f.length,")"]}),e.jsxs(u,{value:"warnings",children:["Warnings (",s.length,")"]}),e.jsxs(u,{value:"opportunities",children:["Opportunities (",r.length,")"]}),e.jsxs(u,{value:"competitor",children:["Competitors (",C.length,")"]})]}),e.jsx(F,{value:"critical",className:"space-y-4",children:f.length===0?e.jsx(l,{children:e.jsxs(n,{className:"pt-6 text-center text-muted-foreground",children:[e.jsx(G,{className:"h-12 w-12 mx-auto mb-2 text-green-500"}),e.jsx("p",{children:"No critical issues detected"})]})}):f.map(a=>e.jsx(X,{notification:a,onDismiss:L,getSeverityIcon:v,getSeverityBadge:t},a.id))}),e.jsx(F,{value:"warnings",className:"space-y-4",children:s.length===0?e.jsx(l,{children:e.jsxs(n,{className:"pt-6 text-center text-muted-foreground",children:[e.jsx(G,{className:"h-12 w-12 mx-auto mb-2 text-green-500"}),e.jsx("p",{children:"No warnings at this time"})]})}):s.map(a=>e.jsx(X,{notification:a,onDismiss:L,getSeverityIcon:v,getSeverityBadge:t},a.id))}),e.jsx(F,{value:"opportunities",className:"space-y-4",children:r.length===0?e.jsx(l,{children:e.jsxs(n,{className:"pt-6 text-center text-muted-foreground",children:[e.jsx(V,{className:"h-12 w-12 mx-auto mb-2 text-blue-500"}),e.jsx("p",{children:"No new opportunities identified"})]})}):r.map(a=>e.jsx(X,{notification:a,onDismiss:L,getSeverityIcon:v,getSeverityBadge:t},a.id))}),e.jsx(F,{value:"competitor",className:"space-y-4",children:C.length===0?e.jsx(l,{children:e.jsxs(n,{className:"pt-6 text-center text-muted-foreground",children:[e.jsx(Q,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No competitor alerts"})]})}):C.map(a=>e.jsx(X,{notification:a,onDismiss:L,getSeverityIcon:v,getSeverityBadge:t},a.id))})]}),e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Recent Audits"}),e.jsx(M,{children:"Latest automated audit results"})]}),e.jsx(n,{children:d.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"No recent audits found"}):e.jsx("div",{className:"space-y-4",children:d.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:a.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.last_run_at&&`Ran ${ee(new Date(a.last_run_at),{addSuffix:!0})}`})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[a.last_run_results&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold",children:a.last_run_results.overall_score||"N/A"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Score"})]}),e.jsx(y,{variant:a.last_run_status==="success"?"default":"destructive",children:a.last_run_status})]})]},a.id))})})]})]})},X=({notification:i,onDismiss:j,getSeverityIcon:D,getSeverityBadge:g})=>e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[D(i.severity),e.jsxs("div",{children:[e.jsx(x,{className:"text-lg",children:i.title}),e.jsx(M,{children:ee(new Date(i.created_at),{addSuffix:!0})})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[g(i.severity),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>j(i.id),children:e.jsx(Ee,{className:"h-4 w-4"})})]})]})}),e.jsxs(n,{children:[e.jsx("p",{className:"text-sm mb-4",children:i.message}),i.data&&e.jsxs("div",{className:"space-y-2",children:[i.data.critical_issues&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-sm mb-1",children:"Critical Issues:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-muted-foreground",children:i.data.critical_issues.slice(0,3).map((_,d)=>e.jsx("li",{children:_},d))})]}),i.data.warnings&&e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-sm mb-1",children:"Warnings:"}),e.jsx("ul",{className:"list-disc list-inside text-sm text-muted-foreground",children:i.data.warnings.slice(0,3).map((_,d)=>e.jsx("li",{children:_},d))})]}),i.data.overall_score&&e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("span",{className:"text-sm font-semibold",children:"Overall Score:"}),e.jsxs("span",{className:"text-lg font-bold",children:[i.data.overall_score,"/100"]})]})]})]})]}),fe=[{value:"missing_meta_description",label:"Missing Meta Description"},{value:"missing_alt_text",label:"Missing Alt Text"},{value:"broken_link",label:"Broken Link"},{value:"missing_h1",label:"Missing H1"},{value:"duplicate_title",label:"Duplicate Title"},{value:"thin_content",label:"Thin Content"},{value:"slow_page",label:"Slow Page Speed"},{value:"missing_schema",label:"Missing Schema Markup"}],rs=[{value:"generate_meta_description",label:"Generate Meta Description (AI)"},{value:"generate_alt_text",label:"Generate Alt Text (AI)"},{value:"update_link",label:"Update Link"},{value:"add_schema_markup",label:"Add Schema Markup"},{value:"optimize_image",label:"Optimize Image"},{value:"fix_heading_structure",label:"Fix Heading Structure"}],is=()=>{const{toast:i}=$(),[j,D]=p.useState([]),[g,_]=p.useState([]),[d,E]=p.useState([]),[q,m]=p.useState(!1),[c,k]=p.useState(!1),[h,S]=p.useState({name:"",description:"",issue_type:"",fix_action:"",requires_approval:!0,auto_apply:!1,priority:50});p.useEffect(()=>{P(),O(),I()},[]);const P=async()=>{try{const{data:s,error:r}=await b.from("seo_autofix_rules").select("*").order("priority",{ascending:!1});if(r)throw r;D(s||[])}catch(s){console.error("Error loading rules:",s)}},O=async()=>{try{const{data:s,error:r}=await b.from("seo_autofix_history").select("*").order("applied_at",{ascending:!1}).limit(50);if(r)throw r;_(s||[])}catch(s){console.error("Error loading history:",s)}},I=async()=>{try{const{data:s,error:r}=await b.from("seo_autofix_history").select("*").eq("result","pending_approval").order("applied_at",{ascending:!1});if(r)throw r;E(s||[])}catch(s){console.error("Error loading pending approvals:",s)}},L=async()=>{if(!h.name||!h.issue_type||!h.fix_action){i({title:"Missing Fields",description:"Please fill in all required fields",variant:"destructive"});return}m(!0);try{const{data:s,error:r}=await b.from("seo_autofix_rules").insert([{name:h.name,description:h.description,issue_type:h.issue_type,conditions:{},fix_action:{action:h.fix_action},requires_approval:h.requires_approval,auto_apply:h.auto_apply,priority:h.priority}]).select();if(r)throw r;i({title:"Rule Created",description:"Auto-fix rule has been created successfully"}),k(!1),S({name:"",description:"",issue_type:"",fix_action:"",requires_approval:!0,auto_apply:!1,priority:50}),await P()}catch(s){i({title:"Error",description:s.message,variant:"destructive"})}finally{m(!1)}},K=async(s,r)=>{try{const{error:C}=await b.from("seo_autofix_rules").update({active:!r}).eq("id",s);if(C)throw C;i({title:r?"Rule Disabled":"Rule Enabled",description:`Auto-fix rule has been ${r?"disabled":"enabled"}`}),await P()}catch(C){i({title:"Error",description:C.message,variant:"destructive"})}},v=async s=>{if(confirm("Are you sure you want to delete this rule?"))try{const{error:r}=await b.from("seo_autofix_rules").delete().eq("id",s);if(r)throw r;i({title:"Rule Deleted",description:"Auto-fix rule has been deleted"}),await P()}catch(r){i({title:"Error",description:r.message,variant:"destructive"})}},t=async s=>{try{const{error:r}=await b.from("seo_autofix_history").update({result:"failed",error_message:"Rejected by admin"}).eq("id",s);if(r)throw r;i({title:"Fix Rejected",description:"The fix has been rejected"}),I(),O()}catch(r){i({title:"Error",description:r.message,variant:"destructive"})}},f=s=>{switch(s){case"success":return e.jsx(G,{className:"h-5 w-5 text-green-500"});case"failed":return e.jsx(pe,{className:"h-5 w-5 text-red-500"});case"pending_approval":return e.jsx(Z,{className:"h-5 w-5 text-yellow-500"});default:return e.jsx(Z,{className:"h-5 w-5 text-gray-500"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(ie,{className:"h-6 w-6"}),"Auto-Fix Engine"]}),e.jsx("p",{className:"text-muted-foreground",children:"Automatically detect and fix common SEO issues"})]}),e.jsxs(Ne,{open:c,onOpenChange:k,children:[e.jsx(ve,{asChild:!0,children:e.jsxs(N,{children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Create Rule"]})}),e.jsxs(ye,{className:"max-w-2xl",children:[e.jsxs(_e,{children:[e.jsx(we,{children:"Create Auto-Fix Rule"}),e.jsx(be,{children:"Define a rule to automatically fix SEO issues"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"rule-name",children:"Rule Name *"}),e.jsx(B,{id:"rule-name",placeholder:"e.g., Auto-generate missing alt text",value:h.name,onChange:s=>S({...h,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"rule-description",children:"Description"}),e.jsx(Le,{id:"rule-description",placeholder:"Describe what this rule does...",value:h.description,onChange:s=>S({...h,description:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"issue-type",children:"Issue Type *"}),e.jsxs(ce,{value:h.issue_type,onValueChange:s=>S({...h,issue_type:s}),children:[e.jsx(de,{children:e.jsx(oe,{placeholder:"Select issue type"})}),e.jsx(xe,{children:fe.map(s=>e.jsx(he,{value:s.value,children:s.label},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"fix-action",children:"Fix Action *"}),e.jsxs(ce,{value:h.fix_action,onValueChange:s=>S({...h,fix_action:s}),children:[e.jsx(de,{children:e.jsx(oe,{placeholder:"Select fix action"})}),e.jsx(xe,{children:rs.map(s=>e.jsx(he,{value:s.value,children:s.label},s.value))})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"priority",children:"Priority (0-100)"}),e.jsx(B,{id:"priority",type:"number",min:"0",max:"100",value:h.priority,onChange:s=>S({...h,priority:parseInt(s.target.value)||50})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Higher priority rules are executed first"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{id:"requires-approval",checked:h.requires_approval,onCheckedChange:s=>S({...h,requires_approval:s})}),e.jsx(T,{htmlFor:"requires-approval",children:"Requires Approval"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(se,{id:"auto-apply",checked:h.auto_apply,onCheckedChange:s=>S({...h,auto_apply:s}),disabled:h.requires_approval}),e.jsx(T,{htmlFor:"auto-apply",children:"Auto Apply"})]})]})]}),e.jsxs(ke,{children:[e.jsx(N,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),e.jsx(N,{onClick:L,disabled:q,children:q?"Creating...":"Create Rule"})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Active Rules"})}),e.jsx(n,{children:e.jsx("div",{className:"text-3xl font-bold",children:j.filter(s=>s.active).length})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Pending Approvals"})}),e.jsx(n,{children:e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:d.length})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Total Fixes Applied"})}),e.jsx(n,{children:e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:j.reduce((s,r)=>s+r.applied_count,0)})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Success Rate"})}),e.jsx(n,{children:e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:[j.reduce((s,r)=>s+r.applied_count,0)>0?Math.round(j.reduce((s,r)=>s+r.success_count,0)/j.reduce((s,r)=>s+r.applied_count,0)*100):0,"%"]})})]})]}),e.jsxs(le,{defaultValue:"rules",className:"w-full",children:[e.jsxs(W,{className:"grid w-full grid-cols-3",children:[e.jsxs(u,{value:"rules",children:["Rules (",j.length,")"]}),e.jsxs(u,{value:"approvals",children:["Pending Approvals (",d.length,")"]}),e.jsxs(u,{value:"history",children:["History (",g.length,")"]})]}),e.jsx(F,{value:"rules",className:"space-y-4",children:j.length===0?e.jsx(l,{children:e.jsxs(n,{className:"pt-6 text-center text-muted-foreground",children:[e.jsx(ie,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No auto-fix rules created yet"}),e.jsxs(N,{className:"mt-4",onClick:()=>k(!0),children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Create Your First Rule"]})]})}):j.map(s=>e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs(x,{className:"flex items-center gap-2",children:[s.name,e.jsxs(y,{variant:s.active?"default":"secondary",children:[s.active?e.jsx(ue,{className:"h-3 w-3 mr-1"}):e.jsx(ge,{className:"h-3 w-3 mr-1"}),s.active?"Active":"Inactive"]}),e.jsxs(y,{variant:"outline",children:["Priority: ",s.priority]})]}),e.jsx(M,{children:s.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>K(s.id,s.active),children:s.active?e.jsx(ge,{className:"h-4 w-4"}):e.jsx(ue,{className:"h-4 w-4"})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>v(s.id),children:e.jsx(Re,{className:"h-4 w-4"})})]})]})}),e.jsxs(n,{children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Issue Type"}),e.jsx("p",{className:"font-semibold",children:fe.find(r=>r.value===s.issue_type)?.label||s.issue_type})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Applied"}),e.jsx("p",{className:"font-semibold",children:s.applied_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Success"}),e.jsx("p",{className:"font-semibold text-green-600",children:s.success_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Failed"}),e.jsx("p",{className:"font-semibold text-red-600",children:s.failure_count})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[s.requires_approval&&e.jsx(y,{variant:"outline",children:"Requires Approval"}),s.auto_apply&&e.jsx(y,{variant:"outline",children:"Auto Apply"})]})]})]},s.id))}),e.jsx(F,{value:"approvals",className:"space-y-4",children:d.length===0?e.jsx(l,{children:e.jsxs(n,{className:"pt-6 text-center text-muted-foreground",children:[e.jsx(G,{className:"h-12 w-12 mx-auto mb-2 text-green-500"}),e.jsx("p",{children:"No pending approvals"})]})}):d.map(s=>e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[f(s.result),"Pending Fix Approval"]}),e.jsx(M,{children:ee(new Date(s.applied_at),{addSuffix:!0})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{size:"sm",variant:"outline",onClick:()=>approveFiximestamp(s.id),children:[e.jsx(G,{className:"h-4 w-4 mr-1"}),"Approve"]}),e.jsxs(N,{size:"sm",variant:"destructive",onClick:()=>t(s.id),children:[e.jsx(pe,{className:"h-4 w-4 mr-1"}),"Reject"]})]})]})}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:"Issue Type:"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.issue_type})]}),s.fix_applied&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold",children:"Proposed Fix:"}),e.jsx("pre",{className:"text-xs bg-muted p-2 rounded-md mt-1 overflow-auto",children:JSON.stringify(s.fix_applied,null,2)})]})]})})]},s.id))}),e.jsx(F,{value:"history",className:"space-y-4",children:g.length===0?e.jsx(l,{children:e.jsxs(n,{className:"pt-6 text-center text-muted-foreground",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No fix history yet"})]})}):g.map(s=>e.jsxs(l,{children:[e.jsx(o,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(x,{className:"flex items-center gap-2",children:[f(s.result),s.issue_type]}),e.jsx(M,{children:ee(new Date(s.applied_at),{addSuffix:!0})})]}),e.jsx(y,{variant:s.result==="success"?"default":s.result==="failed"?"destructive":"secondary",children:s.result})]})}),s.error_message&&e.jsx(n,{children:e.jsx("p",{className:"text-sm text-red-600",children:s.error_message})})]},s.id))})]})]})},ls=()=>{const{toast:i}=$(),[j,D]=p.useState([]),[g,_]=p.useState(!1),[d,E]=p.useState(""),[q,m]=p.useState(null),[c,k]=p.useState([]);p.useEffect(()=>{h()},[]);const h=async()=>{_(!0);try{const{data:s,error:r}=await b.from("seo_keywords").select("*").order("current_position",{ascending:!0});if(r)throw r;D(s||[])}catch(s){i({title:"Error",description:s.message,variant:"destructive"})}finally{_(!1)}},S=async s=>{try{const{data:r,error:C}=await b.from("seo_keyword_history").select("keyword, position, checked_at").eq("keyword",s).order("checked_at",{ascending:!0}).limit(30);if(C)throw C;k(r||[])}catch(r){console.error("Error loading keyword history:",r)}},P=async()=>{_(!0);try{const{error:s}=await Se.invoke("check-keyword-positions",{body:{}});if(s)throw s;i({title:"Positions Updated",description:"Keyword positions have been refreshed"}),await h()}catch(s){i({title:"Error",description:s.message,variant:"destructive"})}finally{_(!1)}},O=(s,r)=>s<r?e.jsx(V,{className:"h-4 w-4 text-green-500"}):s>r?e.jsx(Me,{className:"h-4 w-4 text-red-500"}):e.jsx(We,{className:"h-4 w-4 text-gray-500"}),I=(s,r)=>{const C=r-s;return C>0?e.jsxs("span",{className:"text-green-600",children:["+",C]}):C<0?e.jsx("span",{className:"text-red-600",children:C}):e.jsx("span",{className:"text-gray-500",children:"0"})},L=s=>s>=70?e.jsx(y,{variant:"destructive",children:"Hard"}):s>=40?e.jsx(y,{variant:"default",children:"Medium"}):e.jsx(y,{variant:"secondary",children:"Easy"}),K=j.filter(s=>s.keyword.toLowerCase().includes(d.toLowerCase())),v=j.filter(s=>s.previous_position&&s.current_position!==s.previous_position).sort((s,r)=>r.previous_position-r.current_position-(s.previous_position-s.current_position)).slice(0,5),t=j.filter(s=>s.current_position<=10),f=j.filter(s=>s.current_position>20&&s.search_volume>100);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold",children:"Keywords Tracker"}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor keyword rankings and track position changes"})]}),e.jsxs(N,{onClick:P,disabled:g,children:[e.jsx(ne,{className:`h-4 w-4 mr-2 ${g?"animate-spin":""}`}),"Check Positions"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Total Keywords"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold",children:j.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Being tracked"})]})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Top 10 Rankings"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Keywords in top 10"})]})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Biggest Gain"})}),e.jsx(n,{children:v.length>0&&v[0].current_position<v[0].previous_position?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-3xl font-bold text-green-600",children:["+",v[0].previous_position-v[0].current_position]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:v[0].keyword})]}):e.jsx("div",{className:"text-3xl font-bold text-gray-400",children:"-"})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsxs(x,{className:"text-sm flex items-center gap-1",children:[e.jsx(J,{className:"h-4 w-4"}),"Needs Attention"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:f.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Keywords to optimize"})]})]})]}),e.jsx("div",{className:"flex gap-4",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ce,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(B,{placeholder:"Search keywords...",value:d,onChange:s=>E(s.target.value),className:"pl-9"})]})}),e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"All Keywords"}),e.jsxs(M,{children:[K.length," keywords found"]})]}),e.jsx(n,{children:e.jsx("div",{className:"overflow-auto",children:e.jsxs(Te,{children:[e.jsx(De,{children:e.jsxs(Y,{children:[e.jsx(R,{children:"Keyword"}),e.jsx(R,{children:"Position"}),e.jsx(R,{children:"Change"}),e.jsx(R,{children:"Search Volume"}),e.jsx(R,{children:"Difficulty"}),e.jsx(R,{children:"URL"}),e.jsx(R,{children:"Last Checked"}),e.jsx(R,{children:"Actions"})]})}),e.jsx(Fe,{children:K.length===0?e.jsx(Y,{children:e.jsx(A,{colSpan:8,className:"text-center text-muted-foreground",children:"No keywords found"})}):K.map(s=>e.jsxs(Y,{children:[e.jsx(A,{className:"font-medium",children:s.keyword}),e.jsx(A,{children:e.jsxs(y,{variant:s.current_position<=10?"default":"outline",children:["#",s.current_position]})}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[O(s.current_position,s.previous_position||s.current_position),I(s.current_position,s.previous_position||s.current_position)]})}),e.jsx(A,{children:s.search_volume?.toLocaleString()||"N/A"}),e.jsx(A,{children:L(s.difficulty||0)}),e.jsx(A,{className:"max-w-xs truncate",children:s.url||"-"}),e.jsx(A,{children:s.last_checked?new Date(s.last_checked).toLocaleDateString():"Never"}),e.jsx(A,{children:e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>{m(s),S(s.keyword)},children:"View History"})})]},s.id))})]})})})]}),q&&e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsxs(x,{children:["Position History: ",q.keyword]}),e.jsx(M,{children:"Ranking positions over the last 30 checks"})]}),e.jsxs(n,{children:[c.length>0?e.jsx(He,{width:"100%",height:300,children:e.jsxs(Be,{data:c,children:[e.jsx(ze,{dataKey:"checked_at",tickFormatter:s=>new Date(s).toLocaleDateString()}),e.jsx(Ue,{reversed:!0,domain:[0,100]}),e.jsx(Ve,{labelFormatter:s=>new Date(s).toLocaleDateString(),formatter:s=>[`Position ${s}`,"Rank"]}),e.jsx(Ge,{type:"monotone",dataKey:"position",stroke:"#2563eb",strokeWidth:2,dot:{r:4}})]})}):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No history available for this keyword"}),e.jsx("div",{className:"mt-4",children:e.jsx(N,{variant:"outline",onClick:()=>m(null),children:"Close"})})]})]}),v.length>0&&e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Top Movers"}),e.jsx(M,{children:"Keywords with the biggest position changes"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:v.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:s.keyword}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Position: #",s.current_position]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[O(s.current_position,s.previous_position),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-bold",children:I(s.current_position,s.previous_position)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[s.previous_position," â†’ ",s.current_position]})]})]})]},s.id))})})]})]})},ns=()=>{const{toast:i}=$(),[j,D]=p.useState([]),[g,_]=p.useState([]),[d,E]=p.useState(!1),[q,m]=p.useState(!1),[c,k]=p.useState({competitor_domain:"",competitor_name:"",keywords:"",check_frequency:"weekly",alert_on_rank_change:!0,alert_on_new_backlinks:!0,rank_change_threshold:5});p.useEffect(()=>{h(),S()},[]);const h=async()=>{try{const{data:t,error:f}=await b.from("seo_competitor_tracking").select("*").order("created_at",{ascending:!1});if(f)throw f;D(t||[])}catch(t){console.error("Error loading competitors:",t)}},S=async()=>{try{const{data:t,error:f}=await b.from("seo_competitor_analysis").select("*").order("analyzed_at",{ascending:!1}).limit(100);if(f)throw f;_(t||[])}catch(t){console.error("Error loading analysis:",t)}},P=async()=>{if(!c.competitor_domain){i({title:"Domain Required",description:"Please enter a competitor domain",variant:"destructive"});return}E(!0);try{const t=c.keywords.split(",").map(s=>s.trim()).filter(s=>s.length>0),{error:f}=await b.from("seo_competitor_tracking").insert([{competitor_domain:c.competitor_domain,competitor_name:c.competitor_name||c.competitor_domain,keywords:t,check_frequency:c.check_frequency,alert_on_rank_change:c.alert_on_rank_change,alert_on_new_backlinks:c.alert_on_new_backlinks,rank_change_threshold:c.rank_change_threshold}]);if(f)throw f;i({title:"Competitor Added",description:"Competitor tracking has been configured"}),m(!1),k({competitor_domain:"",competitor_name:"",keywords:"",check_frequency:"weekly",alert_on_rank_change:!0,alert_on_new_backlinks:!0,rank_change_threshold:5}),await h()}catch(t){i({title:"Error",description:t.message,variant:"destructive"})}finally{E(!1)}},O=async t=>{if(confirm("Are you sure you want to stop tracking this competitor?"))try{const{error:f}=await b.from("seo_competitor_tracking").delete().eq("id",t);if(f)throw f;i({title:"Competitor Removed",description:"Competitor tracking has been stopped"}),await h()}catch(f){i({title:"Error",description:f.message,variant:"destructive"})}},I=async()=>{E(!0);try{i({title:"Analysis Refreshing",description:"Competitor analysis is being updated..."}),await new Promise(t=>setTimeout(t,2e3)),await S(),i({title:"Analysis Complete",description:"Competitor data has been refreshed"})}catch(t){i({title:"Error",description:t.message,variant:"destructive"})}finally{E(!1)}},L=g.filter(t=>t.gap<0&&Math.abs(t.gap)<=10),K=g.filter(t=>t.gap>0&&t.our_position<=10),v=g.filter(t=>t.their_position<=10&&t.our_position>10&&t.search_volume>100);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(re,{className:"h-6 w-6"}),"Competitor Matrix"]}),e.jsx("p",{className:"text-muted-foreground",children:"Monitor competitor rankings and identify opportunities"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(N,{variant:"outline",onClick:I,disabled:d,children:[e.jsx(ne,{className:`h-4 w-4 mr-2 ${d?"animate-spin":""}`}),"Refresh"]}),e.jsxs(Ne,{open:q,onOpenChange:m,children:[e.jsx(ve,{asChild:!0,children:e.jsxs(N,{children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Add Competitor"]})}),e.jsxs(ye,{children:[e.jsxs(_e,{children:[e.jsx(we,{children:"Add Competitor"}),e.jsx(be,{children:"Configure automated competitor tracking"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"domain",children:"Competitor Domain *"}),e.jsx(B,{id:"domain",placeholder:"competitor.com",value:c.competitor_domain,onChange:t=>k({...c,competitor_domain:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"name",children:"Competitor Name"}),e.jsx(B,{id:"name",placeholder:"Competitor Inc.",value:c.competitor_name,onChange:t=>k({...c,competitor_name:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"keywords",children:"Keywords to Track"}),e.jsx(B,{id:"keywords",placeholder:"keyword1, keyword2, keyword3",value:c.keywords,onChange:t=>k({...c,keywords:t.target.value})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Comma-separated list of keywords"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{htmlFor:"threshold",children:"Rank Change Alert Threshold"}),e.jsx(B,{id:"threshold",type:"number",value:c.rank_change_threshold,onChange:t=>k({...c,rank_change_threshold:parseInt(t.target.value)||5})}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Alert when position changes by more than this number"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"rank-alert",children:"Alert on Rank Changes"}),e.jsx(se,{id:"rank-alert",checked:c.alert_on_rank_change,onCheckedChange:t=>k({...c,alert_on_rank_change:t})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{htmlFor:"backlink-alert",children:"Alert on New Backlinks"}),e.jsx(se,{id:"backlink-alert",checked:c.alert_on_new_backlinks,onCheckedChange:t=>k({...c,alert_on_new_backlinks:t})})]})]}),e.jsxs(ke,{children:[e.jsx(N,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),e.jsx(N,{onClick:P,disabled:d,children:d?"Adding...":"Add Competitor"})]})]})]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Tracked Competitors"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold",children:j.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Being monitored"})]})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Keyword Gaps"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-yellow-600",children:L.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Close to outranking"})]})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Winning Keywords"})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:K.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Outranking competitors"})]})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsxs(x,{className:"text-sm flex items-center gap-1",children:[e.jsx(V,{className:"h-4 w-4"}),"Opportunities"]})}),e.jsxs(n,{children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:v.length}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"High-value targets"})]})]})]}),e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Tracked Competitors"}),e.jsxs(M,{children:[j.length," competitors being monitored"]})]}),e.jsx(n,{children:j.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx(re,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No competitors tracked yet"}),e.jsxs(N,{className:"mt-4",onClick:()=>m(!0),children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Add Your First Competitor"]})]}):e.jsx("div",{className:"space-y-4",children:j.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-semibold",children:t.competitor_name}),e.jsx("a",{href:`https://${t.competitor_domain}`,target:"_blank",rel:"noopener noreferrer",className:"text-muted-foreground hover:text-foreground",children:e.jsx(Ae,{className:"h-4 w-4"})}),e.jsx(y,{variant:t.active?"default":"secondary",children:t.active?"Active":"Paused"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t.competitor_domain}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs(y,{variant:"outline",children:[t.keywords?.length||0," keywords"]}),e.jsxs(y,{variant:"outline",children:["Check ",t.check_frequency]}),t.alert_on_rank_change&&e.jsxs(y,{variant:"outline",children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"Rank alerts"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-right mr-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Last checked"}),e.jsx("p",{className:"text-sm font-semibold",children:t.last_checked_at?new Date(t.last_checked_at).toLocaleDateString():"Never"})]}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>O(t.id),children:e.jsx(Re,{className:"h-4 w-4"})})]})]},t.id))})})]}),v.length>0&&e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Top Opportunities"}),e.jsx(M,{children:"High-value keywords where competitors rank well and you don't"})]}),e.jsx(n,{children:e.jsxs(Te,{children:[e.jsx(De,{children:e.jsxs(Y,{children:[e.jsx(R,{children:"Keyword"}),e.jsx(R,{children:"Competitor"}),e.jsx(R,{children:"Their Position"}),e.jsx(R,{children:"Your Position"}),e.jsx(R,{children:"Gap"}),e.jsx(R,{children:"Search Volume"})]})}),e.jsx(Fe,{children:v.slice(0,10).map(t=>e.jsxs(Y,{children:[e.jsx(A,{className:"font-medium",children:t.keyword}),e.jsx(A,{children:t.competitor_domain}),e.jsx(A,{children:e.jsxs(y,{variant:"default",children:["#",t.their_position]})}),e.jsx(A,{children:e.jsxs(y,{variant:"outline",children:["#",t.our_position]})}),e.jsx(A,{children:e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(Me,{className:"h-4 w-4"}),t.gap]})}),e.jsx(A,{children:t.search_volume?.toLocaleString()||"N/A"})]},t.id))})]})})]}),L.length>0&&e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"Close Keyword Gaps"}),e.jsx(M,{children:"Keywords where you're close to outranking competitors"})]}),e.jsx(n,{children:e.jsx("div",{className:"space-y-4",children:L.slice(0,5).map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:t.keyword}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["vs ",t.competitor_domain]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"You"}),e.jsxs(y,{variant:"outline",children:["#",t.our_position]})]}),e.jsxs("div",{className:"text-yellow-600 font-bold",children:[Math.abs(t.gap)," positions"]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Them"}),e.jsxs(y,{variant:"default",children:["#",t.their_position]})]})]})]},t.id))})})]})]})},Ss=()=>{const{toast:i}=$(),[j,D]=p.useState(!1),[g,_]=p.useState(""),[d,E]=p.useState(null),q=async()=>{if(!g){i({title:"URL Required",description:"Please enter a URL to audit",variant:"destructive"});return}D(!0);try{const{data:m,error:c}=await Se.invoke("seo-audit",{body:{url:g,auditType:"full",saveResults:!0}});if(c)throw c;E(m.audit),i({title:"Audit Complete",description:`Overall score: ${m.audit.overallScore}/100`})}catch(m){i({title:"Audit Failed",description:m.message,variant:"destructive"})}finally{D(!1)}};return e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"SEO Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Comprehensive SEO tools and analytics for your website"})]}),e.jsxs(le,{defaultValue:"alerts",className:"w-full",children:[e.jsxs(W,{className:"grid grid-cols-4 lg:grid-cols-4 gap-2 h-auto mb-2",children:[e.jsxs(u,{value:"alerts",className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Alerts"})]}),e.jsxs(u,{value:"autofix",className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Auto-Fix"})]}),e.jsxs(u,{value:"keywords",className:"flex items-center gap-2",children:[e.jsx(qe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Keywords"})]}),e.jsxs(u,{value:"competitors",className:"flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Competitors"})]})]}),e.jsxs(W,{className:"grid grid-cols-6 lg:grid-cols-11 gap-2 h-auto",children:[e.jsxs(u,{value:"audit",className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Audit"})]}),e.jsxs(u,{value:"pages",className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Pages"})]}),e.jsxs(u,{value:"monitoring",className:"flex items-center gap-2",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Monitoring"})]}),e.jsxs(u,{value:"meta",className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Meta Tags"})]}),e.jsxs(u,{value:"robots",className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"robots.txt"})]}),e.jsxs(u,{value:"sitemap",className:"flex items-center gap-2",children:[e.jsx(ts,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Sitemap"})]}),e.jsxs(u,{value:"structured",className:"flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Schema"})]}),e.jsxs(u,{value:"performance",className:"flex items-center gap-2",children:[e.jsx(Pe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Performance"})]}),e.jsxs(u,{value:"backlinks",className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Backlinks"})]})]}),e.jsxs(W,{className:"grid grid-cols-6 lg:grid-cols-11 gap-2 h-auto mt-2",children:[e.jsxs(u,{value:"broken-links",className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Broken Links"})]}),e.jsxs(u,{value:"link-structure",className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Links"})]}),e.jsxs(u,{value:"content",className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Content"})]}),e.jsxs(u,{value:"crawler",className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Crawler"})]}),e.jsxs(u,{value:"images",className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Images"})]}),e.jsxs(u,{value:"redirects",className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Redirects"})]}),e.jsxs(u,{value:"duplicate",className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Duplicates"})]}),e.jsxs(u,{value:"security",className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Security"})]}),e.jsxs(u,{value:"mobile",className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Mobile"})]}),e.jsxs(u,{value:"budget",className:"flex items-center gap-2",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Budget"})]}),e.jsxs(u,{value:"semantic",className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Semantic"})]})]}),e.jsx(F,{value:"audit",children:e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{children:"SEO Audit"}),e.jsx(M,{children:"Run a comprehensive SEO audit on any URL"})]}),e.jsx(n,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(T,{htmlFor:"audit-url",children:"URL to Audit"}),e.jsx(B,{id:"audit-url",placeholder:"https://example.com",value:g,onChange:m=>_(m.target.value)})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(N,{onClick:q,disabled:j,children:j?"Running...":"Run Audit"})})]}),d&&e.jsxs("div",{className:"mt-6 grid gap-4 md:grid-cols-4",children:[e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Overall Score"})}),e.jsx(n,{children:e.jsxs("div",{className:"text-3xl font-bold",children:[d.overallScore,"/100"]})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"SEO Score"})}),e.jsx(n,{children:e.jsxs("div",{className:"text-3xl font-bold",children:[d.seoScore,"/100"]})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Performance"})}),e.jsx(n,{children:e.jsxs("div",{className:"text-3xl font-bold",children:[d.performanceScore,"/100"]})})]}),e.jsxs(l,{children:[e.jsx(o,{className:"pb-2",children:e.jsx(x,{className:"text-sm",children:"Accessibility"})}),e.jsx(n,{children:e.jsxs("div",{className:"text-3xl font-bold",children:[d.accessibilityScore,"/100"]})})]})]}),d&&e.jsxs("div",{className:"mt-6 space-y-4",children:[d.criticalIssues.length>0&&e.jsxs(l,{className:"border-red-500",children:[e.jsx(o,{children:e.jsxs(x,{className:"text-red-600",children:["Critical Issues (",d.criticalIssues.length,")"]})}),e.jsx(n,{children:e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:d.criticalIssues.map((m,c)=>e.jsx("li",{className:"text-red-600",children:m},c))})})]}),d.warnings.length>0&&e.jsxs(l,{className:"border-yellow-500",children:[e.jsx(o,{children:e.jsxs(x,{className:"text-yellow-600",children:["Warnings (",d.warnings.length,")"]})}),e.jsx(n,{children:e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:d.warnings.map((m,c)=>e.jsx("li",{className:"text-yellow-600",children:m},c))})})]}),d.recommendations.length>0&&e.jsxs(l,{className:"border-blue-500",children:[e.jsx(o,{children:e.jsxs(x,{className:"text-blue-600",children:["Recommendations (",d.recommendations.length,")"]})}),e.jsx(n,{children:e.jsx("ul",{className:"list-disc pl-5 space-y-1",children:d.recommendations.map((m,c)=>e.jsx("li",{className:"text-blue-600",children:m},c))})})]})]})]})})]})}),e.jsx(F,{value:"alerts",children:e.jsx(as,{})}),e.jsx(F,{value:"autofix",children:e.jsx(is,{})}),e.jsx(F,{value:"keywords",children:e.jsx(ls,{})}),e.jsx(F,{value:"competitors",children:e.jsx(ns,{})}),["pages","monitoring","meta","robots","sitemap","structured","performance","backlinks","broken-links","link-structure","content","crawler","images","redirects","duplicate","security","mobile","budget","semantic"].map(m=>e.jsx(F,{value:m,children:e.jsxs(l,{children:[e.jsxs(o,{children:[e.jsx(x,{className:"capitalize",children:m.replace("-"," ")}),e.jsxs(M,{children:[m.charAt(0).toUpperCase()+m.slice(1).replace("-"," ")," management and analysis"]})]}),e.jsx(n,{children:e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"This feature is under development."}),e.jsx("p",{className:"text-sm mt-2",children:"The backend functions are ready. UI coming soon!"})]})})]})},m))]})]})};export{es as D,Ss as S};
