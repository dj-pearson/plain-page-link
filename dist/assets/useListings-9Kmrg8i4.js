import{p as y,aS as f,D as m,s as n}from"./index-DliZj9NM.js";import{u as a}from"./useMutation-EUGWti0R.js";function h(){const{user:e}=y(),r=f(),{data:u=[],isLoading:d}=m({queryKey:["listings",e?.id],queryFn:async()=>{if(!e?.id)return[];const{data:t,error:i}=await n.from("listings").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(i)throw i;return t},enabled:!!e?.id}),c=a({mutationFn:async t=>{if(!e?.id)throw new Error("User not authenticated");const{data:i,error:s}=await n.from("listings").insert({user_id:e.id,...t}).select().single();if(s)throw s;return i},onSuccess:()=>{r.invalidateQueries({queryKey:["listings",e?.id]})}}),l=a({mutationFn:async({id:t,...i})=>{const{data:s,error:o}=await n.from("listings").update(i).eq("id",t).select().single();if(o)throw o;return s},onSuccess:()=>{r.invalidateQueries({queryKey:["listings",e?.id]})}}),g=a({mutationFn:async t=>{const{error:i}=await n.from("listings").delete().eq("id",t);if(i)throw i},onSuccess:()=>{r.invalidateQueries({queryKey:["listings",e?.id]})}});return{listings:u,isLoading:d,addListing:c,updateListing:l,deleteListing:g}}export{h as u};
