{"version":3,"file":"ResetPassword-DYYNdGUv.js","sources":["../../src/pages/auth/ResetPassword.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { Home, Lock, Eye, EyeOff, Check, Loader2 } from \"lucide-react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { PasswordStrengthIndicator } from \"@/components/PasswordStrengthIndicator\";\n\nexport default function ResetPassword() {\n  const navigate = useNavigate();\n  const [password, setPassword] = useState(\"\");\n  const [confirmPassword, setConfirmPassword] = useState(\"\");\n  const [showPassword, setShowPassword] = useState(false);\n  const [showConfirmPassword, setShowConfirmPassword] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [success, setSuccess] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(\"\");\n\n    if (password !== confirmPassword) {\n      setError(\"Passwords don't match\");\n      return;\n    }\n\n    // SECURITY FIX: Enforce 12 character minimum\n    if (password.length < 12) {\n      setError(\"Password must be at least 12 characters\");\n      return;\n    }\n\n    // Additional password strength checks\n    if (!/[a-z]/.test(password)) {\n      setError(\"Password must contain at least one lowercase letter\");\n      return;\n    }\n    if (!/[A-Z]/.test(password)) {\n      setError(\"Password must contain at least one uppercase letter\");\n      return;\n    }\n    if (!/\\d/.test(password)) {\n      setError(\"Password must contain at least one number\");\n      return;\n    }\n    if (!/[^a-zA-Z\\d]/.test(password)) {\n      setError(\"Password must contain at least one special character\");\n      return;\n    }\n\n    setLoading(true);\n\n    const { error } = await supabase.auth.updateUser({\n      password: password,\n    });\n\n    if (error) {\n      setError(error.message);\n      setLoading(false);\n    } else {\n      setSuccess(true);\n      setTimeout(() => {\n        navigate(\"/auth/login\");\n      }, 2000);\n    }\n  };\n\n  if (success) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50\">\n        <header className=\"bg-white/80 backdrop-blur-sm border-b border-gray-200\">\n          <div className=\"container mx-auto px-4 py-3\">\n            <Link to=\"/\" className=\"flex items-center gap-2 text-xl font-bold text-gray-900 hover:text-blue-600 transition-colors\">\n              <Home className=\"h-6 w-6 text-blue-600\" />\n              AgentBio.net\n            </Link>\n          </div>\n        </header>\n\n        <div className=\"flex items-center justify-center px-4 py-12\">\n          <div className=\"bg-white rounded-lg shadow-lg p-8 max-w-md w-full text-center\">\n            <div className=\"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4\">\n              <Check className=\"h-8 w-8 text-green-600\" />\n            </div>\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Password Reset Successful!</h2>\n            <p className=\"text-gray-600 mb-4\">\n              Your password has been updated successfully.\n            </p>\n            <p className=\"text-sm text-gray-500\">\n              Redirecting you to login...\n            </p>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-purple-50\">\n      <header className=\"bg-white/80 backdrop-blur-sm border-b border-gray-200\">\n        <div className=\"container mx-auto px-4 py-3\">\n          <Link to=\"/\" className=\"flex items-center gap-2 text-xl font-bold text-gray-900 hover:text-blue-600 transition-colors\">\n            <Home className=\"h-6 w-6 text-blue-600\" />\n            AgentBio.net\n          </Link>\n        </div>\n      </header>\n\n      <div className=\"flex items-center justify-center px-4 py-12\">\n        <div className=\"w-full max-w-md\">\n          <div className=\"text-center mb-8\">\n            <h1 className=\"text-3xl font-bold text-gray-900 mb-2\">\n              Create New Password\n            </h1>\n            <p className=\"text-gray-600\">\n              Please enter your new password below\n            </p>\n          </div>\n\n          <div className=\"bg-white rounded-lg shadow-lg p-8\">\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              {error && (\n                <div className=\"p-4 bg-red-50 border border-red-200 rounded-lg\">\n                  <p className=\"text-sm text-red-600\">{error}</p>\n                </div>\n              )}\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  New Password\n                </label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type={showPassword ? \"text\" : \"password\"}\n                    value={password}\n                    onChange={(e) => setPassword(e.target.value)}\n                    required\n                    minLength={12}\n                    className=\"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                    placeholder=\"••••••••\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowPassword(!showPassword)}\n                    className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors\"\n                    aria-label={showPassword ? \"Hide password\" : \"Show password\"}\n                  >\n                    {showPassword ? (\n                      <EyeOff className=\"h-5 w-5\" />\n                    ) : (\n                      <Eye className=\"h-5 w-5\" />\n                    )}\n                  </button>\n                </div>\n                <PasswordStrengthIndicator password={password} />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Confirm New Password\n                </label>\n                <div className=\"relative\">\n                  <Lock className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400\" />\n                  <input\n                    type={showConfirmPassword ? \"text\" : \"password\"}\n                    value={confirmPassword}\n                    onChange={(e) => setConfirmPassword(e.target.value)}\n                    required\n                    minLength={12}\n                    className=\"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                    placeholder=\"••••••••\"\n                  />\n                  <button\n                    type=\"button\"\n                    onClick={() => setShowConfirmPassword(!showConfirmPassword)}\n                    className=\"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors\"\n                    aria-label={showConfirmPassword ? \"Hide password\" : \"Show password\"}\n                  >\n                    {showConfirmPassword ? (\n                      <EyeOff className=\"h-5 w-5\" />\n                    ) : (\n                      <Eye className=\"h-5 w-5\" />\n                    )}\n                  </button>\n                </div>\n              </div>\n\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2\"\n              >\n                {loading ? (\n                  <>\n                    <Loader2 className=\"h-5 w-5 animate-spin\" />\n                    Updating Password...\n                  </>\n                ) : (\n                  \"Reset Password\"\n                )}\n              </button>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":["ResetPassword","navigate","useNavigate","password","setPassword","useState","confirmPassword","setConfirmPassword","showPassword","setShowPassword","showConfirmPassword","setShowConfirmPassword","loading","setLoading","error","setError","success","setSuccess","handleSubmit","e","supabase","jsxs","jsx","Link","Home","Check","Lock","EyeOff","Eye","PasswordStrengthIndicator","Fragment","Loader2"],"mappings":"sbAMA,SAAwBA,GAAgB,CACtC,MAAMC,EAAWC,EAAA,EACX,CAACC,EAAUC,CAAW,EAAIC,EAAAA,SAAS,EAAE,EACrC,CAACC,EAAiBC,CAAkB,EAAIF,EAAAA,SAAS,EAAE,EACnD,CAACG,EAAcC,CAAe,EAAIJ,EAAAA,SAAS,EAAK,EAChD,CAACK,EAAqBC,CAAsB,EAAIN,EAAAA,SAAS,EAAK,EAC9D,CAACO,EAASC,CAAU,EAAIR,EAAAA,SAAS,EAAK,EACtC,CAACS,EAAOC,CAAQ,EAAIV,EAAAA,SAAS,EAAE,EAC/B,CAACW,EAASC,CAAU,EAAIZ,EAAAA,SAAS,EAAK,EAEtCa,EAAe,MAAOC,GAAuB,CAIjD,GAHAA,EAAE,eAAA,EACFJ,EAAS,EAAE,EAEPZ,IAAaG,EAAiB,CAChCS,EAAS,uBAAuB,EAChC,MACF,CAGA,GAAIZ,EAAS,OAAS,GAAI,CACxBY,EAAS,yCAAyC,EAClD,MACF,CAGA,GAAI,CAAC,QAAQ,KAAKZ,CAAQ,EAAG,CAC3BY,EAAS,qDAAqD,EAC9D,MACF,CACA,GAAI,CAAC,QAAQ,KAAKZ,CAAQ,EAAG,CAC3BY,EAAS,qDAAqD,EAC9D,MACF,CACA,GAAI,CAAC,KAAK,KAAKZ,CAAQ,EAAG,CACxBY,EAAS,2CAA2C,EACpD,MACF,CACA,GAAI,CAAC,cAAc,KAAKZ,CAAQ,EAAG,CACjCY,EAAS,sDAAsD,EAC/D,MACF,CAEAF,EAAW,EAAI,EAEf,KAAM,CAAE,MAAAC,CAAAA,EAAU,MAAMM,EAAS,KAAK,WAAW,CAC/C,SAAAjB,CAAA,CACD,EAEGW,GACFC,EAASD,EAAM,OAAO,EACtBD,EAAW,EAAK,IAEhBI,EAAW,EAAI,EACf,WAAW,IAAM,CACfhB,EAAS,aAAa,CACxB,EAAG,GAAI,EAEX,EAEA,OAAIe,EAEAK,EAAAA,KAAC,MAAA,CAAI,UAAU,2DACb,SAAA,CAAAC,MAAC,SAAA,CAAO,UAAU,wDAChB,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,8BACb,SAAAD,EAAAA,KAACE,EAAA,CAAK,GAAG,IAAI,UAAU,gGACrB,SAAA,CAAAD,EAAAA,IAACE,EAAA,CAAK,UAAU,uBAAA,CAAwB,EAAE,cAAA,CAAA,CAE5C,EACF,EACF,QAEC,MAAA,CAAI,UAAU,8CACb,SAAAH,EAAAA,KAAC,MAAA,CAAI,UAAU,gEACb,SAAA,CAAAC,EAAAA,IAAC,OAAI,UAAU,oFACb,eAACG,EAAA,CAAM,UAAU,yBAAyB,CAAA,CAC5C,EACAH,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,6BAA0B,EAChFA,EAAAA,IAAC,IAAA,CAAE,UAAU,qBAAqB,SAAA,+CAElC,EACAA,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,6BAAA,CAErC,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,EAKFD,EAAAA,KAAC,MAAA,CAAI,UAAU,2DACb,SAAA,CAAAC,MAAC,SAAA,CAAO,UAAU,wDAChB,SAAAA,EAAAA,IAAC,MAAA,CAAI,UAAU,8BACb,SAAAD,EAAAA,KAACE,EAAA,CAAK,GAAG,IAAI,UAAU,gGACrB,SAAA,CAAAD,EAAAA,IAACE,EAAA,CAAK,UAAU,uBAAA,CAAwB,EAAE,cAAA,CAAA,CAE5C,EACF,EACF,QAEC,MAAA,CAAI,UAAU,8CACb,SAAAH,EAAAA,KAAC,MAAA,CAAI,UAAU,kBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,mBACb,SAAA,CAAAC,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,sBAEtD,EACAA,EAAAA,IAAC,IAAA,CAAE,UAAU,gBAAgB,SAAA,sCAAA,CAE7B,CAAA,EACF,EAEAA,EAAAA,IAAC,OAAI,UAAU,oCACb,gBAAC,OAAA,CAAK,SAAUJ,EAAc,UAAU,YACrC,SAAA,CAAAJ,GACCQ,EAAAA,IAAC,OAAI,UAAU,iDACb,eAAC,IAAA,CAAE,UAAU,uBAAwB,SAAAR,CAAA,CAAM,CAAA,CAC7C,SAGD,MAAA,CACC,SAAA,CAAAQ,EAAAA,IAAC,QAAA,CAAM,UAAU,+CAA+C,SAAA,eAEhE,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,CAAAC,EAAAA,IAACI,EAAA,CAAK,UAAU,gEAAA,CAAiE,EACjFJ,EAAAA,IAAC,QAAA,CACC,KAAMd,EAAe,OAAS,WAC9B,MAAOL,EACP,SAAWgB,GAAMf,EAAYe,EAAE,OAAO,KAAK,EAC3C,SAAQ,GACR,UAAW,GACX,UAAU,mHACV,YAAY,UAAA,CAAA,EAEdG,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAMb,EAAgB,CAACD,CAAY,EAC5C,UAAU,gGACV,aAAYA,EAAe,gBAAkB,gBAE5C,SAAAA,QACEmB,EAAA,CAAO,UAAU,UAAU,EAE5BL,EAAAA,IAACM,EAAA,CAAI,UAAU,SAAA,CAAU,CAAA,CAAA,CAE7B,EACF,EACAN,MAACO,GAA0B,SAAA1B,CAAA,CAAoB,CAAA,EACjD,SAEC,MAAA,CACC,SAAA,CAAAmB,EAAAA,IAAC,QAAA,CAAM,UAAU,+CAA+C,SAAA,uBAEhE,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,WACb,SAAA,CAAAC,EAAAA,IAACI,EAAA,CAAK,UAAU,gEAAA,CAAiE,EACjFJ,EAAAA,IAAC,QAAA,CACC,KAAMZ,EAAsB,OAAS,WACrC,MAAOJ,EACP,SAAWa,GAAMZ,EAAmBY,EAAE,OAAO,KAAK,EAClD,SAAQ,GACR,UAAW,GACX,UAAU,mHACV,YAAY,UAAA,CAAA,EAEdG,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAMX,EAAuB,CAACD,CAAmB,EAC1D,UAAU,gGACV,aAAYA,EAAsB,gBAAkB,gBAEnD,SAAAA,QACEiB,EAAA,CAAO,UAAU,UAAU,EAE5BL,EAAAA,IAACM,EAAA,CAAI,UAAU,SAAA,CAAU,CAAA,CAAA,CAE7B,CAAA,CACF,CAAA,EACF,EAEAN,EAAAA,IAAC,SAAA,CACC,KAAK,SACL,SAAUV,EACV,UAAU,yLAET,WACCS,EAAAA,KAAAS,EAAAA,SAAA,CACE,SAAA,CAAAR,EAAAA,IAACS,EAAA,CAAQ,UAAU,sBAAA,CAAuB,EAAE,sBAAA,CAAA,CAE9C,EAEA,gBAAA,CAAA,CAEJ,CAAA,CACF,CAAA,CACF,CAAA,CAAA,CACF,CAAA,CACF,CAAA,EACF,CAEJ"}